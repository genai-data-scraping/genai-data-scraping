/*
 For license information please see app.js.LICENSE.txt */
(function(fa){var c=window.AmazonUIPageJS||window.P,Sa=c._namespace||c.attributeErrors,O=Sa?Sa("RufusPanelWebAssetsBuild",""):c;O.guardFatal?O.guardFatal(fa)(O,window):O.execute(function(){fa(O,window)})})(function(fa,c,Sa){!function(){function O(c){var m=Nb[c];if(void 0!==m)return m.exports;m=Nb[c]={exports:{}};return Sa[c](m,m.exports,O),m.exports}var Sa={958:function(c,M,a){var m=a(463),G={codecs:{}};G.codecs.Codec=function(){return{encode:function(a,b){for(var y="",c=0;c<b.length;c++){var R=b.charAt(c);
y+=this.encodeCharacter(a,R)}return y},encodeCharacter:function(a,b){return b},decode:function(a){var b="";for(a=new G.codecs.PushbackString(a);a.hasNext();){var Fa=this.decodeCharacter(a);b+=null!=Fa?Fa:a.next()}return b},decodeCharacter:function(a){return a.next()}}};G.codecs.Codec.getHexForNonAlphanumeric=function(a){return 256>a.charCodeAt(0)?G.codecs.Codec.hex[a.charCodeAt(0)]:a.charCodeAt(0).toString(16)};G.codecs.Codec.hex=[];for(M=0;255>M;M++)G.codecs.Codec.hex[M]=48<=M&&57>=M||65<=M&&90>=
M||97<=M&&122>=M?null:M.toString(16);G.codecs.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d",encode:function(a){if(!a)return null;for(var b,Fa,c,R,m,z="",r=0,M=G.codecs.UTF8.encode(a);r<M.length;)a=(b=M.charCodeAt(r++))>>2,c=(3&b)<<4|(b=M.charCodeAt(r++))>>4,R=(15&b)<<2|(Fa=M.charCodeAt(r++))>>6,m=63&Fa,isNaN(b)?R=m=64:isNaN(Fa)&&(m=64),z+=this._keyStr.charAt(a)+this._keyStr.charAt(c)+this._keyStr.charAt(R)+this._keyStr.charAt(m);return z},decode:function(a){if(!a)return null;
for(var b,Fa,c,m,R="",r=0,z=a.replace(/[^A-Za-z0-9\+\/=]/g,"");r<z.length;)a=this._keyStr.indexOf(z.charAt(r++))<<2|(b=this._keyStr.indexOf(z.charAt(r++)))>>4,b=(15&b)<<4|(c=this._keyStr.indexOf(z.charAt(r++)))>>2,Fa=(3&c)<<6|(m=this._keyStr.indexOf(z.charAt(r++))),R+=String.fromCharCode(a),64!=c&&(R+=String.fromCharCode(b)),64!=m&&(R+=String.fromCharCode(Fa));return G.codecs.UTF8.decode(R)}};G.codecs.CSSCodec=function(){var a=new G.codecs.Codec;return{encode:a.encode,decode:a.decode,encodeCharacter:function(a,
b){if(m.contains(a,b))return b;a=G.codecs.Codec.getHexForNonAlphanumeric(b);return null==a?b:"\\"+a+" "},decodeCharacter:function(a){a.mark();var b=a.next();if(null==b||"\\"!=b)return a.reset(),null;b=a.next();if(null==b)return a.reset(),null;if(a.isHexDigit(b)){for(var y=0;6>y;y++){var c=a.next();if(null==c||32==c.charCodeAt(0))break;if(!a.isHexDigit(c)){input.pushback(c);break}b+=c}try{var m=parseInt(b,16);return String.fromCharCode(m)}catch(eb){return a.reset(),null}}return b}}};var b=[];b["\x26quot"]=
"34";b["\x26amp"]="38";b["\x26lt"]="60";b["\x26gt"]="62";b["\x26nbsp"]="160";b["\x26iexcl"]="161";b["\x26cent"]="162";b["\x26pound"]="163";b["\x26curren"]="164";b["\x26yen"]="165";b["\x26brvbar"]="166";b["\x26sect"]="167";b["\x26uml"]="168";b["\x26copy"]="169";b["\x26ordf"]="170";b["\x26laquo"]="171";b["\x26not"]="172";b["\x26shy"]="173";b["\x26reg"]="174";b["\x26macr"]="175";b["\x26deg"]="176";b["\x26plusmn"]="177";b["\x26sup2"]="178";b["\x26sup3"]="179";b["\x26acute"]="180";b["\x26micro"]="181";
b["\x26para"]="182";b["\x26middot"]="183";b["\x26cedil"]="184";b["\x26sup1"]="185";b["\x26ordm"]="186";b["\x26raquo"]="187";b["\x26frac14"]="188";b["\x26frac12"]="189";b["\x26frac34"]="190";b["\x26iquest"]="191";b["\x26Agrave"]="192";b["\x26Aacute"]="193";b["\x26Acirc"]="194";b["\x26Atilde"]="195";b["\x26Auml"]="196";b["\x26Aring"]="197";b["\x26AElig"]="198";b["\x26Ccedil"]="199";b["\x26Egrave"]="200";b["\x26Eacute"]="201";b["\x26Ecirc"]="202";b["\x26Euml"]="203";b["\x26Igrave"]="204";b["\x26Iacute"]=
"205";b["\x26Icirc"]="206";b["\x26Iuml"]="207";b["\x26ETH"]="208";b["\x26Ntilde"]="209";b["\x26Ograve"]="210";b["\x26Oacute"]="211";b["\x26Ocirc"]="212";b["\x26Otilde"]="213";b["\x26Ouml"]="214";b["\x26times"]="215";b["\x26Oslash"]="216";b["\x26Ugrave"]="217";b["\x26Uacute"]="218";b["\x26Ucirc"]="219";b["\x26Uuml"]="220";b["\x26Yacute"]="221";b["\x26THORN"]="222";b["\x26szlig"]="223";b["\x26agrave"]="224";b["\x26aacute"]="225";b["\x26acirc"]="226";b["\x26atilde"]="227";b["\x26auml"]="228";b["\x26aring"]=
"229";b["\x26aelig"]="230";b["\x26ccedil"]="231";b["\x26egrave"]="232";b["\x26eacute"]="233";b["\x26ecirc"]="234";b["\x26euml"]="235";b["\x26igrave"]="236";b["\x26iacute"]="237";b["\x26icirc"]="238";b["\x26iuml"]="239";b["\x26eth"]="240";b["\x26ntilde"]="241";b["\x26ograve"]="242";b["\x26oacute"]="243";b["\x26ocirc"]="244";b["\x26otilde"]="245";b["\x26ouml"]="246";b["\x26divide"]="247";b["\x26oslash"]="248";b["\x26ugrave"]="249";b["\x26uacute"]="250";b["\x26ucirc"]="251";b["\x26uuml"]="252";b["\x26yacute"]=
"253";b["\x26thorn"]="254";b["\x26yuml"]="255";b["\x26OElig"]="338";b["\x26oelig"]="339";b["\x26Scaron"]="352";b["\x26scaron"]="353";b["\x26Yuml"]="376";b["\x26fnof"]="402";b["\x26circ"]="710";b["\x26tilde"]="732";b["\x26Alpha"]="913";b["\x26Beta"]="914";b["\x26Gamma"]="915";b["\x26Delta"]="916";b["\x26Epsilon"]="917";b["\x26Zeta"]="918";b["\x26Eta"]="919";b["\x26Theta"]="920";b["\x26Iota"]="921";b["\x26Kappa"]="922";b["\x26Lambda"]="923";b["\x26Mu"]="924";b["\x26Nu"]="925";b["\x26Xi"]="926";b["\x26Omicron"]=
"927";b["\x26Pi"]="928";b["\x26Rho"]="929";b["\x26Sigma"]="931";b["\x26Tau"]="932";b["\x26Upsilon"]="933";b["\x26Phi"]="934";b["\x26Chi"]="935";b["\x26Psi"]="936";b["\x26Omega"]="937";b["\x26alpha"]="945";b["\x26beta"]="946";b["\x26gamma"]="947";b["\x26delta"]="948";b["\x26epsilon"]="949";b["\x26zeta"]="950";b["\x26eta"]="951";b["\x26theta"]="952";b["\x26iota"]="953";b["\x26kappa"]="954";b["\x26lambda"]="955";b["\x26mu"]="956";b["\x26nu"]="957";b["\x26xi"]="958";b["\x26omicron"]="959";b["\x26pi"]=
"960";b["\x26rho"]="961";b["\x26sigmaf"]="962";b["\x26sigma"]="963";b["\x26tau"]="964";b["\x26upsilon"]="965";b["\x26phi"]="966";b["\x26chi"]="967";b["\x26psi"]="968";b["\x26omega"]="969";b["\x26thetasym"]="977";b["\x26upsih"]="978";b["\x26piv"]="982";b["\x26ensp"]="8194";b["\x26emsp"]="8195";b["\x26thinsp"]="8201";b["\x26zwnj"]="8204";b["\x26zwj"]="8205";b["\x26lrm"]="8206";b["\x26rlm"]="8207";b["\x26ndash"]="8211";b["\x26mdash"]="8212";b["\x26lsquo"]="8216";b["\x26rsquo"]="8217";b["\x26sbquo"]=
"8218";b["\x26ldquo"]="8220";b["\x26rdquo"]="8221";b["\x26bdquo"]="8222";b["\x26dagger"]="8224";b["\x26Dagger"]="8225";b["\x26bull"]="8226";b["\x26hellip"]="8230";b["\x26permil"]="8240";b["\x26prime"]="8242";b["\x26Prime"]="8243";b["\x26lsaquo"]="8249";b["\x26rsaquo"]="8250";b["\x26oline"]="8254";b["\x26frasl"]="8260";b["\x26euro"]="8364";b["\x26image"]="8365";b["\x26weierp"]="8472";b["\x26real"]="8476";b["\x26trade"]="8482";b["\x26alefsym"]="8501";b["\x26larr"]="8592";b["\x26uarr"]="8593";b["\x26rarr"]=
"8594";b["\x26darr"]="8595";b["\x26harr"]="8596";b["\x26crarr"]="8629";b["\x26lArr"]="8656";b["\x26uArr"]="8657";b["\x26rArr"]="8658";b["\x26dArr"]="8659";b["\x26hArr"]="8660";b["\x26forall"]="8704";b["\x26part"]="8706";b["\x26exist"]="8707";b["\x26empty"]="8709";b["\x26nabla"]="8711";b["\x26isin"]="8712";b["\x26notin"]="8713";b["\x26ni"]="8715";b["\x26prod"]="8719";b["\x26sum"]="8721";b["\x26minus"]="8722";b["\x26lowast"]="8727";b["\x26radic"]="8730";b["\x26prop"]="8733";b["\x26infin"]="8734";b["\x26ang"]=
"8736";b["\x26and"]="8743";b["\x26or"]="8744";b["\x26cap"]="8745";b["\x26cup"]="8746";b["\x26int"]="8747";b["\x26there4"]="8756";b["\x26sim"]="8764";b["\x26cong"]="8773";b["\x26asymp"]="8776";b["\x26ne"]="8800";b["\x26equiv"]="8801";b["\x26le"]="8804";b["\x26ge"]="8805";b["\x26sub"]="8834";b["\x26sup"]="8835";b["\x26nsub"]="8836";b["\x26sube"]="8838";b["\x26supe"]="8839";b["\x26oplus"]="8853";b["\x26otimes"]="8855";b["\x26perp"]="8869";b["\x26sdot"]="8901";b["\x26lceil"]="8968";b["\x26rceil"]="8969";
b["\x26lfloor"]="8970";b["\x26rfloor"]="8971";b["\x26lang"]="9001";b["\x26rang"]="9002";b["\x26loz"]="9674";b["\x26spades"]="9824";b["\x26clubs"]="9827";b["\x26hearts"]="9829";b["\x26diams"]="9830";var r=[],z;for(z in b)r[b[z]]=z;G.codecs.HTMLEntityCodec=function(){var a=new G.codecs.Codec;return{encode:a.encode,decode:a.decode,encodeCharacter:function(a,b){if(m.contains(a,b))return b;a=G.codecs.Codec.getHexForNonAlphanumeric(b);if(null==a)return b;var y=b.charCodeAt(0);if(31>=y&&"\t"!=b&&"\n"!=b&&
"\r"!=b||127<=y&&159>=y||" "==b)return" ";b=r[y];return null!=b?b+";":"\x26#x"+a+";"},decodeCharacter:function(a){a.mark();var y=a.next();if(null==y||"\x26"!=y)return a.reset(),null;y=a.next();if(null==y)return a.reset(),null;if("#"==y){var c=function(a){var b=a.peek();return null==b?null:"x"==b||"X"==b?(a.next(),function(a){for(var b="";a.hasNext();){var y=a.peek();if(!y.match(/[0-9A-Fa-f]/)){if(";"==y){a.next();break}break}b+=y;a.next()}try{return parseInt(b,16)}catch(pb){return null}}(a)):function(a){for(var b=
"";a.hasNext();){var y=a.peek();if(!y.match(/[0-9]/)){if(";"==y){a.next();break}break}b+=y;a.next()}try{return parseInt(b)}catch(pb){return null}}(a)}(a);if(null!=c)return c}else if(y.match(/[A-Za-z]/)&&(a.pushback(y),c=function(a){for(var y="";a.hasNext();){var c=a.peek();if(c.match(/[A-Za-z]/)){if(y+=c,a.next(),m.containsKey(b,"\x26"+y)){a.peek(";")&&a.next();break}}else{if(";"!=c)break;a.next()}}return String.fromCharCode(b.getCaseInsensitive("\x26"+y))}(a),null!=c))return c;return a.reset(),null}}};
G.codecs.JavascriptCodec=function(){return{encode:function(a,b){for(var y="",c=0;c<b.length;c++){var R=b.charAt(c);if(m.contains(a,R))y+=R;else if(null==G.codecs.Codec.getHexForNonAlphanumeric(R))y+=R;else{var r=R.charCodeAt(0).toString(16);256>R.charCodeAt(0)?(R="00".substr(r.length),y+="\\x"+R+r.toUpperCase()):y+="\\u"+"0000".substr(r.length)+r.toUpperCase()}}return y},decode:(new G.codecs.Codec).decode,decodeCharacter:function(a){a.mark();var b=a.next();if(null==b||"\\"!=b)return a.reset(),null;
b=a.next();if(null==b)return a.reset(),null;if("b"==b)return 8;if("t"==b)return 9;if("n"==b)return 10;if("v"==b)return 11;if("f"==b)return 12;if("r"==b)return 13;if('"'==b)return 34;if("'"==b)return 39;if("\\"==b)return 92;if("x"==b.toLowerCase()){b="";for(var c=0;2>c;c++){var m=a.nextHex();if(null==m)return input.reset(),null;b+=m}try{return r=parseInt(b,16),String.fromCharCode(r)}catch(ob){return a.reset(),null}}else if("u"==b.toLowerCase()){b="";for(c=0;4>c;c++){if(null==(m=a.nextHex()))return input.reset(),
null;b+=m}try{var r=parseInt(b,16);return String.fromCharCode(r)}catch(ob){return a.reset(),null}}else if(a.isOctalDigit(b)){c=a.next();a.isOctalDigit(c)?(b+=c,c=a.next(),a.isOctalDigit(c)?b+=c:a.pushback(c)):a.pushback(c);try{return r=parseInt(b,8),String.fromCharCode(r)}catch(ob){return a.reset(),null}}return b}}};G.codecs.PercentCodec=function(){var a=new G.codecs.Codec;return{encode:a.encode,decode:a.decode,encodeCharacter:function(a,b){if(-1<"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".indexOf(b))return b;
a=G.codecs.UTF8.encode(b);var c="";for(b=0;b<a.length;b++){var y=a.charCodeAt(b),m="";if(-128>y||127<y)throw new IllegalArgumentException("b is not a byte (was "+y+")");var r=(16>(y&=255)&&(m+="0"),m+y.toString(16).toUpperCase());c+="%"+r}return c},decodeCharacter:function(a){a.mark();var b=a.next();if(null==b||"%"!=b)return a.reset(),null;b="";for(var c=0;2>c;c++){var y=a.nextHex();null!=y&&(b+=y)}if(2==b.length)try{var m=parseInt(b,16);return String.fromCharCode(m)}catch(eb){}return a.reset(),null}}};
G.codecs.PushbackString=function(a){var b="",c="",m=0,r=0;return{pushback:function(a){b=a},index:function(){return m},hasNext:function(){return null!=b||!(null==a||0==a.length||m>=a.length)},next:function(){if(null!=b){var c=b;return b=null,c}return null==a||0==a.length||m>=a.length?null:a.charAt(m++)},nextHex:function(){var a=this.next();return this.isHexDigit(a)?a:null},nextOctal:function(){var a=this.next();return this.isOctalDigit(a)?a:null},isHexDigit:function(a){return null!=a&&("0"<=a&&"9">=
a||"a"<=a&&"f">=a||"A"<=a&&"F">=a)},isOctalDigit:function(a){return null!=a&&"0"<=a&&"7">=a},peek:function(c){return c?null!=b&&b==c||!(null==a||0==a.length||m>=a.length)&&a.charAt(m)==c:null!=b?b:null==a||0==a.length||m>=a.length?null:a.charAt(m)},mark:function(){c=b;r=m},reset:function(){b=c;m=r},remainder:function(){var c=a.substr(m);return null!=b&&(c=b+c),c}}};G.codecs.UTF8={encode:function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var m=a.charCodeAt(c);128>m?b+=String.fromCharCode(m):
127<m&&2048>m?(b+=String.fromCharCode(m>>6|192),b+=String.fromCharCode(63&m|128)):(b+=String.fromCharCode(m>>12|224),b+=String.fromCharCode(m>>6&63|128),b+=String.fromCharCode(63&m|128))}return b},decode:function(a){var b,c,m,r,z="";for(b=c=m=0;b<a.length;)128>(c=a.charCodeAt(b))?(z+=String.fromCharCode(c),b++):191<c&&224>c?(m=a.charCodeAt(b+1),z+=String.fromCharCode((31&c)<<6|63&m),b+=2):(m=utftext.charCodeAt(b+1),r=utftext.charCodeAt(b+2),String.fromCharCode((15&c)<<12|(63&m)<<6|63&r),b+=3);return z}};
G.DefaultEncoder=function(a){var b=[],c=new G.codecs.HTMLEntityCodec,m=new G.codecs.JavascriptCodec,r=new G.codecs.CSSCodec,z=new G.codecs.PercentCodec;a?b=a:(b.push(c),b.push(m),b.push(r),b.push(z));var M=[",",".","-","_"," "],R=[",",".","-","_"],O=[],fa=[",",".","_"];return{cananicalize:function(a,c){if(!a)return null;for(var m=a,r=null,z=1,y=0,M=!1;!M;)M=!0,b.each(function(a){m!=(m=a.decode(m))&&(null!=r&&r!=a&&z++,r=a,M&&y++,M=!1)});if(2<=y&&1<z){if(c)throw new G.IntrusionException("Input validation failure",
"Multiple ("+y+"x) and mixed encoding ("+z+"x) detected in "+a);}else if(2<=y){if(c)throw new G.IntrusionException("Input validation failure","Multiple ("+y+"x) encoding detected in "+a);}else if(1<z&&c)throw new G.IntrusionException("Input validation failure","Mixed ("+z+"x) encoding detected in "+a);return m},normalize:function(a){return a.replace(/[^\x00-\x7F]/g,"")},encodeForHTML:function(a){return a?c.encode(M,a):null},decodeForHTML:function(a){return a?c.decode(a):null},encodeForHTMLAttribute:function(a){return a?
c.encode(R,a):null},encodeForCSS:function(a){return a?r.encode(O,a):null},encodeForJavaScript:function(a){return a?m.encode(fa,a):null},encodeForJavascript:this.encodeForJavaScript,encodeForJS:this.encodeForJavascript,encodeForURL:function(a){return a?escape(a):null},decodeFromURL:function(a){return a?unescape(a):null},encodeForBase64:function(a){return a?G.codecs.Base64.encode(a):null},decodeFromBase64:function(a){return a?G.codecs.Base64.decode(a):null}}};c.exports={encoder:function(){return G.DefaultEncoder()},
middleware:function(){return m.middleware}}},463:function(c){c.exports.contains=function(c,a){return c.some(function(c){if(a.equals&&a.equals(e)||c===a)return!0})};c.exports.containsKey=function(c,a){if("string"==typeof a){var m=a.toLowerCase();return c.some(function(a,b){if(m===b||"string"==typeof b&&m===b.toLowerCase())return!0})}return!1};c.exports.middleware=function(c,a,m){switch(c.url){case "/esapi/esapi.js":a.sendfile("//public/esapi.js");break;case "/esapi/esapi-compressed.js":a.sendfile("//public/esapi-compressed.js");
break;case "/esapi/resources/Base.esapi.properties.js":a.sendfile("//public/resources/Base.esapi.properties.js");break;case "/esapi/resources/i18n/ESAPI_Standard_en_US.properties.js":a.sendfile("//public/resources/i18n/ESAPI_Standard_en_US.properties.js");break;default:m()}}},223:function(c,M,a){function m(){function a(a,b,c){return Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}),a[b]}function r(a,b,c,m){b=Object.create((b&&b.prototype instanceof M?b:M).prototype);m=
new pb(m||[]);return qb(b,"_invoke",{value:ob(a,c,m)}),b}function z(a,b,c){try{return{type:"normal",arg:a.call(b,c)}}catch(W){return{type:"throw",arg:W}}}function M(){}function y(){}function O(){}function fa(b){["next","throw","return"].forEach(function(c){a(b,c,function(a){return this._invoke(c,a)})})}function ic(a,b){function c(m,r,U,Wa){m=z(a[m],a,r);if("throw"!==m.type){var y=m.arg;return(m=y.value)&&"object"==G(m)&&J.call(m,"__await")?b.resolve(m.__await).then(function(a){c("next",a,U,Wa)},function(a){c("throw",
a,U,Wa)}):b.resolve(m).then(function(a){y.value=a;U(y)},function(a){return c("throw",a,U,Wa)})}Wa(m.arg)}var m;qb(this,"_invoke",{value:function(a,U){function r(){return new b(function(b,m){c(a,U,b,m)})}return m=m?m.then(r,r):r()}})}function ob(a,b,c){var m=Ob;return function(r,U){if(m===Pb)throw Error("Generator is already running");if(m===sb){if("throw"===r)throw U;return{value:Ba,done:!0}}c.method=r;for(c.arg=U;;){if(r=c.delegate)if(r=eb(r,c)){if(r===ua)continue;return r}if("next"===c.method)c.sent=
c._sent=c.arg;else if("throw"===c.method){if(m===Ob)throw m=sb,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);m=Pb;r=z(a,b,c);if("normal"===r.type){if(m=c.done?sb:Qb,r.arg===ua)continue;return{value:r.arg,done:c.done}}"throw"===r.type&&(m=sb,c.method="throw",c.arg=r.arg)}}}function eb(a,b){var c=b.method,m=a.iterator[c];if(m===Ba)return b.delegate=null,"throw"===c&&a.iterator.return&&(b.method="return",b.arg=Ba,eb(a,b),"throw"===b.method)||"return"!==c&&(b.method=
"throw",b.arg=new TypeError("The iterator does not provide a '"+c+"' method")),ua;c=z(m,a.iterator,b.arg);return"throw"===c.type?(b.method="throw",b.arg=c.arg,b.delegate=null,ua):(c=c.arg)?c.done?(b[a.resultName]=c.value,b.next=a.nextLoc,"return"!==b.method&&(b.method="next",b.arg=Ba),b.delegate=null,ua):c:(b.method="throw",b.arg=new TypeError("iterator result is not an object"),b.delegate=null,ua)}function Sa(a){var b={tryLoc:a[0]};1 in a&&(b.catchLoc=a[1]);2 in a&&(b.finallyLoc=a[2],b.afterLoc=
a[3]);this.tryEntries.push(b)}function Na(a){var b=a.completion||{};b.type="normal";delete b.arg;a.completion=b}function pb(a){this.tryEntries=[{tryLoc:"root"}];a.forEach(Sa,this);this.reset(!0)}function zb(a){if(a||""===a){var b=a[rb];if(b)return b.call(a);if("function"==typeof a.next)return a;if(!isNaN(a.length)){var c=-1;b=function ya(){for(;++c<a.length;)if(J.call(a,c))return ya.value=a[c],ya.done=!1,ya;return ya.value=Ba,ya.done=!0,ya};return b.next=b}}throw new TypeError(G(a)+" is not iterable");
}c.exports=m=function(){return Ca};c.exports.__esModule=!0;c.exports.default=c.exports;var Ba,Ca={},jc=Object.prototype,J=jc.hasOwnProperty,qb=Object.defineProperty||function(a,b,c){a[b]=c.value},Ta="function"==typeof Symbol?Symbol:{},rb=Ta.iterator||"@@iterator",kc=Ta.asyncIterator||"@@asyncIterator",Rb=Ta.toStringTag||"@@toStringTag";try{a({},"")}catch(Wa){a=function(a,b,c){return a[b]=c}}Ca.wrap=r;var Ob="suspendedStart",Qb="suspendedYield",Pb="executing",sb="completed",ua={};Ta={};a(Ta,rb,function(){return this});
var Ja=Object.getPrototypeOf;(Ja=Ja&&Ja(Ja(zb([]))))&&Ja!==jc&&J.call(Ja,rb)&&(Ta=Ja);var Ka=O.prototype=M.prototype=Object.create(Ta);return y.prototype=O,qb(Ka,"constructor",{value:O,configurable:!0}),qb(O,"constructor",{value:y,configurable:!0}),y.displayName=a(O,Rb,"GeneratorFunction"),Ca.isGeneratorFunction=function(a){a="function"==typeof a&&a.constructor;return!!a&&(a===y||"GeneratorFunction"===(a.displayName||a.name))},Ca.mark=function(b){return Object.setPrototypeOf?Object.setPrototypeOf(b,
O):(b.__proto__=O,a(b,Rb,"GeneratorFunction")),b.prototype=Object.create(Ka),b},Ca.awrap=function(a){return{__await:a}},fa(ic.prototype),a(ic.prototype,kc,function(){return this}),Ca.AsyncIterator=ic,Ca.async=function(a,b,c,m,y){void 0===y&&(y=Promise);var z=new ic(r(a,b,c,m),y);return Ca.isGeneratorFunction(b)?z:z.next().then(function(a){return a.done?a.value:z.next()})},fa(Ka),a(Ka,Rb,"Generator"),a(Ka,rb,function(){return this}),a(Ka,"toString",function(){return"[object Generator]"}),Ca.keys=function(a){var b=
Object(a),c=[],m;for(m in b)c.push(m);return c.reverse(),function Ya(){for(;c.length;){var a=c.pop();if(a in b)return Ya.value=a,Ya.done=!1,Ya}return Ya.done=!0,Ya}},Ca.values=zb,pb.prototype={constructor:pb,reset:function(a){if(this.prev=0,this.next=0,this.sent=this._sent=Ba,this.done=!1,this.delegate=null,this.method="next",this.arg=Ba,this.tryEntries.forEach(Na),!a)for(var b in this)"t"===b.charAt(0)&&J.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=Ba)},stop:function(){this.done=!0;var a=this.tryEntries[0].completion;
if("throw"===a.type)throw a.arg;return this.rval},dispatchException:function(a){function b(b,m){return y.type="throw",y.arg=a,c.next=b,m&&(c.method="next",c.arg=Ba),!!m}if(this.done)throw a;for(var c=this,m=this.tryEntries.length-1;0<=m;--m){var r=this.tryEntries[m],y=r.completion;if("root"===r.tryLoc)return b("end");if(r.tryLoc<=this.prev){var z=J.call(r,"catchLoc"),G=J.call(r,"finallyLoc");if(z&&G){if(this.prev<r.catchLoc)return b(r.catchLoc,!0);if(this.prev<r.finallyLoc)return b(r.finallyLoc)}else if(z){if(this.prev<
r.catchLoc)return b(r.catchLoc,!0)}else{if(!G)throw Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return b(r.finallyLoc)}}}},abrupt:function(a,b){for(var c=this.tryEntries.length-1;0<=c;--c){var m=this.tryEntries[c];if(m.tryLoc<=this.prev&&J.call(m,"finallyLoc")&&this.prev<m.finallyLoc){var r=m;break}}r&&("break"===a||"continue"===a)&&r.tryLoc<=b&&b<=r.finallyLoc&&(r=null);c=r?r.completion:{};return c.type=a,c.arg=b,r?(this.method="next",this.next=r.finallyLoc,ua):this.complete(c)},
complete:function(a,b){if("throw"===a.type)throw a.arg;return"break"===a.type||"continue"===a.type?this.next=a.arg:"return"===a.type?(this.rval=this.arg=a.arg,this.method="return",this.next="end"):"normal"===a.type&&b&&(this.next=b),ua},finish:function(a){for(var b=this.tryEntries.length-1;0<=b;--b){var c=this.tryEntries[b];if(c.finallyLoc===a)return this.complete(c.completion,c.afterLoc),Na(c),ua}},catch:function(a){for(var b=this.tryEntries.length-1;0<=b;--b){var c=this.tryEntries[b];if(c.tryLoc===
a){a=c.completion;if("throw"===a.type){var m=a.arg;Na(c)}return m}}throw Error("illegal catch attempt");},delegateYield:function(a,b,c){return this.delegate={iterator:zb(a),resultName:b,nextLoc:c},"next"===this.method&&(this.arg=Ba),ua}},Ca}var G=a(584).default;c.exports=m;c.exports.__esModule=!0;c.exports.default=c.exports},584:function(c){function m(a){return c.exports=m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&
a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},c.exports.__esModule=!0,c.exports.default=c.exports,m(a)}c.exports=m;c.exports.__esModule=!0;c.exports.default=c.exports},578:function(c,M,a){function m(a){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},m(a)}M=a(223)();c.exports=M;try{regeneratorRuntime=M}catch(G){"object"===
("undefined"==typeof globalThis?"undefined":m(globalThis))?globalThis.regeneratorRuntime=M:Function("r","regeneratorRuntime \x3d r")(M)}},278:function(c){c.exports=JSON.parse('{"ar":{"strings":{"default_error_message":"حدث خطأ ما. يرجى المحاولة مرة أخرى لاحقًا.","general_error_message":"عذرًا، لقد حدث خطأ ما.","offline_error_message":"عذرًا، فقدنا الاتصال.\\nتحقّق مرة أخرى من الإنترنت الخاص بك، ثم دعنا نجرّب ذلك مرة أخرى.","rufus_panel_close":"أغلق لوحة Rufus","rufus_panel_open":"افتح لوحة Rufus"}}}')},
214:function(c){c.exports=JSON.parse('{"de":{"strings":{"default_error_message":"Etwas ist schief gelaufen. Bitte versuch es später erneut.","general_error_message":"Es tut uns leid, aber etwas ist schief gelaufen.","offline_error_message":"Oh nein, wir haben die Verbindung verloren.\\nÜberprüfe noch einmal dein Internet und lass es uns dann noch einmal versuchen.","rufus_panel_close":"Rufus-Panel schließen","rufus_panel_open":"Rufus-Panel öffnen"}}}')},494:function(c){c.exports=JSON.parse('{"en":{"strings":{"default_error_message":"Something went wrong. Please try again later.","general_error_message":"Sorry, but something went wrong.","offline_error_message":"Oh no, we lost connection.\\nDouble check your internet, then let\'s try this again.","rufus_panel_close":"Close Rufus panel","rufus_panel_open":"Open Rufus panel"}},"en-CA":{"strings":{}},"en-GB":{"strings":{}},"en-IN":{"strings":{}},"en-US":{"strings":{}}}')},
45:function(c){c.exports=JSON.parse('{"es":{"strings":{"default_error_message":"Algo salió mal. Inténtalo de nuevo más tarde.","general_error_message":"Lo siento, pero algo salió mal."}},"es-ES":{"strings":{"offline_error_message":"Oh, no, hemos perdido la conexión.\\nComprueba tu conexión a Internet y, a continuación, volvamos a intentarlo.","rufus_panel_close":"Cerrar el panel Rufus","rufus_panel_open":"Abrir el panel Rufus"}},"es-US":{"strings":{"offline_error_message":"Oh, no. Se perdió la conexión.\\nVuelve a verificar tu internet e intenta de nuevo.","rufus_panel_close":"Cerrar panel Rufus","rufus_panel_open":"Abrir panel Rufus"}}}')},
925:function(c){c.exports=JSON.parse('{"fr":{"strings":{"general_error_message":"Nous sommes désolés, une erreur s’est produite.","rufus_panel_close":"Fermer le panneau Rufus","rufus_panel_open":"Ouvrir le panneau Rufus"}},"fr-CA":{"strings":{"default_error_message":"Une erreur s’est produite. Veuillez réessayer plus tard.","offline_error_message":"Oh non, nous avons perdu la connexion.\\nVérifiez votre connexion Internet, puis essayons à nouveau."}},"fr-FR":{"strings":{"default_error_message":"Une erreur s\'est produite. Réessayez ultérieurement.","offline_error_message":"Oh non, nous avons perdu la connexion.\\nVérifiez à nouveau votre connexion Internet, puis réessayez."}}}')},
602:function(c){c.exports=JSON.parse('{"he":{"strings":{"default_error_message":"משהו השתבש. נא לנסות שוב מאוחר יותר.","general_error_message":"מצטערים, אבל משהו השתבש.","offline_error_message":"אוי לא, החיבור אבד.\\nיש לבדוק שוב את האינטרנט שלך, וננסה את זה שוב.","rufus_panel_close":"סגור את חלונית Rufus","rufus_panel_open":"פתח את חלונית Rufus"}}}')},992:function(c){c.exports=JSON.parse('{"it":{"strings":{"default_error_message":"Si è verificato un errore. Riprova più tardi.","general_error_message":"Siamo spiacenti, ma si è verificato un problema.","offline_error_message":"Oh no, abbiamo perso la connessione.\\nRicontrolla la connessione internet, poi riproviamo.","rufus_panel_close":"Chiudi il pannello Rufus","rufus_panel_open":"Apri il pannello Rufus"}}}')},
300:function(c){c.exports=JSON.parse('{"ja":{"strings":{"default_error_message":"問題が発生しました。 しばらくしてから、もう一度お試しください。","general_error_message":"申し訳ありませんが、問題が発生しました。","offline_error_message":"申し訳ありませんが、接続が切断されました。\\nインターネットを再確認してから、もう一度試してみましょう。","rufus_panel_close":"ルーファスパネルを閉じる","rufus_panel_open":"ルーファスパネルを開く"}}}')},743:function(c){c.exports=JSON.parse('{"ko":{"strings":{"default_error_message":"문제가 발생했습니다. 나중에 다시 시도하세요.","general_error_message":"죄송하지만 문제가 발생했습니다.","offline_error_message":"이런, 연결이 끊겼네요.\\n인터넷을 다시 한 번 확인한 다음 다시 시도해 보죠.","rufus_panel_close":"Rufus 패널 닫기","rufus_panel_open":"Rufus 패널 열기"}}}')},
61:function(c){c.exports=JSON.parse('{"pt":{"strings":{"rufus_panel_open":"Abrir painel Rufus"}},"pt-BR":{"strings":{"default_error_message":"Algo deu errado. Tente novamente mais tarde.","general_error_message":"Desculpe, ocorreu um erro.","offline_error_message":"Ah, não, perdemos a conexão.\\nVerifique sua Internet e, em seguida, vamos tentar novamente.","rufus_panel_close":"Fechar painel Rufus"}},"pt-PT":{"strings":{"default_error_message":"Ocorreu um erro. Tente novamente mais tarde.","general_error_message":"Lamentamos, mas ocorreu um erro.","offline_error_message":"Perdemos a ligação.\\nVerifique novamente a ligação à Internet e, em seguida, vamos tentar novamente.","rufus_panel_close":"Fechar painel do Rufus"}}}')},
847:function(c){c.exports=JSON.parse('{"zh-CN":{"strings":{"default_error_message":"出错了。 请稍后再试。","general_error_message":"抱歉，出错了。","offline_error_message":"抱歉，我们的连接中断了。\\n仔细检查您的互联网连接，然后再试一次。","rufus_panel_close":"关闭 Rufus 面板","rufus_panel_open":"打开 Rufus 面板"}},"zh-TW":{"strings":{"default_error_message":"發生錯誤。 請稍後再試一次。","general_error_message":"很抱歉，發生錯誤。","offline_error_message":"哦不，我們的連線中斷了。\\n再次檢查您的網際網路，然後再試一次。","rufus_panel_close":"關閉 Rufus 面板","rufus_panel_open":"打開 Rufus 面板"}}}')},254:function(c){c.exports=
JSON.parse('{"und":{"strings":{"default_error_message":"Something went wrong. Please try again later.","general_error_message":"Sorry, but something went wrong.","offline_error_message":"Oh no, we lost connection.\\nDouble check your internet, then let\'s try this again.","rufus_panel_close":"Close Rufus panel","rufus_panel_open":"Open Rufus panel"}}}')}},Nb={};O.n=function(c){var m=c&&c.__esModule?function(){return c.default}:function(){return c};return O.d(m,{a:m}),m};O.d=function(c,M){for(var a in M)O.o(M,
a)&&!O.o(c,a)&&Object.defineProperty(c,a,{enumerable:!0,get:M[a]})};O.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||(new Function("return this"))()}catch(m){if("object"==typeof c)return c}}();O.o=function(c,M){return Object.prototype.hasOwnProperty.call(c,M)};(function(){function m(a){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?
"symbol":typeof a},m(a)}function M(a){a:if("object"==m(a)&&a){var n=a[Symbol.toPrimitive];if(void 0!==n){a=n.call(a,"string");if("object"!=m(a))break a;throw new TypeError("@@toPrimitive must return a primitive value.");}a=String(a)}return"symbol"==m(a)?a:a+""}function a(a,n,b){return(n=M(n))in a?Object.defineProperty(a,n,{value:b,enumerable:!0,configurable:!0,writable:!0}):a[n]=b,a}function Sa(a,b,c,ba,k,da,p){try{var n=a[da](p),v=n.value}catch(I){return void c(I)}n.done?b(v):Promise.resolve(v).then(ba,
k)}function G(a){return function(){var b=this,v=arguments;return new Promise(function(n,c){function oa(a){Sa(k,n,c,oa,ba,"next",a)}function ba(a){Sa(k,n,c,oa,ba,"throw",a)}var k=a.apply(b,v);oa(void 0)})}}function b(a,b){for(var n=0;n<b.length;n++){var v=b[n];v.enumerable=v.enumerable||!1;v.configurable=!0;"value"in v&&(v.writable=!0);Object.defineProperty(a,M(v.key),v)}}function r(a,n,c){return n&&b(a.prototype,n),c&&b(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a}function z(a,b){if(!(a instanceof
b))throw new TypeError("Cannot call a class as a function");}function R(a,b){if(b&&("object"==m(b)||"function"==typeof b))return b;if(void 0!==b)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function y(a){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},y(a)}function Fa(a,b){return Fa=Object.setPrototypeOf?
Object.setPrototypeOf.bind():function(a,b){return a.__proto__=b,a},Fa(a,b)}function Aa(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}});Object.defineProperty(a,"prototype",{writable:!1});b&&Fa(a,b)}function nb(a){var b=document.getElementById("nav-flyout-rufus");if(b)return b=b.getElementsByTagName("input"),(b=Array.from(b).find(function(b){return b.name===
a}))&&b.value?b.value:""}function ob(){return crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:3&b|8).toString(16)})}function eb(a,b){(null==b||b>a.length)&&(b=a.length);for(var v=0,n=Array(b);v<b;v++)n[v]=a[v];return n}function Nb(a,b){if(a){if("string"==typeof a)return eb(a,b);var n={}.toString.call(a).slice(8,-1);return"Object"===n&&a.constructor&&(n=a.constructor.name),"Map"===n||"Set"===n?
Array.from(a):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eb(a,b):void 0}}function Na(a,b){if(!(a=function(a){if(Array.isArray(a))return a}(a)||function(a,b){var n=null==a?null:"undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(null!=n){var v,c,oa,ba=[],I=!0,h=!1;try{if(c=(n=n.call(a)).next,0===b){if(Object(n)!==n)return;I=!1}else for(;!(I=(v=c.call(n)).done)&&(ba.push(v.value),ba.length!==b);I=!0);}catch(f){h=!0;var x=f}finally{try{if(!I&&null!=n.return&&(oa=
n.return(),Object(oa)!==oa))return}finally{if(h)throw x;}}return ba}}(a,b)||Nb(a,b)))throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return a}function pb(){var a=navigator.userAgent;for(var b="",c="",ba=0,k=Object.entries({Chrome:/Chrome\/(\d+\.\d+\.\d+\.\d+)/i,Firefox:/Firefox\/(\d+\.\d+)/i,Safari:/Version\/(\d+(\.\d+)+)\s+Safari\/(\d+(\.\d+)+)/i,Edge:/Edge\/(\d+\.\d+\.\d+)/i,IE:/(MSIE |Trident\/\d+\.\d+;.*rv:(\d+\.\d+))/i});ba<
k.length;ba++){var da=Na(k[ba],2),p=da[0];if((da=a.match(da[1]))&&2<=da.length){b=p;c=da[1];break}}a=a.match(/Win(?:dows)?\s?(\d+\.\d+)?/)?"Windows":a.match(/Mac(?:intosh| OS X)?\s?(\d+_\d+(_\d+)?)?/)?"MacOS":a.match(/Linux/)?"Linux":"Other";Lg.getInstance().browserVersion="".concat(c);ye.getInstance().browserName="".concat(b);Mg.getInstance().osType="".concat(a);ze.getInstance().deviceVersion="".concat(a,"_").concat(b,"_").concat(c)}function zb(a,b){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var v=
Object.getOwnPropertySymbols(a);b&&(v=v.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));n.push.apply(n,v)}return n}function Ba(b){for(var n=1;n<arguments.length;n++){var v=null!=arguments[n]?arguments[n]:{};n%2?zb(Object(v),!0).forEach(function(n){a(b,n,v[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(v)):zb(Object(v)).forEach(function(a){Object.defineProperty(b,a,Object.getOwnPropertyDescriptor(v,a))})}return b}function Ca(a){var b=
(new Date).toISOString(),v=ob(),c=Ab.getInstance().nileRequestId,k=Ab.getInstance().nileRequestId;a=jc(a);var da=ze.getInstance().deviceVersion,p=nb("locale"),Sb=nb("marketplaceId"),m=Ae.getInstance().tabId,I="";try{var h=document.cookie.match(/(?:^|;)\s*session-id\s*=\s*([^\s;]+)/);h&&(I=h[1])}catch(x){I=""}return{timestamp:b,messageId:v,nileRequestId:c,clickstreamRequestId:k,metadata:a,isBeta:!1,deviceTypeId:"",directedCustomerId:"",appVersion:da,locale:p,marketplaceId:Sb,uxSessionId:m,sessionId:I,
obfuscatedCustomerId:nb("customerId")}}function jc(){var a=Ba({program:"nile-classic-desktop"},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});return JSON.stringify(a)}function J(a,b,c){a=Ba(Ba({},Ca(c)),{},{eventName:a,eventDetail:b,eventTimeUTC:(new Date).toISOString()});k.logEvent(function(a){for(var b=Object.keys(a),n=0;n<b.length;n++){var v=b[n],c=a[v];null==c?c="":"number"==typeof c&&(c=c.toString());a[v]=c}return a}(a),"desktop-nile",Ng.EVENT_SCHEMA)}function qb(a,b){(null==b||b>
a.length)&&(b=a.length);for(var n=0,v=Array(b);n<b;n++)v[n]=a[n];return v}function Ta(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(Ta=function(){return!!a})()}function rb(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(rb=function(){return!!a})()}function kc(a,b){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(a);b&&(v=v.filter(function(b){return Object.getOwnPropertyDescriptor(a,
b).enumerable}));n.push.apply(n,v)}return n}function Rb(b){for(var n=1;n<arguments.length;n++){var v=null!=arguments[n]?arguments[n]:{};n%2?kc(Object(v),!0).forEach(function(n){a(b,n,v[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(v)):kc(Object(v)).forEach(function(a){Object.defineProperty(b,a,Object.getOwnPropertyDescriptor(v,a))})}return b}function Ob(a,b){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(a);
b&&(v=v.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));n.push.apply(n,v)}return n}function Qb(b){for(var n=1;n<arguments.length;n++){var v=null!=arguments[n]?arguments[n]:{};n%2?Ob(Object(v),!0).forEach(function(n){a(b,n,v[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(v)):Ob(Object(v)).forEach(function(a){Object.defineProperty(b,a,Object.getOwnPropertyDescriptor(v,a))})}return b}function Pb(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,
[],function(){}))}catch(n){}return(Pb=function(){return!!a})()}function sb(a,b,c,ba,k,da,p){try{var n=a[da](p),v=n.value}catch(I){return void c(I)}n.done?b(v):Promise.resolve(v).then(ba,k)}function ua(a){return function(){var b=this,v=arguments;return new Promise(function(n,c){function oa(a){sb(k,n,c,oa,ba,"next",a)}function ba(a){sb(k,n,c,oa,ba,"throw",a)}var k=a.apply(b,v);oa(void 0)})}}function Ja(a){var b="function"==typeof Map?new Map:void 0;return Ja=function(a){function n(){return Ka(a,arguments,
tb(this).constructor)}if(null===a||!function(a){try{return-1!==Function.toString.call(a).indexOf("[native code]")}catch(da){return"function"==typeof a}}(a))return a;if("function"!=typeof a)throw new TypeError("Super expression must either be null or a function");if(void 0!==b){if(b.has(a))return b.get(a);b.set(a,n)}return n.prototype=Object.create(a.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Tb(n,a)},Ja(a)}function Ka(a,b,c){if(wd())return Reflect.construct.apply(null,
arguments);var n=[null];n.push.apply(n,b);n=new (a.bind.apply(a,n));return c&&Tb(n,c.prototype),n}function Wa(a,b,c){return(b=Be(b))in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function U(){function a(h,a,d){return Object.defineProperty(h,a,{value:d,enumerable:!0,configurable:!0,writable:!0}),h[a]}function b(h,a,d,g){a=Object.create((a&&a.prototype instanceof ba?a:ba).prototype);g=new f(g||[]);return l(a,"_invoke",{value:r(h,d,g)}),a}function c(h,a,
d){try{return{type:"normal",arg:h.call(a,d)}}catch(Qg){return{type:"throw",arg:Qg}}}function ba(){}function k(){}function da(){}function p(h){["next","throw","return"].forEach(function(d){a(h,d,function(h){return this._invoke(d,h)})})}function m(h,a){function f(g,l,q,x){g=c(h[g],h,l);if("throw"!==g.type){var b=g.arg;return(g=b.value)&&"object"==ka(g)&&d.call(g,"__await")?a.resolve(g.__await).then(function(h){f("next",h,q,x)},function(h){f("throw",h,q,x)}):a.resolve(g).then(function(h){b.value=h;q(b)},
function(h){return f("throw",h,q,x)})}x(g.arg)}var g;l(this,"_invoke",{value:function(h,d){function l(){return new a(function(a,g){f(h,d,a,g)})}return g=g?g.then(l,l):l()}})}function r(h,a,d){var g=P;return function(f,l){if(g===ta)throw Error("Generator is already running");if(g===Ua){if("throw"===f)throw l;return{value:S,done:!0}}d.method=f;for(d.arg=l;;){if(f=d.delegate)if(f=I(f,d)){if(f===La)continue;return f}if("next"===d.method)d.sent=d._sent=d.arg;else if("throw"===d.method){if(g===P)throw g=
Ua,d.arg;d.dispatchException(d.arg)}else"return"===d.method&&d.abrupt("return",d.arg);g=ta;f=c(h,a,d);if("normal"===f.type){if(g=d.done?Ua:xa,f.arg===La)continue;return{value:f.arg,done:d.done}}"throw"===f.type&&(g=Ua,d.method="throw",d.arg=f.arg)}}}function I(h,a){var d=a.method,g=h.iterator[d];if(g===S)return a.delegate=null,"throw"===d&&h.iterator.return&&(a.method="return",a.arg=S,I(h,a),"throw"===a.method)||"return"!==d&&(a.method="throw",a.arg=new TypeError("The iterator does not provide a '"+
d+"' method")),La;d=c(g,h.iterator,a.arg);return"throw"===d.type?(a.method="throw",a.arg=d.arg,a.delegate=null,La):(d=d.arg)?d.done?(a[h.resultName]=d.value,a.next=h.nextLoc,"return"!==a.method&&(a.method="next",a.arg=S),a.delegate=null,La):d:(a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,La)}function h(h){var a={tryLoc:h[0]};1 in h&&(a.catchLoc=h[1]);2 in h&&(a.finallyLoc=h[2],a.afterLoc=h[3]);this.tryEntries.push(a)}function x(h){var a=h.completion||{};
a.type="normal";delete a.arg;h.completion=a}function f(a){this.tryEntries=[{tryLoc:"root"}];a.forEach(h,this);this.reset(!0)}function D(h){if(h||""===h){var a=h[g];if(a)return a.call(h);if("function"==typeof h.next)return h;if(!isNaN(h.length)){var f=-1;a=function fb(){for(;++f<h.length;)if(d.call(h,f))return fb.value=h[f],fb.done=!1,fb;return fb.value=S,fb.done=!0,fb};return a.next=a}}throw new TypeError(ka(h)+" is not iterable");}U=function(){return w};var S,w={},E=Object.prototype,d=E.hasOwnProperty,
l=Object.defineProperty||function(h,a,d){h[a]=d.value},q="function"==typeof Symbol?Symbol:{},g=q.iterator||"@@iterator",C=q.asyncIterator||"@@asyncIterator",N=q.toStringTag||"@@toStringTag";try{a({},"")}catch(Ce){a=function(h,a,d){return h[a]=d}}w.wrap=b;var P="suspendedStart",xa="suspendedYield",ta="executing",Ua="completed",La={};q={};a(q,g,function(){return this});var Oa=Object.getPrototypeOf;(Oa=Oa&&Oa(Oa(D([]))))&&Oa!==E&&d.call(Oa,g)&&(q=Oa);var u=da.prototype=ba.prototype=Object.create(q);
return k.prototype=da,l(u,"constructor",{value:da,configurable:!0}),l(da,"constructor",{value:k,configurable:!0}),k.displayName=a(da,N,"GeneratorFunction"),w.isGeneratorFunction=function(h){h="function"==typeof h&&h.constructor;return!!h&&(h===k||"GeneratorFunction"===(h.displayName||h.name))},w.mark=function(h){return Object.setPrototypeOf?Object.setPrototypeOf(h,da):(h.__proto__=da,a(h,N,"GeneratorFunction")),h.prototype=Object.create(u),h},w.awrap=function(h){return{__await:h}},p(m.prototype),
a(m.prototype,C,function(){return this}),w.AsyncIterator=m,w.async=function(h,a,d,g,f){void 0===f&&(f=Promise);var l=new m(b(h,a,d,g),f);return w.isGeneratorFunction(a)?l:l.next().then(function(h){return h.done?h.value:l.next()})},p(u),a(u,N,"Generator"),a(u,g,function(){return this}),a(u,"toString",function(){return"[object Generator]"}),w.keys=function(h){var a=Object(h),d=[],g;for(g in a)d.push(g);return d.reverse(),function t(){for(;d.length;){var h=d.pop();if(h in a)return t.value=h,t.done=!1,
t}return t.done=!0,t}},w.values=D,f.prototype={constructor:f,reset:function(h){if(this.prev=0,this.next=0,this.sent=this._sent=S,this.done=!1,this.delegate=null,this.method="next",this.arg=S,this.tryEntries.forEach(x),!h)for(var a in this)"t"===a.charAt(0)&&d.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=S)},stop:function(){this.done=!0;var h=this.tryEntries[0].completion;if("throw"===h.type)throw h.arg;return this.rval},dispatchException:function(h){function a(a,d){return q.type="throw",q.arg=h,g.next=
a,d&&(g.method="next",g.arg=S),!!d}if(this.done)throw h;for(var g=this,f=this.tryEntries.length-1;0<=f;--f){var l=this.tryEntries[f],q=l.completion;if("root"===l.tryLoc)return a("end");if(l.tryLoc<=this.prev){var x=d.call(l,"catchLoc"),b=d.call(l,"finallyLoc");if(x&&b){if(this.prev<l.catchLoc)return a(l.catchLoc,!0);if(this.prev<l.finallyLoc)return a(l.finallyLoc)}else if(x){if(this.prev<l.catchLoc)return a(l.catchLoc,!0)}else{if(!b)throw Error("try statement without catch or finally");if(this.prev<
l.finallyLoc)return a(l.finallyLoc)}}}},abrupt:function(h,a){for(var g=this.tryEntries.length-1;0<=g;--g){var f=this.tryEntries[g];if(f.tryLoc<=this.prev&&d.call(f,"finallyLoc")&&this.prev<f.finallyLoc){var l=f;break}}l&&("break"===h||"continue"===h)&&l.tryLoc<=a&&a<=l.finallyLoc&&(l=null);g=l?l.completion:{};return g.type=h,g.arg=a,l?(this.method="next",this.next=l.finallyLoc,La):this.complete(g)},complete:function(h,a){if("throw"===h.type)throw h.arg;return"break"===h.type||"continue"===h.type?
this.next=h.arg:"return"===h.type?(this.rval=this.arg=h.arg,this.method="return",this.next="end"):"normal"===h.type&&a&&(this.next=a),La},finish:function(h){for(var a=this.tryEntries.length-1;0<=a;--a){var d=this.tryEntries[a];if(d.finallyLoc===h)return this.complete(d.completion,d.afterLoc),x(d),La}},catch:function(h){for(var a=this.tryEntries.length-1;0<=a;--a){var d=this.tryEntries[a];if(d.tryLoc===h){h=d.completion;if("throw"===h.type){var g=h.arg;x(d)}return g}}throw Error("illegal catch attempt");
},delegateYield:function(h,a,d){return this.delegate={iterator:D(h),resultName:a,nextLoc:d},"next"===this.method&&(this.arg=S),La}},w}function Xa(a,b){if(!(a=function(a){if(Array.isArray(a))return a}(a)||function(a,b){var n=null==a?null:"undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(null!=n){var v,c,oa,ba=[],I=!0,h=!1;try{if(c=(n=n.call(a)).next,0===b){if(Object(n)!==n)return;I=!1}else for(;!(I=(v=c.call(n)).done)&&(ba.push(v.value),ba.length!==b);I=!0);}catch(f){h=!0;var x=f}finally{try{if(!I&&
null!=n.return&&(oa=n.return(),Object(oa)!==oa))return}finally{if(h)throw x;}}return ba}}(a,b)||Ya(a,b)))throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return a}function W(a,b){var n="undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(!n){if(Array.isArray(a)||(n=Ya(a))||b&&a&&"number"==typeof a.length){n&&(a=n);var v=0;b=function(){};return{s:b,n:function(){return v>=a.length?
{done:!0}:{done:!1,value:a[v++]}},e:function(a){throw a;},f:b}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var c,k=!0,p=!1;return{s:function(){n=n.call(a)},n:function(){var a=n.next();return k=a.done,a},e:function(a){p=!0;c=a},f:function(){try{k||null==n.return||n.return()}finally{if(p)throw c;}}}}function ya(a){var b=Array.isArray(a)?vd(a):void 0;b||(b="undefined"!=typeof Symbol&&null!=
a[Symbol.iterator]||null!=a["@@iterator"]?Array.from(a):void 0);if(!(a=b||Ya(a)))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return a}function Ya(a,b){if(a){if("string"==typeof a)return vd(a,b);var n={}.toString.call(a).slice(8,-1);return"Object"===n&&a.constructor&&(n=a.constructor.name),"Map"===n||"Set"===n?Array.from(a):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?
vd(a,b):void 0}}function vd(a,b){(null==b||b>a.length)&&(b=a.length);for(var n=0,v=Array(b);n<b;n++)v[n]=a[n];return v}function ca(a,b,c){b=tb(b);b=wd()?Reflect.construct(b,c||[],tb(a).constructor):b.apply(a,c);if(!b||"object"!=ka(b)&&"function"!=typeof b){if(void 0!==b)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}else a=b;return a}function wd(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,
[],function(){}))}catch(n){}return(wd=function(){return!!a})()}function xd(){return xd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(a,b,c){var n;for(n=a;!{}.hasOwnProperty.call(n,b)&&null!==(n=tb(n)););if(n)return n=Object.getOwnPropertyDescriptor(n,b),n.get?n.get.call(3>arguments.length?a:c):n.value},xd.apply(null,arguments)}function tb(a){return tb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},tb(a)}function ea(a,
b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}});Object.defineProperty(a,"prototype",{writable:!1});b&&Tb(a,b)}function Tb(a,b){return Tb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){return a.__proto__=b,a},Tb(a,b)}function ka(a){return ka="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:
function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},ka(a)}function A(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function De(a,b){for(var n=0;n<b.length;n++){var c=b[n];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,Be(c.key),c)}}function B(a,b,c){return b&&De(a.prototype,b),c&&De(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a}function Be(a){a:if("object"==
ka(a)&&a){var b=a[Symbol.toPrimitive];if(void 0!==b){a=b.call(a,"string");if("object"!=ka(a))break a;throw new TypeError("@@toPrimitive must return a primitive value.");}a=String(a)}return"symbol"==ka(a)?a:a+""}function Ee(a){return!(!a||"object"!==ka(a)||a.type!==Bb.number)}function Bd(a){return!(!a||"object"!==ka(a)||a.type!==Bb.dateTime)}function Sg(a){var b={};return a.replace(Tg,function(a){var n=a.length;switch(a[0]){case "G":b.era=4===n?"long":5===n?"narrow":"short";break;case "y":b.year=2===
n?"2-digit":"numeric";break;case "Y":case "u":case "U":case "r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case "q":case "Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case "M":case "L":b.month=["numeric","2-digit","short","long","narrow"][n-1];break;case "w":case "W":throw new RangeError("`w/W` (week) patterns are not supported");case "d":b.day=["numeric","2-digit"][n-1];break;case "D":case "F":case "g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");
case "E":b.weekday=4===n?"short":5===n?"narrow":"short";break;case "e":if(4>n)throw new RangeError("`e..eee` (weekday) patterns are not supported");b.weekday=["short","long","narrow","short"][n-4];break;case "c":if(4>n)throw new RangeError("`c..ccc` (weekday) patterns are not supported");b.weekday=["short","long","narrow","short"][n-4];break;case "a":b.hour12=!0;break;case "b":case "B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case "h":b.hourCycle="h12";b.hour=
["numeric","2-digit"][n-1];break;case "H":b.hourCycle="h23";b.hour=["numeric","2-digit"][n-1];break;case "K":b.hourCycle="h11";b.hour=["numeric","2-digit"][n-1];break;case "k":b.hourCycle="h24";b.hour=["numeric","2-digit"][n-1];break;case "j":case "J":case "C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case "m":b.minute=["numeric","2-digit"][n-1];break;case "s":b.second=["numeric","2-digit"][n-1];break;case "S":case "A":throw new RangeError("`S/A` (second) patterns are not supported, use `s` instead");
case "z":b.timeZoneName=4>n?"short":"long";break;case "Z":case "O":case "v":case "V":case "X":case "x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) patterns are not supported, use `z` instead");}return""}),b}function Fe(a){var b={};return"r"===a[a.length-1]?b.roundingPriority="morePrecision":"s"===a[a.length-1]&&(b.roundingPriority="lessPrecision"),a.replace(Ge,function(a,n,c){return"string"!=typeof c?(b.minimumSignificantDigits=n.length,b.maximumSignificantDigits=n.length):"+"===c?b.minimumSignificantDigits=
n.length:"#"===n[0]?b.maximumSignificantDigits=n.length:(b.minimumSignificantDigits=n.length,b.maximumSignificantDigits=n.length+("string"==typeof c?c.length:0)),""}),b}function Cd(a){switch(a){case "sign-auto":return{signDisplay:"auto"};case "sign-accounting":case "()":return{currencySign:"accounting"};case "sign-always":case "+!":return{signDisplay:"always"};case "sign-accounting-always":case "()!":return{signDisplay:"always",currencySign:"accounting"};case "sign-except-zero":case "+?":return{signDisplay:"exceptZero"};
case "sign-accounting-except-zero":case "()?":return{signDisplay:"exceptZero",currencySign:"accounting"};case "sign-never":case "+_":return{signDisplay:"never"}}}function Ug(a){var b;if("E"===a[0]&&"E"===a[1]?(b={notation:"engineering"},a=a.slice(2)):"E"===a[0]&&(b={notation:"scientific"},a=a.slice(1)),b){var c=a.slice(0,2);if("+!"===c?(b.signDisplay="always",a=a.slice(2)):"+?"===c&&(b.signDisplay="exceptZero",a=a.slice(2)),!He.test(a))throw Error("Malformed concise eng/scientific notation");b.minimumIntegerDigits=
a.length}return b}function Vg(a){for(var b={},c=0;c<a.length;c++){var v=a[c];switch(v.stem){case "percent":case "%":b.style="percent";continue;case "%x100":b.style="percent";b.scale=100;continue;case "currency":b.style="currency";b.currency=v.options[0];continue;case "group-off":case ",_":b.useGrouping=!1;continue;case "precision-integer":case ".":b.maximumFractionDigits=0;continue;case "measure-unit":case "unit":b.style="unit";b.unit=v.options[0].replace(/^(.*?)-/,"");continue;case "compact-short":case "K":b.notation=
"compact";b.compactDisplay="short";continue;case "compact-long":case "KK":b.notation="compact";b.compactDisplay="long";continue;case "scientific":b=pa(pa(pa({},b),{notation:"scientific"}),v.options.reduce(function(a,b){return pa(pa({},a),Cd(b)||{})},{}));continue;case "engineering":b=pa(pa(pa({},b),{notation:"engineering"}),v.options.reduce(function(a,b){return pa(pa({},a),Cd(b)||{})},{}));continue;case "notation-simple":b.notation="standard";continue;case "unit-width-narrow":b.currencyDisplay="narrowSymbol";
b.unitDisplay="narrow";continue;case "unit-width-short":b.currencyDisplay="code";b.unitDisplay="short";continue;case "unit-width-full-name":b.currencyDisplay="name";b.unitDisplay="long";continue;case "unit-width-iso-code":b.currencyDisplay="symbol";continue;case "scale":b.scale=parseFloat(v.options[0]);continue;case "integer-width":if(1<v.options.length)throw new RangeError("integer-width stems only accept a single optional option");v.options[0].replace(Wg,function(a,n,c,v,I,h){if(n)b.minimumIntegerDigits=
c.length;else{if(v&&I)throw Error("We currently do not support maximum integer digits");if(h)throw Error("We currently do not support exact integer digits");}return""});continue}if(He.test(v.stem))b.minimumIntegerDigits=v.stem.length;else if(Ie.test(v.stem)){if(1<v.options.length)throw new RangeError("Fraction-precision stems only accept a single optional option");v.stem.replace(Ie,function(a,n,c,v,I,h){return"*"===c?b.minimumFractionDigits=n.length:v&&"#"===v[0]?b.maximumFractionDigits=v.length:
I&&h?(b.minimumFractionDigits=I.length,b.maximumFractionDigits=I.length+h.length):(b.minimumFractionDigits=n.length,b.maximumFractionDigits=n.length),""});v=v.options[0];"w"===v?b=pa(pa({},b),{trailingZeroDisplay:"stripIfInteger"}):v&&(b=pa(pa({},b),Fe(v)))}else if(Ge.test(v.stem))b=pa(pa({},b),Fe(v.stem));else{var k=Cd(v.stem);k&&(b=pa(pa({},b),k));(v=Ug(v.stem))&&(b=pa(pa({},b),v))}}return b}function Xg(a){var b=a.hourCycle;if(void 0===b&&a.hourCycles&&a.hourCycles.length&&(b=a.hourCycles[0]),b)switch(b){case "h24":return"k";
case "h23":return"H";case "h12":return"h";case "h11":return"K";default:throw Error("Invalid hourCycle");}var c;b=a.language;return"root"!==b&&(c=a.maximize().region),(lc[c||""]||lc[b||""]||lc["".concat(b,"-001")]||lc["001"])[0]}function X(a,b){return{start:a,end:b}}function Dd(a){return 97<=a&&122>=a||65<=a&&90>=a}function Je(a){return 9<=a&&13>=a||32===a||133===a||8206<=a&&8207>=a||8232===a||8233===a}function Ed(a){a.forEach(function(a){if(delete a.location,a.type===V.select||a.type===V.plural)for(var b in a.options)delete a.options[b].location,
Ed(a.options[b].value);else a.type===V.number&&Ee(a.style)||(a.type===V.date||a.type===V.time)&&Bd(a.style)?delete a.style.location:a.type===V.tag&&Ed(a.children)})}function mc(a,b){return(b&&b.strategy?b.strategy:Yg)(a,{cache:b&&b.cache?b.cache:Zg,serializer:b&&b.serializer?b.serializer:$g})}function ah(a,b,c,k){c=null==k||"number"==typeof k||"boolean"==typeof k?k:c(k);var n=b.get(c);return void 0===n&&(n=a.call(this,k),b.set(c,n)),n}function Ke(a,b,c){var n=Array.prototype.slice.call(arguments,
3),v=c(n),k=b.get(v);return void 0===k&&(k=a.apply(this,n),b.set(v,k)),k}function Yg(a,b){var c=b.cache.create();return(1===a.length?ah:Ke).bind(this,a,c,b.serializer)}function Fd(){this.cache=Object.create(null)}function Ub(a,b,c,k,p,da,m,r,u){if(1===a.length&&a[0].type===V.literal)return[{type:va.literal,value:a[0].value}];var I,h,x;void 0!==b.getLocale?(I=b,h=b.getLocale(),x=b.getTimeZone()):h=b;h=u||nc.getCanonicalLocaleString(h);var f;u=[];a=W(a);try{for(a.s();!(f=a.n()).done;){var D=f.value;
if(D.type===V.literal)u.push({type:va.literal,value:D.value});else if(D.type===V.pound)"number"==typeof da&&u.push({type:va.literal,value:c.getNumberFormat(h).format(da)});else{var n=D.value;if(!p)throw new Le(n,m);if(D.type===V.tag){var w=D.children,E=D.value,d=p[E];if(r&&(d=function(a){return a}),"function"!=typeof d)throw new bh(E,"function",m);var l=d(Ub(w,b,c,k,p,da,m,r,h).map(function(a){return a.value}));Array.isArray(l)||(l=[l]);r?u.push({type:va.object,value:r.createElement.apply(r,[E,{}].concat(ya(l)))}):
u.push.apply(u,ya(l.map(function(a){return{type:"string"==typeof a?va.literal:va.object,value:a}})))}else{if(!(p&&n in p))throw new Le(n,m);var q=p[n];if(D.type===V.argument)q&&"string"!=typeof q&&"number"!=typeof q?"function"==typeof q&&(q=q(r,{},[])):q="string"==typeof q||"number"==typeof q?String(q):"",u.push({type:"string"==typeof q?va.literal:va.object,value:q});else if(D.type===V.date){var g="string"==typeof D.style?k.date[D.style]:Bd(D.style)?D.style.parsedOptions:{};void 0!==x&&(g.timeZone=
x);u.push({type:va.literal,value:c.getDateTimeFormat(h,g).format(q)})}else if(D.type===V.time){var C="string"==typeof D.style?k.time[D.style]:Bd(D.style)?D.style.parsedOptions:k.time.medium;void 0!==x&&(C.timeZone=x);u.push({type:va.literal,value:c.getDateTimeFormat(h,C).format(q)})}else if(D.type===V.number){var N="string"==typeof D.style?k.number[D.style]:Ee(D.style)?D.style.parsedOptions:void 0;N&&N.scale&&(q*=N.scale||1);u.push({type:va.literal,value:c.getNumberFormat(h,N).format(q)})}else if(D.type===
V.price){var P="string"==typeof D.style?k.price[D.style]:void 0,v=c.getPriceFormat(I||h,P).format(q,P);u.push({type:"string"==typeof v?va.literal:va.object,value:v})}else if(D.type===V.select){var ta=D.options[q]||D.options.other;if(!ta)throw new Me(D.value,q,Object.keys(D.options),m);u.push.apply(u,ya(Ub(ta.value,b,c,k,p,da,m,r,h)))}else if(D.type===V.plural){var oa=D.options["\x3d".concat(q)];if(!oa){if(!Intl.PluralRules)throw new oc('Intl.PluralRules is not available in this environment.\nTry polyfilling it using "@formatjs/intl-pluralrules"\n',
Cb.MISSING_INTL_API,m);var ba=c.getPluralRules(h,{type:D.pluralType}).select(q-(D.offset||0));oa=D.options[ba]||D.options.other}if(!oa)throw new Me(D.value,q,Object.keys(D.options),m);u.push.apply(u,ya(Ub(oa.value,b,c,k,p,q-(D.offset||0),m,r,h)))}}}}}catch(Oa){a.e(Oa)}finally{a.f()}return r?u:2>u.length?u:u.reduce(function(a,h){var d=a[a.length-1];return d&&d.type===va.literal&&h.type===va.literal?d.value+=h.value:a.push(h),a},[])}function pc(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=
arguments[c];if(!b||0===b.length)throw Error("The key field(s) must not be null or empty");return b.join("_")}function Vb(a,b){if(null==a)return null;if(b.has(a))return b.get(a);throw Error("Failed to convert to config enum with ".concat(a));}function Ne(a,b){if(null==a)return null;var c;b=W(b.entries());try{for(b.s();!(c=b.n()).done;){var n=Xa(c.value,2),v=n[0];if(n[1]==a)return v}}catch(da){b.e(da)}finally{b.f()}throw Error("Failed to convert from config enum with ".concat(a));}function qc(a,b){a.includes(b)&&
a.splice(a.indexOf(b),1)}function Oe(a){return a.map(function(a){return a.value}).reduce(function(a,b){return a+b})}function rc(a,b){var c,n="";a=W(a);try{for(a.s();!(c=a.n()).done;){var v=c.value;if("integer"!==b||"integer"!==v.type&&"group"!==v.type){if(v.type===b)return v.value}else n+=v.value}}catch(da){a.e(da)}finally{a.f()}return n||void 0}function Pe(a,b,c,k,p){Gd(b)&&(p=ub(b,"literal",p),"end"===c&&(b[p].value=b[p].value.replace(ch,"")),b=Hd(b,p,k),"compact"===a&&b.splice(k,1));return b}function dh(a){switch(a){case "iso":return"code";
case "plural":return"name";default:return"symbol"}}function Gd(a){var b=1;return vb(a)?("literal"===a[(b=a.length)-1].type&&b--,b-=2):("literal"===a[b-1].type&&b++,"minusSign"===a[b-1].type&&b++),"literal"===a[b].type}function vb(a){var b=a.length-1;return"literal"===a[b].type&&b--,"currency"===a[b].type}function Id(a,b){if(!a)throw Error("Format Parts must not be emtpy");var c;a=W(a);try{for(a.s();!(c=a.n()).done;)if(c.value.type===b)return!0}catch(ba){a.e(ba)}finally{a.f()}return!1}function Hd(a,
b,c){if(c===b)return a;for(var n=a[b],v=c<b?-1:1;b!==c;b+=v)a[b]=a[b+v];return a[c]=n,a}function ub(a,b,c){var n,v,k;for(c?(n=a.length-1,v=0,k=-1):(n=0,v=a.length-1,k=1);n!==v;){if(a[n].type===b&&("literal"!==b||0!==n&&n!==a.length-1))return n;n+=k}return a[n].type===b?n:-1}function Qe(a){switch(a){case "compact":return"compact";case "in_sentence":return"inSentence";case "iso":return"iso";case "plural":return"plural";default:return"amazonSymbol"}}function sc(a){return{create:function(){return{has:function(b){return b in
a},get:function(b){return a[b]},set:function(b,c){a[b]=c}}}}}function eh(a,b){return Re.apply(this,arguments)}function Re(){return(Re=ua(U().mark(function ba(a,b){var c,n;return U().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if("undefined"==typeof performance){k.next=8;break}return c=performance.now(),k.next=4,b();case 4:n=performance.now();Pa.info("".concat(a,": ").concat(n-c," ms"));k.next=12;break;case 8:return console.time(a),k.next=11,b();case 11:console.timeEnd(a);case 12:case "end":return k.stop()}},
ba)}))).apply(this,arguments)}function Se(a,b){return(a=a&&a.endpointMap&&a.endpointMap[b.locale])&&a[b.bundle]}function Te(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"strings";return function(a){var b={};a.resolveBundleUrl?b.resolveBundleUrl=function(b,c){return a.resolveBundleUrl(Se(a.arbManifest,c),c.locale,c.bundle)}:b.resolveBundleUrl=function(b,c){var n;b=null!==(n=a.urlPrefix)&&void 0!==n?n:"";return"/"!==b[0]&&(b="/"+b),b&&"/"!==b[b.length-1]&&(b+="/"),b+Se(a.arbManifest,
c)};a.resolveResourcePack&&(b.resolveResourcePack=a.resolveResourcePack);b=function(a){return new fh(Object.assign({resolveResourcePack:function(a){return ua(U().mark(function Sb(){var b,I,h,x,f;return U().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,fetch(a);case 2:if(b=c.sent,I=b.ok,h=b.status,x=b.statusText,I){c.next=8;break}throw f=500<=h&&600>h,Pa.error("Failed to fetch ".concat(a,": %O"),{status:h,statusText:x}),new gh("Failed to fetch ".concat(a),f);case 8:return c.abrupt("return",
b.json());case 9:case "end":return c.stop()}},Sb)}))()}},a))}(b);return new Ue(new hh(a.localizationContextProvider),b)}({arbManifest:ih,localizationContextProvider:function(){return(new wb).withLocale(a).withDefaultLocale("en-US").build()},resolveBundleUrl:function(a){return a?"translations/".concat(a):void 0},resolveResourcePack:function(a){return a?Promise.resolve(jh.get(a)):Promise.reject(Error("Asset could not be retrieved"))}}).getBundle(b)}function Ve(a,b){var c="undefined"!=typeof Symbol&&
a[Symbol.iterator]||a["@@iterator"];if(!c){if(Array.isArray(a)||(c=We(a))||b&&a&&"number"==typeof a.length){c&&(a=c);var n=0;b=function(){};return{s:b,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(a){throw a;},f:b}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var k,v=!0,p=!1;return{s:function(){c=c.call(a)},n:function(){var a=c.next();return v=a.done,a},e:function(a){p=
!0;k=a},f:function(){try{v||null==c.return||c.return()}finally{if(p)throw k;}}}}function We(a,b){if(a){if("string"==typeof a)return Xe(a,b);var c={}.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?Xe(a,b):void 0}}function Xe(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,n=Array(b);c<b;c++)n[c]=a[c];return n}function Ye(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var n=
Object.getOwnPropertySymbols(a);b&&(n=n.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));c.push.apply(c,n)}return c}function kh(b){for(var c=1;c<arguments.length;c++){var k=null!=arguments[c]?arguments[c]:{};c%2?Ye(Object(k),!0).forEach(function(c){a(b,c,k[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(k)):Ye(Object(k)).forEach(function(a){Object.defineProperty(b,a,Object.getOwnPropertyDescriptor(k,a))})}return b}function Za(a){return a in
Ze?"ATVDetail"===a&&K.extractGtiFromUrl(K.getCurrentPageUrl())?wa.UNKNOWN:Ze[a]:wa.UNKNOWN}function $e(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);b&&(n=n.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));c.push.apply(c,n)}return c}function gb(b){for(var c=1;c<arguments.length;c++){var k=null!=arguments[c]?arguments[c]:{};c%2?$e(Object(k),!0).forEach(function(c){a(b,c,k[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,
Object.getOwnPropertyDescriptors(k)):$e(Object(k)).forEach(function(a){Object.defineProperty(b,a,Object.getOwnPropertyDescriptor(k,a))})}return b}function af(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(af=function(){return!!a})()}function bf(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(bf=function(){return!!a})()}function Jd(a){var b=Array.isArray(a)?eb(a):void 0;b||(b="undefined"!=
typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"]?Array.from(a):void 0);if(!(a=b||Nb(a)))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return a}function Kd(a,b){var c=a.querySelectorAll("img"),n=0,k=function(){n===c.length&&(b(),c.forEach(function(a){a.removeEventListener("load",v);a.removeEventListener("error",v)}))},v=function(){n++;k()};c.forEach(function(a){a.complete?n++:
(a.addEventListener("load",v),a.addEventListener("error",v))});k()}function cf(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,n=Array(b);c<b;c++)n[c]=a[c];return n}function df(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(df=function(){return!!a})()}function ef(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,n=Array(b);c<b;c++)n[c]=a[c];return n}function ff(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],
function(){}))}catch(n){}return(ff=function(){return!!a})()}function gf(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(gf=function(){return!!a})()}function hf(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(hf=function(){return!!a})()}function jf(){var a=document.getElementById("nav-flyout-rufus"),b=document.querySelector(".rufus-pill"),k=document.getElementById("rufus-conversation-container"),
p=na.getInstance().getWeblabTreatment("RUFUS_DESKTOP_VISUAL_BRANDING_UPDATE_1201601");if(a&&b&&k){var m=0;if("T1"!==p&&"T2"!==p){m=document.querySelector(".rufus-avatar-padding");if(!m)return;m=parseFloat(c.getComputedStyle(m).paddingLeft)}a=parseFloat(c.getComputedStyle(a).getPropertyValue("--expanded-container-width"));b=c.getComputedStyle(b);b=parseFloat(b.paddingLeft)+parseFloat(b.paddingRight);k=c.getComputedStyle(k);return a-m-b-(parseFloat(k.paddingLeft)+parseFloat(k.paddingRight))}}function kf(){try{var a=
!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(kf=function(){return!!a})()}function lf(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(lf=function(){return!!a})()}function mf(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);b&&(n=n.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));c.push.apply(c,n)}return c}function hb(b){for(var c=
1;c<arguments.length;c++){var k=null!=arguments[c]?arguments[c]:{};c%2?mf(Object(k),!0).forEach(function(c){a(b,c,k[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(k)):mf(Object(k)).forEach(function(a){Object.defineProperty(b,a,Object.getOwnPropertyDescriptor(k,a))})}return b}function nf(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(nf=function(){return!!a})()}function of(a,b){var c=Object.keys(a);
if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);b&&(n=n.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));c.push.apply(c,n)}return c}function tc(b){for(var c=1;c<arguments.length;c++){var k=null!=arguments[c]?arguments[c]:{};c%2?of(Object(k),!0).forEach(function(c){a(b,c,k[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(k)):of(Object(k)).forEach(function(a){Object.defineProperty(b,a,Object.getOwnPropertyDescriptor(k,
a))})}return b}function pf(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(pf=function(){return!!a})()}function qf(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(qf=function(){return!!a})()}function rf(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,n=Array(b);c<b;c++)n[c]=a[c];return n}function sf(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);
b&&(n=n.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));c.push.apply(c,n)}return c}function tf(b){for(var c=1;c<arguments.length;c++){var k=null!=arguments[c]?arguments[c]:{};c%2?sf(Object(k),!0).forEach(function(c){a(b,c,k[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(k)):sf(Object(k)).forEach(function(a){Object.defineProperty(b,a,Object.getOwnPropertyDescriptor(k,a))})}return b}function uf(a,b){var c=Object.keys(a);
if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(a);b&&(k=k.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));c.push.apply(c,k)}return c}function Ld(b){for(var c=1;c<arguments.length;c++){var k=null!=arguments[c]?arguments[c]:{};c%2?uf(Object(k),!0).forEach(function(c){a(b,c,k[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(k)):uf(Object(k)).forEach(function(a){Object.defineProperty(b,a,Object.getOwnPropertyDescriptor(k,
a))})}return b}var lh=O(578),Q=O.n(lh),p=r(function n(){z(this,n)});a(p,"RUFUS_PANEL_STATE_PREFIX","RUFUS_PANEL_");a(p,"RUFUS_PANEL_INFOCUS","RUFUS_PANEL_INFOCUS");a(p,"RUFUS_PANEL_OUTFOCUS","RUFUS_PANEL_OUTFOCUS");a(p,"RUFUS_THUMBSUP_CLICKED","RUFUS_THUMBSUP_CLICKED");a(p,"RUFUS_PANEL_EXPANDED_BY_CX_ZEN","RUFUS_PANEL_EXPANDED_BY_CX_ZEN");a(p,"RUFUS_THUMBSDOWN_CLICKED","RUFUS_THUMBSDOWN_CLICKED");a(p,"RUFUS_CLOSE_CLICK_FROM_EXPANDED","RUFUS_CLOSE_CLICK_FROM_EXPANDED");a(p,"RUFUS_CLOSE_CLICK_FROM_MINIMIZED",
"RUFUS_CLOSE_CLICK_FROM_MINIMIZED");a(p,"RUFUS_ENTER_PRESSED_ON_INPUT_TEXT","RUFUS_ENTER_PRESSED_ON_INPUT_TEXT");a(p,"RUFUS_SUBMIT_ON_INPUT_TEXT","RUFUS_SUBMIT_ON_INPUT_TEXT");a(p,"RUFUS_PANEL_CONTAINER_INSTANTIATED","RUFUS_PANEL_CONTAINER_INSTANTIATED");a(p,"RUFUS_FEEDBACK_OPTION_SUBMITTED","RUFUS_FEEDBACK_OPTION_SUBMITTED");a(p,"RUFUS_FEEDBACK_TEXT_SUBMITTED","RUFUS_FEEDBACK_TEXT_SUBMITTED");a(p,"RUFUS_SCROLL_DOWN_CLICKED","RUFUS_SCROLL_DOWN_CLICKED");a(p,"RUFUS_TAB_ID_GENERATED","RUFUS_TAB_ID_GENERATED");
a(p,"RUFUS_STREAM_INTERRUPT","RUFUS_STREAM_INTERRUPT");a(p,"RUFUS_RQ_CLICK","RUFUS_RQ_CLICK");a(p,"RUFUS_OPEN_URL_CLICK_PREFIX","RUFUS_OPEN_URL_CLICK_");a(p,"RUFUS_HYPERLINK_CLICK_PREFIX","RUFUS_HYPERLINK_CLICK_");a(p,"RUFUS_PANEL_CACHE_INVALID","RUFUS_PANEL_CACHE_INVALID");a(p,"RUFUS_PANEL_CACHE_VALID","RUFUS_PANEL_CACHE_VALID");a(p,"RUFUS_BEGINNING_HISTORY_SHOWN","RUFUS_BEGINNING_HISTORY_SHOWN");a(p,"RUFUS_HISTORY_BUTTON_SHOWN","RUFUS_HISTORY_BUTTON_SHOWN");a(p,"RUFUS_SCROLL_TO_TOP","RUFUS_SCROLL_TO_TOP");
a(p,"FETCH_HISTORY","FETCH_HISTORY");a(p,"FETCH_HISTORY_INTERRUPTION_RECOVERY","RUFUS_FETCH_HISTORY_INTERRUPTION_RECOVERY");a(p,"FIRST_TIME_FETCH_HISTORY","FIRST_TIME_FETCH_HISTORY");a(p,"LOAD_HISTORY_BUTTON_CLICK","LOAD_HISTORY_BUTTON_CLICK");a(p,"RUFUS_SIGN_OUT","RUFUS_SIGN_OUT");a(p,"RUFUS_ACTIVE_CONVERSATION_CONTAINER_IN_HISTORY_NULL","RUFUS_ACTIVE_CONVERSATION_CONTAINER_IN_HISTORY_NULL");a(p,"RUFUS_HISTORY_CONTAINER_IN_HISTORY_NULL","RUFUS_HISTORY_CONTAINER_IN_HISTORY_NULL");a(p,"RUFUS_PANEL_OVERFLOW_MENU_AUTO_MINIMIZE",
"RUFUS_PANEL_OVERFLOW_MENU_AUTO_MINIMIZE");a(p,"RUFUS_PANEL_OVERFLOW_MENU_GET_STARTED","RUFUS_PANEL_OVERFLOW_MENU_GET_STARTED");a(p,"RUFUS_DEALS_PILL_PRESENTED","RUFUS_DEALS_PILL_PRESENTED");a(p,"RUFUS_DEALS_RQ_CLICK","RUFUS_DEALS_RQ_CLICK");a(p,"RUFUS_WDCS_RQ_CLICK","RUFUS_WDCS_RQ_CLICK");a(p,"RUFUS_RECOVERY_TEASER_CX_CLICK","RUFUS_RECOVERY_TEASER_CX_CLICK");a(p,"RUFUS_RECOVERY_TEASER_CX_OPEN_PANEL","RUFUS_RECOVERY_TEASER_CX_OPEN_PANEL");a(p,"INPUT_QUERY_MAX_LIMIT_REACHED","INPUT_QUERY_MAX_LIMIT_REACHED");
a(p,"RENDERED_ERROR_CODE_PREFIX","RENDERED_ERROR_CODE_");a(p,"RUFUS_SECTION_WITHOUT_GROUP_SECTION_ID","RUFUS_SECTION_WITHOUT_GROUP_SECTION_ID");a(p,"RUFUS_MULTIMODAL_IMAGE_SHOWN","RUFUS_MULTIMODAL_IMAGE_SHOWN");a(p,"RUFUS_MULTIMODAL_IMAGE_CLICKED","RUFUS_MULTIMODAL_IMAGE_CLICKED");a(p,"INTERRUPTION_RECOVERY_BUTTON_CLICK","INTERRUPTION_RECOVERY_BUTTON_CLICK");a(p,"INTERRUPTION_RECOVERY_BUTTON_SHOWN","RUFUS_INTERRUPTION_RECOVERY_BUTTON_SHOWN");a(p,"INTERRUPTION_RECOVERY_FAILED","RUFUS_INTERRUPTION_RECOVERY_FAILED");
a(p,"RUFUS_CLIENT_WEBLAB_TREATMENTS_PARSED","RUFUS_CLIENT_WEBLAB_TREATMENTS_PARSED");a(p,"RUFUS_CSAI_OPENED","RUFUS_CSAI_OPENED");a(p,"RUFUS_MULTIMODAL_DISMISS_BUTTON_CLICKED","RUFUS_MULTIMODAL_DISMISS_BUTTON_CLICKED");a(p,"RUFUS_MULTIMODAL_POPOVER_SHOWN","RUFUS_MULTIMODAL_POPOVER_SHOWN");a(p,"ERROR_ON_LOADING_HIGH_RES_IMAGE","ERROR_ON_LOADING_HIGH_RES_IMAGE");a(p,"ERROR_ON_LOADING_LOW_RES_IMAGE","ERROR_ON_LOADING_LOW_RES_IMAGE");a(p,"RUFUS_INSUFFICIENT_BROWSER_CAPABILITIES","RUFUS_INSUFFICIENT_BROWSER_CAPABILITIES");
a(p,"RUFUS_UNDEFINED_EVENT_SOURCE","RUFUS_UNDEFINED_EVENT_SOURCE");a(p,"RUFUS_SSE_HANDLER_ERROR","RUFUS_SSE_HANDLER_ERROR");a(p,"RUFUS_TIMEOUT","RUFUS_TIMEOUT");a(p,"RUFUS_OFFLINE","RUFUS_OFFLINE");a(p,"RUFUS_HANDLE_CONTEXT_CHUNK_ERROR","RUFUS_HANDLE_CONTEXT_CHUNK_ERROR");a(p,"ERROR_ON_RENDERING_HIGH_RES_IMAGE","ERROR_ON_RENDERING_HIGH_RES_IMAGE");a(p,"ERROR_ON_RENDERING_LOW_RES_IMAGE","ERROR_ON_RENDERING_LOW_RES_IMAGE");a(p,"RUFUS_TEASER_AUTO_EXPANDS_CL","RUFUS_TEASER_AUTO_EXPANDS_CL");a(p,"RUFUS_TEASER_WIDGET_BSR_SENT_TO_SEARCH",
"RUFUS_TEASER_WIDGET_BSR_SENT_TO_SEARCH");a(p,"RUFUS_TEASER_RECOVERY_WIDGET_SENT_TO_SEARCH","RUFUS_TEASER_RECOVERY_WIDGET_SENT_TO_SEARCH");a(p,"SECTION_REMOVED","SECTION_REMOVED");a(p,"RUFUS_TWISTER_STREAMING_REQUEST","RUFUS_TWISTER_STREAMING_REQUEST");a(p,"UNKNOWN_PATCH_ID_IN_BACKFILL_DATA","UNKNOWN_PATCH_ID_IN_BACKFILL_DATA");a(p,"RUFUS_PRICING_INVALID_DATA","RUFUS_PRICING_INVALID_DATA");a(p,"RUFUS_PRICING_RENDERING_ERROR","RUFUS_PRICING_RENDERING_ERROR");a(p,"RUFUS_PRICING_CLIENT_NOT_LOADED","RUFUS_PRICING_CLIENT_NOT_LOADED");
a(p,"RASIN_INITIALIZE_SUCCESS","RASIN_INITIALIZE_SUCCESS");a(p,"RASIN_INITIALIZATION_ERROR","RASIN_INITIALIZATION_ERROR");a(p,"RASIN_CONVERSATION_REFINEMENT_SET","RASIN_CONVERSATION_REFINEMENT_SET");a(p,"RASIN_CONVERSATION_REFINEMENT_CLEARED","RASIN_CONVERSATION_REFINEMENT_CLEARED");a(p,"RASIN_CONVERSATION_REFINEMENT_SWAPPED","RASIN_CONVERSATION_REFINEMENT_SWAPPED");a(p,"RASIN_FILTER_PILL_CLICK","RASIN_FILTER_PILL_CLICK");a(p,"RASIN_FILTER_PILL_DISMISS_CLICK","RASIN_FILTER_PILL_DISMISS_CLICK");a(p,
"RASIN_RQ_PILL_CLICK","RASIN_RQ_PILL_CLICK");a(p,"RASIN_CL_INPUT_QUERY","RASIN_CL_INPUT_QUERY");var ha=r(function oa(){z(this,oa)});a(ha,"STREAM_ERROR","STREAM_ERROR");a(ha,"STREAM_WITHOUT_ACTION","STREAM_WITHOUT_ACTION");a(ha,"STREAM_INTERRUPTION","STREAM_INTERRUPTION");a(ha,"STREAM_START","STREAM_START");a(ha,"SSE_STREAM_OPEN","SSE_STREAM_OPEN");a(ha,"SSE_STREAM_CLOSE","SSE_STREAM_CLOSE");a(ha,"STREAM_LAST_RENDERED_CHUNK","STREAM_LAST_RENDERED_CHUNK");a(ha,"RENDER_SUFFIX","-render");a(ha,"RECEIVE_SUFFIX",
"-receive");a(ha,"CHUNK_FIRST_SECTION_RENDER_SUFFIX","-chunk-first-section-render");a(ha,"CHUNK_LAST_SECTION_RENDER_SUFFIX","-chunk-last-section-render");a(ha,"FIRST_INFERENCE_CHUNK_RENDER_SUFFIX","first-inference-chunk-render");var ma=r(function ba(){z(this,ba)});a(ma,"RUFUS_FEEDBACK_LATENCY","RUFUS_FEEDBACK");a(ma,"RUFUS_HISTORY_LATENCY","RUFUS_HISTORY");a(ma,"RUFUS_INTERRUPTION_RECOVERY_LATENCY","RUFUS_HISTORY_INTERRUPTION_RECOVERY");a(ma,"RUFUS_LOW_RESOLUTION_IMAGE_LOADED_LATENCY","RUFUS_LOW_RESOLUTION_IMAGE_LOADED_LATENCY");
a(ma,"RUFUS_HIGH_RESOLUTION_IMAGE_LOADED_LATENCY","RUFUS_HIGH_RESOLUTION_IMAGE_LOADED_LATENCY");a(ma,"RUFUS_LOW_RESOLUTION_IMAGE_RENDERED_LATENCY","RUFUS_LOW_RESOLUTION_IMAGE_RENDERED_LATENCY");a(ma,"RUFUS_HIGH_RESOLUTION_IMAGE_RENDERED_LATENCY","RUFUS_HIGH_RESOLUTION_IMAGE_RENDERED_LATENCY");a(ma,"UPDATE_CL_IMAGE_URL_TO_LOW_RES","UPDATE_CL_IMAGE_URL_TO_LOW_RES");var F=r(function Jg(){z(this,Jg)});a(F,"PANEL_RESIZE","PANEL_RESIZE");a(F,"PANEL_RESIZE_RUFUS","PANEL_RESIZE_RUFUS");a(F,"PANEL_CLOSE_CLICK",
"PANEL_CLOSE_CLICK");a(F,"PANEL_MINIMIZE_CLICK","PANEL_MINIMIZE_CLICK");a(F,"PANEL_EXPAND_CLICK","PANEL_EXPAND_CLICK");a(F,"SCROLL_VIEW","SCROLL_VIEW");a(F,"SCROLL_VIEW_END","SCROLL_VIEW_END");a(F,"MAIN_FEEDBACK_REQUEST","MAIN_FEEDBACK_REQUEST");a(F,"DETAIL_FEEDBACK_REQUEST","DETAIL_FEEDBACK_REQUEST");a(F,"RUFUS_PANEL_OVERFLOW_MENU","RUFUS_PANEL_OVERFLOW_MENU");a(F,"INPUT_TEXT_FOCUS","INPUT_TEXT_FOCUS");a(F,"INPUT_TEXT_TRIGGER","INPUT_TEXT_TRIGGER");a(F,"INPUT_TEXT_ERASE","INPUT_TEXT_ERASE");a(F,
"LOAD_HISTORY","LOAD_HISTORY");a(F,"INVOKE_NILE","INVOKE_NILE");a(F,"RUFUS_OPEN","RUFUS_OPEN");a(F,"RUFUS_CLOSE","RUFUS_CLOSE");a(F,"CONVERSATION_ABANDONMENT","CONVERSATION_ABANDONMENT");a(F,"BACK_NAVIGATION","BACK_NAVIGATION");a(F,"INTERRUPTION_RECOVERY_BUTTON_CLICK","INTERRUPTION_RECOVERY_BUTTON_CLICK");a(F,"INTERRUPTION_RECOVERY_BUTTON_SHOWN","INTERRUPTION_RECOVERY_BUTTON_SHOWN");a(F,"OPEN_MEDIA","OPEN_MEDIA");a(F,"CLOSE_MEDIA","CLOSE_MEDIA");a(F,"TEASER_AUTO_EXPANDS_CL","TEASER_AUTO_EXPANDS_CL");
a(F,"TEASER_WIDGET_BSR_SENT_TO_SEARCH","TEASER_WIDGET_BSR_SENT_TO_SEARCH");a(F,"TEASER_RECOVERY_WIDGET_SENT_TO_SEARCH","TEASER_RECOVERY_WIDGET_SENT_TO_SEARCH");a(F,"REMOVE_SECTION","REMOVE_SECTION");a(F,"RUFUS_TWISTER_STREAMING_REQUEST_SENT","RUFUS_TWISTER_STREAMING_REQUEST_SENT");a(F,"CONVERSATION_REFINEMENT_SET","CONVERSATION_REFINEMENT_SET");a(F,"CONVERSATION_REFINEMENT_CLEARED","CONVERSATION_REFINEMENT_CLEARED");a(F,"FILTER_PILL_CLICK","FILTER_PILL_CLICK");a(F,"FILTER_PILL_DISMISS_CLICK","FILTER_PILL_DISMISS");
var ia=r(function da(){z(this,da)});a(ia,"THUMBS_UP","THUMBS_UP");a(ia,"THUMBS_DOWN","THUMBS_DOWN");a(ia,"AUTO_MINIMIZE_ENABLE","AUTO_MINIMIZE_ENABLE");a(ia,"AUTO_MINIMIZE_DISABLE","AUTO_MINIMIZE_DISABLE");a(ia,"GET_STARTED","GET_STARTED");a(ia,"OVERFLOW_MENU_CLOSE","CLOSE");a(ia,"OVERFLOW_MENU_OPEN","OPEN");a(ia,"RUFUS_ICON_TAP","RUFUS_ICON_TAP");a(ia,"EXPANDED_TO_MINIMIZED","expanded_to_minimized");a(ia,"ASIN_REFINEMENT","asin_refinement");a(ia,"FILTER_PILL_INGRESS_PREFIX","filter_pill_ingress_");
var Z=function(a){return a.SWIPE_UP="SWIPE_UP",a.ASIN_CLICK="ASIN_CLICK",a.SEARCH="SEARCH",a.CLOSE="CLOSE",a.UNKNOWN="UNKNOWN",a}({}),vf=function(a){return a.FIRST_TIME_USER_MESSAGE_SEEN_STATUS="FIRST_TIME_USER_MESSAGE_SEEN_STATUS",a}({}),wf=function(a){return a.SEEN="SEEN",a}({}),qa=function(a){return a.NILE_CL_TEXT_INPUT="NileCLTextInput",a.NILE_RELATED_QUESTION="NileRelatedQuestion",a.NILE_DEALS_RELATED_QUESTION="NileDealsRelatedQuestion",a.NILE_NDSWDCS_RELATED_QUESTION="NileNDSWDCSRelatedQuestion",
a.NILE_ASIN_INGRESS="NileAsinIngress",a}({}),Ma=function(a){return a.NILE_OPTION_IN_AUTOCOMPLETE="NileOptionInAutocomplete",a.NILE_TEASER_CX_RECOVERY="NileTeaserRecovery",a.NILE_INGRESS_LINK="NileIngressLink",a}({}),H=function(a){return a.FATAL="FATAL",a.ERROR="ERROR",a.WARN="WARN",a.DEBUG="DEBUG",a}({}),ib=function(a){return a.ClickToATF="af",a.ClickToCF="cf",a.ClickToPageLoaded="ld",a.ClickToBodyBegin="bb",a.ClickToBodyEnd="be",a}({}),k=function(){function a(){z(this,a)}return r(a,null,[{key:"logErrorWithLevelWithException",
value:function(a,b,k){k=k?"".concat(k," ").concat(b.message):"".concat(b.message);c.ueLogError&&a!=H.DEBUG?(a={logLevel:a,attribution:"rufus_panel",message:"error occurred with following message ".concat(k)},c.ueLogError(b,a)):console.error(b.message)}},{key:"logErrorWithLevel",value:function(a,b,k){c.ueLogError&&a!=H.DEBUG?(a={logLevel:a,attribution:"rufus_panel",message:"error occurred with following message: ".concat(b)},c.ueLogError(Error(b),a)):console.error(b);k&&this.addCount(k,1)}},{key:"recordTrigger",
value:function(a,b,k){c.ue&&(k?c.ue.trigger(a,b,k):c.ue.trigger(a,b))}},{key:"setCount",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;c.ue&&c.ue.count(a,b)}},{key:"getCount",value:function(a){return c.ue&&c.ue.count&&null!=c.ue.count(a)?c.ue.count(a):0}},{key:"addCount",value:function(a,b){this.setCount(a,this.getCount(a)+b)}},{key:"logEvent",value:function(a,b,k){var I;null===(I=c.ue)||void 0===I||I.event(a,b,k)}},{key:"sendCsmFeatureLatency",value:function(a,b){c.uex&&
(b?c.uex(ib.ClickToPageLoaded,a,{wb:1},b):c.uex(ib.ClickToPageLoaded,a,{wb:1}))}},{key:"logCsmFeatureLatency",value:function(a,b,k){c.uet&&(k?c.uet(a,b,{wb:1},k):c.uet(a,b,{wb:1}))}},{key:"fetchRequestIdFromCSMData",value:function(){return c.ue&&c.ue.id?c.ue.id:""}},{key:"widgetBodyBegin",value:function(b,c){a.logCsmFeatureLatency(ib.ClickToBodyBegin,b,c)}},{key:"widgetBodyEnd",value:function(b,c,k){c||a.logCsmFeatureLatency(ib.ClickToBodyEnd,b,k);a.sendCsmFeatureLatency(b,k)}}])}(),mh=new Map([["expanded_minimized",
"rufus-panel-expanded-to-minimized"],["expanded_closed","rufus-panel-expanded-to-closed"],["minimized_expanded","rufus-panel-minimized-to-expanded"],["minimized_closed","rufus-panel-expanded-to-closed"],["closed_expanded","rufus-panel-closed-to-expanded"]]),nh=new Map([["¬¨‚àû","\x26deg;"],["¬¨‚àü","\x26trade;"],["¬¨‚àö","\x26reg;"],["¬¨‚àö©","\x26copy;"],["¬¨‚àû‚àö√≤","\x26hellip;"],["¬¨‚àû‚àö√ñ","\x26mdash;"],["¬¨‚àû‚àö√í","\x26ndash;"],["¬¨‚àö√∫","\x26lsquo;"],["¬¨‚àö√≠","\x26rsquo;"],["¬¨‚àö√¢",
"\x26ldquo;"],["¬¨‚àö√£","\x26rdquo;"]]),Db=function(a){return a.HIDDEN="hidden",a.COLLAPSED="collapsed",a.EXPANDED="expanded",a}({}),Eb=function(a){return a.FEEDBACK="nl_cl_dsk_fb",a.HISTORY="nl_cl_dsk_hist",a.CUSTOMER_SUBMITTED_QUERY="nl_cl_dsk_csq",a.RASIN_INGRESS_BUTTON_CLICK="nl_bp_ra_cl_ing",a.DP_FROM_FILTER_PILL="nl_cl_ra_fp",a}({}),oh="https://".concat("development.amazon.com","/"),ph="https://".concat("pre-prod.amazon.com","/"),qh="https://".concat("www.amazon.com","/"),rh=["Up","Down","ArrowUp",
"ArrowDown"],Lg=function(){function b(){z(this,b);a(this,"_browserVersion","")}return r(b,[{key:"browserVersion",get:function(){return this._browserVersion},set:function(a){this._browserVersion=a}}],[{key:"getInstance",value:function(){return b.instance||(b.instance=new b),b.instance}}])}(),ye=function(){function b(){z(this,b);a(this,"_browserName","")}return r(b,[{key:"browserName",get:function(){return this._browserName},set:function(a){this._browserName=a}}],[{key:"getInstance",value:function(){return b.instance||
(b.instance=new b),b.instance}}])}(),Mg=function(){function b(){z(this,b);a(this,"_osType","")}return r(b,[{key:"osType",get:function(){return this._osType},set:function(a){this._osType=a}}],[{key:"getInstance",value:function(){return b.instance||(b.instance=new b),b.instance}}])}(),ze=function(){function b(){z(this,b);a(this,"_deviceVersion","")}return r(b,[{key:"deviceVersion",get:function(){return this._deviceVersion},set:function(a){this._deviceVersion=a}}],[{key:"getInstance",value:function(){return b.instance||
(b.instance=new b),b.instance}}])}(),Ae=function(){function b(){z(this,b);a(this,"_tabId","")}return r(b,[{key:"tabId",get:function(){return this._tabId},set:function(a){this._tabId=a}}],[{key:"getInstance",value:function(){return b.instance||(b.instance=new b),b.instance}}])}(),Ab=function(){function b(){z(this,b);a(this,"_nileRequestId","")}return r(b,[{key:"nileRequestId",get:function(){return this._nileRequestId},set:function(a){this._nileRequestId=a}}],[{key:"getInstance",value:function(){return b.instance||
(b.instance=new b),b.instance}}])}(),Ng=function(a){return a.EVENT_SCHEMA="mshop.nile.events.5",a.LATENCY_SCHEMA_V2="mshop.nile.latency.6",a.IMPRESSION_SCHEMA="mshop.nile.impressions.1",a}({}),Ga=function(){return r(function yd(){z(this,yd);a(this,"listeners",new Map)},[{key:"on",value:function(a,b){this.listeners.has(a)||this.listeners.set(a,[]);this.listeners.get(a).push(b)}},{key:"off",value:function(a,b){var c=this.listeners.get(a);c&&this.listeners.set(a,c.filter(function(a){return a!==b}))}},
{key:"dispatch",value:function(a,b){(a=this.listeners.get(a))&&a.forEach(function(a){a(b)})}}])}(),xf=r(function yd(){z(this,yd)});a(xf,"TEASER_CX_CUSTOMER_QUERY","tcxcq");var K=function(){return r(function Sb(){z(this,Sb)},null,[{key:"extractQueryFromUrl",value:function(a){return(a=this.capture(a,/[?&]k=([^&/]*)/i))?decodeURIComponent(a.replace(/\+/g," ")):void 0}},{key:"extractAsinFromUrl",value:function(a){return this.capture(a,/(?:\/gp\/aw\/d\/|\/gp\/product\/|\/dp\/product\/|\/exec\/obidos\/ASIN\/|\/gp\/video\/detail\/|\/o\/asin\/|\/exec\/obidos\/tg\/detail\/-\/|.*?\/dp\/|.*?\/d\/|.*?%2Fdp%2F|[?&]asin=)(?:[^/?]*?\/)*(\w{10}\b)/i)}},
{key:"extractGtiFromUrl",value:function(a){return this.capture(a,/\/gp\/video\/detail\/(\w{26}|[\w.]+gti.[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12})\b/i)}},{key:"extractNileReftagFromUrl",value:function(a){var b,c=/^(ref|ref_)(.*)$/;a=function(a,h){var b="undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(!b){if(Array.isArray(a)||(b=function(a,h){if(a){if("string"==typeof a)return qb(a,h);var b={}.toString.call(a).slice(8,-1);return"Object"===b&&a.constructor&&(b=a.constructor.name),
"Map"===b||"Set"===b?Array.from(a):"Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b)?qb(a,h):void 0}}(a))||h&&a&&"number"==typeof a.length){b&&(a=b);var f=0;h=function(){};return{s:h,n:function(){return f>=a.length?{done:!0}:{done:!1,value:a[f++]}},e:function(a){throw a;},f:h}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var x,d=!0,l=!1;return{s:function(){b=b.call(a)},
n:function(){var a=b.next();return d=a.done,a},e:function(a){l=!0;x=a},f:function(){try{d||null==b.return||b.return()}finally{if(l)throw x;}}}}((new URL(a)).searchParams.entries());try{for(a.s();!(b=a.n()).done;){var h=Na(b.value,2),x=h[1];if(c.exec(h[0])&&x.startsWith("nl_cl_"))return x}}catch(f){a.e(f)}finally{a.f()}}},{key:"getOriginUrl",value:function(){return document.referrer}},{key:"getCurrentPageUrl",value:function(){return c.location.href}},{key:"extractQis",value:function(a){return this.capture(a,
/[?&]qis=([^&]*)/)}},{key:"setReftagAndQisInTargetUrl",value:function(a,b){if(!b)return a;try{var c=new URL(a),h=new URL(b),x=h.searchParams.get("ref"),f=h.searchParams.get("qis");return x&&c.searchParams.set("ref",x),f&&c.searchParams.set("qis",f),c.toString()}catch(D){k.logErrorWithLevelWithException(H.ERROR,D,"Error updating targetUrl with metadata qis and ref: ".concat(D instanceof Error?"(".concat(D.message,")"):""))}return a}},{key:"capture",value:function(a,b){var c=2<arguments.length&&void 0!==
arguments[2]?arguments[2]:1;return(a.match(b)||[])[c]}},{key:"extractBaseUrl",value:function(a){if(a){var b=a.match(/^(https?:\/\/[^/]+)/);return b?b[1]:a}}}])}();var Wb=K;a(K,"metadataParsers",{DETAIL_PAGE:function(a){var b=Wb.extractAsinFromUrl(a);return b?[{type:"ASIN",value:b}]:(a=Wb.extractGtiFromUrl(a))?[{type:"GTI",value:a}]:void 0},SEARCH_RESULTS:function(a){a=Wb.extractQueryFromUrl(a);if(void 0!==a)return[{type:"KEYWORDS",value:a}]}});a(K,"HOST_NAME_DOMAIN_MAPPING",a(a(a({},"development.amazon.com",
oh),"pre-prod.amazon.com",ph),"www.amazon.com",qh));a(K,"getUrlByDomain",function(a,b){return Wb.HOST_NAME_DOMAIN_MAPPING[a]?"".concat(Wb.HOST_NAME_DOMAIN_MAPPING[a]).concat(b):void 0});a(K,"isDevoDomain",function(){return"development.amazon.com"===c.location.hostname});a(K,"getTeaserCXCustomerQueryFromURLQueryParam",function(a){var b;a=new URL(a);return decodeURIComponent(null!==(b=a.searchParams.get(xf.TEASER_CX_CUSTOMER_QUERY))&&void 0!==b?b:"")});var yf=r(function x(a,b,c,h){z(this,x);this.action=
a;this.query=b;this.sectionId=c;this.clickEventName=h}),zf=function(a){return a.POPUP="POPUP",a.SELF="SELF",a}({}),uc=function(a){return a.OPEN_URL="OPEN_URL",a.DISMISS="DISMISS",a.OPEN_MEDIA="OPEN_MEDIA",a.BOTTOM_SHEET_NAVIGATE="BOTTOM_SHEET_NAVIGATE",a.INVOKE_NILE_BACKEND_API="INVOKE_NILE_BACKEND_API",a.NEW_SEARCH_REQUEST="NEW_SEARCH_REQUEST",a.MAIN_FEEDBACK_REQUEST="MAIN_FEEDBACK_REQUEST",a.DETAILED_FEEDBACK_REQUEST="DETAILED_FEEDBACK_REQUEST",a.AD_FEEDBACK_REQUEST="AD_FEEDBACK_REQUEST",a.EXPAND_TO_CONTENT=
"EXPAND_TO_CONTENT",a}({}),sh=function(b){function m(b){var h;return z(this,m),a(h=function(a,h,b){return h=y(h),R(a,Ta()?Reflect.construct(h,[],y(a).constructor):h.apply(a,b))}(this,m),"handleAction",function(a){var b=a.action.actionType;switch(b){case uc.INVOKE_NILE_BACKEND_API.toString():h.handleInvokeNileBackendApi(a);break;case uc.OPEN_URL.toString():J(a.action.actionType,a.action.actionId);k.addCount(p.RUFUS_OPEN_URL_CLICK_PREFIX+a.clickEventName,1);h.handleOpenUrlAction(a.action);h.containsCSAIParam(a.action.actionAdditionalProps)&&
(h.dispatch("applyAnimationAndStateUpdateWithDefault","minimized"),k.addCount(p.RUFUS_CSAI_OPENED,1));break;case uc.DISMISS.toString():break;default:k.logErrorWithLevel(H.ERROR,"New ActionType: ".concat(b))}}),a(h,"getOpenUrlTarget",function(a){var h,b={targetType:zf.SELF};return null!==(h=null==a?void 0:a.openURLTarget)&&void 0!==h?h:b}),a(h,"isValidPopupTarget",function(a){return 0<a.newWindowHeightPixels&&0<a.newWindowWidthPixels&&-1<a.newWindowScreenPosition}),a(h,"handleOpenUrlAction",function(a){var b=
h.getOpenUrlTarget(a.payload);switch(b.targetType){case zf.POPUP:var x="width\x3d".concat(b.newWindowWidthPixels,", height\x3d").concat(b.newWindowHeightPixels,", left\x3d").concat(b.newWindowScreenPosition);if(!h.isValidPopupTarget(b)){k.logErrorWithLevel(H.ERROR,"Invalid Popup Target ".concat(x));c.open(a.url,"_self");break}c.open(a.url,b.targetType.toString(),x);break;default:c.open(a.url,"_self")}}),a(h,"handleInvokeNileBackendApi",function(a){var b,x=null!==(b=a.query)&&void 0!==b?b:a.action.payload.query;
null!=x&&(h.streamingClient.startStream({actionType:Z.SEARCH,inputQuery:x,qis:a.action.payload.qis,reftag:K.extractNileReftagFromUrl(a.action.url)}),J(a.action.actionType,a.action.actionId),k.addCount(p.RUFUS_RQ_CLICK,1),a.action.payload.qis===qa.NILE_DEALS_RELATED_QUESTION&&k.addCount(p.RUFUS_DEALS_RQ_CLICK,1),a.action.payload.qis===qa.NILE_NDSWDCS_RELATED_QUESTION&&k.addCount(p.RUFUS_WDCS_RQ_CLICK,1))}),a(h,"containsCSAIParam",function(a){return"true"==(null==a?void 0:a.isCSAI)||"true"==(null==
a?void 0:a.get("isCSAI"))}),h.streamingClient=b,h}return Aa(m,b),r(m)}(Ga),Fb=function(a){return a.AUTHENTICATED="authenticated",a.UNAUTHENTICATED="unauthenticated",a.UNKNOWN="unknown",a}({}),th=function(b){function m(){var b;return z(this,m),a(b=function(a,b,f){return b=y(b),R(a,rb()?Reflect.construct(b,[],y(a).constructor):b.apply(a,f))}(this,m),"lastAuthStatus",Fb.UNKNOWN),a(b,"handleStorageEvent",function(a){"csa-tabbed-browsing"==a.key&&b.checkAuthStatus()}),a(b,"handleVisibilityChange",function(){b.checkAuthStatus()}),
b.attachEventListeners(),b}return Aa(m,b),r(m,[{key:"checkAuthStatus",value:function(){var a=this.isValidAuthSession()?Fb.AUTHENTICATED:Fb.UNAUTHENTICATED;if(a!==this.lastAuthStatus){if(this.dispatch("authStatusChanged",a),a!==Fb.AUTHENTICATED)return k.addCount(p.RUFUS_SIGN_OUT,1),Fb.UNAUTHENTICATED;this.lastAuthStatus=a}return a}},{key:"isValidAuthSession",value:function(){var a,b,x,f=nb("authCookieName");return!(""===(a=null!=f&&f.trim()?f:"x-main",b=a.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),
x=document.cookie.match("(^|;)\\s*"+b+"\\s*\x3d\\s*([^;]+)"),x?x.pop():"")&&!K.isDevoDomain())}},{key:"attachEventListeners",value:function(){c.addEventListener("storage",this.handleStorageEvent);document.addEventListener("visibilitychange",this.handleVisibilityChange)}}],[{key:"getInstance",value:function(){return m.instance||(m.instance=new m),m.instance}}])}(Ga),vc={tabId:{key:"".concat("rufus",":tabId")},panel:{key:"".concat("rufus",":panel"),json:!0},impressionsContextMap:{key:"".concat("rufus",
":impression-context-map"),json:!0},previousPageUrl:{key:"".concat("rufus",":previous-page-url")}},uh=function(){return r(function S(b,h){var f=this;z(this,S);a(this,"markCustomerSeenFTUX",function(){f.impressionsContextMap[f.uniqueId]||(f.impressionsContextMap[f.uniqueId]=!0,f.write("impressionsContextMap",f.impressionsContextMap,localStorage))});a(this,"toggleAutoMinimize",function(a){f.panel&&(f.panel.state.autoMinimize=a,f.setPanel(f.panel))});a(this,"setPreviousPageUrl",function(){f.previousPageUrl=
K.getCurrentPageUrl();f.write("previousPageUrl",f.previousPageUrl)});a(this,"isStreamingRequestInProgress",function(){var a;return!1===(null===(a=f.getPanelState())||void 0===a||null===(a=a.requestContext)||void 0===a?void 0:a.requestCompleted)});a(this,"updateLastCacheInvalidatedTimestamp",function(){f.panel&&(f.panel.metadata.lastCacheInvalidatedTimestamp=Date.now(),f.setPanel(f.panel))});a(this,"setRequestMetadata",function(a){f.panel&&(f.panel.state.requestMetadata=a,f.setPanel(f.panel))});a(this,
"getRequestMetadata",function(){var a;return null===(a=f.panel)||void 0===a?void 0:a.state.requestMetadata});this.uniqueId=b;this.isCacheEnabled=h;this.tabId=this.readTabId();this.defaultPanel=this.buildDefaultPanel();this.impressionsContextMap=this.readImpressionsContextMap();this.previousPageUrl=this.readPreviousPageUrl()},[{key:"initialize",value:function(){this.panel=this.readPanel();this.setPreviousPageUrl()}},{key:"getTabId",value:function(){return this.tabId||k.logErrorWithLevel(H.ERROR,"".concat("RufusCacheManager",
" - Error retrieving tabId")),this.tabId}},{key:"getPanel",value:function(){return this.panel||k.logErrorWithLevel(H.ERROR,"".concat("RufusCacheManager"," - Error retrieving panel")),this.panel}},{key:"setPanel",value:function(a){return this.panel=a,this.panel.metadata.creationTimestamp=Date.now(),this.write("panel",this.panel),this.panel}},{key:"setPanelContent",value:(h=G(Q().mark(function S(a){return Q().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(this.panel&&this.isCacheEnabled){b.next=
2;break}return b.abrupt("return");case 2:this.panel.content=a.innerHTML,this.setPanel(this.panel);case 4:case "end":return b.stop()}},S,this)})),function(a){return h.apply(this,arguments)})},{key:"setPanelState",value:(I=G(Q().mark(function w(a){return Q().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(this.panel){b.next=2;break}return b.abrupt("return");case 2:this.panel.state=Rb({},a),this.setPanel(this.panel);case 4:case "end":return b.stop()}},w,this)})),function(a){return I.apply(this,
arguments)})},{key:"getPanelState",value:function(){var a;return null===(a=this.panel)||void 0===a?void 0:a.state}},{key:"setPanelRequestCompleted",value:(c=G(Q().mark(function E(a){var b;return Q().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.panel){h.next=2;break}return h.abrupt("return");case 2:!this.panel.state||!this.panel.state.requestContext||null!==(b=this.panel.state.requestContext)&&void 0!==b&&b.requestCompleted||(this.panel.state.requestContext.requestCompleted=a),this.setPanel(this.panel);
case 4:case "end":return h.stop()}},E,this)})),function(a){return c.apply(this,arguments)})},{key:"setPanelRequestContext",value:(b=G(Q().mark(function d(a){return Q().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(this.panel){b.next=2;break}return b.abrupt("return");case 2:this.panel.state.requestContext=a,this.setPanel(this.panel);case 4:case "end":return b.stop()}},d,this)})),function(a){return b.apply(this,arguments)})},{key:"hasCustomerSeenFTUX",value:function(){var a;return null!==
(a=this.impressionsContextMap[this.uniqueId])&&void 0!==a&&a}},{key:"shouldInvalidatePanelCache",value:function(){return!this.isPanelCacheLastInvalidatedTimestampWithinTTL(this.getPanel())&&!this.isStreamingRequestInProgress()}},{key:"getPreviousPageUrl",value:function(){return this.previousPageUrl}},{key:"read",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:sessionStorage,h=null,q=vc[a],g=q.key;q=q.json;try{var c=b.getItem(g);c&&(h=q?JSON.parse(c):c)}catch(N){k.logErrorWithLevelWithException(H.ERROR,
N,"".concat("RufusCacheManager"," - Error reading from ").concat(g," ").concat(N instanceof Error?"(".concat(N.message,")"):"")),h=null}return h}},{key:"write",value:function(a,b){var h=2<arguments.length&&void 0!==arguments[2]?arguments[2]:sessionStorage,d=vc[a],g=d.key;d=d.json;if("object"===m(b)&&!d)return k.logErrorWithLevel(H.ERROR,"".concat("RufusCacheManager"," - Trying to serialize a non-json object ").concat(g)),!1;try{return h.setItem(g,"object"===m(b)?JSON.stringify(b):b),!0}catch(C){return k.logErrorWithLevelWithException(H.ERROR,
C,"".concat("RufusCacheManager"," - Error writing from ").concat(g," ").concat(C instanceof Error?"(".concat(C.message,")"):"")),!1}}},{key:"readTabId",value:function(){var a=this.read("tabId");return a||(a=ob(),this.write("tabId",a),k.addCount(p.RUFUS_TAB_ID_GENERATED,1)),a}},{key:"readPanel",value:function(){var a=this.read("panel");return this.validatePanel(a)||(a=this.clonePanel(this.defaultPanel),this.write("panel",a)),this.isCacheEnabled||(a.content=""),this.validatePanelContent(a)||(a.content=
"",a.metadata.creationTimestamp=Date.now()),a}},{key:"readImpressionsContextMap",value:function(){var b=this.read("impressionsContextMap",localStorage);return null!=b?b:a({},this.uniqueId,!1)}},{key:"readPreviousPageUrl",value:function(){var a=this.read("previousPageUrl");return a||(a=K.getCurrentPageUrl(),this.write("previousPageUrl",a)),a}},{key:"buildDefaultPanel",value:function(){return{content:"",metadata:{creationTimestamp:Date.now(),uniqueId:this.uniqueId,lastCacheInvalidatedTimestamp:Date.now()},
state:{height:300,width:320,viewState:"closed"}}}},{key:"validatePanel",value:function(a){return!(!a||!a.metadata||a.metadata.uniqueId!==this.uniqueId)}},{key:"validatePanelContent",value:function(a){return 2E6>a.content.length}},{key:"clonePanel",value:function(a){return JSON.parse(JSON.stringify(a))}},{key:"isPanelCacheLastInvalidatedTimestampWithinTTL",value:function(a){return void 0===a||864E5>Math.abs(a.metadata.lastCacheInvalidatedTimestamp-Date.now())}}]);var b,c,I,h}(),jb=r(function Kg(){z(this,
Kg)});a(jb,"CONTENT_TYPE","Content-Type");a(jb,"ANTI_CSRF_TOKEN","anti-csrftoken-a2z");a(jb,"FLOW_CLOSURE_ID","x-amzn-flow-closure-id");var Af=function(a,b){b=a.children.length-b;for(var h=0;h<b&&a.firstChild;h++)a.removeChild(a.firstChild)},Bf=function(a){Array.from(a.children).forEach(function(b){0===b.children.length&&a.removeChild(b)})},Md=function(){var a=document.querySelector("#nav-flyout-rufus meta[name\x3d'anti-csrftoken-a2z']");return a&&a.getAttribute("content")||""},Cf=function(a,b){var h=
a.firstElementChild;h&&(a.style.width=b?"".concat(b,"px"):"100%",b=h.getBoundingClientRect(),0<b.width&&(a.style.width="".concat(b.width,"px")))},Df=function(a){function b(a,h){z(this,b);var f=b;a=[a,h];return f=y(f),R(this,Pb()?Reflect.construct(f,a||[],y(this).constructor):f.apply(this,a))}return Aa(b,a),r(b,[{key:"fetchHistory",value:(h=G(Q().mark(function D(a){var h,f,c=this,d=arguments;return Q().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return f=(h=1<d.length&&void 0!==d[1]?d[1]:
"")?ma.RUFUS_INTERRUPTION_RECOVERY_LATENCY:ma.RUFUS_HISTORY_LATENCY,k.widgetBodyBegin(f),l.abrupt("return",new Promise(function(d,g){c.abortCurrentRequest();c.currentRequest=c.post(b.HISTORY_ENDPOINT,{method:"POST",params:h?c.buildInterruptionRecoveryRequest(h):c.buildRequest(a),paramsFormat:"json",contentType:"application/json",success:function(a){return c.onFetchHistorySuccess(a,d,f,h)},error:function(a,b){return c.onFetchHistoryError(a,b,g,f)}})}));case 4:case "end":return l.stop()}},D)})),function(a){return h.apply(this,
arguments)})},{key:"hasMoreHistory",value:function(){var a,b;return null===(a=null===(b=this.lastResponseMetadata)||void 0===b?void 0:b.hasAdditionalHistory)||void 0===a||a}},{key:"isFirstTimeLoadHistory",value:function(){var a;return!(null!==(a=this.lastResponseMetadata)&&void 0!==a&&a.lastFetchedTurnId)}},{key:"buildRequest",value:function(a){var b,h;a={tabId:this.tabId,maxTurns:a+5,historyOrder:"ASC",historySource:"CONVERSATION_LAYER"};return null!==(b=this.lastResponseMetadata)&&void 0!==b&&b.lastFetchedTurnId&&
(a.lastFetchedTurnId=null===(h=this.lastResponseMetadata)||void 0===h?void 0:h.lastFetchedTurnId),a}},{key:"buildInterruptionRecoveryRequest",value:function(a){return{tabId:this.tabId,maxTurns:2,historyOrder:"ASC",historySource:"CONVERSATION_LAYER",interruptedConversationRecoveryContext:{interruptedConversationRequestId:a,isInterruptedConversationRecoveryRequest:!0}}}},{key:"retrieveRecoveredInterruptedConversation",value:function(a,b){var h,f=null===(h=this.lastResponseMetadata)||void 0===h?void 0:
h.conversationHistoryRequestIds;return f&&(b=f.lastIndexOf(b),-1!==b&&(a=(new DOMParser).parseFromString(a,"text/html"),a=Array.from(a.getElementsByClassName("conversation-turn-container")),a=b<a.length&&0<=b?a[b].outerHTML:null))?a:""}},{key:"onFetchHistorySuccess",value:function(a,b,h,c){this.lastResponseMetadata=a.metadata;this.currentRequest=void 0;a=function(a){var b=(new DOMParser).parseFromString(a,"text/html"),h=document.createDocumentFragment();a=Array.from(b.getElementsByClassName("rufus-customer-text"));
var f=b.getElementById("rufus-welcome-message-box-container");if(f&&f.parentElement){var g=b.createElement("div");g.className="conversation-turn-container";g.appendChild(f.parentElement.cloneNode(!0));h.appendChild(g)}a.forEach(function(a){var d=b.createElement("div");d.className="conversation-turn-container";(a=a.parentElement)&&d.appendChild(a.cloneNode(!0));for(a=a?a.nextElementSibling:null;a&&!a.querySelector(".rufus-customer-text");)d.appendChild(a.cloneNode(!0)),a=a.nextElementSibling;h.appendChild(d)});
a=b.createElement("div");return a.appendChild(h),a.innerHTML}(a.renderedHistoryContent);b(c?this.retrieveRecoveredInterruptedConversation(a,c):a);k.widgetBodyEnd(h,!1)}},{key:"onFetchHistoryError",value:function(a,b,h,c){this.currentRequest=void 0;h(b);k.logErrorWithLevel(H.ERROR,"Error fetching history. Status Code: ".concat(a.status,", Status text: ").concat(b));k.widgetBodyEnd(c,!0)}}]);var h}(function(){return r(function x(a,b){z(this,x);this.A=a;this.tabId=b},[{key:"post",value:function(a,b){return this.A.post(a,
Qb(Qb({},b),{},{headers:this.buildPostHeaders()}))}},{key:"get",value:function(a,b){return this.A.get(a,Qb({},b))}},{key:"abortCurrentRequest",value:function(){this.currentRequest&&(this.currentRequest.abort(),this.currentRequest=void 0)}},{key:"isLoading",value:function(){return!!this.currentRequest}},{key:"buildPostHeaders",value:function(){return a({},jb.ANTI_CSRF_TOKEN,Md())}}])}());a(Df,"HISTORY_ENDPOINT","/rufus/cl/"+"history?ref\x3d".concat(Eb.HISTORY));var xb=function(a){return a[a.INSUFFICIENT_BROWSER_CAPABILITIES=
10]="INSUFFICIENT_BROWSER_CAPABILITIES",a[a.UNDEFINED_EVENT_SOURCE=20]="UNDEFINED_EVENT_SOURCE",a[a.SSE_HANDLER_ERROR=30]="SSE_HANDLER_ERROR",a[a.TIMEOUT=40]="TIMEOUT",a[a.OFFLINE=50]="OFFLINE",a[a.HANDLE_CONTEXT_CHUNK_ERROR=60]="HANDLE_CONTEXT_CHUNK_ERROR",a}({}),kb=function(){function a(b){A(this,a);this._key=b}return B(a,[{key:"asString",value:function(){return this._key}}],[{key:"of",value:function(b){if(this.KEY_REGISTRY.has(b))throw Error("Key with name ".concat(b," already exist. AttributeKeys ").concat(JSON.stringify(this.KEY_REGISTRY),
" must only be created once."));return this.KEY_REGISTRY.add(b),new a(b)}}])}();kb.KEY_REGISTRY=new Set;var la=B(function I(){A(this,I)});la.LOCALE_KEY=kb.of("locale");la.DEFAULT_LOCALE_KEY=kb.of("defaultLocale");la.TIME_ZONE_KEY=kb.of("timeZone");la.I18N_DOMAIN_KEY=kb.of("i18nDomain");la.CX_TUPLE_KEY=kb.of("cxTuple");la.CURRENCY_KEY=kb.of("currency");la.DEFAULT_CURRENCY_KEY=kb.of("defaultCurrency");var vh=function(){return B(function x(a){A(this,x);this._locale=a.locale;this._defaultLocale=a.defaultLocale;
this._timeZone=a.timeZone;this._i18nDomain=a.i18nDomain},[{key:"getTimeZone",value:function(){return this._timeZone}},{key:"getLocale",value:function(){return this._locale}},{key:"getDefaultLocale",value:function(){return this._defaultLocale}},{key:"getI18nDomain",value:function(){return this._i18nDomain}},{key:"asAttributesMap",value:function(){return new Map([["locale",this._locale],["defaultLocale",this._defaultLocale],["timeZone",this._timeZone],["i18nDomain",this._i18nDomain]])}},{key:"toString",
value:function(){var a="LocalizationContext[";return a+="".concat("locale","\x3d").concat(this.getLocale(),","),a+="".concat("timeZone","\x3d").concat(this.getTimeZone(),","),a+"".concat("defaultLocale","\x3d").concat(this.getDefaultLocale(),",")+"".concat("i18nDomain","\x3d").concat(this.getI18nDomain(),"]")}},{key:"getAttribute",value:function(a){switch(a){case la.LOCALE_KEY:return this.getLocale();case la.DEFAULT_LOCALE_KEY:return this.getDefaultLocale();case la.TIME_ZONE_KEY:case la.I18N_DOMAIN_KEY:return this.getTimeZone()}}}])}(),
wb=function(){function a(){A(this,a);this._locale=a.DEFAULT_LOCALE;this._defaultLocale=void 0;this._timeZone=a.DEFAULT_TIME_ZONE;this._i18nDomain=""}return B(a,[{key:"locale",get:function(){return this._locale}},{key:"defaultLocale",get:function(){return this._defaultLocale}},{key:"timeZone",get:function(){return this._timeZone}},{key:"i18nDomain",get:function(){return this._i18nDomain}},{key:"withLocale",value:function(b){try{this._locale=Intl.getCanonicalLocales(b)[0]}catch(x){console.error("Provided Locale is invalid: locale\x3d".concat(b,
". Using default runtime locale: ").concat(a.DEFAULT_LOCALE))}return this}},{key:"withDefaultLocale",value:function(a){try{this._defaultLocale=Intl.getCanonicalLocales(a)[0]}catch(x){console.error("Provided DefaultLocale is invalid: defaultLocale:".concat(a,"."))}return this}},{key:"withI18nDomain",value:function(a){return this._i18nDomain=a,this}},{key:"withTimeZone",value:function(b){try{this._timeZone=(new Intl.DateTimeFormat(void 0,{timeZone:b})).resolvedOptions().timeZone}catch(x){console.error("Provided TimeZone is invalid: timeZone\x3d".concat(b,
". Using default TimeZone: ").concat(a.DEFAULT_TIME_ZONE))}return this}},{key:"build",value:function(){return new vh(this)}}])}();wb.DATE_TIME_OPTIONS=(new Intl.DateTimeFormat).resolvedOptions();wb.DEFAULT_LOCALE=wb.DATE_TIME_OPTIONS.locale;wb.DEFAULT_TIME_ZONE=wb.DATE_TIME_OPTIONS.timeZone;var hh=function(){return B(function x(a){A(this,x);this.provideContext=a},[{key:"getLocalizationContext",value:function(){return this.provideContext()}}])}(),wh=function(a){function b(){return A(this,b),ca(this,
b,arguments)}return ea(b,a),B(b)}(function(){return B(function h(){A(this,h)},[{key:"getObfuscatedMarketplaceId",value:function(){}},{key:"getDefaultLocale",value:function(){return Intl.DateTimeFormat().resolvedOptions().locale}},{key:"getDefaultCurrency",value:function(){}}])}()),Ef=function(){function a(){A(this,a)}return B(a,[{key:"getMarketplace",value:function(){return a.emptyMarketplace}}])}();Ef.emptyMarketplace=new wh;(function(){function a(){A(this,a)}return B(a,null,[{key:"setProvider",
value:function(b){a.marketplaceProvider=b}},{key:"provider",value:function(){return a.marketplaceProvider||(a.marketplaceProvider=new Ef),a.marketplaceProvider}}])})().marketplaceProvider=void 0;var Nd,yb=function(){function a(b){A(this,a);this._programs=ya(b);this._programs.sort()}return B(a,[{key:"has",value:function(a){return this._programs.includes(a)}},{key:"isEmpty",value:function(){return 0==this._programs.length}},{key:"toString",value:function(){var b=this._programs.join(a.DELIMITER);return a.OPENING_CHAR+
b+a.CLOSING_CHAR}},{key:"equals",value:function(a){return!!a&&this.toString()===a.toString()}}],[{key:"of",value:function(b){return new a(b)}},{key:"fromString",value:function(b){if(!b.startsWith(a.OPENING_CHAR)||!b.endsWith(a.CLOSING_CHAR))throw Error("Invalid fully qualified CXProgram: ".concat(b,". Valid example: [exports]."));var h=b.substring(1,b.length-1).trim();if(0==h.length)return a.EMPTY;var f;b=[];h=W(h.split(a.DELIMITER));try{for(h.s();!(f=h.n()).done;){var c=f.value,I=c.trim().toLowerCase();
if(!Object.values(Nd).includes(I))throw Error("Unrecognized program ".concat(c));b.push(I)}}catch(w){h.e(w)}finally{h.f()}return new a(b)}}])}();yb.EMPTY=yb.of([]);yb.DELIMITER=",";yb.OPENING_CHAR="[";yb.CLOSING_CHAR="]";(function(a){a.EXPORTS="exports";a.B2B="b2b"})(Nd||(Nd={}));var Gb=function(){function a(b,c){var h=2<arguments.length&&void 0!==arguments[2]?arguments[2]:yb.EMPTY;A(this,a);this._cxFamily=a.validateString("cxFamily",b);this._cxId=a.validateString("cxId",c);this._cxProgram=h}return B(a,
[{key:"cxFamily",get:function(){return this._cxFamily}},{key:"cxId",get:function(){return this._cxId}},{key:"cxProgram",get:function(){return this._cxProgram}},{key:"toString",value:function(){return this._cxProgram.isEmpty()?this._cxFamily+"/"+this._cxId:this._cxFamily+"/"+this._cxId+"/"+this._cxProgram.toString()}},{key:"equals",value:function(a){return this._cxFamily===a._cxFamily&&this._cxId==this._cxId&&this._cxProgram===a._cxProgram}}],[{key:"of",value:function(b,c,f){return new a(b,c,f)}},
{key:"fromString",value:function(b){var h=b.split("/");if(2!=h.length&&3!=h.length)throw Error("Invalid fully qualified CXTuple: ".concat(b));b=h[0];var f=h[1];return 3==h.length?new a(b,f,yb.fromString(h[2])):new a(b,f)}},{key:"validateString",value:function(a,b){if(!b)throw Error("".concat(a," must not be empty"));for(var h=0;h<b.length;h++){var c=b.charAt(h);if(!("."===c||"-"===c||"A"<=c&&"Z">=c||"a"<=c&&"z">=c||"0"<=c&&"9">=c))throw Error("Invalid character ".concat(c," in ").concat(a,": ").concat(b));
}return b}}])}();Gb.UNKNOWN=new Gb("unknown","unknown");var xh=function(){return B(function x(a){A(this,x);this._attributes=a},[{key:"getAttribute",value:function(a){return this._attributes.get(a)}},{key:"asAttributesMap",value:function(){var a,b=new Map,f=W(this._attributes.keys());try{for(f.s();!(a=f.n()).done;){var c=a.value;b.set(c.asString(),this._attributes.get(c))}}catch(S){f.e(S)}finally{f.f()}return b}},{key:"getDefaultLocale",value:function(){return this.getAttribute(la.DEFAULT_LOCALE_KEY)}},
{key:"getI18nDomain",value:function(){return this.getAttribute(la.I18N_DOMAIN_KEY)}},{key:"getLocale",value:function(){return this.getAttribute(la.LOCALE_KEY)}},{key:"getTimeZone",value:function(){return this.getAttribute(la.TIME_ZONE_KEY)}}])}(),Od=function(){return B(function f(a,b){A(this,f);this.attributeKey=a;this.value=b},[{key:"getAttribute",value:function(a){return this.value}},{key:"getProvidedAttributes",value:function(){var a=new Set;return a.add(this.attributeKey),a}}])}(),Hb=function(){return B(function h(){A(this,
h);for(var a=new Map,b=arguments.length,c=Array(b),k=0;k<b;k++)c[k]=arguments[k];for(b=0;b<c.length;b++){var w;k=c[b];var E=W(k.getProvidedAttributes());try{for(E.s();!(w=E.n()).done;){var d=w.value;if(a.has(d))throw Error("Attribute ".concat(d.asString()," is already provided by ").concat(a.get(d),"."));a.set(d,k)}}catch(l){E.e(l)}finally{E.f()}}a.has(la.LOCALE_KEY)||a.set(la.LOCALE_KEY,h.JVM_LOCALE_PROVIDER);a.has(la.TIME_ZONE_KEY)||a.set(la.TIME_ZONE_KEY,h.JVM_TIME_ZONE_PROVIDER);a.has(la.I18N_DOMAIN_KEY)||
a.set(la.I18N_DOMAIN_KEY,h.DEFAULT_I18N_DOMAIN_PROVIDER);this._attributeProviders=a},[{key:"getLocalizationContext",value:function(){var a,b=new Map,f=W(this._attributeProviders);try{for(f.s();!(a=f.n()).done;){var c=Xa(a.value,2),k=c[0];b.set(k,c[1].getAttribute(k))}}catch(w){f.e(w)}finally{f.f()}return new xh(b)}}])}();Hb.DATE_TIME_OPTIONS=(new Intl.DateTimeFormat).resolvedOptions();Hb.JVM_LOCALE_PROVIDER=new Od(la.LOCALE_KEY,Hb.DATE_TIME_OPTIONS.locale);Hb.JVM_TIME_ZONE_PROVIDER=new Od(la.TIME_ZONE_KEY,
Hb.DATE_TIME_OPTIONS.timeZone);Hb.DEFAULT_I18N_DOMAIN_PROVIDER=new Od(la.TIME_ZONE_KEY,"");var za="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof c?c:void 0!==O.g?O.g:"undefined"!=typeof self?self:{},Ff=function(){return B(function h(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(A(this,h),!(a.maxSize&&0<a.maxSize))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=a.maxSize;this.onEviction=a.onEviction;this.cache=new Map;this.oldCache=
new Map;this._size=0},[{key:"_set",value:function(a,b){if(this.cache.set(a,b),this._size++,this._size>=this.maxSize){if(this._size=0,"function"==typeof this.onEviction){var h;a=W(this.oldCache.entries());try{for(a.s();!(h=a.n()).done;){var c=Xa(h.value,2);this.onEviction(c[0],c[1])}}catch(S){a.e(S)}finally{a.f()}}this.oldCache=this.cache;this.cache=new Map}}},{key:"get",value:function(a){if(this.cache.has(a))return this.cache.get(a);if(this.oldCache.has(a)){var b=this.oldCache.get(a);return this.oldCache.delete(a),
this._set(a,b),b}}},{key:"set",value:function(a,b){return this.cache.has(a)?this.cache.set(a,b):this._set(a,b),this}},{key:"has",value:function(a){return this.cache.has(a)||this.oldCache.has(a)}},{key:"peek",value:function(a){return this.cache.has(a)?this.cache.get(a):this.oldCache.has(a)?this.oldCache.get(a):void 0}},{key:"delete",value:function(a){var b=this.cache.delete(a);return b&&this._size--,this.oldCache.delete(a)||b}},{key:"clear",value:function(){this.cache.clear();this.oldCache.clear();
this._size=0}},{key:"keys",value:U().mark(function x(){var a,b,c,w;return U().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:a=W(this),f.prev=1,a.s();case 3:if((b=a.n()).done){f.next=9;break}return c=Xa(b.value,1),w=c[0],f.next=7,w;case 7:f.next=3;break;case 9:f.next=14;break;case 11:f.prev=11,f.t0=f.catch(1),a.e(f.t0);case 14:return f.prev=14,a.f(),f.finish(14);case 17:case "end":return f.stop()}},x,this,[[1,11,14,17]])})},{key:"values",value:U().mark(function f(){var a,b,c,E;return U().wrap(function(d){for(;;)switch(d.prev=
d.next){case 0:a=W(this),d.prev=1,a.s();case 3:if((b=a.n()).done){d.next=9;break}return c=Xa(b.value,2),E=c[1],d.next=7,E;case 7:d.next=3;break;case 9:d.next=14;break;case 11:d.prev=11,d.t0=d.catch(1),a.e(d.t0);case 14:return d.prev=14,a.f(),d.finish(14);case 17:case "end":return d.stop()}},f,this,[[1,11,14,17]])})},{key:Symbol.iterator,value:U().mark(function D(){var a,b,c,d,l,q,g,C;return U().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:a=W(this.cache),w.prev=1,a.s();case 3:if((b=a.n()).done){w.next=
9;break}return c=b.value,w.next=7,c;case 7:w.next=3;break;case 9:w.next=14;break;case 11:w.prev=11,w.t0=w.catch(1),a.e(w.t0);case 14:return w.prev=14,a.f(),w.finish(14);case 17:d=W(this.oldCache),w.prev=18,d.s();case 20:if((l=d.n()).done){w.next=28;break}if(q=l.value,g=Xa(q,1),C=g[0],this.cache.has(C)){w.next=26;break}return w.next=26,q;case 26:w.next=20;break;case 28:w.next=33;break;case 30:w.prev=30,w.t1=w.catch(18),d.e(w.t1);case 33:return w.prev=33,d.f(),w.finish(33);case 36:case "end":return w.stop()}},
D,this,[[1,11,14,17],[18,30,33,36]])})},{key:"size",get:function(){var a,b=0,c=W(this.oldCache.keys());try{for(c.s();!(a=c.n()).done;)this.cache.has(a.value)||b++}catch(E){c.e(E)}finally{c.f()}return Math.min(this._size+b,this.maxSize)}}])}(),yh=function(a){return String(a)},Gf=function(){return B(function f(a,b){A(this,f);this.loader=a;this.storage=new Ff(b);this.serializeKeyFn=void 0!==b.keyFn?b.keyFn:yh},[{key:"get",value:function(a){var b=this.serializeKeyFn(a),h=this.storage.get(b);if(h)return h;
a=this.loader(a);return void 0!==a?(this.storage.set(b,a),a):void 0}},{key:"size",value:function(){return this.storage.size}},{key:"has",value:function(a){return this.storage.has(this.serializeKeyFn(a))}}])}(),Pd=function(){function a(b,c){A(this,a);this._bundle=b;this._context=c}return B(a,[{key:"bundle",get:function(){return this._bundle}},{key:"context",get:function(){return this._context}}],[{key:"generateCacheKey",value:function(b){var h,f=b.bundle;b=b.context.asAttributesMap();var c=W(a.LOCALIZATION_CONTEXT_ATTRIBUTES_FOR_CACHE_KEY);
try{for(c.s();!(h=c.n()).done;){var I=h.value,w=b.get(I);w&&(f+="#".concat(I,"#").concat(w))}}catch(E){c.e(E)}finally{c.f()}return f}}])}();Pd.LOCALIZATION_CONTEXT_ATTRIBUTES_FOR_CACHE_KEY=["locale","defaultLocale","i18nDomain"];var T,V,Bb,Qd=function(){return B(function D(a,b,f){A(this,D);this._bundle=a;this._variants=f;this._locale=b},[{key:"bundle",get:function(){return this._bundle}},{key:"variants",get:function(){return this._variants}},{key:"locale",get:function(){return this._locale}}],[{key:"cacheKey",
value:function(a){var b=a.bundle;return a.variants&&a.variants.forEach(function(a,h){b+="#var-".concat(h,"#").concat(a)}),b+="#".concat(a.locale)}}])}(),Hf=function(){function a(){A(this,a)}return B(a,[{key:"getFallbackChains",value:function(a,b,f){var h=this.createLocaleFallbackChain(f.getLocale(),f.getDefaultLocale()),c=this.getVariantFallbackChain(b,f);return Wa({},Symbol.iterator,U().mark(function E(){var b,f,q,g,x,I,D,k,S,p,m,r;return U().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:b=
W(c),d.prev=1,b.s();case 3:if((f=b.n()).done){d.next=39;break}q=f.value;g=W(q);d.prev=6;g.s();case 8:if((x=g.n()).done){d.next=29;break}I=x.value;D=W(h);d.prev=11;D.s();case 13:if((k=D.n()).done){d.next=19;break}return S=k.value,d.next=17,new Qd(a,S,I);case 17:d.next=13;break;case 19:d.next=24;break;case 21:d.prev=21,d.t0=d.catch(11),D.e(d.t0);case 24:return d.prev=24,D.f(),d.finish(24);case 27:d.next=8;break;case 29:d.next=34;break;case 31:d.prev=31,d.t1=d.catch(6),g.e(d.t1);case 34:return d.prev=
34,g.f(),d.finish(34);case 37:d.next=3;break;case 39:d.next=44;break;case 41:d.prev=41,d.t2=d.catch(1),b.e(d.t2);case 44:return d.prev=44,b.f(),d.finish(44);case 47:p=W(h),d.prev=48,p.s();case 50:if((m=p.n()).done){d.next=56;break}return r=m.value,d.next=54,new Qd(a,r,void 0);case 54:d.next=50;break;case 56:d.next=61;break;case 58:d.prev=58,d.t3=d.catch(48),p.e(d.t3);case 61:return d.prev=61,p.f(),d.finish(61);case 64:case "end":return d.stop()}},E,null,[[1,41,44,47],[6,31,34,37],[11,21,24,27],[48,
58,61,64]])}))}},{key:"getVariantFallbackChain",value:function(a,b){var h=b.asAttributesMap();return Wa({},Symbol.iterator,U().mark(function S(){var b,f,d,l,q,g,c,x,I;return U().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:b=0;case 1:if(!(b<a.length)){C.next=29;break}f=[];b<a.length-1&&(f=a[b+1]);d=a[b];l=!0;q=[];g=new Map;c=0;case 9:if(!(c<d.length)){C.next=24;break}if(h){C.next=12;break}return C.abrupt("continue",21);case 12:if(x=d[c],I=h.get(x)){C.next=16;break}return C.abrupt("continue",
21);case 16:if(g.set(x,I),!(l&&c<f.length&&f[c]===d[c])){C.next=19;break}return C.abrupt("continue",21);case 19:l=!1,q.push(new Map(g));case 21:c++;C.next=9;break;case 24:return C.next=26,q.reverse();case 26:b++;C.next=1;break;case 29:case "end":return C.stop()}},S)}))}},{key:"createLocaleFallbackChain",value:function(a,b){a=Intl.getCanonicalLocales(a)[0];b=void 0!==b?Intl.getCanonicalLocales(b)[0]:b;a=this.getFallbackChain(a);b&&!a.includes(b)&&(b=this.getFallbackChain(b),a.push.apply(a,ya(b)));
return a.push("und"),a}},{key:"getFallbackChain",value:function(b){var h=[];b=(new Intl.Locale(b)).baseName;if("und"!==b){h.push(b);for(var f=b.lastIndexOf(a.LOCALE_TAG_SEPARATOR);0<f;)b=b.substr(0,f),h.push(b),f=b.lastIndexOf(a.LOCALE_TAG_SEPARATOR)}return h}}])}();Hf.LOCALE_TAG_SEPARATOR="-";(function(a){a[a.EXPECT_ARGUMENT_CLOSING_BRACE=1]="EXPECT_ARGUMENT_CLOSING_BRACE";a[a.EMPTY_ARGUMENT=2]="EMPTY_ARGUMENT";a[a.MALFORMED_ARGUMENT=3]="MALFORMED_ARGUMENT";a[a.EXPECT_ARGUMENT_TYPE=4]="EXPECT_ARGUMENT_TYPE";
a[a.INVALID_ARGUMENT_TYPE=5]="INVALID_ARGUMENT_TYPE";a[a.EXPECT_ARGUMENT_STYLE=6]="EXPECT_ARGUMENT_STYLE";a[a.INVALID_NUMBER_SKELETON=7]="INVALID_NUMBER_SKELETON";a[a.INVALID_DATE_TIME_SKELETON=8]="INVALID_DATE_TIME_SKELETON";a[a.EXPECT_NUMBER_SKELETON=9]="EXPECT_NUMBER_SKELETON";a[a.EXPECT_DATE_TIME_SKELETON=10]="EXPECT_DATE_TIME_SKELETON";a[a.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE=11]="UNCLOSED_QUOTE_IN_ARGUMENT_STYLE";a[a.EXPECT_SELECT_ARGUMENT_OPTIONS=12]="EXPECT_SELECT_ARGUMENT_OPTIONS";a[a.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE=
13]="EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE";a[a.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE=14]="INVALID_PLURAL_ARGUMENT_OFFSET_VALUE";a[a.EXPECT_SELECT_ARGUMENT_SELECTOR=15]="EXPECT_SELECT_ARGUMENT_SELECTOR";a[a.EXPECT_PLURAL_ARGUMENT_SELECTOR=16]="EXPECT_PLURAL_ARGUMENT_SELECTOR";a[a.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT=17]="EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT";a[a.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT=18]="EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT";a[a.INVALID_PLURAL_ARGUMENT_SELECTOR=19]="INVALID_PLURAL_ARGUMENT_SELECTOR";
a[a.DUPLICATE_PLURAL_ARGUMENT_SELECTOR=20]="DUPLICATE_PLURAL_ARGUMENT_SELECTOR";a[a.DUPLICATE_SELECT_ARGUMENT_SELECTOR=21]="DUPLICATE_SELECT_ARGUMENT_SELECTOR";a[a.MISSING_OTHER_CLAUSE=22]="MISSING_OTHER_CLAUSE";a[a.INVALID_TAG=23]="INVALID_TAG";a[a.INVALID_TAG_NAME=25]="INVALID_TAG_NAME";a[a.UNMATCHED_CLOSING_TAG=26]="UNMATCHED_CLOSING_TAG";a[a.UNCLOSED_TAG=27]="UNCLOSED_TAG"})(T||(T={}));(function(a){a[a.literal=0]="literal";a[a.argument=1]="argument";a[a.number=2]="number";a[a.date=3]="date";a[a.time=
4]="time";a[a.select=5]="select";a[a.plural=6]="plural";a[a.pound=7]="pound";a[a.tag=8]="tag";a[a.price=9]="price"})(V||(V={}));(function(a){a[a.number=0]="number";a[a.dateTime=1]="dateTime"})(Bb||(Bb={}));var If=/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,Tg=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g,pa=function(){return pa=Object.assign||function(a){for(var b,c=1,f=
arguments.length;c<f;c++)for(var D in b=arguments[c])Object.prototype.hasOwnProperty.call(b,D)&&(a[D]=b[D]);return a},pa.apply(this,arguments)},zh=/[\t-\r \x85\u200E\u200F\u2028\u2029]/i,Ie=/^\.(?:(0+)(\*)?|(#+)|(0+)(#+))$/g,Ge=/^(@+)?(\+|#+)?[rs]?$/g,Wg=/(\*)(0+)|(#+)(0+)|(0+)/g,He=/^(0+)$/,lc={AX:["H"],BQ:["H"],CP:["H"],CZ:["H"],DK:["H"],FI:["H"],ID:["H"],IS:["H"],ML:["H"],NE:["H"],RU:["H"],SE:["H"],SJ:["H"],SK:["H"],AS:["h","H"],BT:["h","H"],DJ:["h","H"],ER:["h","H"],GH:["h","H"],IN:["h","H"],
LS:["h","H"],PG:["h","H"],PW:["h","H"],SO:["h","H"],TO:["h","H"],VU:["h","H"],WS:["h","H"],"001":["H","h"],AL:["h","H","hB"],TD:["h","H","hB"],"ca-ES":["H","h","hB"],CF:["H","h","hB"],CM:["H","h","hB"],"fr-CA":["H","h","hB"],"gl-ES":["H","h","hB"],"it-CH":["H","h","hB"],"it-IT":["H","h","hB"],LU:["H","h","hB"],NP:["H","h","hB"],PF:["H","h","hB"],SC:["H","h","hB"],SM:["H","h","hB"],SN:["H","h","hB"],TF:["H","h","hB"],VA:["H","h","hB"],CY:["h","H","hb","hB"],GR:["h","H","hb","hB"],CO:["h","H","hB",
"hb"],DO:["h","H","hB","hb"],KP:["h","H","hB","hb"],KR:["h","H","hB","hb"],NA:["h","H","hB","hb"],PA:["h","H","hB","hb"],PR:["h","H","hB","hb"],VE:["h","H","hB","hb"],AC:["H","h","hb","hB"],AI:["H","h","hb","hB"],BW:["H","h","hb","hB"],BZ:["H","h","hb","hB"],CC:["H","h","hb","hB"],CK:["H","h","hb","hB"],CX:["H","h","hb","hB"],DG:["H","h","hb","hB"],FK:["H","h","hb","hB"],GB:["H","h","hb","hB"],GG:["H","h","hb","hB"],GI:["H","h","hb","hB"],IE:["H","h","hb","hB"],IM:["H","h","hb","hB"],IO:["H","h",
"hb","hB"],JE:["H","h","hb","hB"],LT:["H","h","hb","hB"],MK:["H","h","hb","hB"],MN:["H","h","hb","hB"],MS:["H","h","hb","hB"],NF:["H","h","hb","hB"],NG:["H","h","hb","hB"],NR:["H","h","hb","hB"],NU:["H","h","hb","hB"],PN:["H","h","hb","hB"],SH:["H","h","hb","hB"],SX:["H","h","hb","hB"],TA:["H","h","hb","hB"],ZA:["H","h","hb","hB"],"af-ZA":["H","h","hB","hb"],AR:["H","h","hB","hb"],CL:["H","h","hB","hb"],CR:["H","h","hB","hb"],CU:["H","h","hB","hb"],EA:["H","h","hB","hb"],"es-BO":["H","h","hB","hb"],
"es-BR":["H","h","hB","hb"],"es-EC":["H","h","hB","hb"],"es-ES":["H","h","hB","hb"],"es-GQ":["H","h","hB","hb"],"es-PE":["H","h","hB","hb"],GT:["H","h","hB","hb"],HN:["H","h","hB","hb"],IC:["H","h","hB","hb"],KG:["H","h","hB","hb"],KM:["H","h","hB","hb"],LK:["H","h","hB","hb"],MA:["H","h","hB","hb"],MX:["H","h","hB","hb"],NI:["H","h","hB","hb"],PY:["H","h","hB","hb"],SV:["H","h","hB","hb"],UY:["H","h","hB","hb"],JP:["H","h","K"],AD:["H","hB"],AM:["H","hB"],AO:["H","hB"],AT:["H","hB"],AW:["H","hB"],
BE:["H","hB"],BF:["H","hB"],BJ:["H","hB"],BL:["H","hB"],BR:["H","hB"],CG:["H","hB"],CI:["H","hB"],CV:["H","hB"],DE:["H","hB"],EE:["H","hB"],FR:["H","hB"],GA:["H","hB"],GF:["H","hB"],GN:["H","hB"],GP:["H","hB"],GW:["H","hB"],HR:["H","hB"],IL:["H","hB"],IT:["H","hB"],KZ:["H","hB"],MC:["H","hB"],MD:["H","hB"],MF:["H","hB"],MQ:["H","hB"],MZ:["H","hB"],NC:["H","hB"],NL:["H","hB"],PM:["H","hB"],PT:["H","hB"],RE:["H","hB"],RO:["H","hB"],SI:["H","hB"],SR:["H","hB"],ST:["H","hB"],TG:["H","hB"],TR:["H","hB"],
WF:["H","hB"],YT:["H","hB"],BD:["h","hB","H"],PK:["h","hB","H"],AZ:["H","hB","h"],BA:["H","hB","h"],BG:["H","hB","h"],CH:["H","hB","h"],GE:["H","hB","h"],LI:["H","hB","h"],ME:["H","hB","h"],RS:["H","hB","h"],UA:["H","hB","h"],UZ:["H","hB","h"],XK:["H","hB","h"],AG:["h","hb","H","hB"],AU:["h","hb","H","hB"],BB:["h","hb","H","hB"],BM:["h","hb","H","hB"],BS:["h","hb","H","hB"],CA:["h","hb","H","hB"],DM:["h","hb","H","hB"],"en-001":["h","hb","H","hB"],FJ:["h","hb","H","hB"],FM:["h","hb","H","hB"],GD:["h",
"hb","H","hB"],GM:["h","hb","H","hB"],GU:["h","hb","H","hB"],GY:["h","hb","H","hB"],JM:["h","hb","H","hB"],KI:["h","hb","H","hB"],KN:["h","hb","H","hB"],KY:["h","hb","H","hB"],LC:["h","hb","H","hB"],LR:["h","hb","H","hB"],MH:["h","hb","H","hB"],MP:["h","hb","H","hB"],MW:["h","hb","H","hB"],NZ:["h","hb","H","hB"],SB:["h","hb","H","hB"],SG:["h","hb","H","hB"],SL:["h","hb","H","hB"],SS:["h","hb","H","hB"],SZ:["h","hb","H","hB"],TC:["h","hb","H","hB"],TT:["h","hb","H","hB"],UM:["h","hb","H","hB"],US:["h",
"hb","H","hB"],VC:["h","hb","H","hB"],VG:["h","hb","H","hB"],VI:["h","hb","H","hB"],ZM:["h","hb","H","hB"],BO:["H","hB","h","hb"],EC:["H","hB","h","hb"],ES:["H","hB","h","hb"],GQ:["H","hB","h","hb"],PE:["H","hB","h","hb"],AE:["h","hB","hb","H"],"ar-001":["h","hB","hb","H"],BH:["h","hB","hb","H"],DZ:["h","hB","hb","H"],EG:["h","hB","hb","H"],EH:["h","hB","hb","H"],HK:["h","hB","hb","H"],IQ:["h","hB","hb","H"],JO:["h","hB","hb","H"],KW:["h","hB","hb","H"],LB:["h","hB","hb","H"],LY:["h","hB","hb","H"],
MO:["h","hB","hb","H"],MR:["h","hB","hb","H"],OM:["h","hB","hb","H"],PH:["h","hB","hb","H"],PS:["h","hB","hb","H"],QA:["h","hB","hb","H"],SA:["h","hB","hb","H"],SD:["h","hB","hb","H"],SY:["h","hB","hb","H"],TN:["h","hB","hb","H"],YE:["h","hB","hb","H"],AF:["H","hb","hB","h"],LA:["H","hb","hB","h"],CN:["H","hB","hb","h"],LV:["H","hB","hb","h"],TL:["H","hB","hb","h"],"zu-ZA":["H","hB","hb","h"],CD:["hB","H"],IR:["hB","H"],"hi-IN":["hB","h","H"],"kn-IN":["hB","h","H"],"ml-IN":["hB","h","H"],"te-IN":["hB",
"h","H"],KH:["hB","h","H","hb"],"ta-IN":["hB","h","hb","H"],BN:["hb","hB","h","H"],MY:["hb","hB","h","H"],ET:["hB","hb","h","H"],"gu-IN":["hB","hb","h","H"],"mr-IN":["hB","hb","h","H"],"pa-IN":["hB","hb","h","H"],TW:["hB","hb","h","H"],KE:["hB","hb","H","h"],MM:["hB","hb","H","h"],TZ:["hB","hb","H","h"],UG:["hB","hb","H","h"]},Ah=new RegExp("^".concat(If.source,"*")),Bh=new RegExp("".concat(If.source,"*$")),Ch=!!String.prototype.startsWith,Dh=!!String.fromCodePoint,Eh=!!Object.fromEntries,Fh=!!String.prototype.codePointAt,
Gh=!!String.prototype.trimStart,Hh=!!String.prototype.trimEnd,Ih=Number.isSafeInteger?Number.isSafeInteger:function(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a&&9007199254740991>=Math.abs(a)},Rd=!0;try{var Jf=RegExp("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu").exec("a");Rd="a"===(Jf&&Jf[0])}catch(I){Rd=!1}var Kf=Ch?function(a,b,c){return a.startsWith(b,c)}:function(a,b,c){return a.slice(c,c+b.length)===b},Sd=Dh?String.fromCodePoint:function(){for(var a,b="",c=arguments.length,
f=0;c>f;){var D;if(1114111<(a=0>(D=f++)||arguments.length<=D?void 0:arguments[D]))throw RangeError(a+" is not a valid code point");b+=65536>a?String.fromCharCode(a):String.fromCharCode(55296+((a-=65536)>>10),a%1024+56320)}return b},Lf=Eh?Object.fromEntries:function(a){var b,c={};a=W(a);try{for(a.s();!(b=a.n()).done;){var f=Xa(b.value,2);c[f[0]]=f[1]}}catch(D){a.e(D)}finally{a.f()}return c},Mf=Fh?function(a,b){return a.codePointAt(b)}:function(a,b){var h=a.length;if(!(0>b||b>=h)){var f,c=a.charCodeAt(b);
return 55296>c||56319<c||b+1===h||56320>(f=a.charCodeAt(b+1))||57343<f?c:f-56320+(c-55296<<10)+65536}},Jh=Gh?function(a){return a.trimStart()}:function(a){return a.replace(Ah,"")},Kh=Hh?function(a){return a.trimEnd()}:function(a){return a.replace(Bh,"")};if(Rd){var Nf=RegExp("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");var Of=function(a,b){Nf.lastIndex=b;return(a=Nf.exec(a))&&void 0!==a[1]&&null!==a[1]?a[1]:""}}else Of=function(a,b){for(var h=[];;){var f=Mf(a,b);if(void 0===f||Je(f)||33<=f&&
35>=f||36===f||37<=f&&39>=f||40===f||41===f||42===f||43===f||44===f||45===f||46<=f&&47>=f||58<=f&&59>=f||60<=f&&62>=f||63<=f&&64>=f||91===f||92===f||93===f||94===f||96===f||123===f||124===f||125===f||126===f||161===f||162<=f&&165>=f||166===f||167===f||169===f||171===f||172===f||174===f||176===f||177===f||182===f||187===f||191===f||215===f||247===f||8208<=f&&8213>=f||8214<=f&&8215>=f||8216===f||8217===f||8218===f||8219<=f&&8220>=f||8221===f||8222===f||8223===f||8224<=f&&8231>=f||8240<=f&&8248>=f||
8249===f||8250===f||8251<=f&&8254>=f||8257<=f&&8259>=f||8260===f||8261===f||8262===f||8263<=f&&8273>=f||8274===f||8275===f||8277<=f&&8286>=f||8592<=f&&8596>=f||8597<=f&&8601>=f||8602<=f&&8603>=f||8604<=f&&8607>=f||8608===f||8609<=f&&8610>=f||8611===f||8612<=f&&8613>=f||8614===f||8615<=f&&8621>=f||8622===f||8623<=f&&8653>=f||8654<=f&&8655>=f||8656<=f&&8657>=f||8658===f||8659===f||8660===f||8661<=f&&8691>=f||8692<=f&&8959>=f||8960<=f&&8967>=f||8968===f||8969===f||8970===f||8971===f||8972<=f&&8991>=
f||8992<=f&&8993>=f||8994<=f&&9E3>=f||9001===f||9002===f||9003<=f&&9083>=f||9084===f||9085<=f&&9114>=f||9115<=f&&9139>=f||9140<=f&&9179>=f||9180<=f&&9185>=f||9186<=f&&9254>=f||9255<=f&&9279>=f||9280<=f&&9290>=f||9291<=f&&9311>=f||9472<=f&&9654>=f||9655===f||9656<=f&&9664>=f||9665===f||9666<=f&&9719>=f||9720<=f&&9727>=f||9728<=f&&9838>=f||9839===f||9840<=f&&10087>=f||10088===f||10089===f||10090===f||10091===f||10092===f||10093===f||10094===f||10095===f||10096===f||10097===f||10098===f||10099===f||
10100===f||10101===f||10132<=f&&10175>=f||10176<=f&&10180>=f||10181===f||10182===f||10183<=f&&10213>=f||10214===f||10215===f||10216===f||10217===f||10218===f||10219===f||10220===f||10221===f||10222===f||10223===f||10224<=f&&10239>=f||10240<=f&&10495>=f||10496<=f&&10626>=f||10627===f||10628===f||10629===f||10630===f||10631===f||10632===f||10633===f||10634===f||10635===f||10636===f||10637===f||10638===f||10639===f||10640===f||10641===f||10642===f||10643===f||10644===f||10645===f||10646===f||10647===
f||10648===f||10649<=f&&10711>=f||10712===f||10713===f||10714===f||10715===f||10716<=f&&10747>=f||10748===f||10749===f||10750<=f&&11007>=f||11008<=f&&11055>=f||11056<=f&&11076>=f||11077<=f&&11078>=f||11079<=f&&11084>=f||11085<=f&&11123>=f||11124<=f&&11125>=f||11126<=f&&11157>=f||11158===f||11159<=f&&11263>=f||11776<=f&&11777>=f||11778===f||11779===f||11780===f||11781===f||11782<=f&&11784>=f||11785===f||11786===f||11787===f||11788===f||11789===f||11790<=f&&11798>=f||11799===f||11800<=f&&11801>=f||
11802===f||11803===f||11804===f||11805===f||11806<=f&&11807>=f||11808===f||11809===f||11810===f||11811===f||11812===f||11813===f||11814===f||11815===f||11816===f||11817===f||11818<=f&&11822>=f||11823===f||11824<=f&&11833>=f||11834<=f&&11835>=f||11836<=f&&11839>=f||11840===f||11841===f||11842===f||11843<=f&&11855>=f||11856<=f&&11857>=f||11858===f||11859<=f&&11903>=f||12289<=f&&12291>=f||12296===f||12297===f||12298===f||12299===f||12300===f||12301===f||12302===f||12303===f||12304===f||12305===f||12306<=
f&&12307>=f||12308===f||12309===f||12310===f||12311===f||12312===f||12313===f||12314===f||12315===f||12316===f||12317===f||12318<=f&&12319>=f||12320===f||12336===f||64830===f||64831===f||65093<=f&&65094>=f)break;h.push(f);b+=65536<=f?2:1}return Sd.apply(void 0,h)};var Lh=function(){return B(function x(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};A(this,x);this.message=a;this.position={offset:0,line:1,column:1};this.ignoreTag=!!b.ignoreTag;this.locale=b.locale;this.requiresOtherClause=
!!b.requiresOtherClause;this.shouldParseSkeletons=!!b.shouldParseSkeletons},[{key:"parse",value:function(){if(0!==this.offset())throw Error("parser can only be used once");return this.parseMessage(0,"",!1)}},{key:"parseMessage",value:function(a,b,f){for(var h=[];!this.isEOF();){var c=this.char();if(123===c){c=this.parseArgument(a,f);if(c.err)return c;h.push(c.val)}else{if(125===c&&0<a)break;if(35!==c||"plural"!==b&&"selectordinal"!==b){if(60===c&&!this.ignoreTag&&47===this.peek()){if(f)break;return this.error(T.UNMATCHED_CLOSING_TAG,
X(this.clonePosition(),this.clonePosition()))}if(60===c&&!this.ignoreTag&&Dd(this.peek()||0)){c=this.parseTag(a,b);if(c.err)return c;h.push(c.val)}else{c=this.parseLiteral(a,b);if(c.err)return c;h.push(c.val)}}else c=this.clonePosition(),this.bump(),h.push({type:V.pound,location:X(c,this.clonePosition())})}}return{val:h,err:null}}},{key:"parseTag",value:function(a,b){var h=this.clonePosition();this.bump();var c=this.parseTagName();if(this.bumpSpace(),this.bumpIf("/\x3e"))return{val:{type:V.literal,
value:"\x3c".concat(c,"/\x3e"),location:X(h,this.clonePosition())},err:null};if(this.bumpIf("\x3e")){a=this.parseMessage(a+1,b,!0);if(a.err)return a;a=a.val;b=this.clonePosition();if(this.bumpIf("\x3c/")){if(this.isEOF()||!Dd(this.char()))return this.error(T.INVALID_TAG,X(b,this.clonePosition()));var x=this.clonePosition();return c!==this.parseTagName()?this.error(T.UNMATCHED_CLOSING_TAG,X(x,this.clonePosition())):(this.bumpSpace(),this.bumpIf("\x3e")?{val:{type:V.tag,value:c,children:a,location:X(h,
this.clonePosition())},err:null}:this.error(T.INVALID_TAG,X(b,this.clonePosition())))}return this.error(T.UNCLOSED_TAG,X(h,this.clonePosition()))}return this.error(T.INVALID_TAG,X(h,this.clonePosition()))}},{key:"parseTagName",value:function(){var a,b=this.offset();for(this.bump();!this.isEOF()&&(45===(a=this.char())||46===a||48<=a&&57>=a||95===a||97<=a&&122>=a||65<=a&&90>=a||183==a||192<=a&&214>=a||216<=a&&246>=a||248<=a&&893>=a||895<=a&&8191>=a||8204<=a&&8205>=a||8255<=a&&8256>=a||8304<=a&&8591>=
a||11264<=a&&12271>=a||12289<=a&&55295>=a||63744<=a&&64975>=a||65008<=a&&65533>=a||65536<=a&&983039>=a);)this.bump();return this.message.slice(b,this.offset())}},{key:"parseLiteral",value:function(a,b){for(var h=this.clonePosition(),c="";;){var x=this.tryParseQuote(b);if(x)c+=x;else if(x=this.tryParseUnquoted(a,b))c+=x;else{x=this.tryParseLeftAngleBracket();if(!x)break;c+=x}}a=X(h,this.clonePosition());return{val:{type:V.literal,value:c,location:a},err:null}}},{key:"tryParseLeftAngleBracket",value:function(){return this.isEOF()||
60!==this.char()||!this.ignoreTag&&(Dd(a=this.peek()||0)||47===a)?null:(this.bump(),"\x3c");var a}},{key:"tryParseQuote",value:function(a){if(this.isEOF()||39!==this.char())return null;switch(this.peek()){case 39:return this.bump(),this.bump(),"'";case 123:case 60:case 62:case 125:break;case 35:if("plural"===a||"selectordinal"===a)break;return null;default:return null}this.bump();a=[this.char()];for(this.bump();!this.isEOF();){var b=this.char();if(39===b){if(39!==this.peek()){this.bump();break}a.push(39);
this.bump()}else a.push(b);this.bump()}return Sd.apply(void 0,a)}},{key:"tryParseUnquoted",value:function(a,b){if(this.isEOF())return null;var h=this.char();return 60===h||123===h||35===h&&("plural"===b||"selectordinal"===b)||125===h&&0<a?null:(this.bump(),Sd(h))}},{key:"parseArgument",value:function(a,b){var h=this.clonePosition();if(this.bump(),this.bumpSpace(),this.isEOF())return this.error(T.EXPECT_ARGUMENT_CLOSING_BRACE,X(h,this.clonePosition()));if(125===this.char())return this.bump(),this.error(T.EMPTY_ARGUMENT,
X(h,this.clonePosition()));var c=this.parseIdentifierIfPossible().value;if(!c)return this.error(T.MALFORMED_ARGUMENT,X(h,this.clonePosition()));if(this.bumpSpace(),this.isEOF())return this.error(T.EXPECT_ARGUMENT_CLOSING_BRACE,X(h,this.clonePosition()));switch(this.char()){case 125:return this.bump(),{val:{type:V.argument,value:c,location:X(h,this.clonePosition())},err:null};case 44:return this.bump(),this.bumpSpace(),this.isEOF()?this.error(T.EXPECT_ARGUMENT_CLOSING_BRACE,X(h,this.clonePosition())):
this.parseArgumentOptions(a,b,c,h);default:return this.error(T.MALFORMED_ARGUMENT,X(h,this.clonePosition()))}}},{key:"parseIdentifierIfPossible",value:function(){var a=this.clonePosition(),b=this.offset(),f=Of(this.message,b);return this.bumpTo(b+f.length),{value:f,location:X(a,this.clonePosition())}}},{key:"parseArgumentOptions",value:function(a,b,f,c){var h=this.clonePosition(),x=this.parseIdentifierIfPossible().value,E=this.clonePosition();switch(x){case "":return this.error(T.EXPECT_ARGUMENT_TYPE,
X(h,E));case "number":case "price":case "date":case "time":this.bumpSpace();a=null;if(this.bumpIf(",")){this.bumpSpace();a=this.clonePosition();b=this.parseSimpleArgStyleIfPossible();if(b.err)return b;b=Kh(b.val);if(0===b.length)return this.error(T.EXPECT_ARGUMENT_STYLE,X(this.clonePosition(),this.clonePosition()));a={style:b,styleLocation:X(a,this.clonePosition())}}b=this.tryParseArgumentClose(c);if(b.err)return b;c=X(c,this.clonePosition());if(a&&a.style&&Kf(a.style,"::",0)){b=Jh(a.style.slice(2));
if("number"===x)return x=this.parseNumberSkeletonFromString(b,a.styleLocation),x.err?x:{val:{type:V.number,value:f,location:c,style:x.val},err:null};if(0===b.length)return this.error(T.EXPECT_DATE_TIME_SKELETON,c);h=b;if(this.locale){h=this.locale;E="";for(var d=0;d<b.length;d++){var l=b.charAt(d);if("j"===l){for(var q=0;d+1<b.length&&b.charAt(d+1)===l;)q++,d++;l=1+(1&q);q=2>q?1:3+(q>>1);var g=Xg(h);for("H"!=g&&"k"!=g||(q=0);0<q--;)E+="a";for(;0<l--;)E=g+E}else E+="J"===l?"H":l}h=E}a={type:Bb.dateTime,
pattern:h,location:a.styleLocation,parsedOptions:this.shouldParseSkeletons?Sg(h):{}};return{val:{type:"date"===x?V.date:V.time,value:f,location:c,style:a},err:null}}return{val:{type:"number"===x?V.number:"price"===x?V.price:"date"===x?V.date:V.time,value:f,location:c,style:a&&void 0!==a.style&&null!==a.style?a.style:null},err:null};case "plural":case "selectordinal":case "select":h=this.clonePosition();if(this.bumpSpace(),!this.bumpIf(","))return this.error(T.EXPECT_SELECT_ARGUMENT_OPTIONS,X(h,Object.assign({},
h)));this.bumpSpace();E=this.parseIdentifierIfPossible();h=0;if("select"!==x&&"offset"===E.value){if(!this.bumpIf(":"))return this.error(T.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,X(this.clonePosition(),this.clonePosition()));this.bumpSpace();h=this.tryParseDecimalInteger(T.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,T.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE);if(h.err)return h;this.bumpSpace();E=this.parseIdentifierIfPossible();h=h.val}a=this.tryParsePluralOrSelectOptions(a,x,b,E);if(a.err)return a;b=this.tryParseArgumentClose(c);
if(b.err)return b;c=X(c,this.clonePosition());return"select"===x?{val:{type:V.select,value:f,options:Lf(a.val),location:c},err:null}:{val:{type:V.plural,value:f,options:Lf(a.val),offset:h,pluralType:"plural"===x?"cardinal":"ordinal",location:c},err:null};default:return this.error(T.INVALID_ARGUMENT_TYPE,X(h,E))}}},{key:"tryParseArgumentClose",value:function(a){return this.isEOF()||125!==this.char()?this.error(T.EXPECT_ARGUMENT_CLOSING_BRACE,X(a,this.clonePosition())):(this.bump(),{val:!0,err:null})}},
{key:"parseSimpleArgStyleIfPossible",value:function(){for(var a=0,b=this.clonePosition();!this.isEOF();)switch(this.char()){case 39:this.bump();var f=this.clonePosition();if(!this.bumpUntil("'"))return this.error(T.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE,X(f,this.clonePosition()));this.bump();break;case 123:a+=1;this.bump();break;case 125:if(!(0<a))return{val:this.message.slice(b.offset,this.offset()),err:null};--a;break;default:this.bump()}return{val:this.message.slice(b.offset,this.offset()),err:null}}},
{key:"parseNumberSkeletonFromString",value:function(a,b){var h=[];try{h=function(a){if(0===a.length)throw Error("Number skeleton cannot be empty");var b=[],h=0;for(a=a.split(zh).filter(function(a){return 0<a.length});h<a.length;h++){var f=a[h].split("/");if(0===f.length)throw Error("Invalid number skeleton");var d=f[0];f=f.slice(1);for(var l=0,q=f;l<q.length;l++)if(0===q[l].length)throw Error("Invalid number skeleton");b.push({stem:d,options:f})}return b}(a)}catch(D){return this.error(T.INVALID_NUMBER_SKELETON,
b)}return{val:{type:Bb.number,tokens:h,location:b,parsedOptions:this.shouldParseSkeletons?Vg(h):{}},err:null}}},{key:"tryParsePluralOrSelectOptions",value:function(a,b,f,c){var h=!1,x=[],E=new Set,d=c.value;for(c=c.location;;){if(0===d.length){d=this.clonePosition();if("select"===b||!this.bumpIf("\x3d"))break;c=this.tryParseDecimalInteger(T.EXPECT_PLURAL_ARGUMENT_SELECTOR,T.INVALID_PLURAL_ARGUMENT_SELECTOR);if(c.err)return c;c=X(d,this.clonePosition());d=this.message.slice(d.offset,this.offset())}if(E.has(d))return this.error("select"===
b?T.DUPLICATE_SELECT_ARGUMENT_SELECTOR:T.DUPLICATE_PLURAL_ARGUMENT_SELECTOR,c);"other"===d&&(h=!0);this.bumpSpace();c=this.clonePosition();if(!this.bumpIf("{"))return this.error("select"===b?T.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT:T.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT,X(this.clonePosition(),this.clonePosition()));var l=this.parseMessage(a+1,b,f);if(l.err)return l;var q=this.tryParseArgumentClose(c);if(q.err)return q;x.push([d,{value:l.val,location:X(c,this.clonePosition())}]);E.add(d);this.bumpSpace();
c=this.parseIdentifierIfPossible();d=c.value;c=c.location}return 0===x.length?this.error("select"===b?T.EXPECT_SELECT_ARGUMENT_SELECTOR:T.EXPECT_PLURAL_ARGUMENT_SELECTOR,X(this.clonePosition(),this.clonePosition())):this.requiresOtherClause&&!h?this.error(T.MISSING_OTHER_CLAUSE,X(this.clonePosition(),this.clonePosition())):{val:x,err:null}}},{key:"tryParseDecimalInteger",value:function(a,b){var h=1,c=this.clonePosition();this.bumpIf("+")||this.bumpIf("-")&&(h=-1);for(var x=!1,w=0;!this.isEOF();){var E=
this.char();if(!(48<=E&&57>=E))break;x=!0;w=10*w+(E-48);this.bump()}c=X(c,this.clonePosition());return x?Ih(w*=h)?{val:w,err:null}:this.error(b,c):this.error(a,c)}},{key:"offset",value:function(){return this.position.offset}},{key:"isEOF",value:function(){return this.offset()===this.message.length}},{key:"clonePosition",value:function(){return{offset:this.position.offset,line:this.position.line,column:this.position.column}}},{key:"char",value:function(){var a=this.position.offset;if(a>=this.message.length)throw Error("out of bound");
var b=Mf(this.message,a);if(void 0===b)throw Error("Offset ".concat(a," is at invalid UTF-16 code unit boundary"));return b}},{key:"error",value:function(a,b){return{val:null,err:{kind:a,message:this.message,location:b}}}},{key:"bump",value:function(){if(!this.isEOF()){var a=this.char();10===a?(this.position.line+=1,this.position.column=1,this.position.offset+=1):(this.position.column+=1,this.position.offset+=65536>a?1:2)}}},{key:"bumpIf",value:function(a){if(Kf(this.message,a,this.offset())){for(var b=
0;b<a.length;b++)this.bump();return!0}return!1}},{key:"bumpUntil",value:function(a){var b=this.offset();a=this.message.indexOf(a,b);return 0<=a?(this.bumpTo(a),!0):(this.bumpTo(this.message.length),!1)}},{key:"bumpTo",value:function(a){if(this.offset()>a)throw Error("targetOffset ".concat(a," must be greater than or equal to the current offset ").concat(this.offset()));for(a=Math.min(a,this.message.length);;){var b=this.offset();if(b===a)break;if(b>a)throw Error("targetOffset ".concat(a," is at invalid UTF-16 code unit boundary"));
if(this.bump(),this.isEOF())break}}},{key:"bumpSpace",value:function(){for(;!this.isEOF()&&Je(this.char());)this.bump()}},{key:"peek",value:function(){if(this.isEOF())return null;var a=this.char(),b=this.offset();a=this.message.charCodeAt(b+(65536<=a?2:1));return null!=a?a:null}}])}(),$g=function(){return JSON.stringify(arguments)};Fd.prototype.get=function(a){return this.cache[a]};Fd.prototype.set=function(a,b){this.cache[a]=b};var Cb,Zg={create:function(){return new Fd}},wc=function(a,b){var h=
b.cache.create();return Ke.bind(this,a,h,b.serializer)};!function(a){a.MISSING_VALUE="MISSING_VALUE";a.INVALID_VALUE="INVALID_VALUE";a.MISSING_INTL_API="MISSING_INTL_API"}(Cb||(Cb={}));var oc=function(a){function b(a,h,c){var f;return A(this,b),(f=ca(this,b,[a])).code=h,f.originalMessage=c,f}return ea(b,a),B(b,[{key:"toString",value:function(){return"[formatjs Error: ".concat(this.code,"] ").concat(this.message)}}])}(Ja(Error)),Me=function(a){function b(a,h,c,k){return A(this,b),ca(this,b,['Invalid values for "'.concat(a,
'": "').concat(h,'". Options are "').concat(Object.keys(c).join('", "'),'"'),Cb.INVALID_VALUE,k])}return ea(b,a),B(b)}(oc),bh=function(a){function b(a,h,c){return A(this,b),ca(this,b,['Value for "'.concat(a,'" must be of type ').concat(h),Cb.INVALID_VALUE,c])}return ea(b,a),B(b)}(oc),Le=function(a){function b(a,h){return A(this,b),ca(this,b,['The intl string context variable "'.concat(a,'" was not provided to the string "').concat(h,'"'),Cb.MISSING_VALUE,h])}return ea(b,a),B(b)}(oc),va,Mh=new Map([["no",
"nb"],["iw","he"],["in","id"],["ji","yi"]]),nc=function(){function a(){A(this,a)}return B(a,null,[{key:"getCanonicalLocaleString",value:function(b){return Array.isArray(b)?b.map(function(b){return a.getCanonicalLocale(a.forLocaleStringInternal(b)).toLocaleString()}):a.getCanonicalLocale(a.forLocaleStringInternal(b)).toLocaleString()}},{key:"getCanonicalLocale",value:function(b){return null==b&&(b=new Intl.Locale((new Intl.NumberFormat).resolvedOptions().locale)),(b=a.processLocale(b)).numberingSystem?
b:new Intl.Locale(b,{numberingSystem:"latn"})}},{key:"processLocale",value:function(a){if(a.toLocaleString().startsWith("und"))return a;var b=Intl.NumberFormat.supportedLocalesOf(a.toLocaleString());return 0===b.length?(b=Mh.get(a.language))?new Intl.Locale(a.baseName.replace(a.language,b)):(console.log("Unsupported locale: ".concat(a.toLocaleString())),new Intl.Locale("und")):new Intl.Locale(b[0])}},{key:"forLocaleStringInternal",value:function(a){return a?new Intl.Locale(a.trim().replace(/_/g,"-")):
void 0}}])}(),Nh=Object.freeze({__proto__:null,LocaleUtil:nc});!function(a){a[a.literal=0]="literal";a[a.object=1]="object"}(va||(va={}));var Td=function(){return B(function h(){A(this,h)},[{key:"getObfuscatedMarketplaceId",value:function(){}},{key:"getDefaultLocale",value:function(){return Intl.DateTimeFormat().resolvedOptions().locale}},{key:"getDefaultCurrency",value:function(){}}])}(),Oh=function(a){function b(){return A(this,b),ca(this,b,arguments)}return ea(b,a),B(b)}(Td),Pf=function(){function a(){A(this,
a)}return B(a,[{key:"getMarketplace",value:function(){return a.emptyMarketplace}}])}();Pf.emptyMarketplace=new Oh;var Qf=function(){function a(){A(this,a)}return B(a,null,[{key:"setProvider",value:function(b){a.marketplaceProvider=b}},{key:"provider",value:function(){return a.marketplaceProvider||(a.marketplaceProvider=new Pf),a.marketplaceProvider}}])}();Qf.marketplaceProvider=void 0;var Ud={A2Q3Y263D00KWC:{name:"BR",locale:"pt-BR",currency:"BRL"},AZXD3QD5B39HD:{name:"BR_DEVO",locale:"pt-BR",currency:"BRL"},
A2EUQ1WTGCTBG2:{name:"CA",locale:"en-CA",currency:"CAD"},A2WDZJZ5TCRMLH:{name:"CL",locale:"es-CL",currency:"CLP"},A2IDBVIE7EAGN4:{name:"CL_DEVO",locale:"es-CL",currency:"CLP"},A1ZXRLSQW2V54D:{name:"CO",locale:"es-CO",currency:"COP"},A1NOHO22DE3OHQ:{name:"CO_DEVO",locale:"es-CO",currency:"COP"},A1AM78C64UM0Y8:{name:"MX",locale:"es-MX",currency:"MXN"},A3P3J5A7D2ZVXI:{name:"MX_DEVO",locale:"es-MX",currency:"MXN"},ATVPDKIKX0DER:{name:"US",locale:"en-US",currency:"USD"},AGWSWK15IEJJ7:{name:"PYOP_US_PROD",
locale:"en-US",currency:"USD"},A3BXB0YN3XH17H:{name:"PYOP_US_PROD_SANDBOX",locale:"en-US",currency:"USD"},A35A4JO734ER04:{name:"PYOP_US_DEVO",locale:"en-US",currency:"USD"},A341L3VCFKNMIY:{name:"PYOP_US_DEVO_SANDBOX",locale:"en-US",currency:"USD"},A2CE4MDCUAASDP:{name:"PYOP_CA_PROD",locale:"en-CA",currency:"CAD"},A2VJI655WT2I0B:{name:"PYOP_CA_PROD_SANDBOX",locale:"en-CA",currency:"CAD"},A1NWP2E4EKQP94:{name:"PYOP_CA_DEVO",locale:"en-CA",currency:"CAD"},ASBG27DKM7EX6:{name:"PYOP_CA_DEVO_SANDBOX",locale:"en-CA",
currency:"CAD"},A2VIGQ35RCS4UG:{name:"AE",locale:"en-AE",currency:"AED"},A34GYYCZVDBSIK:{name:"AE_DEVO",locale:"en-AE",currency:"AED"},A1PA6795UKMFR9:{name:"DE",locale:"de-DE",currency:"EUR"},AMEN7PMS3EDWL:{name:"BE",locale:"fr-FR",currency:"EUR"},A1YFOMBPFBRY22:{name:"BE_DEVO",locale:"fr-FR",currency:"EUR"},ARBP9OOSHTCHU:{name:"EG",locale:"en-AE",currency:"EGP"},AUJPM9XGFJRC7:{name:"EG_DEVO",locale:"en-AE",currency:"EGP"},A1RKKUPIHCS9HS:{name:"ES",locale:"es-ES",currency:"EUR"},AJZF8LZ1EJVJN:{name:"ES_DEVO",
locale:"es-ES",currency:"EUR"},A13V1IB3VIYZZH:{name:"FR",locale:"fr-FR",currency:"EUR"},A1F83G8C2ARO7P:{name:"GB",locale:"en-GB",currency:"GBP"},APJ6JRA9NG5V4:{name:"IT",locale:"it-IT",currency:"EUR"},A3HOBANJMCMD83:{name:"IT_DEVO",locale:"it-IT",currency:"EUR"},A28R8C7NBKEWEA:{name:"IE",locale:"en-IE",currency:"EUR"},AQGJ466SKA0F0:{name:"IE_DEVO",locale:"en-IE",currency:"EUR"},A21TJRUUN4KGV:{name:"IN",locale:"en-IN",currency:"INR"},A2XZLSVIQ0F4JT:{name:"IN_DEVO",locale:"en-IN",currency:"INR"},A3OCL2LJ6GDH9T:{name:"NG",
locale:"en-NG",currency:"NGN"},A3PJZM0QIA8QDU:{name:"NG_DEVO",locale:"en-NG",currency:"NGN"},A1805IZSGTT6HS:{name:"NL",locale:"nl-NL",currency:"EUR"},A1M3WC0SJ3A38T:{name:"NL_DEVO",locale:"nl-NL",currency:"EUR"},A1C3SOZRARQ6R3:{name:"PL",locale:"pl-PL",currency:"PLN"},AKY4K4WKH21YQ:{name:"PL_DEVO",locale:"pl-PL",currency:"PLN"},A17E79C6D8DWNP:{name:"SA",locale:"en-AE",currency:"SAR"},A1MQPSGJ6U9Q54:{name:"SA_DEVO",locale:"en-AE",currency:"SAR"},A2NODRKZP88ZB9:{name:"SE",locale:"sv-SE",currency:"SEK"},
AT614YYYNOC1S:{name:"SE_DEVO",locale:"sv-SE",currency:"SEK"},A33AVAJ2PDY3EV:{name:"TR",locale:"tr-TR",currency:"TRY"},A3CQBQD3RGPJR8:{name:"TR_DEVO",locale:"tr-TR",currency:"TRY"},AE08WJ6YKNBMC:{name:"ZA",locale:"en-ZA",currency:"ZAR"},A3TFQ1G9L8TQ5L:{name:"ZA_DEVO",locale:"en-ZA",currency:"ZAR"},AZAJMM36N6WQL:{name:"PYOP_UK_PROD",locale:"en-GB",currency:"GBP"},A3M3RRFO9XDT2G:{name:"PYOP_UK_PROD_SANDBOX",locale:"en-GB",currency:"GBP"},A2UWQKHEFGNQY3:{name:"PYOP_UK_DEVO",locale:"en-GB",currency:"GBP"},
A2V84NPDZD3ZEH:{name:"PYOP_UK_DEVO_SANDBOX",locale:"en-GB",currency:"GBP"},A53RDEWN57UU5:{name:"PYOP_DE_PROD",locale:"de-DE",currency:"EUR"},A1G8446IYHA4MR:{name:"PYOP_DE_PROD_SANDBOX",locale:"de-DE",currency:"EUR"},A34RX6LWLXD2KA:{name:"PYOP_DE_DEVO",locale:"de-DE",currency:"EUR"},A225AO9WA6YYOF:{name:"PYOP_DE_DEVO_SANDBOX",locale:"de-DE",currency:"EUR"},A3FDG49KKM823Y:{name:"PYOP_IN_PROD",locale:"en-IN",currency:"INR"},A1IAUC0NN979H6:{name:"PYOP_IN_PROD_SANDBOX",locale:"en-IN",currency:"INR"},A18VPDB9UTK24D:{name:"PYOP_IN_DEVO",
locale:"en-IN",currency:"INR"},A16Z2XWZJTFS70:{name:"PYOP_IN_DEVO_SANDBOX",locale:"en-IN",currency:"INR"},A39IBJ37TRP1C6:{name:"AU",locale:"en-AU",currency:"AUD"},A1RNPCQ4K8U27I:{name:"AU_DEVO",locale:"en-AU",currency:"AUD"},A1VC38T7YXB528:{name:"JP",locale:"ja-JP",currency:"JPY"},AD2EMQ3L3PG8S:{name:"RU",locale:"ru-RU",currency:"RUB"},A38NPJYVS5YHNH:{name:"RU_DEVO",locale:"ru-RU",currency:"RUB"},A19VAU5U5O7RUS:{name:"SG",locale:"en-SG",currency:"SGD"},A1DQ6JV7I20JSG:{name:"SG_DEVO",locale:"en-SG",
currency:"SGD"},A75P1MG8VMU51:{name:"PYOP_JP_PROD",locale:"ja-JP",currency:"JPY"},A31YDYE76E6TCP:{name:"PYOP_JP_PROD_SANDBOX",locale:"ja-JP",currency:"JPY"},A2EFPHRCZ60KI3:{name:"PYOP_JP_DEVO",locale:"ja-JP",currency:"JPY"},A1U1OSY46WLA42:{name:"PYOP_JP_DEVO_SANDBOX",locale:"ja-JP",currency:"JPY"},AAHKV2X7AFYLW:{name:"CN",locale:"zh-CN",currency:"CNY"}},Vd=function(a){function b(a,h,c){var f;(A(this,b),f=ca(this,b),a)?(f.obfuscatedMarketplaceId=a,a=Ud[a],f.defaultLocale=h||(a?a.locale:function(a,
b,d,h){var f=xd(tb(1&h?a.prototype:a),b,d);return 2&h&&"function"==typeof f?function(a){return f.apply(d,a)}:f}(b,"getDefaultLocale",f,3)([])),f.defaultCurrency=c||(a?a.currency:void 0)):(f.obfuscatedMarketplaceId=void 0,f.defaultLocale=void 0,f.defaultCurrency=void 0);return f}return ea(b,a),B(b,[{key:"getObfuscatedMarketplaceId",value:function(){return this.obfuscatedMarketplaceId}},{key:"getDefaultLocale",value:function(){return this.defaultLocale}},{key:"getDefaultCurrency",value:function(){return this.defaultCurrency}},
{key:"toString",value:function(){return"Marketplace[obfuscatedMarketplaceId\x3d".concat(this.getObfuscatedMarketplaceId(),",defaultLocale\x3d").concat(this.getDefaultLocale(),",defaultCurrency\x3d").concat(this.getDefaultCurrency(),"]")}}],[{key:"getObfuscatedMarketplaceIdMap",value:function(){for(var a=new Map,b=0,h=Object.keys(Ud);b<h.length;b++){var c=h[b];a.set(Ud[c].name,c)}return a}}])}(Td),u={},Da={};Object.defineProperty(Da,"__esModule",{value:!0});Da.ConfigType=void 0;var Ea=function(){return B(function f(a,
b){A(this,f);this._name=a;this._parent=b},[{key:"parent",get:function(){return this._parent}},{key:"toString",value:function(){return this._name}}])}();Da.ConfigType=Ea;Ea.MARKETPLACEID_TO_CX_TUPLE=new Ea("MARKETPLACEID_TO_CX_TUPLE");Ea.PRICE_FORMAT=new Ea("PRICE_FORMAT");Ea.RETAIL_PRICE_FORMAT=new Ea("RETAIL_PRICE_FORMAT",Ea.PRICE_FORMAT);Ea.POINTS_FORMAT=new Ea("POINTS_FORMAT");Ea.CX_TUPLE_TO_I18N_DOMAIN=new Ea("CX_TUPLE_TO_I18N_DOMAIN");Ea.CX_TUPLE_TO_DEFAULT_PREFERENCES=new Ea("CX_TUPLE_TO_DEFAULT_PREFERENCES");
var $a={};Object.defineProperty($a,"__esModule",{value:!0});$a.ConfigName=void 0;var Ph=function(){return B(function f(a,b){A(this,f);this._name=a;this._returnType=b},[{key:"getReturnType",value:function(){return this._returnType}},{key:"toString",value:function(){return this._name}}])}();$a.ConfigName=Ph;var ab={};Object.defineProperty(ab,"__esModule",{value:!0});ab.QueryOutput=void 0;var Qh=function(){return B(function f(a,b){A(this,f);this._name=a;this._returnType=b},[{key:"getReturnType",value:function(){return this._returnType}},
{key:"toString",value:function(){return this._name}}])}();ab.QueryOutput=Qh;var Xb={},Yb={},Va={};Object.defineProperty(Va,"__esModule",{value:!0});Va.isNullOrUndefined=void 0;Va.isNullOrUndefined=function(a){return null==a||null==a};Object.defineProperty(Yb,"__esModule",{value:!0});Yb.ConfigurationData=void 0;var Rh=function(){return B(function x(a){A(this,x);this._configs=Va.isNullOrUndefined(a)?new Map:a},[{key:"getStringValue",value:function(a){a=this._configs.get(a);return Va.isNullOrUndefined(a)?
null:String(a)}},{key:"getNumberValue",value:function(a){var b=this._configs.get(a);if(Va.isNullOrUndefined(b))return null;if(b=Number(b),Number.isNaN(b))throw Error("The value of ".concat(a," cannot be converted to a number"));return b}},{key:"getBooleanValue",value:function(a){a=this._configs.get(a);return Va.isNullOrUndefined(a)?null:"true"===String(a).toLowerCase()}},{key:"getEnumValue",value:function(a,b){var h=this._configs.get(b);if(Va.isNullOrUndefined(h))return null;b=Object.keys(a).filter(function(b){return a[b]==
h});return 0<b.length?a[b[0]]:null}},{key:"isPrimitiveData",value:function(){return 1>=this._configs.size}},{key:"getPrimitiveDataConfigName",value:function(){return 1==this._configs.size?this._configs.keys().next().value:null}},{key:"isEmpty",value:function(){if(0===this._configs.size)return!0;var a,b=W(this._configs.values());try{for(b.s();!(a=b.n()).done;)if(!Va.isNullOrUndefined(a.value))return!1}catch(f){b.e(f)}finally{b.f()}return!0}},{key:"merge",value:function(a){var b;a=W(a._configs.entries());
try{for(a.s();!(b=a.n()).done;){var h=b.value;this._configs.set(h[0],h[1])}}catch(D){a.e(D)}finally{a.f()}return this}},{key:"toString",value:function(){var a,b="{",f=0,c=W(this._configs.entries());try{for(c.s();!(a=c.n()).done;){var k=a.value;b+="".concat(k[0],":").concat(k[1]);++f!=this._configs.size&&(b+=",")}}catch(w){c.e(w)}finally{c.f()}return b+"}"}}])}();Yb.ConfigurationData=Rh;Object.defineProperty(Xb,"__esModule",{value:!0});Xb.I18nConfiguration=void 0;var Wd=function(){return B(function x(a){A(this,
x);this._configData=a;this._isPrimitiveDataResult=a.isPrimitiveData()},[{key:"configData",get:function(){return this._configData}},{key:"getStringValue",value:function(){return this.validatePrimitiveResult("getStringValue"),this._configData.getStringValue(this._configData.getPrimitiveDataConfigName())}},{key:"getNumberValue",value:function(){return this.validatePrimitiveResult("getNumberValue"),this._configData.getNumberValue(this._configData.getPrimitiveDataConfigName())}},{key:"getBooleanValue",
value:function(){return this.validatePrimitiveResult("getBooleanValue"),this._configData.getBooleanValue(this._configData.getPrimitiveDataConfigName())}},{key:"getEnumValue",value:function(a){return this.validatePrimitiveResult("getEnumValue"),this._configData.getEnumValue(a,this._configData.getPrimitiveDataConfigName())}},{key:"isEmpty",value:function(){return this._configData.isEmpty()}},{key:"validatePrimitiveResult",value:function(a){if(!this._isPrimitiveDataResult)throw Error("Method ".concat(a,
" cannot be called on a configuration of type object.\n                Call getConfigData().").concat(a,"(configName) instead."));}},{key:"toString",value:function(){return"I18nConfiguration: ".concat(this._configData)}}])}();Xb.I18nConfiguration=Wd;Wd.Builder=function(){return B(function h(){A(this,h);this._configs=new Map},[{key:"addConfiguration",value:function(a,b){return this._configs.set(a,b),this}},{key:"build",value:function(){return new Wd(new Yb.ConfigurationData(this._configs))}}])}();
var ja={};Object.defineProperty(ja,"__esModule",{value:!0});ja.DataType=void 0;var Qa=function(){return B(function x(a){A(this,x);this._isPrimitive=a},[{key:"isPrimitive",get:function(){return this._isPrimitive}}])}();ja.DataType=Qa;Qa.STRING=new Qa(!0);Qa.INT=new Qa(!0);Qa.BOOLEAN=new Qa(!0);Qa.CONFIGURATION_DATA=new Qa(!1);Qa.ENUM=new Qa(!0);var bb={};Object.defineProperty(bb,"__esModule",{value:!0});bb.I18nArgs=void 0;var Sh=function(){return B(function h(){A(this,h)},[{key:"toString",value:function(){var a,
b="".concat(this.constructor.name,":{"),f=0,c=W(this.getArgsMap().entries());try{for(c.s();!(a=c.n()).done;){var k=a.value;b+="".concat(k[0],":").concat(k[1]);++f!=this.getArgsMap().size&&(b+=",")}}catch(w){c.e(w)}finally{c.f()}return b+"}"}}])}();bb.I18nArgs=Sh;var xc={};Object.defineProperty(xc,"__esModule",{value:!0});xc.QueryResolver=void 0;var Th=function(){return B(function h(){A(this,h);this._isInitialized=!1},[{key:"validate",value:function(a,b){var h=this.getTargetConfigType();if(a.getConfigType()!==
h||b.getConfigType()!==h)throw Error(this.getValidationErrorMessage());}},{key:"isInitialized",value:function(){return this._isInitialized}},{key:"setInitializedState",value:function(a){this._isInitialized=a}}])}();xc.QueryResolver=Th;var yc={};Object.defineProperty(yc,"__esModule",{value:!0});yc.I18nConfigurationProvider=void 0;var Uh=function(){return B(function h(){A(this,h)},[{key:"getConfiguration",value:function(a,b){this.validate(a,b);try{var h=this.resolveConfiguration(a,b)}catch(D){console.warn("Failed to resolve configuration query with name ".concat(a.toString(),
" and args ").concat(b.toString(),". Error: ").concat(D)),h=(new Xb.I18nConfiguration.Builder).build()}return h}},{key:"validate",value:function(a,b){if(a.getConfigType()!==b.getConfigType()&&(void 0===b.getConfigType().parent||a.getConfigType()!==b.getConfigType().parent))throw Error("Input query args type need to match the config name type."+"Found ".concat(a.getConfigType()," for config name, but ").concat(b.getConfigType()," for config args."));}}])}();yc.I18nConfigurationProvider=Uh;var zc={};
Object.defineProperty(zc,"__esModule",{value:!0});zc.ConfigurationProviderManager=void 0;var Vh=function(){function a(b){A(this,a);this._provider=b}return B(a,null,[{key:"register",value:function(b){if(null==b)throw Error("Configuration provider cannot be undefined or null");void 0===this.instance?(this._instance=new a(b),console.log("Registered provider ".concat(b.constructor.name," for configuration resolution."))):console.warn("Provider ".concat(this.instance._provider.constructor.name," is already registered. ")+
"Ignoring register request for ".concat(b.constructor.name))}},{key:"getProvider",value:function(){if(void 0!==this.instance)return this.instance._provider;console.warn("No provider has been registered yet. Returning undefined.")}},{key:"hasProvider",value:function(){return null!=this.instance}},{key:"instance",get:function(){return this._instance}},{key:"resetInstance",value:function(){this._instance=void 0}}])}();zc.ConfigurationProviderManager=Vh;var Ac={};Object.defineProperty(Ac,"__esModule",
{value:!0});Ac.MarketplaceIdToCxTuple=void 0;var Zb=function(a){function b(a,h){return A(this,b),ca(this,b,[a,h])}return ea(b,a),B(b,[{key:"getConfigType",value:function(){return Da.ConfigType.MARKETPLACEID_TO_CX_TUPLE}}])}($a.ConfigName);Ac.MarketplaceIdToCxTuple=Zb;Zb.CX_ID=new Zb("cx_id",ja.DataType.STRING);Zb.CX_FAMILY=new Zb("cx_family",ja.DataType.STRING);var Bc={};Object.defineProperty(Bc,"__esModule",{value:!0});Bc.MarketplaceIdToCxTupleArgs=void 0;var Xd=function(a){function b(a){var h;return A(this,
b),(h=ca(this,b))._obfuscatedMarketplaceId=a,h}return ea(b,a),B(b,[{key:"obfuscatedMarketplaceId",get:function(){return this._obfuscatedMarketplaceId}},{key:"getConfigType",value:function(){return Da.ConfigType.MARKETPLACEID_TO_CX_TUPLE}},{key:"getArgsMap",value:function(){return new Map([["obfuscated_marketplace_id",this._obfuscatedMarketplaceId]])}}])}(bb.I18nArgs);Bc.MarketplaceIdToCxTupleArgs=Xd;Xd.Builder=function(){return B(function h(){A(this,h)},[{key:"withObfuscatedMarketplaceId",value:function(a){return this.obfuscatedMarketplaceId=
a,this}},{key:"build",value:function(){return new Xd(this.obfuscatedMarketplaceId)}}])}();var Cc={};Object.defineProperty(Cc,"__esModule",{value:!0});Cc.MarketplaceIdToCxTupleResult=void 0;var $b=function(a){function b(){return A(this,b),ca(this,b,arguments)}return ea(b,a),B(b)}(ab.QueryOutput);Cc.MarketplaceIdToCxTupleResult=$b;$b.CX_ID=new $b("cx_id",ja.DataType.STRING);$b.CX_FAMILY=new $b("cx_family",ja.DataType.STRING);var Dc={};Object.defineProperty(Dc,"__esModule",{value:!0});Dc.PriceFormat=
void 0;var cb=function(a){function b(a,h){return A(this,b),ca(this,b,[a,h])}return ea(b,a),B(b,[{key:"getConfigType",value:function(){return Da.ConfigType.PRICE_FORMAT}},{key:"getReturnType",value:function(){return this._returnType}}])}($a.ConfigName);Dc.PriceFormat=cb;cb.CURRENCY_FORMAT=new cb("currency_format",ja.DataType.CONFIGURATION_DATA);cb.SYMBOL_PREFIX=new cb("symbol_prefix",ja.DataType.STRING);cb.CURRENCY_SYMBOL_POSITION=new cb("currency_symbol_position",ja.DataType.ENUM);cb.TRAILING_ZERO_DISPLAY=
new cb("trailing_zero_display",ja.DataType.ENUM);var ac={};Object.defineProperty(ac,"__esModule",{value:!0});ac.PriceFormatArgs=void 0;var Wh=function(a){function b(a,h,c,k,w,E){var d;return A(this,b),(d=ca(this,b))._locale=a,d._currency=h,d._cxFamily=c,d._cxId=k,d._cxProgram=w,d._priceFormatType=E,d}return ea(b,a),B(b,[{key:"locale",get:function(){return this._locale}},{key:"currency",get:function(){return this._currency}},{key:"cxFamily",get:function(){return this._cxFamily}},{key:"cxId",get:function(){return this._cxId}},
{key:"cxProgram",get:function(){return this._cxProgram}},{key:"priceFormatType",get:function(){return this._priceFormatType}}])}(bb.I18nArgs);ac.PriceFormatArgs=Wh;var Ec={},Ib={};Object.defineProperty(Ib,"__esModule",{value:!0});Ib.RetailPriceFormatArgs=void 0;var Rf=function(a){function b(a,h,c,k,w,E){return A(this,b),ca(this,b,[a,h,c,k,w,E])}return ea(b,a),B(b,[{key:"getConfigType",value:function(){return Da.ConfigType.RETAIL_PRICE_FORMAT}},{key:"getArgsMap",value:function(){return new Map([["locale",
this._locale],["currency",this._currency],["cx_family",b.RETAIL_CX_FAMILY],["cx_id",this._cxId],["cx_program",this._cxProgram],["price_format_type",this._priceFormatType]])}}])}(ac.PriceFormatArgs);Ib.RetailPriceFormatArgs=Rf;Rf.RETAIL_CX_FAMILY="retail";Object.defineProperty(Ec,"__esModule",{value:!0});Ec.PriceFormatArgsBuilder=void 0;var Sf=function(){return B(function h(){A(this,h);this._cxProgram=h.EMPTY_CX_PROGRAM},[{key:"withLocale",value:function(a){return this._locale=a,this}},{key:"withCurrency",
value:function(a){return this._currency=a,this}},{key:"withCxId",value:function(a){return this._cxId=a,this}},{key:"withCxProgram",value:function(a){return this._cxProgram=a,this}},{key:"withCxFamily",value:function(a){return this._cxFamily=a,this}},{key:"withPriceFormatType",value:function(a){return this._priceFormatType=a,this}},{key:"fromPriceFormatArgs",value:function(a){return this.withCurrency(a.currency).withLocale(a.locale).withCxFamily(a.cxFamily).withCxId(a.cxId).withCxProgram(a.cxProgram).withPriceFormatType(a.priceFormatType)}},
{key:"build",value:function(){if(u.isNullOrUndefined(this._cxFamily)||Ib.RetailPriceFormatArgs.RETAIL_CX_FAMILY===this._cxFamily)return new Ib.RetailPriceFormatArgs(this._locale,this._currency,this._cxFamily,this._cxId,this._cxProgram,this._priceFormatType);throw Error("CX family ".concat(this._cxFamily," is currently not supported."));}}])}();Ec.PriceFormatArgsBuilder=Sf;Sf.EMPTY_CX_PROGRAM="[]";var Tf={};!function(a){Object.defineProperty(a,"__esModule",{value:!0});a.PriceFormatType=void 0;(a=a.PriceFormatType||
(a.PriceFormatType={})).ISO="iso";a.PLURAL="plural";a.AMAZON_SYMBOL="amazonSymbol";a.COMPACT="compact";a.IN_SENTENCE="inSentence"}(Tf);var Fc={};Object.defineProperty(Fc,"__esModule",{value:!0});Fc.PriceFormatResult=void 0;var Ha=function(a){function b(){return A(this,b),ca(this,b,arguments)}return ea(b,a),B(b)}(ab.QueryOutput);Fc.PriceFormatResult=Ha;Ha.SYMBOL=new Ha("symbol",ja.DataType.STRING);Ha.INSERT_SPACE_IN_PATTERN=new Ha("insert_space_in_pattern",ja.DataType.BOOLEAN);Ha.FORMAT_PATTERN=new Ha("format_pattern",
ja.DataType.STRING);Ha.SYMBOL_PREFIX=new Ha("symbol_prefix",ja.DataType.STRING);Ha.CURRENCY_SYMBOL_POSITION=new Ha("currency_symbol_position",ja.DataType.ENUM);Ha.TRAILING_ZERO_DISPLAY=new Ha("trailing_zero_display",ja.DataType.ENUM);var Uf={};!function(a){Object.defineProperty(a,"__esModule",{value:!0});a.TrailingZeroDisplay=void 0;(a=a.TrailingZeroDisplay||(a.TrailingZeroDisplay={})).AUTO="AUTO";a.HIDE_IF_WHOLE="HIDE_IF_WHOLE"}(Uf);var Vf={};!function(a){Object.defineProperty(a,"__esModule",{value:!0});
a.CurrencySymbolPosition=void 0;(a=a.CurrencySymbolPosition||(a.CurrencySymbolPosition={})).DEFAULT="default";a.START="start";a.END="end"}(Vf);var Gc={};Object.defineProperty(Gc,"__esModule",{value:!0});Gc.PointsFormat=void 0;var Yd=function(a){function b(a,f){return A(this,b),ca(this,b,[a,f])}return ea(b,a),B(b,[{key:"getConfigType",value:function(){return Da.ConfigType.POINTS_FORMAT}}])}($a.ConfigName);Gc.PointsFormat=Yd;Yd.PATTERN=new Yd("pattern",ja.DataType.STRING);var Hc={};Object.defineProperty(Hc,
"__esModule",{value:!0});Hc.PointsFormatArgs=void 0;var Zd=function(a){function b(a,f,h){var c;return A(this,b),(c=ca(this,b))._locale=a,c._programName=f,c._style=h,c}return ea(b,a),B(b,[{key:"getConfigType",value:function(){return Da.ConfigType.POINTS_FORMAT}},{key:"getArgsMap",value:function(){return new Map([["locale",this._locale],["program_name",this._programName],["style",this._style]])}},{key:"locale",get:function(){return this._locale}},{key:"programName",get:function(){return this._programName}},
{key:"style",get:function(){return this._style}}])}(bb.I18nArgs);Hc.PointsFormatArgs=Zd;Zd.Builder=function(){return B(function h(){A(this,h)},[{key:"withLocale",value:function(a){return this.locale=a,this}},{key:"withProgramName",value:function(a){return this.programName=a,this}},{key:"withStyle",value:function(a){return this.style=a,this}},{key:"build",value:function(){return new Zd(this.locale,this.programName,this.style)}}])}();var Ic={};Object.defineProperty(Ic,"__esModule",{value:!0});Ic.PointsFormatResult=
void 0;var $d=function(a){function b(){return A(this,b),ca(this,b,arguments)}return ea(b,a),B(b)}(ab.QueryOutput);Ic.PointsFormatResult=$d;$d.PATTERN=new $d("pattern",ja.DataType.STRING);var Wf={};!function(a){Object.defineProperty(a,"__esModule",{value:!0});a.PointsFormatStyle=void 0;(a=a.PointsFormatStyle||(a.PointsFormatStyle={})).DEFAULT="default";a.IMPLICIT="implicit"}(Wf);var Jc={};Object.defineProperty(Jc,"__esModule",{value:!0});Jc.CXTupleToI18nDomain=void 0;var ae=function(a){function b(a,
f){return A(this,b),ca(this,b,[a,f])}return ea(b,a),B(b,[{key:"getConfigType",value:function(){return Da.ConfigType.CX_TUPLE_TO_I18N_DOMAIN}}])}($a.ConfigName);Jc.CXTupleToI18nDomain=ae;ae.I18N_DOMAIN=new ae("i18n_domain",ja.DataType.STRING);var Xf,Kc={};Object.defineProperty(Kc,"__esModule",{value:!0});Kc.CXTupleToI18nDomainArgs=void 0;var Lc=function(a){function b(a,f,c){var h;return A(this,b),(h=ca(this,b))._cxFamily=a,h._cxId=f,h._cxProgram=c,h}return ea(b,a),B(b,[{key:"cxFamily",get:function(){return this._cxFamily}},
{key:"cxId",get:function(){return this._cxId}},{key:"cxProgram",get:function(){return this._cxProgram}},{key:"getConfigType",value:function(){return Da.ConfigType.CX_TUPLE_TO_I18N_DOMAIN}},{key:"getArgsMap",value:function(){return new Map([["cx_family",this._cxFamily],["cx_id",this._cxId],["cx_program",this._cxProgram]])}}])}(bb.I18nArgs);Kc.CXTupleToI18nDomainArgs=Lc;Lc.Builder=((Xf=function(){return B(function h(){A(this,h);this.cxProgram=Lc.Builder.EMPTY_CX_PROGRAM},[{key:"withCxFamily",value:function(a){return this.cxFamily=
a,this}},{key:"withCxId",value:function(a){return this.cxId=a,this}},{key:"withCxProgram",value:function(a){return this.cxProgram=a,this}},{key:"build",value:function(){return new Lc(this.cxFamily,this.cxId,this.cxProgram)}}])}()).EMPTY_CX_PROGRAM="[]",Xf);var Mc={};Object.defineProperty(Mc,"__esModule",{value:!0});Mc.CXTupleToI18nDomainResult=void 0;var be=function(a){function b(){return A(this,b),ca(this,b,arguments)}return ea(b,a),B(b)}(ab.QueryOutput);Mc.CXTupleToI18nDomainResult=be;be.I18N_DOMAIN=
new be("i18n_domain",ja.DataType.STRING);var Nc={};Object.defineProperty(Nc,"__esModule",{value:!0});Nc.CXTupleToDefaultPreferences=void 0;var bc=function(a){function b(a,f){return A(this,b),ca(this,b,[a,f])}return ea(b,a),B(b,[{key:"getConfigType",value:function(){return Da.ConfigType.CX_TUPLE_TO_DEFAULT_PREFERENCES}}])}($a.ConfigName);Nc.CXTupleToDefaultPreferences=bc;bc.DEFAULT_CURRENCY=new bc("default_currency",ja.DataType.STRING);bc.DEFAULT_LANGUAGE=new bc("default_language",ja.DataType.STRING);
var Oc={};Object.defineProperty(Oc,"__esModule",{value:!0});Oc.CXTupleToDefaultPreferencesArgs=void 0;var ce=function(a){function b(a,f,c){var h;return A(this,b),(h=ca(this,b))._cxFamily=a,h._cxId=f,h._cxProgram=c,h}return ea(b,a),B(b,[{key:"getConfigType",value:function(){return Da.ConfigType.CX_TUPLE_TO_DEFAULT_PREFERENCES}},{key:"getArgsMap",value:function(){return new Map([["cx_family",this._cxFamily],["cx_id",this._cxId],["cx_program",this._cxProgram]])}},{key:"cxFamily",get:function(){return this._cxFamily}},
{key:"cxId",get:function(){return this._cxId}},{key:"cxProgram",get:function(){return this._cxProgram}}])}(bb.I18nArgs);Oc.CXTupleToDefaultPreferencesArgs=ce;ce.Builder=function(){return B(function h(){A(this,h)},[{key:"withCxFamily",value:function(a){return this.cxFamily=a,this}},{key:"withCxId",value:function(a){return this.cxId=a,this}},{key:"withCxProgram",value:function(a){return this.cxProgram=a,this}},{key:"build",value:function(){return new ce(this.cxFamily,this.cxId,this.cxProgram)}}])}();
var Pc={};Object.defineProperty(Pc,"__esModule",{value:!0});Pc.CXTupleToDefaultPreferencesResult=void 0;var cc=function(a){function b(){return A(this,b),ca(this,b,arguments)}return ea(b,a),B(b)}(ab.QueryOutput);Pc.CXTupleToDefaultPreferencesResult=cc;cc.DEFAULT_CURRENCY=new cc("default_currency",ja.DataType.STRING);cc.DEFAULT_LANGUAGE=new cc("default_language",ja.DataType.STRING);(function(a){Object.defineProperty(a,"__esModule",{value:!0});Object.defineProperty(a,"ConfigType",{enumerable:!0,get:function(){return Da.ConfigType}});
Object.defineProperty(a,"ConfigName",{enumerable:!0,get:function(){return $a.ConfigName}});Object.defineProperty(a,"QueryOutput",{enumerable:!0,get:function(){return ab.QueryOutput}});Object.defineProperty(a,"I18nConfiguration",{enumerable:!0,get:function(){return Xb.I18nConfiguration}});Object.defineProperty(a,"ConfigurationData",{enumerable:!0,get:function(){return Yb.ConfigurationData}});Object.defineProperty(a,"DataType",{enumerable:!0,get:function(){return ja.DataType}});Object.defineProperty(a,
"I18nArgs",{enumerable:!0,get:function(){return bb.I18nArgs}});Object.defineProperty(a,"QueryResolver",{enumerable:!0,get:function(){return xc.QueryResolver}});Object.defineProperty(a,"I18nConfigurationProvider",{enumerable:!0,get:function(){return yc.I18nConfigurationProvider}});Object.defineProperty(a,"ConfigurationProviderManager",{enumerable:!0,get:function(){return zc.ConfigurationProviderManager}});Object.defineProperty(a,"isNullOrUndefined",{enumerable:!0,get:function(){return Va.isNullOrUndefined}});
Object.defineProperty(a,"MarketplaceIdToCxTuple",{enumerable:!0,get:function(){return Ac.MarketplaceIdToCxTuple}});Object.defineProperty(a,"MarketplaceIdToCxTupleArgs",{enumerable:!0,get:function(){return Bc.MarketplaceIdToCxTupleArgs}});Object.defineProperty(a,"MarketplaceIdToCxTupleResult",{enumerable:!0,get:function(){return Cc.MarketplaceIdToCxTupleResult}});Object.defineProperty(a,"PriceFormat",{enumerable:!0,get:function(){return Dc.PriceFormat}});Object.defineProperty(a,"PriceFormatArgs",{enumerable:!0,
get:function(){return ac.PriceFormatArgs}});Object.defineProperty(a,"PriceFormatArgsBuilder",{enumerable:!0,get:function(){return Ec.PriceFormatArgsBuilder}});Object.defineProperty(a,"RetailPriceFormatArgs",{enumerable:!0,get:function(){return Ib.RetailPriceFormatArgs}});Object.defineProperty(a,"PriceFormatType",{enumerable:!0,get:function(){return Tf.PriceFormatType}});Object.defineProperty(a,"PriceFormatResult",{enumerable:!0,get:function(){return Fc.PriceFormatResult}});Object.defineProperty(a,
"TrailingZeroDisplay",{enumerable:!0,get:function(){return Uf.TrailingZeroDisplay}});Object.defineProperty(a,"CurrencySymbolPosition",{enumerable:!0,get:function(){return Vf.CurrencySymbolPosition}});Object.defineProperty(a,"PointsFormat",{enumerable:!0,get:function(){return Gc.PointsFormat}});Object.defineProperty(a,"PointsFormatArgs",{enumerable:!0,get:function(){return Hc.PointsFormatArgs}});Object.defineProperty(a,"PointsFormatResult",{enumerable:!0,get:function(){return Ic.PointsFormatResult}});
Object.defineProperty(a,"PointsFormatStyle",{enumerable:!0,get:function(){return Wf.PointsFormatStyle}});Object.defineProperty(a,"CXTupleToI18nDomain",{enumerable:!0,get:function(){return Jc.CXTupleToI18nDomain}});Object.defineProperty(a,"CXTupleToI18nDomainArgs",{enumerable:!0,get:function(){return Kc.CXTupleToI18nDomainArgs}});Object.defineProperty(a,"CXTupleToI18nDomainResult",{enumerable:!0,get:function(){return Mc.CXTupleToI18nDomainResult}});Object.defineProperty(a,"CXTupleToDefaultPreferences",
{enumerable:!0,get:function(){return Nc.CXTupleToDefaultPreferences}});Object.defineProperty(a,"CXTupleToDefaultPreferencesArgs",{enumerable:!0,get:function(){return Oc.CXTupleToDefaultPreferencesArgs}});Object.defineProperty(a,"CXTupleToDefaultPreferencesResult",{enumerable:!0,get:function(){return Pc.CXTupleToDefaultPreferencesResult}})})(u);var de={},ee={},fe={},ge={},he={};Object.defineProperty(he,"__esModule",{value:!0});var Yf=function(){function a(){A(this,a)}return B(a,[{key:"getContent",
value:function(){return a.CX_TUPLE_TO_DEFAULT_PREFERENCES_MAPPING}}])}();he.default=Yf;Yf.CX_TUPLE_TO_DEFAULT_PREFERENCES_MAPPING=new Map([["retail/amazon.ae|default_language","en-AE"],["retail/amazon.ae|default_currency","AED"],["retail/amazon.au|default_language","en-AU"],["retail/amazon.au|default_currency","AUD"],["retail/amazon.com.be|default_language","fr-BE"],["retail/amazon.com.be|default_currency","EUR"],["retail/amazon.com.br|default_language","pt-BR"],["retail/amazon.com.br|default_currency",
"BRL"],["retail/amazon.ca|default_language","en-CA"],["retail/amazon.ca|default_currency","CAD"],["retail/amazon.cl|default_language","es-CL"],["retail/amazon.cl|default_currency","CLP"],["retail/amazon.com.co|default_language","es-CO"],["retail/amazon.com.co|default_currency","COP"],["retail/amazon.cn|default_language","zh-CN"],["retail/amazon.cn|default_currency","CNY"],["retail/amazon.de|default_language","de-DE"],["retail/amazon.de|default_currency","EUR"],["retail/amazon.eg|default_language",
"ar-AE"],["retail/amazon.eg|default_currency","EGP"],["retail/amazon.es|default_language","es-ES"],["retail/amazon.es|default_currency","EUR"],["retail/amazon.fr|default_language","fr-FR"],["retail/amazon.fr|default_currency","EUR"],["retail/amazon.in|default_language","en-IN"],["retail/amazon.in|default_currency","INR"],["retail/amazon.it|default_language","it-IT"],["retail/amazon.it|default_currency","EUR"],["retail/amazon.co.jp|default_language","ja-JP"],["retail/amazon.co.jp|default_currency",
"JPY"],["retail/amazon.com.mx|default_language","es-MX"],["retail/amazon.com.mx|default_currency","MXN"],["retail/amazon.com.ng|default_language","en-NG"],["retail/amazon.com.ng|default_currency","NGN"],["retail/amazon.nl|default_language","nl-NL"],["retail/amazon.nl|default_currency","EUR"],["retail/amazon.pl|default_language","pl-PL"],["retail/amazon.pl|default_currency","PLN"],["retail/amazon.ru|default_language","ru-RU"],["retail/amazon.ru|default_currency","RUB"],["retail/amazon.sa|default_language",
"ar-AE"],["retail/amazon.sa|default_currency","SAR"],["retail/amazon.se|default_language","sv-SE"],["retail/amazon.se|default_currency","SEK"],["retail/amazon.sg|default_language","en-SG"],["retail/amazon.sg|default_currency","SGD"],["retail/amazon.com.tr|default_language","tr-TR"],["retail/amazon.com.tr|default_currency","TRY"],["retail/amazon.co.uk|default_language","en-GB"],["retail/amazon.co.uk|default_currency","GBP"],["retail/amazon.com|default_language","en-US"],["retail/amazon.com|default_currency",
"USD"],["retail/amazon.co.za|default_language","en-ZA"],["retail/amazon.co.za|default_currency","ZAR"],["pyop/apa.amazon.ca|default_language","en-CA"],["pyop/apa.amazon.ca|default_currency","CAD"],["pyop/apa.amazon.de|default_language","de-DE"],["pyop/apa.amazon.de|default_currency","EUR"],["pyop/apa.amazon.in|default_language","en-IN"],["pyop/apa.amazon.in|default_currency","INR"],["pyop/apa.amazon.co.jp|default_language","ja-JP"],["pyop/apa.amazon.co.jp|default_currency","JPY"],["pyop/apa.amazon.com|default_language",
"en-US"],["pyop/apa.amazon.com|default_currency","USD"],["pyop/apa.amazon.co.uk|default_language","en-GB"],["pyop/apa.amazon.co.uk|default_currency","GBP"]]);var dc={};Object.defineProperty(dc,"__esModule",{value:!0});var Zf=function(a){function b(){var a;return A(this,b),(a=ca(this,b)).initialize(),a}return ea(b,a),B(b,[{key:"initialize",value:function(){if(!this.isInitialized())try{this._resourceConfigRetriever=this.createMapResourceConfigRetriever(),this.setInitializedState(!0)}catch(x){console.error("Failed to initialize query resolver ".concat(this.constructor.name))}return this.isInitialized()}}])}(u.QueryResolver);
dc.default=Zf;Zf.MAP_ATTRIBUTE_KEY_SEPARATOR="|";var $f=za&&za.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(ge,"__esModule",{value:!0});var Xh=$f(he),ag=$f(dc),ie=function(a){function b(){return A(this,b),ca(this,b)}return ea(b,a),B(b,[{key:"resolve",value:function(a,b){return this.validate(a,b),this.doResolve(a,b)}},{key:"doResolve",value:function(a,b){var f=new u.I18nConfiguration.Builder;switch(a){case u.CXTupleToDefaultPreferences.DEFAULT_CURRENCY:a=
this.getResource(a,b);f.addConfiguration(u.CXTupleToDefaultPreferencesResult.DEFAULT_CURRENCY,a);break;case u.CXTupleToDefaultPreferences.DEFAULT_LANGUAGE:a=this.getResource(a,b);f.addConfiguration(u.CXTupleToDefaultPreferencesResult.DEFAULT_LANGUAGE,a);break;default:throw Error("Attribute name ".concat(a," is not defined for feature ").concat(a.getConfigType()));}return f.build()}},{key:"getResource",value:function(a,f){f=f.cxFamily+b.CX_TUPLE_SEPARATOR+f.cxId;return f+=ag.default.MAP_ATTRIBUTE_KEY_SEPARATOR,
f+=a,this._resourceConfigRetriever.getContent().get(f)}},{key:"createMapResourceConfigRetriever",value:function(){return new Xh.default}},{key:"getTargetConfigType",value:function(){return b.CONFIG_TYPE}},{key:"getValidationErrorMessage",value:function(){return"CXTuple to default preferences configs can only be resolved for configType ".concat(b.CONFIG_TYPE)}}])}(ag.default);ge.default=ie;ie.CX_TUPLE_SEPARATOR="/";ie.CONFIG_TYPE=u.ConfigType.CX_TUPLE_TO_DEFAULT_PREFERENCES;var je={},ke={};Object.defineProperty(ke,
"__esModule",{value:!0});var bg=function(){function a(){A(this,a)}return B(a,[{key:"getContent",value:function(){return a.CX_TUPLE_TO_I18N_DOMAIN_MAPPINGS}}])}();ke.default=bg;bg.CX_TUPLE_TO_I18N_DOMAIN_MAPPINGS=new Map([["retail/amazon.ae|i18n_domain","retail-ae"],["retail/amazon.com.au|i18n_domain","retail-au"],["retail/amazon.com.be|i18n_domain","retail-be"],["retail/amazon.com.br|i18n_domain","retail-br"],["retail/amazon.ca|i18n_domain","retail-ca"],["retail/amazon.cl|i18n_domain","retail-cl"],
["retail/amazon.com.co|i18n_domain","retail-co"],["retail/amazon.cn|i18n_domain","retail-cn"],["retail/amazon.de|i18n_domain","retail-de"],["retail/amazon.eg|i18n_domain","retail-eg"],["retail/amazon.es|i18n_domain","retail-es"],["retail/amazon.fr|i18n_domain","retail-fr"],["retail/amazon.in|i18n_domain","retail-in"],["retail/amazon.it|i18n_domain","retail-it"],["retail/amazon.co.jp|i18n_domain","retail-jp"],["retail/amazon.com.mx|i18n_domain","retail-mx"],["retail/amazon.com.ng|i18n_domain","retail-ng"],
["retail/amazon.nl|i18n_domain","retail-nl"],["retail/amazon.pl|i18n_domain","retail-pl"],["retail/amazon.ru|i18n_domain","retail-ru"],["retail/amazon.sa|i18n_domain","retail-sa"],["retail/amazon.se|i18n_domain","retail-se"],["retail/amazon.sg|i18n_domain","retail-sg"],["retail/amazon.com.tr|i18n_domain","retail-tr"],["retail/amazon.co.uk|i18n_domain","retail-uk"],["retail/amazon.com|i18n_domain","retail-us"],["retail/amazon.co.za|i18n_domain","retail-za"]]);var cg=za&&za.__importDefault||function(a){return a&&
a.__esModule?a:{default:a}};Object.defineProperty(je,"__esModule",{value:!0});var Yh=cg(ke),dg=cg(dc),le=function(a){function b(){return A(this,b),ca(this,b)}return ea(b,a),B(b,[{key:"resolve",value:function(a,b){return this.validate(a,b),this.doResolve(a,b)}},{key:"doResolve",value:function(a,b){var f=new u.I18nConfiguration.Builder;if(a!==u.CXTupleToI18nDomain.I18N_DOMAIN)throw Error("Attribute name ".concat(a," is not defined for feature ").concat(a.getConfigType()));a=this.getResource(a,b);return f.addConfiguration(u.CXTupleToI18nDomainResult.I18N_DOMAIN,
a),f.build()}},{key:"getResource",value:function(a,f){f=f.cxFamily+b.CX_TUPLE_SEPARATOR+f.cxId;return f+=dg.default.MAP_ATTRIBUTE_KEY_SEPARATOR,f+=a,this._resourceConfigRetriever.getContent().get(f)}},{key:"createMapResourceConfigRetriever",value:function(){return new Yh.default}},{key:"getTargetConfigType",value:function(){return b.CONFIG_TYPE}},{key:"getValidationErrorMessage",value:function(){return"CXTuple to I18nDomain configs can only be resolved for configType ".concat(b.CONFIG_TYPE)}}])}(dg.default);
je.default=le;le.CX_TUPLE_SEPARATOR="/";le.CONFIG_TYPE=u.ConfigType.CX_TUPLE_TO_I18N_DOMAIN;var me={},ne={};Object.defineProperty(ne,"__esModule",{value:!0});var eg=function(){function a(){A(this,a)}return B(a,[{key:"getContent",value:function(){return a.MARKETPLACE_TO_CXTUPLE_MAPPINGS}}])}();ne.default=eg;eg.MARKETPLACE_TO_CXTUPLE_MAPPINGS=new Map([["A2VIGQ35RCS4UG|cx_id","amazon.ae"],["A2VIGQ35RCS4UG|cx_family","retail"],["A34GYYCZVDBSIK|cx_id","amazon.ae"],["A34GYYCZVDBSIK|cx_family","retail"],
["A39IBJ37TRP1C6|cx_id","amazon.com.au"],["A39IBJ37TRP1C6|cx_family","retail"],["A1RNPCQ4K8U27I|cx_id","amazon.com.au"],["A1RNPCQ4K8U27I|cx_family","retail"],["AMEN7PMS3EDWL|cx_id","amazon.com.be"],["AMEN7PMS3EDWL|cx_family","retail"],["A1YFOMBPFBRY22|cx_id","amazon.com.be"],["A1YFOMBPFBRY22|cx_family","retail"],["A2Q3Y263D00KWC|cx_id","amazon.com.br"],["A2Q3Y263D00KWC|cx_family","retail"],["AZXD3QD5B39HD|cx_id","amazon.com.br"],["AZXD3QD5B39HD|cx_family","retail"],["A2EUQ1WTGCTBG2|cx_id","amazon.ca"],
["A2EUQ1WTGCTBG2|cx_family","retail"],["A2WDZJZ5TCRMLH|cx_id","amazon.cl"],["A2WDZJZ5TCRMLH|cx_family","retail"],["A2IDBVIE7EAGN4|cx_id","amazon.cl"],["A2IDBVIE7EAGN4|cx_family","retail"],["A1NOHO22DE3OHQ|cx_id","amazon.com.co"],["A1NOHO22DE3OHQ|cx_family","retail"],["AAHKV2X7AFYLW|cx_id","amazon.cn"],["AAHKV2X7AFYLW|cx_family","retail"],["A1PA6795UKMFR9|cx_id","amazon.de"],["A1PA6795UKMFR9|cx_family","retail"],["ARBP9OOSHTCHU|cx_id","amazon.eg"],["ARBP9OOSHTCHU|cx_family","retail"],["AUJPM9XGFJRC7|cx_id",
"amazon.eg"],["AUJPM9XGFJRC7|cx_family","retail"],["A1RKKUPIHCS9HS|cx_id","amazon.es"],["A1RKKUPIHCS9HS|cx_family","retail"],["AJZF8LZ1EJVJN|cx_id","amazon.es"],["AJZF8LZ1EJVJN|cx_family","retail"],["A13V1IB3VIYZZH|cx_id","amazon.fr"],["A13V1IB3VIYZZH|cx_family","retail"],["A21TJRUUN4KGV|cx_id","amazon.in"],["A21TJRUUN4KGV|cx_family","retail"],["A2XZLSVIQ0F4JT|cx_family","retail"],["A2XZLSVIQ0F4JT|cx_id","amazon.in"],["APJ6JRA9NG5V4|cx_id","amazon.it"],["APJ6JRA9NG5V4|cx_family","retail"],["A3HOBANJMCMD83|cx_id",
"amazon.it"],["A3HOBANJMCMD83|cx_family","retail"],["A1VC38T7YXB528|cx_id","amazon.co.jp"],["A1VC38T7YXB528|cx_family","retail"],["A1AM78C64UM0Y8|cx_id","amazon.com.mx"],["A1AM78C64UM0Y8|cx_family","retail"],["A3P3J5A7D2ZVXI|cx_id","amazon.com.mx"],["A3P3J5A7D2ZVXI|cx_family","retail"],["A3OCL2LJ6GDH9T|cx_id","amazon.com.ng"],["A3OCL2LJ6GDH9T|cx_family","retail"],["A3PJZM0QIA8QDU|cx_id","amazon.com.ng"],["A3PJZM0QIA8QDU|cx_family","retail"],["A1805IZSGTT6HS|cx_id","amazon.nl"],["A1805IZSGTT6HS|cx_family",
"retail"],["A1M3WC0SJ3A38T|cx_id","amazon.nl"],["A1M3WC0SJ3A38T|cx_family","retail"],["A1C3SOZRARQ6R3|cx_id","amazon.pl"],["A1C3SOZRARQ6R3|cx_family","retail"],["AKY4K4WKH21YQ|cx_id","amazon.pl"],["AKY4K4WKH21YQ|cx_family","retail"],["AD2EMQ3L3PG8S|cx_id","amazon.ru"],["AD2EMQ3L3PG8S|cx_family","retail"],["A38NPJYVS5YHNH|cx_id","amazon.ru"],["A38NPJYVS5YHNH|cx_family","retail"],["A17E79C6D8DWNP|cx_id","amazon.sa"],["A17E79C6D8DWNP|cx_family","retail"],["A1MQPSGJ6U9Q54|cx_id","amazon.sa"],["A1MQPSGJ6U9Q54|cx_family",
"retail"],["A2NODRKZP88ZB9|cx_id","amazon.se"],["A2NODRKZP88ZB9|cx_family","retail"],["AT614YYYNOC1S|cx_id","amazon.se"],["AT614YYYNOC1S|cx_family","retail"],["A19VAU5U5O7RUS|cx_id","amazon.sg"],["A19VAU5U5O7RUS|cx_family","retail"],["A1DQ6JV7I20JSG|cx_id","amazon.sg"],["A1DQ6JV7I20JSG|cx_family","retail"],["A33AVAJ2PDY3EV|cx_id","amazon.com.tr"],["A33AVAJ2PDY3EV|cx_family","retail"],["A3CQBQD3RGPJR8|cx_id","amazon.com.tr"],["A3CQBQD3RGPJR8|cx_family","retail"],["A1F83G8C2ARO7P|cx_id","amazon.co.uk"],
["A1F83G8C2ARO7P|cx_family","retail"],["ATVPDKIKX0DER|cx_id","amazon.com"],["ATVPDKIKX0DER|cx_family","retail"],["AE08WJ6YKNBMC|cx_id","amazon.co.za"],["AE08WJ6YKNBMC|cx_family","retail"],["A3TFQ1G9L8TQ5L|cx_id","amazon.co.za"],["A3TFQ1G9L8TQ5L|cx_family","retail"],["A2CE4MDCUAASDP|cx_id","apa.amazon.ca"],["A2CE4MDCUAASDP|cx_family","pyop"],["A2VJI655WT2I0B|cx_id","apa.amazon.ca"],["A2VJI655WT2I0B|cx_family","pyop"],["A1NWP2E4EKQP94|cx_id","apa.amazon.ca"],["A1NWP2E4EKQP94|cx_family","pyop"],["ASBG27DKM7EX6|cx_id",
"apa.amazon.ca"],["ASBG27DKM7EX6|cx_family","pyop"],["A53RDEWN57UU5|cx_id","apa.amazon.de"],["A53RDEWN57UU5|cx_family","pyop"],["A1G8446IYHA4MR|cx_id","apa.amazon.de"],["A1G8446IYHA4MR|cx_family","pyop"],["A34RX6LWLXD2KA|cx_id","apa.amazon.de"],["A34RX6LWLXD2KA|cx_family","pyop"],["A225AO9WA6YYOF|cx_id","apa.amazon.de"],["A225AO9WA6YYOF|cx_family","pyop"],["A3FDG49KKM823Y|cx_id","apa.amazon.in"],["A3FDG49KKM823Y|cx_family","pyop"],["A1IAUC0NN979H6|cx_id","apa.amazon.in"],["A1IAUC0NN979H6|cx_family",
"pyop"],["A18VPDB9UTK24D|cx_id","apa.amazon.in"],["A18VPDB9UTK24D|cx_family","pyop"],["A16Z2XWZJTFS70|cx_id","apa.amazon.in"],["A16Z2XWZJTFS70|cx_family","pyop"],["A75P1MG8VMU51|cx_id","apa.amazon.co.jp"],["A75P1MG8VMU51|cx_family","pyop"],["A31YDYE76E6TCP|cx_id","apa.amazon.co.jp"],["A31YDYE76E6TCP|cx_family","pyop"],["A2EFPHRCZ60KI3|cx_id","apa.amazon.co.jp"],["A2EFPHRCZ60KI3|cx_family","pyop"],["A1U1OSY46WLA42|cx_id","apa.amazon.co.jp"],["A1U1OSY46WLA42|cx_family","pyop"],["AGWSWK15IEJJ7|cx_id",
"apa.amazon.com"],["AGWSWK15IEJJ7|cx_family","pyop"],["A3BXB0YN3XH17H|cx_id","apa.amazon.com"],["A3BXB0YN3XH17H|cx_family","pyop"],["A35A4JO734ER04|cx_id","apa.amazon.com"],["A35A4JO734ER04|cx_family","pyop"],["A341L3VCFKNMIY|cx_id","apa.amazon.com"],["A341L3VCFKNMIY|cx_family","pyop"],["AZAJMM36N6WQL|cx_id","apa.amazon.co.uk"],["AZAJMM36N6WQL|cx_family","pyop"],["A3M3RRFO9XDT2G|cx_id","apa.amazon.co.uk"],["A3M3RRFO9XDT2G|cx_family","pyop"],["A2UWQKHEFGNQY3|cx_id","apa.amazon.co.uk"],["A2UWQKHEFGNQY3|cx_family",
"pyop"],["A2V84NPDZD3ZEH|cx_id","apa.amazon.co.uk"],["A2V84NPDZD3ZEH|cx_family","pyop"]]);var fg=za&&za.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(me,"__esModule",{value:!0});var Zh=fg(ne),gg=fg(dc),hg=function(a){function b(){return A(this,b),ca(this,b)}return ea(b,a),B(b,[{key:"resolve",value:function(a,b){return this.validate(a,b),this.doResolve(a,b)}},{key:"doResolve",value:function(a,b){var f=new u.I18nConfiguration.Builder;switch(a){case u.MarketplaceIdToCxTuple.CX_ID:a=
this.getResource(a,b);f.addConfiguration(u.MarketplaceIdToCxTupleResult.CX_ID,a);break;case u.MarketplaceIdToCxTuple.CX_FAMILY:a=this.getResource(a,b);f.addConfiguration(u.MarketplaceIdToCxTupleResult.CX_FAMILY,a);break;default:throw Error("Attribute name ".concat(a," is not defined for feature ").concat(a.getConfigType()));}return f.build()}},{key:"getResource",value:function(a,b){b=b.obfuscatedMarketplaceId;return b+=gg.default.MAP_ATTRIBUTE_KEY_SEPARATOR,b+=a,this._resourceConfigRetriever.getContent().get(b)}},
{key:"createMapResourceConfigRetriever",value:function(){return new Zh.default}},{key:"getTargetConfigType",value:function(){return b.CONFIG_TYPE}},{key:"getValidationErrorMessage",value:function(){return"Marketplace to CXTuple configs can only be resolved for configType ".concat(b.CONFIG_TYPE)}}])}(gg.default);me.default=hg;hg.CONFIG_TYPE=u.ConfigType.MARKETPLACEID_TO_CX_TUPLE;var oe={},pe={},Qc={},Rc={};Object.defineProperty(Rc,"__esModule",{value:!0});Rc.DEFAULT_PRICE_FORMAT_OVERRIDES=void 0;Rc.DEFAULT_PRICE_FORMAT_OVERRIDES=
{symbolPosition:{},customSymbolData:{"sek_amazon.se":{customSymbol:"kr",insertSpaceInPattern:!1},"pln_amazon.pl":{customSymbol:"zł",insertSpaceInPattern:!1},sgd:{customSymbol:"S$",insertSpaceInPattern:!1},"aed_amazon.ae":{customSymbol:"AED",insertSpaceInPattern:!0},"sar_amazon.sa":{customSymbol:"SAR",insertSpaceInPattern:!0},"egp_amazon.eg":{customSymbol:"EGP",insertSpaceInPattern:!0},"try_amazon.com.tr":{customSymbol:"TL",insertSpaceInPattern:!0}},trailingZeroDisplayOverrides:{cop:u.TrailingZeroDisplay.HIDE_IF_WHOLE,
ngn:u.TrailingZeroDisplay.HIDE_IF_WHOLE}};var Sc={};Object.defineProperty(Sc,"__esModule",{value:!0});Sc.AR_PRICE_FORMAT_OVERRIDES=void 0;Sc.AR_PRICE_FORMAT_OVERRIDES={symbolPosition:{symbol_position:u.CurrencySymbolPosition.END},customSymbolData:{"aed_amazon.ae":{customSymbol:"درهم",insertSpaceInPattern:!0},"egp_amazon.eg":{customSymbol:"جنيه",insertSpaceInPattern:!0},"sar_amazon.sa":{customSymbol:"ريال",insertSpaceInPattern:!0},"usd_amazon.com":{customSymbol:"؜US$",insertSpaceInPattern:!1}},symbolPrefix:"؜"};
var Tc={};Object.defineProperty(Tc,"__esModule",{value:!0});Tc.BN_PRICE_FORMAT_OVERRIDES=void 0;Tc.BN_PRICE_FORMAT_OVERRIDES={symbolPosition:{symbol_position:u.CurrencySymbolPosition.START},customSymbolData:{}};var Uc={};Object.defineProperty(Uc,"__esModule",{value:!0});Uc.DA_PRICE_FORMAT_OVERRIDES=void 0;Uc.DA_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{"sek_amazon.se":{customSymbol:"Skr",insertSpaceInPattern:!1}}};var Vc={};Object.defineProperty(Vc,"__esModule",{value:!0});Vc.ET_PRICE_FORMAT_OVERRIDES=
void 0;Vc.ET_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{"sek_amazon.se":{customSymbol:"Skr",insertSpaceInPattern:!1}}};var Wc={};Object.defineProperty(Wc,"__esModule",{value:!0});Wc.EN_XD_PRICE_FORMAT_OVERRIDES=void 0;Wc.EN_XD_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{}};var Xc={};Object.defineProperty(Xc,"__esModule",{value:!0});Xc.EN_PHNX_XD_UNIFON_PRICE_FORMAT_OVERRIDES=void 0;Xc.EN_PHNX_XD_UNIFON_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{}};
var Yc={};Object.defineProperty(Yc,"__esModule",{value:!0});Yc.ES_PRICE_FORMAT_OVERRIDES=void 0;Yc.ES_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{"usd_amazon.com_compact":{customSymbol:"$",insertSpaceInPattern:!1},"usd_amazon.com":{customSymbol:"US$",insertSpaceInPattern:!1}}};var Zc={};Object.defineProperty(Zc,"__esModule",{value:!0});Zc.FR_CA_PRICE_FORMAT_OVERRIDES=void 0;Zc.FR_CA_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{"cad_amazon.ca":{customSymbol:"$",insertSpaceInPattern:!1}}};
var $c={};Object.defineProperty($c,"__esModule",{value:!0});$c.FR_XD_PRICE_FORMAT_OVERRIDES=void 0;$c.FR_XD_PRICE_FORMAT_OVERRIDES={symbolPosition:{symbol_position:u.CurrencySymbolPosition.END},customSymbolData:{}};var ad={};Object.defineProperty(ad,"__esModule",{value:!0});ad.FR_XD_UNIFON_PRICE_FORMAT_OVERRIDES=void 0;ad.FR_XD_UNIFON_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{}};var bd={};Object.defineProperty(bd,"__esModule",{value:!0});bd.FR_PHNX_XD_UNIFON_PRICE_FORMAT_OVERRIDES=
void 0;bd.FR_PHNX_XD_UNIFON_PRICE_FORMAT_OVERRIDES={symbolPosition:{symbol_position:u.CurrencySymbolPosition.START},customSymbolData:{}};var cd={};Object.defineProperty(cd,"__esModule",{value:!0});cd.HE_PRICE_FORMAT_OVERRIDES=void 0;cd.HE_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{},symbolPrefix:"‏"};var dd={};Object.defineProperty(dd,"__esModule",{value:!0});dd.IS_PRICE_FORMAT_OVERRIDES=void 0;dd.IS_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{"sek_amazon.se":{customSymbol:"Skr",
insertSpaceInPattern:!1}}};var ed={};Object.defineProperty(ed,"__esModule",{value:!0});ed.JA_PRICE_FORMAT_OVERRIDES=void 0;ed.JA_PRICE_FORMAT_OVERRIDES={symbolPosition:{jpy_insentence:u.CurrencySymbolPosition.END},customSymbolData:{jpy_insentence:{customSymbol:"円",insertSpaceInPattern:!1},"jpy_amazon.co.jp_compact":{customSymbol:"¥",insertSpaceInPattern:!1}}};var fd={};Object.defineProperty(fd,"__esModule",{value:!0});fd.NB_PRICE_FORMAT_OVERRIDES=void 0;fd.NB_PRICE_FORMAT_OVERRIDES={symbolPosition:{},
customSymbolData:{"sek_amazon.se":{customSymbol:"Skr",insertSpaceInPattern:!1}}};var gd={};Object.defineProperty(gd,"__esModule",{value:!0});gd.NN_PRICE_FORMAT_OVERRIDES=void 0;gd.NN_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{"sek_amazon.se":{customSymbol:"Skr",insertSpaceInPattern:!1}}};var hd={};Object.defineProperty(hd,"__esModule",{value:!0});hd.NO_PRICE_FORMAT_OVERRIDES=void 0;hd.NO_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{"sek_amazon.se":{customSymbol:"Skr",
insertSpaceInPattern:!1}}};var id={};Object.defineProperty(id,"__esModule",{value:!0});id.TR_PRICE_FORMAT_OVERRIDES=void 0;id.TR_PRICE_FORMAT_OVERRIDES={symbolPosition:{symbol_position:u.CurrencySymbolPosition.END},customSymbolData:{}};var jd={};Object.defineProperty(jd,"__esModule",{value:!0});jd.ZH_PRICE_FORMAT_OVERRIDES=void 0;jd.ZH_PRICE_FORMAT_OVERRIDES={symbolPosition:{jpy_insentence:u.CurrencySymbolPosition.END,cny_insentence:u.CurrencySymbolPosition.END},customSymbolData:{cny_insentence:{customSymbol:"元",
insertSpaceInPattern:!1},jpy_insentence:{customSymbol:"日元",insertSpaceInPattern:!1}}};var kd={};Object.defineProperty(kd,"__esModule",{value:!0});kd.HI_XD_PRICE_FORMAT_OVERRIDES=void 0;kd.HI_XD_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{},trailingZeroDisplayOverrides:{"inr_amazon.in_insentence":u.TrailingZeroDisplay.HIDE_IF_WHOLE,"inr_amazon.in_amazonsymbol":u.TrailingZeroDisplay.HIDE_IF_WHOLE}};var $h=function(a){if(a.__esModule)return a;var b=Object.defineProperty({},"__esModule",
{value:!0});return Object.keys(a).forEach(function(c){var f=Object.getOwnPropertyDescriptor(a,c);Object.defineProperty(b,c,f.get?f:{enumerable:!0,get:function(){return a[c]}})}),b}(Nh);Object.defineProperty(Qc,"__esModule",{value:!0});Qc.CustomSymbolOverrides=void 0;var ig=/-/g,jg=Wa({ar:Sc.AR_PRICE_FORMAT_OVERRIDES,bn:Tc.BN_PRICE_FORMAT_OVERRIDES,da:Uc.DA_PRICE_FORMAT_OVERRIDES,et:Vc.ET_PRICE_FORMAT_OVERRIDES,es:Yc.ES_PRICE_FORMAT_OVERRIDES,fr_ca:Zc.FR_CA_PRICE_FORMAT_OVERRIDES,he:cd.HE_PRICE_FORMAT_OVERRIDES,
is:dd.IS_PRICE_FORMAT_OVERRIDES,ja:ed.JA_PRICE_FORMAT_OVERRIDES,nb:fd.NB_PRICE_FORMAT_OVERRIDES,nn:gd.NN_PRICE_FORMAT_OVERRIDES,no:hd.NO_PRICE_FORMAT_OVERRIDES,tr:id.TR_PRICE_FORMAT_OVERRIDES,zh:jd.ZH_PRICE_FORMAT_OVERRIDES,en_xd:Wc.EN_XD_PRICE_FORMAT_OVERRIDES,en_phnx_xd_unifon:Xc.EN_PHNX_XD_UNIFON_PRICE_FORMAT_OVERRIDES,fr_xd:$c.FR_XD_PRICE_FORMAT_OVERRIDES,fr_xd_unifon:ad.FR_XD_UNIFON_PRICE_FORMAT_OVERRIDES,fr_phnx_xd_unifon:bd.FR_PHNX_XD_UNIFON_PRICE_FORMAT_OVERRIDES,hi_xd:kd.HI_XD_PRICE_FORMAT_OVERRIDES},
"default",Rc.DEFAULT_PRICE_FORMAT_OVERRIDES),ai=function(){return B(function x(a){A(this,x);this.overrides=[];this.intlLocale=$h.LocaleUtil.getCanonicalLocale(new Intl.Locale(a));a=[];for(var b=this.intlLocale.baseName,c=(b=b.replace(ig,"_")).lastIndexOf("_");0<c;)a.push(b.toLocaleLowerCase("und")),c=(b=b.substring(0,c)).lastIndexOf("_");if(this.intlLocale.script)for(c=(b=(b=(new Intl.Locale(this.intlLocale.baseName.replace("-"+this.intlLocale.script,""))).baseName).replace(ig,"_")).lastIndexOf("_");0<
c;)a.push(b.toLocaleLowerCase("und")),c=(b=b.substring(0,c)).lastIndexOf("_");a.push(b.toLocaleLowerCase("und"));for(b=0;b<a.length;b++)(c=jg[a[b]])&&this.overrides.push(c);this.overrides.push(jg["default"])},[{key:"getCustomSymbolData",value:function(a){var b;a=this.getResourceFallbackKeys(a);var c=W(this.overrides);try{for(c.s();!(b=c.n()).done;){var h=this.getResourceValue(b.value.customSymbolData,a);if(h)return h}}catch(S){c.e(S)}finally{c.f()}return null}},{key:"getResourceValue",value:function(a,
b){var c;b=W(b);try{for(b.s();!(c=b.n()).done;){var h=c.value;if(this.containsKey(h,a))return a[h]}}catch(S){b.e(S)}finally{b.f()}return null}},{key:"getResourceFallbackKeys",value:function(a){var b=[];if(!a.currencyCode)return[];var c=a.typeName;c&&(c=c.toLowerCase());var h=a.currencyCode.toLowerCase();a=a.cxId;return a&&(a=a.toLowerCase(),b.push(pc(h,a,c),pc(h,a))),b.push(pc(h,c),pc(h)),b}},{key:"getSymbolPrefix",value:function(){var a,b=W(this.overrides);try{for(b.s();!(a=b.n()).done;){var c=a.value;
if(this.containsKey("symbolPrefix",c))return c.symbolPrefix}}catch(D){b.e(D)}finally{b.f()}return null}},{key:"getSymbolPositionOverride",value:function(a){var b=[];a&&b.push.apply(b,ya(this.getResourceFallbackKeys(a)));b.push("symbol_position");var c;a=W(this.overrides);try{for(a.s();!(c=a.n()).done;){var h=this.getResourceValue(c.value.symbolPosition,b);if(h)return h}}catch(S){a.e(S)}finally{a.f()}return u.CurrencySymbolPosition.DEFAULT}},{key:"getTrailingZeroDisplay",value:function(a){var b;a=
this.getResourceFallbackKeys(a);var c=W(this.overrides);try{for(c.s();!(b=c.n()).done;){var h=b.value;if(h.trailingZeroDisplayOverrides){var k=this.getResourceValue(h.trailingZeroDisplayOverrides,a);if(k)return k}}}catch(w){c.e(w)}finally{c.f()}return null}},{key:"containsKey",value:function(a,b){return!!b&&b.hasOwnProperty(a)}}])}();Qc.CustomSymbolOverrides=ai;Object.defineProperty(pe,"__esModule",{value:!0});var bi=function(){return B(function x(a){A(this,x);this._locale=a},[{key:"getContent",value:function(){return new Qc.CustomSymbolOverrides(this._locale)}}])}();
pe.default=bi;var qe={};Object.defineProperty(qe,"__esModule",{value:!0});var ci=function(a){function b(a){var c;return A(this,b),(c=ca(this,b))._locale=a,c.initialize(),c}return ea(b,a),B(b,[{key:"initialize",value:function(){if(!this.isInitialized())try{this._resourceConfigRetriever=this.createResourceConfigRetriever(),this.setInitializedState(!0)}catch(x){console.error("Failed to initialize query resolver ".concat(this.constructor.name))}return this.isInitialized()}}])}(u.QueryResolver);qe.default=
ci;var kg=za&&za.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(oe,"__esModule",{value:!0});var di=kg(pe),re=function(a){function b(){return A(this,b),ca(this,b,arguments)}return ea(b,a),B(b,[{key:"resolve",value:function(a,b){return this.validate(a,b),this.doResolve(a,b)}},{key:"doResolve",value:function(a,b){var c=new u.I18nConfiguration.Builder,f=this._resourceConfigRetriever.getContent();b={currencyCode:b.currency,typeName:b.priceFormatType,cxId:b.cxId};
switch(a){case u.PriceFormat.CURRENCY_FORMAT:a=f.getCustomSymbolData(b);(0,u.isNullOrUndefined)(a)||(c.addConfiguration(u.PriceFormatResult.SYMBOL,a.customSymbol),c.addConfiguration(u.PriceFormatResult.INSERT_SPACE_IN_PATTERN,a.insertSpaceInPattern),c.addConfiguration(u.PriceFormatResult.FORMAT_PATTERN,a.formatPattern));break;case u.PriceFormat.CURRENCY_SYMBOL_POSITION:c.addConfiguration(u.PriceFormatResult.CURRENCY_SYMBOL_POSITION,f.getSymbolPositionOverride(b)||u.CurrencySymbolPosition.DEFAULT);
break;case u.PriceFormat.SYMBOL_PREFIX:c.addConfiguration(u.PriceFormatResult.SYMBOL_PREFIX,f.getSymbolPrefix());break;case u.PriceFormat.TRAILING_ZERO_DISPLAY:c.addConfiguration(u.PriceFormatResult.TRAILING_ZERO_DISPLAY,f.getTrailingZeroDisplay(b)||u.TrailingZeroDisplay.AUTO);break;default:throw Error("Attribute name ".concat(a," is not defined for feature ").concat(a.getConfigType()));}return c.build()}},{key:"validate",value:function(a,c){if(a.getConfigType()!==this.getTargetConfigType()||c.getConfigType()!==
b.SPECIFIC_CONFIG_TYPE)throw Error(this.getValidationErrorMessage());}},{key:"createResourceConfigRetriever",value:function(){return new di.default(this._locale)}},{key:"getTargetConfigType",value:function(){return b.CONFIG_TYPE}},{key:"getValidationErrorMessage",value:function(){return"Retail Price Format configs can only be resolved for"+"configType ".concat(b.CONFIG_TYPE," and args type ").concat(b.SPECIFIC_CONFIG_TYPE)}}],[{key:"create",value:function(a){if(a instanceof u.PriceFormatArgs)return a=
a.locale,new b((0,u.isNullOrUndefined)(a)?"und":a);throw Error("Cannot create PriceFormatResourceBundleQueryResolver using args of type ".concat(ka(a),".")+"Use RetailPriceFormatArgs to query Price Format data.");}}])}(kg(qe).default);oe.default=re;re.CONFIG_TYPE=u.ConfigType.PRICE_FORMAT;re.SPECIFIC_CONFIG_TYPE=u.ConfigType.RETAIL_PRICE_FORMAT;var ld=za&&za.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(fe,"__esModule",{value:!0});var ei=ld(ge),fi=ld(je),
gi=ld(me),hi=ld(oe),ii=function(){return B(function h(){A(this,h)},null,[{key:"getResolver",value:function(a){switch(a.getConfigType()){case u.ConfigType.RETAIL_PRICE_FORMAT:a=hi.default.create(a);break;case u.ConfigType.MARKETPLACEID_TO_CX_TUPLE:a=new gi.default;break;case u.ConfigType.CX_TUPLE_TO_I18N_DOMAIN:a=new fi.default;break;case u.ConfigType.CX_TUPLE_TO_DEFAULT_PREFERENCES:a=new ei.default;break;default:throw Error("No resolver has been registered for config type ".concat(a.getConfigType()));
}return a}}])}();fe.default=ii;var ji=za&&za.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(ee,"__esModule",{value:!0});var ki=ji(fe),li=function(a){function b(){return A(this,b),ca(this,b,arguments)}return ea(b,a),B(b,[{key:"resolveConfiguration",value:function(a,b){return ki.default.getResolver(b).resolve(a,b)}}])}(u.I18nConfigurationProvider);ee.default=li;var mi=za&&za.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(de,
"__esModule",{value:!0});var lg=de.ResourceBundleI18nConfigurationProvider=void 0,ni=mi(ee);lg=de.ResourceBundleI18nConfigurationProvider=ni.default;var mg,oi=function(){return B(function x(a){A(this,x);this._configProvider=a},[{key:"resolve",value:function(a){if(u.isNullOrUndefined(a)||u.isNullOrUndefined(a.getObfuscatedMarketplaceId()))return Gb.UNKNOWN;var b=(new u.MarketplaceIdToCxTupleArgs.Builder).withObfuscatedMarketplaceId(a.getObfuscatedMarketplaceId()).build();a=this._configProvider.getConfiguration(u.MarketplaceIdToCxTuple.CX_FAMILY,
b).getStringValue();b=this._configProvider.getConfiguration(u.MarketplaceIdToCxTuple.CX_ID,b).getStringValue();return u.isNullOrUndefined(a)||u.isNullOrUndefined(b)?Gb.UNKNOWN:Gb.of(a,b)}}])}(),pi=function(){return B(function x(a){A(this,x);this._configProvider=a},[{key:"resolveDefaultCurrency",value:function(a){a=(new u.CXTupleToDefaultPreferencesArgs.Builder).withCxFamily(a.cxFamily).withCxId(a.cxFamily).build();return this._configProvider.getConfiguration(u.CXTupleToDefaultPreferences.DEFAULT_CURRENCY,
a).getStringValue()||""}},{key:"resolveDefaultLanguage",value:function(a){a=(new u.CXTupleToDefaultPreferencesArgs.Builder).withCxFamily(a.cxFamily).withCxId(a.cxFamily).build();return this._configProvider.getConfiguration(u.CXTupleToDefaultPreferences.DEFAULT_LANGUAGE,a).getStringValue()||""}}])}(),ch=/[‎‏‪-‮⁦-⁩؜]+/,qi="undefined"!=typeof process&&process.env.I18N_PRICE_FORMAT_NUMBER_FORMAT_CACHE_SIZE?parseInt(process.env.I18N_PRICE_FORMAT_NUMBER_FORMAT_CACHE_SIZE,10):1E3,ri=new Set(["retail"]),
si=new Map([["end",u.CurrencySymbolPosition.END],["start",u.CurrencySymbolPosition.START],["default",u.CurrencySymbolPosition.DEFAULT]]),ng=new Map([["HIDE_IF_WHOLE",u.TrailingZeroDisplay.HIDE_IF_WHOLE],["AUTO",u.TrailingZeroDisplay.AUTO]]),md=new Map([["inSentence",u.PriceFormatType.IN_SENTENCE],["amazonSymbol",u.PriceFormatType.AMAZON_SYMBOL],["iso",u.PriceFormatType.ISO],["compact",u.PriceFormatType.COMPACT],["plural",u.PriceFormatType.PLURAL]]),nd=function(){return B(function w(a,b,c,k,p){A(this,
w);this.numberFormatCache=new Ff({maxSize:qi});this.type=b;this.trailingZeroDisplay=p;this.localizationContext=k;this.configurationProvider=this.resolveConfigProvider();k=new oi(this.configurationProvider);p=new pi(this.configurationProvider);this.cxTuple=this.localizationContext.getAttribute(la.CX_TUPLE_KEY)||k.resolve(c);this.locale=nc.getCanonicalLocaleString(this.resolveLocale(a,this.cxTuple,c,p));this.marketplaceDefaultCurrencyCode=this.resolveDefaultCurrency(this.cxTuple,c,p);a=(new u.PriceFormatArgsBuilder).withLocale(this.locale).withPriceFormatType(Vb(b,
md)).build();a=this.getConfigurationDataWithArgs(a,[u.PriceFormat.SYMBOL_PREFIX,u.PriceFormat.CURRENCY_SYMBOL_POSITION]);this.symbolPosition=this.getCurrencySymbolPositionFromConfig(a);this.symbolPrefix=a.getStringValue(u.PriceFormatResult.SYMBOL_PREFIX)||""},[{key:"format",value:function(a){return Oe(this.getNumberFormatParts(a))}},{key:"formatToParts",value:function(a){var b=this.getNumberFormatParts(a);var c=this.type;c=Id(b,"fraction")&&"compact"!==c?vb(b)?Id(b,"decimal")?3:4:Id(b,"decimal")?
0:1:vb(b)?5:2;var h=rc(b,"integer"),k=rc(b,"currency"),w=rc(b,"decimal"),E=rc(b,"fraction");if(!h||!k)throw Error("Currency symbol or integer value are not present");c={fieldOrder:c,integerValue:h,currencySymbol:k,decimalSeparator:w,fractionalValue:E};return{amount:a.amount,currency:a.currency,displayString:Oe(b),displayFields:c}}},{key:"getConfigurationData",value:function(a,b){if(u.isNullOrUndefined(a))throw Error("The currency code must not be null or undefined");var c=new u.ConfigurationData;
if(this.checkCachedConfig(a,b,c),0==b.length)return c;var h=this.buildQueryArgs(a);h=this.getConfigurationDataWithArgs(h,b);return this.cacheConfig(a,b,h),h.merge(c),h}},{key:"resolveSymbolPositionOverride",value:function(a){a?a=this.getConfigurationData(a,[u.PriceFormat.CURRENCY_SYMBOL_POSITION]):(a=(new u.PriceFormatArgsBuilder).withLocale(this.locale).withPriceFormatType(Vb(this.type,md)).build(),a=this.getConfigurationDataWithArgs(a,[u.PriceFormat.CURRENCY_SYMBOL_POSITION]));return this.getCurrencySymbolPositionFromConfig(a)}},
{key:"resolveTrailingZeroDisplay",value:function(a){return void 0!==this.trailingZeroDisplay?this.trailingZeroDisplay:Ne(this.getConfigurationData(a,[u.PriceFormat.TRAILING_ZERO_DISPLAY]).getEnumValue(u.TrailingZeroDisplay,u.PriceFormatResult.TRAILING_ZERO_DISPLAY),ng)||"AUTO"}},{key:"resolveConfigProvider",value:function(){return u.ConfigurationProviderManager.hasProvider()||u.ConfigurationProviderManager.register(new lg),u.ConfigurationProviderManager.getProvider()}},{key:"resolveLocale",value:function(a,
b,c,k){if(!u.isNullOrUndefined(a))return""!==a?a:(console.warn("An empty locale string was passed in; this will be interpreted as the Root locale. This is generally an I18n anti-pattern. Consider passing in a valid BCP 47 language tag."),"und");a=k.resolveDefaultLanguage(b);return""!==a?a:c.getDefaultLocale()||"und"}},{key:"resolveDefaultCurrency",value:function(a,b,c){a=c.resolveDefaultCurrency(a);return""!==a?a:b.getDefaultCurrency()}},{key:"getConfigurationDataWithArgs",value:function(a,b){var c=
new u.ConfigurationData;if(u.isNullOrUndefined(a))return console.log("Return empty configuration data with args undefined."),c;var h;b=W(b);try{for(b.s();!(h=b.n()).done;){var k=this.configurationProvider.getConfiguration(h.value,a);c.merge(k.configData)}}catch(w){b.e(w)}finally{b.f()}return c}},{key:"checkCachedConfig",value:function(a,b,c){if(this.currencyFormatCache&&this.currencyFormatCache.key===a&&(qc(b,u.PriceFormat.CURRENCY_FORMAT),c.merge(this.currencyFormatCache.value)),this.trailingZeroDisplay||
this.trailingZeroDisplayCache&&this.trailingZeroDisplayCache.key===a){qc(b,u.PriceFormat.TRAILING_ZERO_DISPLAY);var f=this.trailingZeroDisplay?Vb(this.trailingZeroDisplay,ng):this.trailingZeroDisplayCache.value;f=(new u.I18nConfiguration.Builder).addConfiguration(u.PriceFormatResult.TRAILING_ZERO_DISPLAY,f).build();c.merge(f.configData)}this.symbolPositionCache&&this.symbolPositionCache.key===a&&(qc(b,u.PriceFormat.CURRENCY_SYMBOL_POSITION),f=(new u.I18nConfiguration.Builder).addConfiguration(u.PriceFormatResult.CURRENCY_SYMBOL_POSITION,
this.symbolPositionCache.value).build().configData,c.merge(f));this.symbolPrefixCache&&this.symbolPrefixCache.key===a&&(qc(b,u.PriceFormat.SYMBOL_PREFIX),a=(new u.I18nConfiguration.Builder).addConfiguration(u.PriceFormatResult.SYMBOL_PREFIX,this.symbolPrefixCache.value).build().configData,c.merge(a))}},{key:"cacheConfig",value:function(a,b,c){b.includes(u.PriceFormat.CURRENCY_FORMAT)&&(this.currencyFormatCache={key:a,value:c});b.includes(u.PriceFormat.CURRENCY_SYMBOL_POSITION)&&(this.symbolPositionCache=
{key:a,value:c.getEnumValue(u.CurrencySymbolPosition,u.PriceFormatResult.CURRENCY_SYMBOL_POSITION)});b.includes(u.PriceFormat.TRAILING_ZERO_DISPLAY)&&(this.trailingZeroDisplayCache={key:a,value:c.getEnumValue(u.TrailingZeroDisplay,u.PriceFormatResult.TRAILING_ZERO_DISPLAY)});b.includes(u.PriceFormat.SYMBOL_PREFIX)&&(this.symbolPrefixCache={key:a,value:c.getStringValue(u.PriceFormatResult.SYMBOL_PREFIX)})}},{key:"getCurrencySymbolPositionFromConfig",value:function(a){return Ne(a.getEnumValue(u.CurrencySymbolPosition,
u.PriceFormatResult.CURRENCY_SYMBOL_POSITION),si)||"default"}},{key:"buildQueryArgs",value:function(a){return ri.has(this.cxTuple.cxFamily)?(new u.PriceFormatArgsBuilder).withCurrency(a).withCxFamily(this.cxTuple.cxFamily).withCxId(this.cxTuple.cxId).withLocale(this.locale).withPriceFormatType(Vb(this.type,md)).build():Gb.UNKNOWN.cxFamily===this.cxTuple.cxFamily?(new u.PriceFormatArgsBuilder).withCurrency(a).withLocale(this.locale).withPriceFormatType(Vb(this.type,md)).build():void 0}},{key:"getFormat",
value:function(a){var b,c=!1,h=!1,k="default",w=this.getConfigurationData(a.currencyCode,[u.PriceFormat.CURRENCY_FORMAT,u.PriceFormat.SYMBOL_PREFIX,u.PriceFormat.CURRENCY_SYMBOL_POSITION]);a:switch(this.type){case "iso":case "plural":var E=!1;break a;default:E=!0}E&&(E=w.getStringValue(u.PriceFormatResult.SYMBOL),this.marketplaceDefaultCurrencyCode&&this.marketplaceDefaultCurrencyCode!==a.currencyCode&&!E?(c=!0,b=this.symbolPrefix+a.currencyCode,h=!0):E&&(b=E,c=!0,h=w.getBooleanValue(u.PriceFormatResult.INSERT_SPACE_IN_PATTERN)||
!1));return"iso"!==this.type&&(k="default"!==this.symbolPosition?this.symbolPosition:this.resolveSymbolPositionOverride(a.currencyCode)),{numberFormat:this.getNumberFormatFromCacheOrCreate(this.locale,a,this.type),currencySymbol:b,insertSpaceInPattern:h,symbolOverrideApplied:c,symbolPosition:k}}},{key:"getNumberFormatParts",value:function(a){var b=a.currency,c=this.getFormat(b),h=function(a,b){b=Math.pow(10,b||0);var d=Number((a*b).toFixed(5));return 0!=d%.5?a:0==Math.floor(d)%2?Math.floor(d)/b:Math.round(d)/
b}(a.amount,c.numberFormat.resolvedOptions().minimumFractionDigits);if("number"!=typeof h||Number.isNaN(h))throw Error("Amount is not a number");var k,w,E;h=c.numberFormat.formatToParts("compact"===this.type?0>h?Math.ceil(h)||0:Math.floor(h):h);if("compact"===this.type?h=function(a){var b;Gd(a)&&"literal"===a[b=vb(a)?ub(a,"literal",!0):ub(a,"literal",!1)].type&&" "===a[b].value&&a.splice(b,1);return a}(h):c.insertSpaceInPattern&&(E={type:"literal",value:" "},Gd(k=h)||(vb(k)?(w=ub(k,"currency",!0),
k.splice(w,0,E)):(w=ub(k,"currency",!1),k.splice(w+1,0,E))),h=k),"default"!==c.symbolPosition&&(h=function(a,b,c){if("end"!==c||vb(b)){if("start"===c&&vb(b)){var d=0;"literal"===b[d].type&&d++;"minusSign"===b[d].type&&d++;b=Hd(b=Pe(a,b,c,d,!0),ub(b,"currency",!0),d)}}else b=Hd(b=Pe(a,b,c,b.length-1,!1),ub(b,"currency",!1),b.length-1);return b}(this.type,h,c.symbolPosition)),!h)throw Error("Intl.NumberFormat formatToParts returned empty");return"HIDE_IF_WHOLE"===this.resolveTrailingZeroDisplay(b.currencyCode)&&
(h=this.hideTrailingZeroIfInteger(a,c,h)),h.map(function(a){var b=a.type;a=a.value;return"currency"===b?(c.symbolOverrideApplied&&c.currencySymbol&&(a=c.currencySymbol),{type:b,value:a}):{type:b,value:a}})}},{key:"hideTrailingZeroIfInteger",value:function(a,b,c){return 0!=a.amount.toFixed(b.numberFormat.resolvedOptions().minimumFractionDigits)%1?c:c.filter(function(a){return"decimal"!==a.type&&"fraction"!==a.type})}},{key:"getNumberFormatFromCacheOrCreate",value:function(a,b,c){a=this.serializeNumberFormatCacheKey(a,
b,c);var f=this.numberFormatCache.get(a);return void 0===f&&(f=new Intl.NumberFormat(this.locale,function(a,b){return Object.assign({currency:a.currencyCode},function(a){return Object.assign({style:"currency",currencyDisplay:dh(a),useGrouping:"compact"!==a},"compact"===a?{maximumFractionDigits:0,minimumFractionDigits:0}:{})}(b))}(b,c)),this.numberFormatCache.set(a,f)),f}},{key:"serializeNumberFormatCacheKey",value:function(a,b,c){return"".concat(a,"-").concat(b.currencyCode,"-").concat(c)}}],[{key:"getInstance",
value:function(a){return(new this.Builder).withLocale(a).withType("amazonSymbol").build()}},{key:"getInstanceByType",value:function(a,b){return(new this.Builder).withLocale(a).withType(b).build()}},{key:"getInstanceByMarketplaceId",value:function(a,b){return(new this.Builder).withLocale(a).withType("amazonSymbol").withMarketplace(new Vd(b)).build()}},{key:"getInstanceByMarketplace",value:function(a,b){return(new this.Builder).withLocale(a).withType("amazonSymbol").withMarketplace(b).build()}},{key:"getInstanceByTypeAndMarketplaceId",
value:function(a,b,c){return(new this.Builder).withLocale(a).withType(b).withMarketplace(new Vd(c)).build()}},{key:"getInstanceByTypeAndMarketplace",value:function(a,b,c){return(new this.Builder).withLocale(a).withType(b).withMarketplace(c).build()}}])}();nd.Builder=((mg=function(){return B(function h(){A(this,h)},[{key:"withLocale",value:function(a){return this.locale=a,this}},{key:"withType",value:function(a){return this.type=a,this}},{key:"withMarketplace",value:function(a){return this.marketplace=
a,this}},{key:"withMarketplaceId",value:function(a){return this.marketplace=new Vd(a),this}},{key:"withTrailingZeroDisplay",value:function(a){return this.trailingZeroDisplay=a,this}},{key:"withLocalizationContext",value:function(a){this.locale=a.getLocale();this.localizationContext=a;a=a.asAttributesMap().get("marketplace");return a instanceof Td&&(this.marketplace=a),this}},{key:"build",value:function(){var a=this.marketplace||Qf.provider().getMarketplace();return new nd(this.locale,this.type||"amazonSymbol",
a,this.localizationContext||nd.Builder.DEFAULT_LC,this.trailingZeroDisplay)}}])}()).DEFAULT_LC=(new wb).build(),mg);var ti=function(){return B(function f(a,b){A(this,f);a||(a=(new Intl.NumberFormat).resolvedOptions().locale);b=b&&b.style?Qe(b.style):Qe("default");var c=new nd.Builder;if(void 0!==a.getLocale){a.getLocale();var h=a.asAttributesMap().get("marketplace");c.withLocalizationContext(a).withMarketplace(h)}else a=Array.isArray(a)?0===a.length?(new Intl.NumberFormat).resolvedOptions().locale:
a[0]:a,c.withLocale(a);this.priceFormat=c.withType(b).build()},[{key:"format",value:function(a){return this.priceFormat.format(a)}}])}(),ec=function(){function a(b){var c,f=this,h=1<arguments.length&&void 0!==arguments[1]?arguments[1]:a.defaultLocale,k=2<arguments.length?arguments[2]:void 0,w=3<arguments.length?arguments[3]:void 0;if(A(this,a),this.formatterCache={number:{},dateTime:{},pluralRules:{},price:{}},this.format=function(a){a=f.formatToParts(a);if(1===a.length)return a[0].value;a=a.reduce(function(a,
b){return a.length&&b.type===va.literal&&"string"==typeof a[a.length-1]?a[a.length-1]+=b.value:a.push(b.value),a},[]);return 1>=a.length?a[0]||"":a},this.formatToParts=function(a){return Ub(f.ast,f.localesOrLocalizationContext,f.formatters,f.formats,a,void 0,f.message,void 0,f.resolvedLocales)},this.formatToVdomParts=function(a,b){return function(a,b,d,c,f,h,k,w,E){return Ub(a,b,d,c,h,void 0,w,f,E).map(function(a){return a.value})}(f.ast,f.localesOrLocalizationContext,f.formatters,f.formats,a,b,0,
f.message,f.resolvedLocales)},this.resolvedOptions=function(){return{locale:f.resolvedLocale.toLocaleString()}},this.getAst=function(){return f.ast},this.localesOrLocalizationContext=h,this.resolvedLocales=a.resolveLocale(void 0!==h.getLocale?h.getLocale():h),Array.isArray(this.resolvedLocales)?this.resolvedLocale=new Intl.Locale(this.resolvedLocales[0]):this.resolvedLocale=new Intl.Locale(this.resolvedLocales),"string"==typeof b){if(this.message=b,!a.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");
this.ast=a.__parse(b,{ignoreTag:void 0!==w?w.ignoreTag:void 0,locale:this.resolvedLocale})}else this.ast=b;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=(c=a.formats,k?Object.keys(c).reduce(function(a,b){var d,q;return a[b]=(d=c[b],(q=k[b])?Object.assign(Object.assign(Object.assign({},d||{}),q||{}),Object.keys(d).reduce(function(a,b){return a[b]=Object.assign(Object.assign({},d[b]),q[b]||{}),a},{})):d),a},Object.assign({},c)):c);this.formatters=
w&&w.formatters||function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{number:{},dateTime:{},pluralRules:{},price:{}};return{getNumberFormat:mc(function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return Ka(Intl.NumberFormat,b)},{cache:sc(a.number),strategy:wc}),getDateTimeFormat:mc(function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return Ka(Intl.DateTimeFormat,b)},{cache:sc(a.dateTime),strategy:wc}),getPluralRules:mc(function(){for(var a=
arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return Ka(Intl.PluralRules,b)},{cache:sc(a.pluralRules),strategy:wc}),getPriceFormat:mc(function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return Ka(ti,b)},{cache:sc(a.price),strategy:wc})}}(this.formatterCache)}return B(a,null,[{key:"defaultLocale",get:function(){return a.memoizedDefaultLocale||(a.memoizedDefaultLocale=(new Intl.NumberFormat).resolvedOptions().locale),a.memoizedDefaultLocale}}])}();ec.memoizedDefaultLocale=
null;ec.resolveLocale=function(a){return nc.getCanonicalLocaleString(a)};ec.__parse=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};b=Object.assign({shouldParseSkeletons:!0,requiresOtherClause:!0},b);var c=(new Lh(a,b)).parse();if(c.err)throw b=SyntaxError(T[c.err.kind]),b.location=c.err.location,b.originalMessage=c.err.message,b;return b&&b.captureLocation||Ed(c.val),c.val};ec.formats={number:{integer:{maximumFractionDigits:0},currency:{style:"currency"},percent:{style:"percent"}},
date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}},price:{default:{style:"default"},
aui:{style:"aui"},iso:{style:"iso"},plural:{style:"plural"},amazon_symbol:{style:"amazon_symbol"},compact:{style:"compact"},in_sentence:{style:"in_sentence"}}};var ui=function(){return B(function D(a,b,c){A(this,D);this.message=a;this.context=b;this.options=c},[{key:"format",value:function(a){return void 0===this.formatter&&(this.formatter=new ec(this.message,this.context)),this.formatter.format(a)}}])}(),vi=function(){return B(function D(a,b,c){A(this,D);this.messages=a;this.baseName=b;this.context=
c},[{key:"getMessage",value:function(a){var b=this.messages.get(a);if(void 0===b)throw Error("Resource does not exist: bundle\x3d".concat(this.baseName,", key\x3d").concat(a,", context\x3d").concat(this.context));return b}},{key:"formatMessage",value:function(a,b){a=this.getMessage(a);return(new ui(a,this.context)).format(b)}}])}(),wi=Object.freeze({runtimeResourceFormat:"JsonFileHierarchy",fallbackMechanismAttributes:[["i18nDomain"]]}),se={};var og=function(){function a(a,b){var d=a[b];if("function"==
typeof d.bind)return d.bind(a);try{return Function.prototype.bind.call(d,a)}catch(xa){return function(){return Function.prototype.apply.apply(d,[a,arguments])}}}function b(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments]));console.trace&&console.trace()}function k(a,b){for(var c=0;c<d.length;c++){var g=d[c];this[g]=c<a?w:this.methodFactory(g,a,b)}this.log=this.debug}function f(a,b,d){return function(){"undefined"!==
("undefined"==typeof console?"undefined":ka(console))&&(k.call(this,b,d),this[a].apply(this,arguments))}}function p(d,c,g){var l=d;return("debug"===l&&(l="log"),"undefined"!==("undefined"==typeof console?"undefined":ka(console))&&("trace"===l&&E?b:void 0!==console[l]?a(console,l):void 0!==console.log?a(console,"log"):w))||f.apply(this,arguments)}function m(a,b,g){function l(){if("undefined"!==("undefined"==typeof c?"undefined":ka(c))&&h){try{var a=c.localStorage[h]}catch(Og){}if("undefined"===ka(a))try{var b=
c.document.cookie,d=b.indexOf(encodeURIComponent(h)+"\x3d");-1!==d&&(a=/^([^;]+)/.exec(b.slice(d))[1])}catch(Og){}return void 0===f.levels[a]&&(a=void 0),a}}var q,f=this;b=null==b?"WARN":b;var h="loglevel";"string"==typeof a?h+=":"+a:"symbol"===ka(a)&&(h=void 0);f.name=a;f.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5};f.methodFactory=g||p;f.getLevel=function(){return q};f.setLevel=function(b,g){if("string"==typeof b&&void 0!==f.levels[b.toUpperCase()]&&(b=f.levels[b.toUpperCase()]),!("number"==
typeof b&&0<=b&&b<=f.levels.SILENT))throw"log.setLevel() called with invalid level: "+b;q=b;if(!1!==g)a:if(g=(d[b]||"silent").toUpperCase(),"undefined"!==("undefined"==typeof c?"undefined":ka(c))&&h){try{c.localStorage[h]=g;break a}catch(Ce){}try{c.document.cookie=encodeURIComponent(h)+"\x3d"+g+";"}catch(Ce){}}if(k.call(f,b,a),"undefined"===("undefined"==typeof console?"undefined":ka(console))&&b<f.levels.SILENT)return"No console available for logging"};f.setDefaultLevel=function(a){b=a;l()||f.setLevel(a,
!1)};f.resetLevel=function(){f.setLevel(b,!1);a:if("undefined"!==("undefined"==typeof c?"undefined":ka(c))&&h){try{c.localStorage.removeItem(h);break a}catch(Oa){}try{c.document.cookie=encodeURIComponent(h)+"\x3d; expires\x3dThu, 01 Jan 1970 00:00:00 UTC"}catch(Oa){}}};f.enableAll=function(a){f.setLevel(f.levels.TRACE,a)};f.disableAll=function(a){f.setLevel(f.levels.SILENT,a)};g=l();null==g&&(g=b);f.setLevel(g,!1)}var w=function(){},E="undefined"!==("undefined"==typeof c?"undefined":ka(c))&&"undefined"!==
ka(c.navigator)&&/Trident\/|MSIE /.test(c.navigator.userAgent),d=["trace","debug","info","warn","error"],l=new m,q={};l.getLogger=function(a){if("symbol"!==ka(a)&&"string"!=typeof a||""===a)throw new TypeError("You must supply a name when creating a logger.");var b=q[a];return b||(b=q[a]=new m(a,l.getLevel(),l.methodFactory)),b};var g="undefined"!==("undefined"==typeof c?"undefined":ka(c))?c.log:void 0;return l.noConflict=function(){return"undefined"!==("undefined"==typeof c?"undefined":ka(c))&&c.log===
l&&(c.log=g),l},l.getLoggers=function(){return q},l.default=l,l};se?se=og():za.log=og();var Jb=se.getLogger("arb-js"),Pa={trace:function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];this.output("trace",b)},debug:function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];this.output("debug",b)},info:function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];this.output("info",b)},warn:function(){for(var a=arguments.length,b=Array(a),
c=0;c<a;c++)b[c]=arguments[c];this.output("warn",b)},error:function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];this.output("error",b)},isDebugEnabled:function(){return Jb.getLevel()<=Jb.levels.DEBUG},isInfoEnabled:function(){return Jb.getLevel()<=Jb.levels.INFO},output:function(a,b){b[0]="[".concat("arb-js","] ").concat(b[0]);Jb[a].apply(Jb,ya(b))}},xi={},fh=function(){return B(function f(a){A(this,f);this.RETRY_LIMIT=1;this.loaded={};this.options=Object.assign(Object.assign({},
xi),a)},[{key:"readManifest",value:function(a){return wi}},{key:"readResource",value:(a=ua(U().mark(function D(a){var b,c,f;return U().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:b=0;case 1:if(!(b<=this.RETRY_LIMIT)){d.next=29;break}if(c=void 0,d.prev=3,void 0!==(c=this.options.resolveBundleUrl(this.options,a))){d.next=8;break}return Pa.error("No resource endpoint found. Fallback item: ",a),d.abrupt("return");case 8:return void 0===this.loaded[c]?(Pa.info("Fetching ".concat(c," for fallback item: "),
a),this.loaded[c]=this.options.resolveResourcePack(c)):Pa.info("Request already fetched for fallback item: ",a),d.next=11,this.loaded[c];case 11:if(null!=(f=d.sent)){d.next=15;break}return Pa.error("Loading resource has failed. Fallback item: ",a),d.abrupt("return");case 15:return d.abrupt("return",f);case 18:if(d.prev=18,d.t0=d.catch(3),!(b<this.RETRY_LIMIT&&d.t0.retry&&c)){d.next=24;break}return Pa.info("Retrying request for ".concat(c,". Fallback item: "),a),this.loaded[c]=void 0,d.abrupt("continue",
26);case 24:return Pa.error("Failed to load resource. Error: ".concat(d.t0.message,". Fallback item: "),a),d.abrupt("break",29);case 26:b++;d.next=1;break;case 29:return d.abrupt("return",void 0);case 30:case "end":return d.stop()}},D,this,[[3,18]])})),function(b){return a.apply(this,arguments)})}]);var a}(),gh=function(a){function b(a){var c,h=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return A(this,b),(c=ca(this,b,[a])).retry=h,c.retry=h,c}return ea(b,a),B(b)}(Ja(Error)),pg=function(){return B(function D(a,
b){A(this,D);this.resourceReader=a;this.fallbackHandler=b;this.resourcesCache=new Gf(this.resourceReader.readResource.bind(this.resourceReader),{maxSize:D.RESOURCE_CACHE_SIZE,keyFn:Qd.cacheKey})},[{key:"load",value:(a=ua(U().mark(function S(a,b){var c,f,d,l,q,g,C,k,P,xa,ta,p,m,r,D=this;return U().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(c=new Map,f=this.resourceReader.readManifest(a)){w.next=4;break}throw Error("Manifest can not be null!");case 4:return d=this.fallbackHandler.getFallbackChains(a,
f.fallbackMechanismAttributes,b),Pa.info('Requesting resource packs for "'.concat(a,'" bundle. Localization context: %0'),b),w.next=8,eh('Resource pack requests for "'.concat(a,'" bundle'),ua(U().mark(function Pg(){var a,b,c,g;return U().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:a=[];b=W(d);try{for(b.s();!(c=b.n()).done;)g=c.value,a.push(D.resourcesCache.get(g))}catch(zd){b.e(zd)}finally{b.f()}return l.next=5,Promise.all(a);case 5:case "end":return l.stop()}},Pg)})));case 8:l=0,q=W(d),
w.prev=10,q.s();case 12:if((g=q.n()).done){w.next=25;break}return C=g.value,l++,w.next=17,this.resourcesCache.get(C);case 17:if(void 0!==(k=w.sent)&&void 0!==k[C.locale]&&void 0!==k[C.locale][C.bundle]){w.next=21;break}return Pa.debug("No bundled resources were found for %0",C),w.abrupt("continue",23);case 21:for(P=k[C.locale][C.bundle],xa=0,ta=Object.entries(P);xa<ta.length;xa++)p=Xa(ta[xa],2),m=p[0],r=p[1],c.has(m)||c.set(m,this.findMessage(r,C));case 23:w.next=12;break;case 25:w.next=30;break;
case 27:w.prev=27,w.t0=w.catch(10),q.e(w.t0);case 30:return w.prev=30,q.f(),w.finish(30);case 33:return 0===l&&Pa.error("The generated locale fallback chain was empty.This is bad as no context messages could be populated in MessageBundle."),w.abrupt("return",new vi(c,a,b));case 35:case "end":return w.stop()}},S,this,[[10,27,30,33]])})),function(b,c){return a.apply(this,arguments)})},{key:"findMessage",value:function(a,b){var c=ka(a);if("string"===c)return a;if("object"===c)return(b=this.findMatchingVariant(a,
b))?b.value:a.value;throw Error("Unsupported resource pack value type");}},{key:"findMatchingVariant",value:function(a,b){a=a.overrides;for(var c=a.length-1;0<=c;c--){for(var f=a[c],k=!0,d=0,l=Object.entries(f.localizationContext);d<l.length;d++){var q=Xa(l[d],2),g=q[0];q=q[1];if(b.variants&&(!b.variants.has(g)||b.variants.get(g)!==q)){k=!1;break}}if(k)return f}}}]);var a}();pg.RESOURCE_CACHE_SIZE=512;var Ue=function(){return B(function S(a,b){A(this,S);this.localizationContextProvider=a;this.asyncResourceReader=
b;a=new Hf;this.bundleLoader=new pg(b,a);this.bundleCache=new Gf(this.generateMessageBundle.bind(this),{maxSize:S.MESSAGE_BUNDLE_CACHE_SIZE,keyFn:Pd.generateCacheKey})},[{key:"generateMessageBundle",value:(b=ua(U().mark(function S(a){return U().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",this.bundleLoader.load(a.bundle,a.context));case 1:case "end":return b.stop()}},S,this)})),function(a){return b.apply(this,arguments)})},{key:"getBundle",value:(a=ua(U().mark(function E(a,
b){var d,c,q;return U().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return d=b||this.localizationContextProvider.getLocalizationContext(),c=new Pd(a,d),g.next=4,this.bundleCache.get(c);case 4:return q=g.sent,g.abrupt("return",q);case 6:case "end":return g.stop()}},E,this)})),function(b,c){return a.apply(this,arguments)})}]);var a,b}();Ue.MESSAGE_BUNDLE_CACHE_SIZE=512;var ih={endpointMap:{ar:{strings:"translation-ar.json"},"ar-AE":{strings:"translation-ar.json"},de:{strings:"translation-de.json"},
"de-DE":{strings:"translation-de.json"},en:{strings:"translation-en.json"},"en-CA":{strings:"translation-en.json"},"en-GB":{strings:"translation-en.json"},"en-IN":{strings:"translation-en.json"},"en-US":{strings:"translation-en.json"},es:{strings:"translation-es.json"},"es-ES":{strings:"translation-es.json"},"es-US":{strings:"translation-es.json"},fr:{strings:"translation-fr.json"},"fr-CA":{strings:"translation-fr.json"},"fr-FR":{strings:"translation-fr.json"},he:{strings:"translation-he.json"},"he-IL":{strings:"translation-he.json"},
it:{strings:"translation-it.json"},"it-IT":{strings:"translation-it.json"},ja:{strings:"translation-ja.json"},"ja-JP":{strings:"translation-ja.json"},ko:{strings:"translation-ko.json"},"ko-KR":{strings:"translation-ko.json"},pt:{strings:"translation-pt.json"},"pt-BR":{strings:"translation-pt.json"},"pt-PT":{strings:"translation-pt.json"},und:{strings:"translation.json"},zh:{strings:"translation-zh.json"},"zh-CN":{strings:"translation-zh.json"},"zh-TW":{strings:"translation-zh.json"}}},jh=new Map([["translations/translation.json",
O(254)],["translations/translation-ar.json",O(278)],["translations/translation-de.json",O(214)],["translations/translation-en.json",O(494)],["translations/translation-es.json",O(45)],["translations/translation-he.json",O(602)],["translations/translation-ko.json",O(743)],["translations/translation-pt.json",O(61)],["translations/translation-zh.json",O(847)],["translations/translation-fr.json",O(925)],["translations/translation-it.json",O(992)],["translations/translation-ja.json",O(300)]]),od=r(function h(){var b=
this,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";z(this,h);a(this,"missingElements",[]);a(this,"getElementOrRecordMissing",function(a){var c=1<arguments.length&&void 0!==arguments[1]&&arguments[1],f=document.getElementById(a);!f&&(b.missingElements.push(a),c)&&(c=b.sourceComponentName?"[".concat(b.sourceComponentName,"] "):"",k.logErrorWithLevel(H.ERROR,"".concat(c,"Rufus element ID was not found: ").concat(a)));return f});a(this,"getMissingElements",function(){return b.missingElements});
a(this,"logMissingElementsAndThrowError",function(){if(0<b.missingElements.length){var a=b.sourceComponentName?"[".concat(b.sourceComponentName,"] "):"";a="".concat(a,"Rufus element IDs were not found: ").concat(b.missingElements.join(", "));throw k.logErrorWithLevel(H.ERROR,a),Error(a);}});this.sourceComponentName=c}),na=function(){function a(){z(this,a);this.weblabTreatmentsMap=this.getWeblabTreatmentsMap()}return r(a,[{key:"parseWeblabTreatmentsMap",value:function(a){var b=this,c={};if(!a)return c;
try{a.slice(1,-1).split(",").forEach(function(a){a=Na(a.trim().split("\x3d"),2);var f=a[1];c[a[0].trim()]=b.isTreatmentNull(f.trim())?void 0:f.trim()}),k.addCount(p.RUFUS_CLIENT_WEBLAB_TREATMENTS_PARSED,1)}catch(S){k.logErrorWithLevelWithException(H.ERROR,S,"Could not parse the weblab treatments, weblabTreatments: ".concat(a))}return c}},{key:"isTreatmentNull",value:function(a){return"null"===a||"undefined"===a}},{key:"getWeblabTreatmentsMap",value:function(){var a=nb("clientWeblabTreatmentMap");
return this.parseWeblabTreatmentsMap(a)}},{key:"getWeblabTreatment",value:function(a){var b;return null===(b=this.weblabTreatmentsMap)||void 0===b?void 0:b[a]}},{key:"getWeblabTreatments",value:function(a){var b=this;return a.map(function(a){var c;return null===(c=b.weblabTreatmentsMap)||void 0===c?void 0:c[a]})}},{key:"isWeblabTreatmentEnabledAndRecordTrigger",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"T1",c=this.getWeblabTreatment(a);return c&&k.recordTrigger(a,
c),c===b}}],[{key:"getInstance",value:function(){return a.instance||(a.instance=new a),a.instance}}])}(),lb=function(){function a(){z(this,a);var b=(new od("ErrorRenderer")).getElementOrRecordMissing("rufus-active-conversation-container",!0),c=document.getElementById("rufus-error-container");c?this.errorContainer=c:(c=document.createElement("div"),c.classList.add("rufus-error-container"),c.id="rufus-error-container",null==b||b.insertAdjacentElement("afterend",c),this.errorContainer=c)}return r(a,
null,[{key:"initialize",value:function(){a.instance=new a}},{key:"renderError",value:function(b){this.logCount(b.errorCode);a.resetErrorContainer();a.hideLoader();a.populateErrorContainerInner(b.errorCode,b.errorMessage,b.retryCallback);a.getInstance().currentErrorCode=b.errorCode}},{key:"removeError",value:function(b){a.getInstance().currentErrorCode===b&&a.resetErrorContainer()}},{key:"getInstance",value:function(){return a.instance||(a.initialize(),k.logErrorWithLevel(H.ERROR,"ErrorRenderer should be initialized at the top level before calling renderError")),
a.instance}},{key:"logCount",value:function(a){k.addCount(p.RENDERED_ERROR_CODE_PREFIX+a,1)}},{key:"resetErrorContainer",value:function(){a.getInstance().errorContainer.innerHTML="";a.getInstance().currentErrorCode=void 0}},{key:"hideLoader",value:function(){var a=document.getElementById("rufus-conversation-loader-container");null==a||a.classList.add("aok-hidden")}},{key:"populateErrorContainerInner",value:function(b,c,h){var f=a.getInstance(),k=document.createElement("div");k.classList.add("rufus-error-container-inner",
"rufus-remove-section");b&&k.setAttribute("data-error-code",b.toString());a.shouldApplyAvatarPadding()&&k.classList.add("rufus-avatar-padding");a.renderErrorMessage(k,c);h&&a.renderRetryButton(k,h);f.errorContainer.appendChild(k)}},{key:"shouldApplyAvatarPadding",value:function(){var a=document.getElementById("rufus-history-container"),b=document.getElementById("rufus-active-conversation-container"),c=na.getInstance().getWeblabTreatment("RUFUS_DESKTOP_VISUAL_BRANDING_UPDATE_1201601");return(this.hasConversation(b)||
this.hasConversation(a))&&"T1"!==c&&"T2"!==c}},{key:"hasConversation",value:function(a){return!!(a&&0<a.children.length)&&Array.from(a.children).some(function(a){return 0<a.children.length})}},{key:"renderErrorMessage",value:(b=G(Q().mark(function w(a,b){var c,d,l;return Q().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:if(c=document.createElement("div"),q.prev=1,"offline_error_message"!==b&&void 0!==b){q.next=10;break}return d="offline_error_message"===b?"offline_error_message":"default_error_message",
q.next=6,Te(document.documentElement.lang);case 6:l=q.sent;c.innerHTML=l.getMessage(d);q.next=11;break;case 10:c.innerHTML=b;case 11:q.next=17;break;case 13:q.prev=13,q.t0=q.catch(1),k.logErrorWithLevel(H.ERROR,"Failed to load translation bundle",q.t0 instanceof Error?q.t0.message:String(q.t0)),c.innerHTML="Something went wrong. Please try again later.";case 17:return q.prev=17,c.classList.add("rufus-error-text"),a.appendChild(c),q.finish(17);case 21:case "end":return q.stop()}},w,null,[[1,13,17,
21]])})),function(a,c){return b.apply(this,arguments)})},{key:"renderRetryButton",value:function(a,b){var c=document.createElement("span");c.classList.add("rufus-retry-button-container","a-button","a-button-toggle","system-pill");var h=document.createElement("span");h.classList.add("a-button-inner");var d=document.createElement("button");d.classList.add("rufus-retry-button","a-button-text","a-text-center");d.type="button";var l=document.createElement("span");l.classList.add("a-color-link");l.textContent=
"Retry";d.appendChild(l);h.appendChild(d);c.appendChild(h);a.appendChild(c);d.addEventListener("click",function(){b()})}},{key:"destroy",value:function(){a.instance=void 0}}]);var b}(),yi=r(function x(){z(this,x);a(this,"firstInferenceChunkProcessed",!1);a(this,"activeChunk",{});a(this,"patchMap",{})}),qg=r(function f(){z(this,f);a(this,"renderingTimestamps",[]);a(this,"networkTimestamps",[]);a(this,"backendTimestamps",[])}),pd=function(a){return a.NEW_STREAM="NEW_STREAM",a.SSE_ERROR="SSE_ERROR",
a.TIMEOUT="TIMEOUT",a.PAGE_NAVIGATION="PAGE_NAVIGATION",a.UNKNOWN="UNKNOWN",a}({}),rg=r(function S(b){z(this,S);a(this,"activeChunkPatchIds",[]);a(this,"chunkFirstReceivedMap",new Map);a(this,"latencyData",new yi);this.tabId=b}),qd=function(a,b){if(!(this instanceof qd))return new qd(a,b);this.INITIALIZING=-1;this.CONNECTING=0;this.OPEN=1;this.CLOSED=2;this.url=a;b=b||{};this.headers=b.headers||{};this.payload=void 0!==b.payload?b.payload:"";this.method=b.method||this.payload&&"POST"||"GET";this.withCredentials=
!!b.withCredentials;this.debug=!!b.debug;this.FIELD_SEPARATOR=":";this.listeners={};this.xhr=null;this.readyState=this.INITIALIZING;this.progress=0;this.lastEventId=this.chunk="";this.addEventListener=function(a,b){void 0===this.listeners[a]&&(this.listeners[a]=[]);-1===this.listeners[a].indexOf(b)&&this.listeners[a].push(b)};this.removeEventListener=function(a,b){if(void 0!==this.listeners[a]){var c=[];this.listeners[a].forEach(function(a){a!==b&&c.push(a)});0===c.length?delete this.listeners[a]:
this.listeners[a]=c}};this.dispatchEvent=function(a){if(!a)return!0;this.debug&&console.debug(a);a.source=this;var b="on"+a.type;return(!this.hasOwnProperty(b)||(this[b].call(this,a),!a.defaultPrevented))&&(!this.listeners[a.type]||this.listeners[a.type].every(function(b){return b(a),!a.defaultPrevented}))};this._markClosed=function(){this.xhr=null;this._setReadyState(this.CLOSED)};this._setReadyState=function(a){var b=new CustomEvent("readystatechange");this.readyState=b.readyState=a;this.dispatchEvent(b)};
this._onStreamFailure=function(a){var b=new CustomEvent("error");b.responseCode=a.currentTarget.status;b.data=a.currentTarget.response;this.dispatchEvent(b);this._markClosed()};this._onStreamAbort=function(){this.dispatchEvent(new CustomEvent("abort"));this._markClosed()};this._onStreamProgress=function(a){if(this.xhr)if(200===this.xhr.status){a=this.xhr.responseText.substring(this.progress);this.progress+=a.length;a=(this.chunk+a).split(/(\r\n\r\n|\r\r|\n\n)/g);var b=a.pop();a.forEach(function(a){0<
a.trim().length&&this.dispatchEvent(this._parseEventChunk(a))}.bind(this));this.chunk=b}else this._onStreamFailure(a)};this._onStreamLoaded=function(a){this._onStreamProgress(a);this.dispatchEvent(this._parseEventChunk(this.chunk));this.chunk="";this._markClosed()};this._preProcessChunk=function(a){var b,c=[],l=!1;a=Ve(a.split(/\n|\r\n|\r/));try{for(a.s();!(b=a.n()).done;){var q=b.value,g=q.trim();g.startsWith("data:")?(l=!0,c.push(q)):g.startsWith("event:")||g.startsWith("id:")||""===g?(l=!1,c.push(q)):
l?c.push("data: ".concat(g)):c.push(q)}}catch(C){a.e(C)}finally{a.f()}return c.join("\n")};this._parseEventChunk=function(a){if(!a||0===a.length)return null;this.debug&&console.debug(a);a=this._preProcessChunk(a);var b={id:null,retry:null,data:null,event:null};a.split(/\n|\r\n|\r/).forEach(function(a){var c=a.indexOf(this.FIELD_SEPARATOR);if(0<c){var d=" "===a[c+1]?2:1;var g=a.substring(0,c);a=a.substring(c+d)}else{if(!(0>c))return;g=a;a=""}g in b&&("data"===g&&null!==b[g]?b.data+="\n"+a:b[g]=a)}.bind(this));
null!==b.id&&(this.lastEventId=b.id);a=new CustomEvent(b.event||"message");return a.id=b.id,a.data=b.data||"",a.lastEventId=this.lastEventId,a};this._onReadyStateChange=function(){if(this.xhr&&this.xhr.readyState===XMLHttpRequest.HEADERS_RECEIVED){var a,b={},c=Ve(this.xhr.getAllResponseHeaders().trim().split("\r\n"));try{for(c.s();!(a=c.n()).done;){var l;var q=ta=a.value.split(":");var g=Array.isArray(q)?q:void 0;(l=g)||(l="undefined"!=typeof Symbol&&null!=ta[Symbol.iterator]||null!=ta["@@iterator"]?
Array.from(ta):void 0);var C;if(!(C=l||We(ta)))throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");var k=C,P=k[0],xa=k.slice(1).join(":").trim();b[P.trim().toLowerCase()]=b[P.trim().toLowerCase()]||[];b[P.trim().toLowerCase()].push(xa)}}catch(Ua){c.e(Ua)}finally{c.f()}a=new CustomEvent("open");a.responseCode=this.xhr.status;a.headers=b;this.dispatchEvent(a);this._setReadyState(this.OPEN)}var ta};
this.stream=function(){if(!this.xhr){for(var a in this._setReadyState(this.CONNECTING),this.xhr=new XMLHttpRequest,this.xhr.addEventListener("progress",this._onStreamProgress.bind(this)),this.xhr.addEventListener("load",this._onStreamLoaded.bind(this)),this.xhr.addEventListener("readystatechange",this._onReadyStateChange.bind(this)),this.xhr.addEventListener("error",this._onStreamFailure.bind(this)),this.xhr.addEventListener("abort",this._onStreamAbort.bind(this)),this.xhr.open(this.method,this.url),
this.headers)this.xhr.setRequestHeader(a,this.headers[a]);0<this.lastEventId.length&&this.xhr.setRequestHeader("Last-Event-ID",this.lastEventId);this.xhr.withCredentials=this.withCredentials;this.xhr.send(this.payload)}};this.close=function(){this.readyState!==this.CLOSED&&this.xhr.abort()};(void 0===b.start||b.start)&&this.stream()};"undefined"!=typeof exports&&(exports.SSE=qd);var sg,wa=function(a){return a.SEARCH_RESULTS="SEARCH_RESULTS",a.DETAIL_PAGE="DETAIL_PAGE",a.GATEWAY="GATEWAY",a.UNKNOWN=
"UNKNOWN",a}({}),Ze=(sg=a(a(a(a({},wa.DETAIL_PAGE,["ATVDetail","Detail","MASDetailPage","MoneraDetailPage"]),wa.SEARCH_RESULTS,["Search"]),wa.GATEWAY,["Gateway"]),wa.UNKNOWN,["Unknown"]),Object.fromEntries(Object.entries(sg).flatMap(function(a){a=Na(a,2);var b=a[0];return a[1].map(function(a){return[a,b]})}))),L=r(function S(){z(this,S)});a(L,"timeouts",new Map);a(L,"startTimeout",function(a,b,c){L.validateTimeoutId(a)&&(L.clear(a),b=L.createTimeoutInfo(b,c),L.setTimeoutWithCallback(a,b))});a(L,"extendTimeout",
function(a,b){var c=L.timeouts.get(a);if(!c)return!1;void 0!==c.id&&clearTimeout(c.id);b=L.calculateExtendedDuration(c,b).newDuration;b=L.updateTimeoutInfo(c,b);return void 0===c.pausedAt?L.setTimeoutWithCallback(a,b):L.timeouts.set(a,b),!0});a(L,"pauseTimeout",function(a){var b=L.timeouts.get(a);if(!b||void 0!==b.pausedAt)return!1;L.clearExistingTimeout(b);b=L.createPausedTimeoutInfo(b);return L.timeouts.set(a,b),!0});a(L,"resumeTimeout",function(a){var b=L.timeouts.get(a);if(!b||void 0===b.pausedAt)return!1;
b=L.createResumedTimeoutInfo(b);return L.setTimeoutWithCallback(a,b),!0});a(L,"clear",function(a){var b=L.timeouts.get(a);return!!b&&(L.clearExistingTimeout(b),L.timeouts.delete(a),!0)});a(L,"clearTimeouts",function(a){a.forEach(function(a){L.clear(a)})});a(L,"hasTimeout",function(a){return L.timeouts.has(a)});a(L,"validateTimeoutId",function(a){return!!a||(k.logErrorWithLevel(H.ERROR,"Empty timeout id. Timeout id must be a non-empty string."),!1)});a(L,"createTimeoutInfo",function(a,b){return{id:void 0,
callback:a,startTime:Date.now(),duration:b,pausedAt:void 0}});a(L,"setTimeoutWithCallback",function(a,b){var c=setTimeout(function(){L.timeouts.delete(a);b.callback()},b.duration);L.timeouts.set(a,gb(gb({},b),{},{id:c}))});a(L,"calculateExtendedDuration",function(a,b){var c,d,l=Date.now();return void 0!==a.pausedAt?(c=a.pausedAt-a.startTime,d=a.duration-c+b):(c=l-a.startTime,d=Math.max(0,a.duration-c)+b),{elapsedTime:c,newDuration:d}});a(L,"updateTimeoutInfo",function(a,b){return gb(gb({},a),{},{id:void 0,
startTime:Date.now(),duration:b})});a(L,"createPausedTimeoutInfo",function(a){var b=Date.now(),c=Math.max(0,a.duration-(b-a.startTime));return gb(gb({},a),{},{id:void 0,duration:c,pausedAt:b})});a(L,"createResumedTimeoutInfo",function(a){return gb(gb({},a),{},{id:void 0,startTime:Date.now(),pausedAt:void 0})});a(L,"clearExistingTimeout",function(a){void 0!==a.id&&clearTimeout(a.id)});var Kb=function(){function b(){var c=this;z(this,b);a(this,"loggers",new Map);a(this,"initialize",function(a,b){c.loggers.set(a.configName,
new zi(a,b))});a(this,"getLogger",function(a){return c.loggers.get(a)})}return r(b,null,[{key:"getInstance",value:function(){return b.instance||(b.instance=new b),b.instance}}])}(),zi=r(function d(b,c){var l=this;z(this,d);a(this,"setMarker",function(a){var b=l.markers.findIndex(function(b){return b.name===a});-1!==b?l.markers[b].timestamp=Date.now():k.logErrorWithLevel(H.WARN,'Marker "'.concat(a,'" not found in configuration.'))});a(this,"skipMarker",function(a){var b=l.markers.findIndex(function(b){return b.name===
a});-1!==b?l.markers[b].timestamp=null:k.logErrorWithLevel(H.WARN,'Marker "'.concat(a,'" not found in configuration.'))});a(this,"markerProcessed",function(a){var b=l.markers.findIndex(function(b){return b.name===a});return-1!==b&&void 0!==l.markers[b].timestamp});a(this,"emitMetrics",function(){if(l.allMarkersProcessed()){var a=l.calculateLatencyMetrics();l.emitCSMLatencyMetrics(a)}});a(this,"allMarkersProcessed",function(){return l.markers.every(function(a){return void 0!==a.timestamp})});a(this,
"calculateLatencyMetrics",function(){return l.markers.map(function(a){var b=l.config.markers.findIndex(function(b){return b.name===a.name});return{timestamp:a.timestamp,csmLatencyEvent:l.config.markers[b].csmLatencyEvent,biMetricName:l.config.markers[b].biMetricName}})});a(this,"emitCSMLatencyMetrics",function(a){var b=l.config.configName;k.widgetBodyBegin(b,l.startTime);a.map(function(a){a.timestamp&&k.logCsmFeatureLatency(a.csmLatencyEvent,b,a.timestamp)});k.widgetBodyEnd(b)});this.startTime=null!=
c?c:Date.now();this.config=b;this.markers=b.markers.map(function(a){return{name:a.name,timestamp:void 0}})}),rd={configName:"RUFUS_USER_PERCEIVED_LATENCY",markers:[{name:"initialized",biMetricName:"RUFUS_INITIALIZE_UPL",csmLatencyEvent:ib.ClickToATF},{name:"initial_streaming_first_chunk_received",biMetricName:"RUFUS_INITIAL_STREAMING_FIRST_CHUNK_UPL",csmLatencyEvent:ib.ClickToCF}]},tg={configName:"RUFUS_USER_PERCEIVED_LATENCY_BF_CACHE",markers:[{name:"initialized",biMetricName:"RUFUS_INITIALIZE_BF_CACHE_UPL",
csmLatencyEvent:ib.ClickToATF},{name:"initial_streaming_first_chunk_received",biMetricName:"RUFUS_INITIAL_STREAMING_FIRST_CHUNK_BF_CACHE_UPL",csmLatencyEvent:ib.ClickToCF}]},aa=function(a){return a.CLOSE="close",a.INTERNAL_ERROR="internal_error",a.SOFTLANDING_ERROR="softlanding_error",a.UNSUPPORTED_QUERY_ERROR="unsupported_query_error",a.CONTEXT="context",a.AFFORDANCE="affordance",a.MESSAGE="message",a.INTERIM="interim",a.INFERENCE="inference",a.CURATED_ANSWER="curated_answer",a.FEEDBACK="feedback",
a.UNKNOWN="unknown",a.REMOVE="remove",a}({}),ra=function(a){return a.OPEN="open",a.STREAMING="streaming",a.CLOSED="closed",a.ERROR="error",a}({}),ug=function(b){function c(b,d,g,C){var l;return z(this,c),a(l=function(a,b,c){return b=y(b),R(a,af()?Reflect.construct(b,[],y(a).constructor):b.apply(a,c))}(this,c),"startInitialStreamingCall",function(a){var b=Za(a.pageType),c=a.qis,d=a.metadata;l.startStream({actionType:l.getInitialStreamingActionType(b,c),isInitialStream:!0,qis:c,externalQuery:l.getInitialStreamingExternalQuery(a.keyword,
c),metadata:d,reftag:K.extractNileReftagFromUrl(K.getCurrentPageUrl())})}),a(l,"genericStreamingEventHandler",function(a){l.eventSource?(l.shouldUseRufusCommonModule?l.streamingLogger.setChunkReceived(a,l.streamingStatus,!0):l.streamingLogger.setChunkReceived(a,l.streamingStatus),L.clearTimeouts(c.streamingTimeoutIds),L.startTimeout("midstream_timeout",l.streamTimeoutHandler,4E4),l.shouldUseRufusCommonModule?l.dispatch("onEventReceivedV2",{event:a,streamingStatusDetails:l.streamingStatus,streamingEventType:a.type}):
l.dispatch("onEventReceived",{event:a,streamingStatusDetails:l.streamingStatus,streamingEventType:a.type}),Object.values(aa).includes(a.type)||k.logErrorWithLevel(H.ERROR,"Unsupported event type ".concat(a.type," received"))):(k.logErrorWithLevel(H.ERROR,"SSE stream event received with undefined event source: ".concat(a.type)),lb.renderError({errorCode:xb.UNDEFINED_EVENT_SOURCE}))}),a(l,"streamOpenHandler",function(){l.setStreamingStatus({streamingStatus:ra.OPEN});l.streamingLogger.openStreamingRequest()}),
a(l,"streamCloseEventHandler",function(){l.setStreamingStatus({streamingStatus:ra.CLOSED});L.clearTimeouts(c.streamingTimeoutIds);l.eventSource&&l.streamingLogger.closeStreamingRequest()}),a(l,"streamErrorHandler",function(a){if(l.setStreamingStatus({streamingStatus:ra.ERROR}),L.clearTimeouts(c.streamingTimeoutIds),navigator.onLine)a=l.getResponseCode(a),l.streamingLogger.handleStreamError(pd.SSE_ERROR,a),lb.renderError({errorCode:xb.SSE_HANDLER_ERROR})}),a(l,"streamTimeoutHandler",function(){l.setStreamingStatus({streamingStatus:ra.ERROR});
L.clearTimeouts(c.streamingTimeoutIds);l.abortCurrentStream(pd.TIMEOUT);lb.renderError({errorCode:xb.TIMEOUT})}),l.A=b,l.contextManager=d,l.tabId=g,l.streamingLogger=C,l.streamingStatus={streamingStatus:void 0,actionType:void 0,inputQuery:void 0,asinId:void 0,isInitialStream:void 0,requestContext:void 0,metadata:void 0},l.isBfcacheNavigation=!1,l.shouldUseRufusCommonModule=na.getInstance().isWeblabTreatmentEnabledAndRecordTrigger("RUFUS_ORTELIUS_COMPLETE_DIALUP_1259431")||na.getInstance().isWeblabTreatmentEnabledAndRecordTrigger("RUFUS_COMMON_ASSETS_MIGRATION_CL_1189218"),
l}return Aa(c,b),r(c,[{key:"startStream",value:(d=G(Q().mark(function g(a){var b,c,d,q,k,E,w,p,m,r,u,y,z;return Q().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(c=a.actionType,d=a.inputQuery,q=a.asinId,k=a.isInitialStream,E=a.qis,w=a.externalQuery,p=a.metadata,m=a.reftag,this.abortCurrentStream(pd.NEW_STREAM),this.streamingLogger.startStreamingRequest(c),r=this.contextManager.buildContext(c,d,q,k,E,w,p,this.shouldUseRufusCommonModule),u=null===(b=r.bottomSheetContext)||void 0===b?void 0:
b.bottomSheetEmpty,c!==Z.SWIPE_UP||!1!==u){g.next=9;break}return null===(y=Kb.getInstance().getLogger(rd.configName))||void 0===y||y.skipMarker("initial_streaming_first_chunk_received"),this.dispatch("invalidatePanelCache",!1),g.abrupt("return");case 9:this.dispatch("saveRequestMetadataToPanelCache",{actionType:c,inputQuery:d,asinId:q,isInitialStream:k,qis:E,externalQuery:w,metadata:p,reftag:m}),k&&this.isBfcacheNavigation&&J(F.BACK_NAVIGATION),z=this.getUrl(m),this.setStreamingStatus({streamingStatus:ra.STREAMING,
actionType:c,requestContext:r,inputQuery:null!=d?d:void 0,asinId:null!=q?q:void 0,isInitialStream:!0===k,metadata:null!=p?p:void 0}),L.startTimeout("initial_chunk_timeout",this.streamTimeoutHandler,4E4),this.initEventSource(z,r);case 15:case "end":return g.stop()}},g,this)})),function(a){return d.apply(this,arguments)})},{key:"getStreamingStatus",value:function(){return this.streamingStatus}},{key:"abortCurrentStream",value:function(a){this.eventSource&&(this.streamingStatus.streamingStatus!==ra.CLOSED&&
this.streamingLogger.handleRequestInterrupted(a),this.eventSource.close(),this.eventSource=void 0)}},{key:"setIsBfcacheNavigation",value:function(a){this.isBfcacheNavigation=a}},{key:"getIsRufusStayBehaviorRequired",value:function(){return this.contextManager.getIsRufusStayBehaviorRequired()}},{key:"initEventSource",value:function(b,c){var d=document.querySelector('meta[name\x3d"flow-closure-id"]');d=d instanceof HTMLMetaElement&&d.content?d.content:void 0;this.eventSource=new qd(b,{payload:JSON.stringify(c),
method:"POST",headers:kh(a(a({},jb.CONTENT_TYPE,"application/json"),jb.ANTI_CSRF_TOKEN,Md()),void 0!==d&&a({},jb.FLOW_CLOSURE_ID,d))});this.eventSource.onopen=this.streamOpenHandler;b=0;for(c=Object.values(aa);b<c.length;b++)d=c[b],this.eventSource.addEventListener(d,this.getEventHandler(d));this.eventSource.onerror=this.streamErrorHandler}},{key:"getEventHandler",value:function(a){return a===aa.CLOSE?this.streamCloseEventHandler:this.genericStreamingEventHandler}},{key:"setStreamingStatus",value:function(a){var b=
a.streamingStatus,c=a.actionType,d=a.inputQuery,q=a.asinId,k=a.isInitialStream;a=a.requestContext;b={streamingStatus:void 0===b?this.streamingStatus.streamingStatus:b,actionType:void 0===c?this.streamingStatus.actionType:c,inputQuery:void 0===d?this.streamingStatus.inputQuery:d,asinId:void 0===q?this.streamingStatus.asinId:q,isInitialStream:void 0===k?this.streamingStatus.isInitialStream:k,requestContext:void 0===a?this.streamingStatus.requestContext:a};this.dispatch("onStreamingStatusChange",b);
this.streamingStatus=b}},{key:"getResponseCode",value:function(a){try{var b=JSON.stringify(a);return JSON.parse(b).responseCode}catch(C){return console.error("".concat("StreamingClient"," - Error parsing SSEvent ").concat(C instanceof Error?"(".concat(C.message,")"):"")),"unknown"}}},{key:"getUrl",value:function(a){var b=this.A.$(location).attr("href");b=new URL(b);return b.search="?tabId\x3d".concat(this.tabId),b.hash="",b.pathname="/rufus/cl/streaming",a&&b.searchParams.append("ref",a),this.shouldUseRufusCommonModule&&
b.searchParams.append("programId","NILE_CLASSIC"),b.toString()}},{key:"shouldShowDeepLinkFallbackCX",value:function(a){return!(a!==Ma.NILE_INGRESS_LINK||"T1"!==na.getInstance().getWeblabTreatment("RUFUS_DESKTOP_DEEP_LINK_FALLBACK_1106261"))}},{key:"getInitialStreamingExternalQuery",value:function(a,b){return this.shouldShowDeepLinkFallbackCX(b)?void 0:a}},{key:"getInitialStreamingActionType",value:function(a,b){if(Object.values(Ma).includes(b))return this.shouldShowDeepLinkFallbackCX(b)?Z.SWIPE_UP:
Z.SEARCH;switch(a){case wa.SEARCH_RESULTS:return a=K.extractQueryFromUrl(K.getCurrentPageUrl()),b=this.contextManager.getSearchBarQuery(),a||b?Z.SEARCH:Z.SWIPE_UP;case wa.DETAIL_PAGE:return Z.ASIN_CLICK;default:return Z.SWIPE_UP}}}]);var d}(Ga);a(ug,"streamingTimeoutIds",["initial_chunk_timeout","midstream_timeout"]);var Ai=function(a){function b(a){z(this,b);var c=b;var d=(c=y(c),R(this,bf()?Reflect.construct(c,[],y(this).constructor):c.apply(this,void 0)));return d.A=a,d.initialize(),d}return Aa(b,
a),r(b,[{key:"initialize",value:function(){this.registerOnClickedAction(this.A)}},{key:"registerOnClickedAction",value:function(a){var c=this;a.declarative("rufus-action","click",function(a){void 0!==a.data.action?(a=b.eventDataToActionData(a.data),c.onAction(a)):void 0!==a.data.actionType&&c.onAction(b.eventDataToAction(a.data))})}},{key:"onAction",value:function(a){this.dispatch("onAction",a)}}],[{key:"eventDataToActionData",value:function(a){return new yf(a.action,null==a?void 0:a.query,null==
a?void 0:a.sectionId,null==a?void 0:a.clickEventName)}},{key:"eventDataToAction",value:function(a){return new yf(a)}}])}(Ga),te=function(){return r(function E(){z(this,E)},null,[{key:"isWDCSSection",value:function(a,b){return"ReviewAspectPillCarousel"===a&&b===qa.NILE_NDSWDCS_RELATED_QUESTION}}])}();a(te,"removeDataMixClaimedAttribute",function(a){var b;a=a.querySelector("#cr-product-insights-cards");null==a||null===(b=a.parentElement)||void 0===b||b.removeAttribute("data-mix-claimed")});var vg=function(a,
b,c){k.logErrorWithLevel(H.ERROR,"".concat(a.toLowerCase()," resolution image could not be ").concat(b.toLowerCase(),"ed due to error: ").concat(c));k.addCount("ERROR_ON_".concat(b,"ING_").concat(a,"_RES_IMAGE"),1);k.widgetBodyEnd("RUFUS_".concat(a,"_RESOLUTION_IMAGE_").concat(b,"ED_LATENCY"),!0)},Y=function(){function a(){z(this,a)}return r(a,null,[{key:"handleLinkWrapperLeftClick",value:function(b,c){var d=a.getAnchorElement(c);b=b(c);var q=c.metaKey;c.ctrlKey||q?a.handleModifierKeyLeftClick(b):
a.handleStandardLeftClick(c,b,null==d?void 0:d.href)}},{key:"handleModifierKeyLeftClick",value:function(a){a&&k.addCount(p.RUFUS_HYPERLINK_CLICK_PREFIX+"OPENED_IN_NEW_TAB_"+a,1)}},{key:"handleStandardLeftClick",value:function(a,b,l){a.preventDefault();b&&k.addCount(p.RUFUS_HYPERLINK_CLICK_PREFIX+"OPENED_IN_CURRENT_TAB_"+b,1);l&&c.location.assign(l)}},{key:"handleLinkWrapperAuxClick",value:function(a,b){(a=a(b))&&k.addCount(p.RUFUS_HYPERLINK_CLICK_PREFIX+"OPENED_IN_NEW_TAB_"+a,1)}},{key:"handleLinkWrapperOpenContextMenu",
value:function(a,b){(a=a(b))&&k.addCount(p.RUFUS_HYPERLINK_CLICK_PREFIX+"OPENED_CONTEXT_MENU_"+a,1)}},{key:"getAnchorElement",value:function(a){return a.currentTarget instanceof HTMLAnchorElement?a.currentTarget:void 0}}])}();a(Y,"LINK_WRAPPER_CLASS_NAME","rufus-link-wrapper");a(Y,"ASIN_FACEOUT_LINK_SELECTOR",".rufus-asin-faceout-wrapper a");a(Y,"ASIN_FACEOUT_DATA_SECTION_CLASS","AsinFaceoutList");a(Y,"addListeners",function(a){"T1"==Y.triggerWeblabAndGetTreatment()&&a&&(Y.addListenersToLinkWrappers(a),
Y.addListenersToAsinFaceoutLinks(a))});a(Y,"addListenersToLinkWrappers",function(a){a=a.getElementsByClassName(Y.LINK_WRAPPER_CLASS_NAME);Array.from(a).forEach(function(a){return Y.addLinkEventListeners(a,Y.getRegularLinkEventName)})});a(Y,"addListenersToAsinFaceoutLinks",function(a){a=a.querySelectorAll(Y.ASIN_FACEOUT_LINK_SELECTOR);Array.from(a).forEach(function(a){return Y.addLinkEventListeners(a,Y.getAsinFaceoutEventName)})});a(Y,"getRegularLinkEventName",function(a){var b;return null===(b=Y.getAnchorElement(a))||
void 0===b?void 0:b.getAttribute("data-click-event-name")});a(Y,"getAsinFaceoutEventName",function(){return Y.ASIN_FACEOUT_DATA_SECTION_CLASS});a(Y,"addLinkEventListeners",function(a,b){a.addEventListener("click",Y.handleLinkWrapperLeftClick.bind(null,b));a.addEventListener("contextmenu",Y.handleLinkWrapperOpenContextMenu.bind(null,b));a.addEventListener("auxclick",Y.handleLinkWrapperAuxClick.bind(null,b))});a(Y,"triggerWeblabAndGetTreatment",function(){var a=na.getInstance().getWeblabTreatment("RUFUS_DESKTOP_LINK_REPLACEMENT_1164286");
if(a)return k.recordTrigger("RUFUS_DESKTOP_LINK_REPLACEMENT_1164286",a),a});var wg=function(){return r(function E(){z(this,E)},null,[{key:"parseEventData",value:function(a){try{return JSON.parse(a.data)}catch(d){return k.logErrorWithLevelWithException(H.ERROR,d,"Rufus - Error parsing event data: ".concat(d instanceof Error?"(".concat(d.message,")"):"")),null}}}])}(),fc=function(a){a.forEach(function(a){a.classList.remove("fade-in","rufus-fade-in","rufus-web-fade-in")})},Bi=["type","src","charset",
"class"],Ci=function(a){return Bi.includes(a)||a.startsWith("data-")},Di=function(a){a=a.getAttribute("type");return!a||"text/javascript"===a||"application/javascript"===a},ue=function(a){var b=document.getElementById("rufus-conversation-container");b&&Array.from(a.querySelectorAll("script")).map(function(a){var b=document.createElement("script");return a.getAttributeNames().filter(Ci).forEach(function(c){var d=a.getAttribute(c);b.setAttribute(c,d)}),b.text=a.text,b}).forEach(function(a){try{b.appendChild(a)}catch(l){k.logErrorWithLevelWithException(H.ERROR,
l,"Failed to load additional script for execution")}})},db=function(a){return a.VisibleWithAvatar="visibileWithAvatar",a.VisibleWithoutAvatar="visibleWithoutAvatar",a.Hidden="hidden",a}({}),sa=function(a){return a.AppendActive="appendActive",a.PrependHistory="prependHistory",a.ReplaceActive="replaceActive",a.ReplaceHistory="replaceHistory",a.InsertIntoLastActiveTurn="insertIntoLastActiveTurn",a.RemoveLastActiveTurn="removeLastActiveTurn",a.ReplaceInterruptedConversation="replaceInterruptedConversation",
a}({}),Ei=function(b){function m(b,c,q){var d;return z(this,m),a(d=function(a,b,c){return b=y(b),R(a,df()?Reflect.construct(b,[],y(a).constructor):b.apply(a,c))}(this,m),"isTopLoading",!1),a(d,"MULTIMODAL_IMAGE_ID_SECTION_SELECTOR",'[id^\x3d"rufus-panel-image-carousel-card-"]'),a(d,"MULTIMODAL_IMAGE_ID_SELECTOR",'[id^\x3d"conversation-layer-image"]'),a(d,"SECTIONS_WITH_SCRIPTS",["ReviewAspectPillCarousel","AsinFaceoutList"]),a(d,"moveInterruptionRecoveryContainerOutOfConversation",function(){d.toggleInterruptionRecoveryButtonVisibility(!1);
d.toggleInterruptionRecoverySpinnerVisibility(!1);d.getInterruptionRecoveryContainer().classList.add("aok-hidden");d.elements.mainContainer.appendChild(d.getInterruptionRecoveryContainer())}),a(d,"fixUnsupportedSymbols",function(a){return nh.forEach(function(b,c){a=a.replace(new RegExp(c,"g"),b)}),a}),a(d,"isSpinnerShowing",function(){return null!=d.elements.spinnerContainer&&!d.elements.spinnerContainer.classList.contains("aok-hidden")}),a(d,"removeActiveConversationTurnsFromHistory",function(a){for(var b=
d.getNumberOfConversationTurns(),c=0;c<b&&a.lastChild;c++)a.removeChild(a.lastChild)}),a(d,"getSectionGroupIdsFromSection",function(a){a=a.querySelectorAll('[id^\x3d"section_groupId_"]');return Array.from(a).map(function(a){return a.id})}),a(d,"selectSectionWithId",function(a,b){return a.querySelector("#".concat(b))}),a(d,"replaceStreamingElement",function(a,b){var c=parseInt(a.getAttribute("data-rufus-sequenceid")||""),g=parseInt(b.getAttribute("data-rufus-sequenceid")||"");return!isNaN(c)&&!isNaN(g)&&
c<g?(d.animationUtil.prepareSectionForReplaceAnimation(a,b),a.style.height="".concat(a.getBoundingClientRect().height,"px"),a.innerHTML=b.innerHTML,a.style.removeProperty("height"),a.setAttribute("data-rufus-sequenceid",String(g)),a):void 0}),a(d,"appendElementToContainer",function(a){var b=1<arguments.length&&void 0!==arguments[1]&&arguments[1],c=2<arguments.length?arguments[2]:void 0,g=3<arguments.length?arguments[3]:void 0;d.animationUtil.prepareSectionForAppendAnimation(a);void 0===d.elements.currentStreamContainer&&
d.createNewStreamContainer(b,Z.UNKNOWN);var l=a.getAttribute("data-section-class")||void 0,q=c&&c===aa.MESSAGE;if("TextSubsections"!==l||g!==qa.NILE_NDSWDCS_RELATED_QUESTION){if(te.isWDCSSection(l,g)||"AsinFaceoutList"===l){var k=a.cloneNode(!0),C=k.id;!function(a){fc([a]);a.classList.remove("rufus-visibility-hidden")}(k);(function(a,b){var c;a=function(a,b){var c="undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(!c){if(Array.isArray(a)||(c=function(a,b){if(a){if("string"==typeof a)return cf(a,
b);var c={}.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?cf(a,b):void 0}}(a))||b&&a&&"number"==typeof a.length){c&&(a=c);var d=0;b=function(){};return{s:b,n:function(){return d>=a.length?{done:!0}:{done:!1,value:a[d++]}},e:function(a){throw a;},f:b}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}var g,l=!0,q=!1;return{s:function(){c=c.call(a)},n:function(){var a=c.next();return l=a.done,a},e:function(a){q=!0;g=a},f:function(){try{l||null==c.return||c.return()}finally{if(q)throw g;}}}}(a.querySelectorAll("script"));try{for(a.s();!(c=a.n()).done;){var d=c.value;Di(d)&&(d.text="//".concat(b,"\n").concat(d.text))}}catch(fb){a.e(fb)}finally{a.f()}})(k,C);d.sectionIdToScriptSectionsMap[C]=k;ue(k)}var p;return d.shouldAddRemoveSectionClass(b,g,q,l)&&a.classList.add("rufus-remove-section"),"Carousel"===
l&&d.updateConversationLayerImageURL(a),"PriceHistoryChart"===l&&d.appendSvgChartToContainer(a),b&&c===aa.AFFORDANCE&&(null===(p=d.elements.currentStreamContainer)||void 0===p||p.classList.remove("rufus-contextual-pills-container")),d.elements.currentStreamContainer.appendChild(a),d.handleHidingLoaderAvatar(c),a}}),a(d,"handleLoadMoreHistoryButtonClick",function(){k.addCount(p.LOAD_HISTORY_BUTTON_CLICK,1);J(F.LOAD_HISTORY);d.dispatch("onLoadMoreHistoryButtonClick",void 0)}),a(d,"replaceContentInContainer",
function(a,b){d.elements.container.style.removeProperty("scroll-behavior");var c=document.createElement("div");c.innerHTML=a;Kd(c,function(){b===sa.ReplaceActive?(d.elements.activeConversationContainer.innerHTML="".concat(c.innerHTML),Y.addListeners(d.elements.activeConversationContainer)):b===sa.ReplaceHistory&&(d.elements.historyContainer.innerHTML="".concat(c.innerHTML),Y.addListeners(d.elements.historyContainer));d.elements.container.scrollTop=d.elements.container.scrollHeight;d.elements.container.style.scrollBehavior=
"smooth";d.dispatch("completeReplacingContentInContainer",void 0)})}),a(d,"handleInterruptionRecoveryButtonClick",function(a){k.addCount(p.INTERRUPTION_RECOVERY_BUTTON_CLICK,1);J(F.INTERRUPTION_RECOVERY_BUTTON_CLICK);d.toggleInterruptionRecoveryButtonVisibility(!1);d.toggleInterruptionRecoverySpinnerVisibility(!0);d.dispatch("onInterruptionRecoveryButtonClick",a)}),a(d,"updateCache",function(){d.cacheManager.setPanelContent(d.getPanelContentSnapshot())}),d.missingElementsRecorder=new od("ConversationList"),
d.sectionIdToScriptSectionsMap={},d.elements=d.readHtmlElementsFromDom(),d.animationUtil=b,d.streamingLifecycleEventLogger=c,d.cacheManager=q,d.asinFaceoutState={expectAsinFaceoutChunkNext:!1},d.SECTIONS_WITH_SCRIPTS.forEach(function(a){a=d.elements.container.querySelectorAll("[".concat("data-section-class",'\x3d"').concat(a,'"]'));Array.from(a).forEach(function(a){a=a.cloneNode(!0);d.sectionIdToScriptSectionsMap[a.id]=a;ue(a)})}),d.updateCache(),d.elements.container.style.scrollBehavior="smooth",
d.attachEventListeners(),d}return Aa(m,b),r(m,[{key:"refreshOnBfCacheNavigation",value:function(){Object.assign(this.elements,this.readHtmlElementsFromDom());this.attachEventListeners()}},{key:"readHtmlElementsFromDom",value:function(){var a={container:this.missingElementsRecorder.getElementOrRecordMissing("rufus-conversation-container"),mainContainer:this.missingElementsRecorder.getElementOrRecordMissing("rufus-container-main-view"),containerInner:this.missingElementsRecorder.getElementOrRecordMissing("rufus-conversation-container-inner"),
activeConversationContainer:this.missingElementsRecorder.getElementOrRecordMissing("rufus-active-conversation-container"),historyContainer:this.missingElementsRecorder.getElementOrRecordMissing("rufus-history-container"),rufusFlyoutDiv:this.missingElementsRecorder.getElementOrRecordMissing("nav-flyout-rufus"),overflowMenu:this.missingElementsRecorder.getElementOrRecordMissing("rufus-overflow-menu-container"),loadMoreHistoryButton:document.getElementById("rufus-load-more-history-button"),beginningOfHistoryContainer:document.getElementById("rufus-history-beginning-container"),
loader:document.getElementById("rufus-conversation-loader-container"),loaderAvatar:document.getElementById("rufus-loader-avatar"),rufusPanelContent:document.getElementById("nav-rufus-content"),spinnerContainer:document.getElementById("rufus-load-history-spinner-container")};return this.missingElementsRecorder.logMissingElementsAndThrowError(),a}},{key:"attachEventListeners",value:function(){var a;null===(a=this.elements.loadMoreHistoryButton)||void 0===a||a.addEventListener("click",this.handleLoadMoreHistoryButtonClick);
Y.addListeners(this.elements.activeConversationContainer)}},{key:"modifyContent",value:function(a,b,c){if(this.validateContentForOperation(a,b)){switch(a){case sa.PrependHistory:this.handlePrependHistory(b,!!c);break;case sa.AppendActive:this.handleAppendActive(b);break;case sa.ReplaceHistory:case sa.ReplaceActive:this.replaceContentInContainer(b,a);break;case sa.InsertIntoLastActiveTurn:this.handleInsertIntoLastActiveTurn(b);break;case sa.RemoveLastActiveTurn:var d;null===(d=this.elements.activeConversationContainer.lastElementChild)||
void 0===d||d.remove();break;case sa.ReplaceInterruptedConversation:this.handleReplaceInterruptedConversation(b)}this.updateCache()}}},{key:"moveInterruptionRecoveryContainerToConversation",value:function(a){var b=this.elements.activeConversationContainer.children.length;0<b&&(this.elements.activeConversationContainer.children[b-1].appendChild(this.getInterruptionRecoveryContainer()),this.dispatch("lastActiveTurnContentUpdated",void 0),this.addInterruptionRecoveryButtonEventListener(a),this.toggleInterruptionRecoveryButtonVisibility(!0),
this.getInterruptionRecoveryContainer().classList.remove("aok-hidden"))}},{key:"getInterruptionRecoveryContainer",value:function(){return document.getElementById("rufus-interrupted-stream-affordance-container")}},{key:"dismissInterruptionRecoverySpinnerAndShowButton",value:function(){this.toggleInterruptionRecoverySpinnerVisibility(!1);this.toggleInterruptionRecoveryButtonVisibility(!0);this.getInterruptionRecoveryContainer().classList.remove("aok-hidden")}},{key:"checkInterruptionRecoveryButtonVisibility",
value:function(){return this.getInterruptionRecoveryButton()&&!this.getInterruptionRecoveryButton().classList.contains("aok-hidden")}},{key:"toggleLoadMoreHistoryButtonElementVisibility",value:function(a){var b;a&&k.addCount(p.RUFUS_HISTORY_BUTTON_SHOWN,1);null===(b=this.elements.loadMoreHistoryButton)||void 0===b||null===(b=b.parentElement)||void 0===b||b.classList.toggle("aok-hidden",!a)}},{key:"toggleBeginningOfHistoryElementVisibility",value:function(a){var b;a&&k.addCount(p.RUFUS_BEGINNING_HISTORY_SHOWN,
1);null===(b=this.elements.beginningOfHistoryContainer)||void 0===b||b.classList.toggle("aok-hidden",!a)}},{key:"isFtuxOrRuxOnScreen",value:function(){var a=Array.from(this.elements.activeConversationContainer.getElementsByClassName("conversation-turn-container")),b=Array.from(this.elements.historyContainer.getElementsByClassName("conversation-turn-container"));return 0<a.length&&(a[0].classList.contains("rufus-initial-stream-container")||a[0].classList.contains("PlaceholderMessage"))&&0===b.length}},
{key:"getActiveConversationContainerContent",value:function(){return this.elements.activeConversationContainer.innerHTML}},{key:"getHistoryContainerContent",value:function(){return this.elements.historyContainer.innerHTML}},{key:"createNewStreamContainer",value:function(a,b){this.handleInitialStream(!!a);var c=this.createAndAppendContainer(!!a);b&&(b===Z.SEARCH||b===Z.ASIN_CLICK)&&a&&c.classList.add("rufus-contextual-pills-container");this.elements.container.focus()}},{key:"removeTemporarySections",
value:function(){Array.from(this.elements.container.getElementsByClassName("rufus-remove-section")).forEach(function(a){var b;null===(b=a.parentElement)||void 0===b||b.removeChild(a)})}},{key:"getRemovableSectionsFromLatestActiveTurn",value:function(){var a,b;return Array.from(null!==(a=null===(b=this.elements.activeConversationContainer.lastElementChild)||void 0===b?void 0:b.getElementsByClassName("rufus-remove-section"))&&void 0!==a?a:[])}},{key:"startTopLoading",value:function(){this.isTopLoading||
(this.elements.container.insertBefore(this.elements.spinnerContainer,this.elements.container.firstChild),this.toggleLoadMoreHistorySpinnerElementVisibility(!0),this.isTopLoading=!0)}},{key:"endTopLoading",value:function(){this.isTopLoading&&(this.toggleLoadMoreHistorySpinnerElementVisibility(!1),this.isTopLoading=!1)}},{key:"toggleLoader",value:function(a){switch(a){case db.VisibleWithAvatar:this.elements.loader.classList.remove("aok-hidden");this.elements.loaderAvatar.classList.remove("rufus-visibility-hidden");
break;case db.VisibleWithoutAvatar:this.elements.loader.classList.remove("aok-hidden");this.elements.loaderAvatar.classList.add("rufus-visibility-hidden");break;case db.Hidden:this.elements.loader.classList.add("aok-hidden"),this.elements.loaderAvatar.classList.add("rufus-visibility-hidden")}}},{key:"updateHtmlSections",value:function(a){var b=this,c=a.event,d=a.streamingStatusDetails,k=a.streamingEventType;if(c.data&&""!==c.data){var N=this.prepareNewHtmlContent(c.data);Y.addListeners(N);this.refreshTruncation();
a=this.getSectionGroupIdsFromSection(N);if(0!==a.length){var P=a.length-1;a.forEach(function(a,g){b.processSection(N,a,g,P,d,c,k)})}else this.handleNoSectionGroups(c.data)}}},{key:"updateHtmlSectionsV2",value:function(a){var b=this,c=a.event,d=a.streamingStatusDetails,k=a.streamingEventType;if(c.data&&""!==c.data){a=this.asinFaceoutState;var N=a.expectAsinFaceoutChunkNext;a=a.faceoutAction;if(N&&a)this.handleASINFaceoutUpdate(c,d,k);else{a=wg.parseEventData(c);a=null==a?void 0:a.sections;var P=null==
a?void 0:a.map(function(a){return a.target.groupId}).filter(function(a){return!!a}),p=P?P.length-1:void 0;this.refreshTruncation();null==a||a.forEach(function(a,g){if("AsinFaceoutList"!==a.target.type||N){var l=a.target.groupId;if(l){var q=b.prepareNewHtmlContent(a.content.data);Y.addListeners(q);b.processSectionV2(q,l,g,p,d,c,a.action,k)}else b.handleNoSectionGroups(a.content.data)}else b.asinFaceoutState={expectAsinFaceoutChunkNext:!0,faceoutAction:a.action}})}}}},{key:"removeHtml",value:function(a,
b){var c=this;"Section"===a&&this.animationUtil.enqueueAnimation(function(){k.addCount(p.SECTION_REMOVED,1);J(F.REMOVE_SECTION);c.removeSection(b);c.streamingLifecycleEventLogger.recordPatchRenderEnd(Date.now())})}},{key:"removeSection",value:function(a){var b;if(a){a=document.getElementById("section_groupId_"+a);var c=this.hasAvatar(a);null==a||null===(b=a.parentElement)||void 0===b||b.removeChild(a);c&&this.handleRemovedSectionHadAvatar()}}},{key:"hasAvatar",value:function(a){return null!=(null==
a?void 0:a.querySelector(".rufus-avatar-img"))}},{key:"handleRemovedSectionHadAvatar",value:function(){this.toggleLoader(db.VisibleWithAvatar)}},{key:"refreshTruncation",value:function(){fa.when("a-truncate").execute(function(a){a.refreshAutoTruncate()})}},{key:"getPanelContentSnapshot",value:function(){var a=this,b=this.elements.rufusPanelContent.cloneNode(!0),c=b.querySelector("#".concat("rufus-conversation-loader-container")),g=b.querySelector("#".concat("rufus-load-history-spinner-container")),
k=b.querySelector("#".concat("rufus-active-conversation-container")),N=b.querySelector("#".concat("rufus-history-container")),P=b.querySelector("#".concat("rufus-conversation-container")),p=b.querySelector("#".concat("rufus-scroll-button")),m=b.querySelector("#".concat("rufus-overflow-menu-container-webapp")),E=b.querySelector(".".concat("rufus-asin-filter-pill")),r=b.querySelector(".".concat("rufus-asin-filter-shade"));P.style.removeProperty("scroll-behavior");this.handleAsinFilterPillSnapshot(E,
r);this.purgeExcessConversations(k,N);N=Array.from(N.children);k.prepend.apply(k,N);k=function(b){var c=P.querySelector("#".concat(b));if(c){var d=a.sectionIdToScriptSectionsMap[b],g=d.getAttribute("data-section-class")||void 0,l="AsinFaceoutList"===g?c.cloneNode(!0):d;document.querySelectorAll("body \x3e script").forEach(function(a){a.text&&a.text.includes("//".concat(b))&&l.appendChild(a)});"ReviewAspectPillCarousel"===g&&te.removeDataMixClaimedAttribute(l);c.replaceWith(l)}};for(var u in this.sectionIdToScriptSectionsMap)k(u);
return c&&c.classList.add("aok-hidden"),g&&g.classList.add("aok-hidden"),p&&(p.style.display="none"),m&&(m.innerHTML=this.elements.overflowMenu.innerHTML),b}},{key:"updateInnerContainerHeight",value:function(){var a=0<arguments.length&&void 0!==arguments[0]&&arguments[0],b=this.elements.containerInner.getBoundingClientRect().height,c=this.elements.rufusFlyoutDiv.style.getPropertyValue("--expanded-container-height");c=c?parseInt(c)-96:0;(a||(b>c||""===this.elements.historyContainer.innerHTML.trim())&&
b!==c)&&(this.elements.containerInner.style.height="".concat(c,"px"))}},{key:"toggleLoadMoreHistorySpinnerElementVisibility",value:function(a){var b;null===(b=this.elements.spinnerContainer)||void 0===b||b.classList.toggle("aok-hidden",!a)}},{key:"getNumberOfConversationTurns",value:function(){if(!this.areContainersValid())return 0;var a=this.getTurnsFromContainers(),b=a.activeTurns;a=a.historyTurns;var c=0<b.length&&b[0].classList.contains("rufus-initial-stream-container")&&0===a.length;return 1===
b.length&&(0===a.length||1===a.length&&a[0].classList.contains("rufus-initial-stream-container"))||c?0:this.calculateTotalTurns(b,a)}},{key:"markLastTurnAnimationComplete",value:function(){var a;null===(a=this.elements.activeConversationContainer.lastElementChild)||void 0===a||a.classList.add("animation-complete")}},{key:"isLastTurnAnimationComplete",value:function(){var a;return(null===(a=this.elements.activeConversationContainer.lastElementChild)||void 0===a?void 0:a.classList.contains("animation-complete"))||
!1}},{key:"isLastTurnContentEmpty",value:function(){var a;return""===(null===(a=this.elements.activeConversationContainer.lastElementChild)||void 0===a?void 0:a.innerHTML)}},{key:"isFtuxPresent",value:function(){var a=document.querySelector('[id^\x3d"section_groupId_"]');return"PlaceholderMessage"===(null==a?void 0:a.getAttribute("data-section-class"))}},{key:"isAffordancePresentInContainer",value:function(){var a,b=(null===(a=this.elements.activeConversationContainer.lastElementChild)||void 0===
a?void 0:a.children)||[];return Array.from(b).some(function(a){return"CustomerText"===a.getAttribute("data-section-class")})}},{key:"purgeExcessConversations",value:function(a,b){Bf(a);Bf(b);Array.from(a.children).forEach(function(b){var c;b.classList.contains("rufus-contextual-pills-container")&&null!==(c=b.lastElementChild)&&void 0!==c&&c.classList.contains("rufus-remove-section")&&a.removeChild(b)});Af(a,5);Af(b,5-a.children.length)}},{key:"moveActiveConversationTurnsToHistory",value:function(){var a=
this;Array.from(this.elements.activeConversationContainer.children).forEach(function(b){return a.elements.historyContainer.append(b)});this.elements.activeConversationContainer.innerHTML="";this.dispatch("completeMovingActiveConversationTurnsToHistory",void 0)}},{key:"handleHidingLoaderAvatar",value:function(a){a=a!==aa.AFFORDANCE;!this.elements.loaderAvatar.classList.contains("rufus-visibility-hidden")&&a&&this.toggleLoader(db.VisibleWithoutAvatar)}},{key:"toggleInterruptionRecoveryButtonVisibility",
value:function(a){var b;a&&(k.addCount(p.INTERRUPTION_RECOVERY_BUTTON_SHOWN,1),J(F.INTERRUPTION_RECOVERY_BUTTON_SHOWN));null===(b=this.getInterruptionRecoveryButton())||void 0===b||b.classList.toggle("aok-hidden",!a)}},{key:"toggleInterruptionRecoverySpinnerVisibility",value:function(a){var b;null===(b=this.getInterruptionRecoverySpinner())||void 0===b||b.classList.toggle("aok-hidden",!a)}},{key:"addInterruptionRecoveryButtonEventListener",value:function(a){var b,c=this;null===(b=this.getInterruptionRecoveryButton())||
void 0===b||b.addEventListener("click",function(){return c.handleInterruptionRecoveryButtonClick(a)})}},{key:"getInterruptionRecoveryButton",value:function(){return document.getElementById("rufus-interrupted-stream-recovery-button-container")}},{key:"getInterruptionRecoverySpinner",value:function(){return document.getElementById("rufus-interrupted-stream-recovery-spinner-container")}},{key:"appendSvgChartToContainer",value:function(a){var b=a.getElementsByClassName("rufus-pricing-chart-container");
0!==b.length&&fa.now("pricing-chart-client").execute(function(a){void 0!==a?Array.from(b).forEach(function(b){var c=b.dataset.pricingChartJson,d=b.dataset.pricingWindowsEnabled;c&&d?(c="true"===d?a.rebuildData(Number(b.dataset.pricingDefaultWindowIndex),JSON.parse(c)):JSON.parse(c),(c=a.renderChart(c))||k.addCount(p.RUFUS_PRICING_RENDERING_ERROR,1),b.innerHTML=c):k.addCount(p.RUFUS_PRICING_INVALID_DATA,1)}):k.addCount(p.RUFUS_PRICING_CLIENT_NOT_LOADED,1)})}},{key:"updateConversationLayerImageURL",
value:function(a){var b=this;k.widgetBodyBegin(ma.UPDATE_CL_IMAGE_URL_TO_LOW_RES);a=a.querySelectorAll(this.MULTIMODAL_IMAGE_ID_SECTION_SELECTOR);0>=a.length||(a.forEach(function(a){!function(a,b){var d=b.getAttribute("data-a-modal");if(null!=d){var g,l,q,C=null===(g=JSON.parse(d))||void 0===g?void 0:g.imageUrl,m=null!==(l=null===(q=JSON.parse(d))||void 0===q?void 0:q.actionId)&&void 0!==l?l:"";null!=C?(g=function(a){if(!a.includes("m.media-amazon.com"))return a;var b=Math.ceil(400*c.devicePixelRatio*
(1>=c.devicePixelRatio?1:.6)),d=a.split(".");d=d[d.length-1];return a.replace(d,"".concat("_SL").concat(b.toString(),"_.").concat(d))}(C),l=a.src,a.onload=function(){k.widgetBodyEnd(ma.RUFUS_LOW_RESOLUTION_IMAGE_LOADED_LATENCY,!1);k.widgetBodyBegin(ma.RUFUS_LOW_RESOLUTION_IMAGE_RENDERED_LATENCY);a.decode().then(function(){k.widgetBodyEnd(ma.RUFUS_LOW_RESOLUTION_IMAGE_RENDERED_LATENCY,!1);k.addCount(p.RUFUS_MULTIMODAL_IMAGE_SHOWN,1)})},a.src=g,k.widgetBodyBegin(ma.RUFUS_LOW_RESOLUTION_IMAGE_LOADED_LATENCY),
a.onclick=function(){J(F.OPEN_MEDIA,m);k.addCount(p.RUFUS_MULTIMODAL_IMAGE_CLICKED,1)},a.onerror=function(a){vg("LOW","RENDER",a.toString())},b.setAttribute("data-a-modal",d.toString().replace(l,g))):k.logErrorWithLevel(H.ERROR,"High resolution image is empty.")}else k.logErrorWithLevel(H.ERROR,"DataModel for MultiModal is null.")}(a.querySelector(b.MULTIMODAL_IMAGE_ID_SELECTOR),a.parentElement)}),k.widgetBodyEnd(ma.UPDATE_CL_IMAGE_URL_TO_LOW_RES))}},{key:"areContainersValid",value:function(){return this.elements.activeConversationContainer?
!!this.elements.historyContainer||(k.addCount(p.RUFUS_HISTORY_CONTAINER_IN_HISTORY_NULL,1),!1):(k.addCount(p.RUFUS_ACTIVE_CONVERSATION_CONTAINER_IN_HISTORY_NULL,1),!1)}},{key:"getTurnsFromContainers",value:function(){return{activeTurns:Array.from(this.elements.activeConversationContainer.getElementsByClassName("conversation-turn-container")),historyTurns:Array.from(this.elements.historyContainer.getElementsByClassName("conversation-turn-container"))}}},{key:"calculateTotalTurns",value:function(a,
b){var c=0;return a.forEach(function(a){var b=a.classList.contains("rufus-initial-stream-container");""!==a.innerHTML.trim()&&(a.hasChildNodes()||b)||a.remove();c+=b?0:1}),b.forEach(function(a){c++;""!==a.innerHTML.trim()&&a.hasChildNodes()||a.remove()}),c}},{key:"handleInitialStream",value:function(a){a&&(this.removeFTUXIfNoInteraction(),this.moveActiveConversationTurnsToHistory())}},{key:"removeFTUXIfNoInteraction",value:function(){var a,b=this.elements.activeConversationContainer.lastElementChild;
this.shouldDedupeFTUX(b)&&(null==b||null===(a=b.parentElement)||void 0===a||a.removeChild(b))}},{key:"shouldDedupeFTUX",value:function(a){var b,c;if(null==a||!a.classList.contains("rufus-initial-stream-container"))return!1;var d=null==a||null===(b=a.firstElementChild)||void 0===b?void 0:b.getAttribute("data-section-class");a=null==a||null===(c=a.children)||void 0===c||null===(c=c[1])||void 0===c?void 0:c.getAttribute("data-section-class");return"PlaceholderMessage"===d&&"CustomerText"!==a}},{key:"createAndAppendContainer",
value:function(a){var b=document.createElement("div");return b.classList.add("conversation-turn-container"),a&&b.classList.add("rufus-initial-stream-container"),this.elements.activeConversationContainer.append(b),this.elements.currentStreamContainer=b,b}},{key:"prepareNewHtmlContent",value:function(a){var b=document.createElement("div");return b.innerHTML=this.fixUnsupportedSymbols(a),b}},{key:"handleNoSectionGroups",value:function(a){this.modifyContent(sa.AppendActive,a);k.addCount(p.RUFUS_SECTION_WITHOUT_GROUP_SECTION_ID,
1)}},{key:"processSection",value:function(a,b,c,g,k,p,P){var d=this;this.animationUtil.enqueueAnimation(function(){var l=d.getSectionGroupIdsFromSection(d.elements.activeConversationContainer).includes(b)?d.updateExistingSection(a,b):d.addNewSection(a,b,k,P);return d.streamingLifecycleEventLogger.recordSectionRenderEnd(p,k,c,c===g),l})}},{key:"processSectionV2",value:function(a,b,c,g,k,p,P,m){var d=this;this.animationUtil.enqueueAnimation(function(){var l;return"ADD"===P?l=d.addNewSection(a,b,k,m):
"REPLACE"===P&&(l=d.updateExistingSection(a,b)),d.streamingLifecycleEventLogger.recordSectionRenderEnd(p,k,c,c===g),l})}},{key:"updateExistingSection",value:function(a,b){var c=this.selectSectionWithId(this.elements.activeConversationContainer,b);a=this.selectSectionWithId(a,b);return c&&a?this.replaceStreamingElement(c,a):void 0}},{key:"addNewSection",value:function(a,b,c,g){var d;return(a=a.querySelector("#".concat(b)))?this.appendElementToContainer(a,c.isInitialStream,g,null===(d=c.requestContext)||
void 0===d||null===(d=d.queryContext)||void 0===d?void 0:d.qis):void 0}},{key:"validateContentForOperation",value:function(a,b){var c=[sa.AppendActive,sa.PrependHistory,sa.InsertIntoLastActiveTurn];return!(!b&&c.includes(a))}},{key:"handlePrependHistory",value:function(a,b){var c=this;this.elements.container.style.removeProperty("scroll-behavior");var d=this.elements.container.scrollHeight,l=this.createTempDiv(a);b&&this.removeActiveConversationTurnsFromHistory(l);this.updateConversationLayerImageURL(l);
this.appendSvgChartToContainer(l);Kd(l,function(){c.prependContentAndUpdateScroll(l,d)})}},{key:"prependContentAndUpdateScroll",value:function(a,b){var c;ue(a);(c=this.elements.historyContainer).prepend.apply(c,Jd(a.children));Y.addListeners(this.elements.historyContainer);this.endTopLoading();this.elements.container.scrollTop+=this.elements.container.scrollHeight-b;this.elements.container.style.scrollBehavior="smooth"}},{key:"createTempDiv",value:function(a){var b=document.createElement("div");return b.innerHTML=
a,b}},{key:"handleReplaceInterruptedConversation",value:function(a){var b=this.getInterruptionRecoveryContainer().parentElement;null!=b&&b.classList.contains("conversation-turn-container")&&(this.moveInterruptionRecoveryContainerOutOfConversation(),a=this.createTempDiv(a),this.updateConversationLayerImageURL(a),this.appendSvgChartToContainer(a),b.outerHTML=a.innerHTML,Y.addListeners(this.elements.activeConversationContainer))}},{key:"handleAppendActive",value:function(a){var b;a=this.createTempDiv(a);
(b=this.elements.activeConversationContainer).append.apply(b,Jd(a.children));Y.addListeners(this.elements.activeConversationContainer)}},{key:"handleInsertIntoLastActiveTurn",value:function(a){if(0<this.elements.activeConversationContainer.children.length){var b;a=this.createTempDiv(a);null===(b=this.elements.activeConversationContainer.lastElementChild)||void 0===b||b.append.apply(b,Jd(a.children));Y.addListeners(this.elements.activeConversationContainer.lastElementChild);this.dispatch("lastActiveTurnContentUpdated",
void 0)}}},{key:"handleASINFaceoutUpdate",value:function(a,b,c){var d=this,l=this.prepareNewHtmlContent(a.data);Y.addListeners(l);this.refreshTruncation();var q=this.getSectionGroupIdsFromSection(l);if(0!==q.length){var k=q.length-1;q.forEach(function(g,q){d.processSectionV2(l,g,q,k,b,a,d.asinFaceoutState.faceoutAction,c)});this.asinFaceoutState={expectAsinFaceoutChunkNext:!1,faceoutAction:void 0}}else this.handleNoSectionGroups(a.data)}},{key:"handleAsinFilterPillSnapshot",value:function(a,b){if(a&&
b){a.classList.remove("rufus-asin-filter-pill-show","rufus-asin-filter-pill-hide");a.classList.add("aok-hidden");a.removeAttribute("aria-label");var c=a.querySelector("#rufus-asin-filter-pill-content"),d=a.querySelector("#rufus-asin-filter-pill-preview-image");a=a.querySelector(".rufus-asin-filter-pill-title");c&&(c.href="");d&&(d.src="");a&&(a.textContent="");b.classList.remove("rufus-asin-filter-shade-show","rufus-asin-filter-shade-hide")}}},{key:"shouldAddRemoveSectionClass",value:function(a,b,
c,g){return(a||b===qa.NILE_ASIN_INGRESS)&&!0===c&&"PlaceholderMessage"!==g}}])}(Ga),Fi=function(){return r(function E(){z(this,E)},null,[{key:"buildPayload",value:function(a,b,c,q,g,k,p,P,m,r){return{feedbackType:b,conversationId:c+q,turnRequestId:g,gmtTime:k,detailFeedback:p,freeformFeedback:P,mainFeedback:m,turnSessionId:r,pageContext:this.buildFeedbackPageContext(a)}}},{key:"buildFeedbackPageContext",value:function(a){var b,c,q=a.getPanelViewContext();a=K.getCurrentPageUrl();q=Za(q.pageType);var g=
null===(b=(c=K.metadataParsers)[q])||void 0===b?void 0:b.call(c,a);return{pageType:q,targetPageType:q,originPageType:q,targetUrl:K.getCurrentPageUrl(),originUrl:a,targetPageMetadata:g,pageMetadata:g,originPageMetadata:g}}}])}(),td=function(b){function c(a,b,q){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:new Set,l=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0;z(this,c);var k=c;var p=(k=y(k),R(this,ff()?Reflect.construct(k,[],y(this).constructor):k.apply(this,void 0)));return p.A=
a,p.contextManager=b,p.panelContainer=q,p.checkedIndices=d,p.numberOfCheckBoxChecked=l,p.registerEventHandlers(),p.shouldUseRufusCommonModule=na.getInstance().isWeblabTreatmentEnabledAndRecordTrigger("RUFUS_ORTELIUS_COMPLETE_DIALUP_1259431")||na.getInstance().isWeblabTreatmentEnabledAndRecordTrigger("RUFUS_COMMON_ASSETS_MIGRATION_CL_1189218"),p}return Aa(c,b),r(c,[{key:"registerEventHandlers",value:function(){var a=this;this.A.declarative("rufus-thumbs-up-actions","mouseenter",function(){return a.handleThumbsUpMouseEnter()});
this.A.declarative("rufus-thumbs-up-actions","mouseleave",function(){return a.handleThumbsUpMouseLeave()});this.A.declarative("rufus-thumbs-up-actions","click",function(){return a.handleThumbsUpMouseClick(a.A,a.contextManager)});this.A.declarative("rufus-thumbs-down-actions","mouseenter",function(){return a.handleThumbsDownMouseEnter()});this.A.declarative("rufus-thumbs-down-actions","mouseleave",function(){return a.handleThumbsDownMouseLeave()});this.A.declarative("rufus-thumbs-down-actions","click",
function(){return a.handleThumbsDownMouseClick()});this.A.declarative("rufus-feedback-checkbox-actions","change",function(b){return a.handleCheckboxChange(b)});this.A.declarative("rufus-dismiss-button-actions","click",function(){return a.handleDismissButtonClick(a.A,a.contextManager)});this.A.declarative("rufus-submit-feedback-button-actions","click",function(){return a.handleSubmitButtonClick(a.A,a.contextManager)})}},{key:"handleThumbsUpMouseEnter",value:function(){var a=this.getVotingConfig(),
b=a.thumbsUpArea,c=a.isThumbsUpClicked;a.isThumbsDownClicked||c||this.updateThumbImage(b,"https://m.media-amazon.com/images/G/01/Rufus_Desktop/thumbs_up_hover-0c724742-dd32-471c-b488-94227df26330._CB559205155_._SY200_.png")}},{key:"handleThumbsUpMouseLeave",value:function(){var a=this.getVotingConfig(),b=a.thumbsUpArea,c=a.isThumbsUpClicked;a.isThumbsDownClicked||c||this.updateThumbImage(b,"https://m.media-amazon.com/images/G/01/Rufus_Desktop/thumbs_up-c1ca7881-13d4-4958-8b4c-f97108f6e11d.png")}},
{key:"handleThumbsUpMouseClick",value:function(a,b){var d=this.getVotingConfig(),g=d.thumbsUpArea,l=d.thumbsDownArea,m=d.isThumbsUpClicked;d.isThumbsDownClicked||m||(d=document.getElementById("rufus-feedback-text"),m=document.getElementById("rufus-thumbs-up-feedback-sent-text"),this.updateThumbImage(g,"https://m.media-amazon.com/images/G/01/Rufus_Desktop/thumbs_up_click-9ca6525e-fc19-41b9-b951-5c5f7bcb3f5a._CB559251617_._SY200_.png"),this.hideElement(l),this.hideElement(d),this.showElement(m),this.dispatch("onFeedbackSubmitted",
void 0),this.sendFeedback("MAIN_FEEDBACK","THUMBS_UP",c.EMPTY_FEEDBACK.detailFeedback,c.EMPTY_FEEDBACK.freeFormFeedback,a,c.FEEDBACK_SUCCESS_CALLBACK,c.FEEDBACK_FAILURE_CALLBACK,b),J(F.MAIN_FEEDBACK_REQUEST,ia.THUMBS_UP),k.addCount(p.RUFUS_THUMBSUP_CLICKED,1))}},{key:"handleThumbsDownMouseEnter",value:function(){var a=this.getVotingConfig(),b=a.thumbsDownArea;a.isThumbsDownClicked||this.updateThumbImage(b,"https://m.media-amazon.com/images/G/01/Rufus_Desktop/thumbs_down_hover-43572115-0a37-4aa3-ad4b-6e031a588612._CB559205155_._SY200_.png")}},
{key:"handleThumbsDownMouseLeave",value:function(){var a=this.getVotingConfig(),b=a.thumbsDownArea;a.isThumbsDownClicked||this.updateThumbImage(b,"https://m.media-amazon.com/images/G/01/Rufus_Desktop/thumbs_down-fd26b2f9-143b-468e-9e99-c020f17a6aa0._CB559205155_._SY200_.png")}},{key:"handleThumbsDownMouseClick",value:function(){var a=this.getVotingConfig(),b=a.thumbsDownArea;a.isThumbsDownClicked||(a=document.getElementById("rufus-thumbs-down-feedback-box"),this.updateThumbImage(b,"https://m.media-amazon.com/images/G/01/Rufus_Desktop/thumbs_down_click-a00e7dd1-e695-495e-b9f8-b462ef9adc71._CB559251617_._SY200_.png"),
this.showElement(a),this.scrollIntoViewElementWithId("rufus-thumbs-down-feedback-box"),J(F.MAIN_FEEDBACK_REQUEST,ia.THUMBS_DOWN),k.addCount(p.RUFUS_THUMBSDOWN_CLICKED,1))}},{key:"handleCheckboxChange",value:function(a){var b=a.$target.get(0).name;b=this.getIndexFromCheckboxId(b);a=a.$target.get(0).checked;var c=document.getElementById("rufus-text-area-".concat(b)),d=document.getElementById("rufus-thumbs-down-feedback-box");d=null==d?void 0:d.querySelector('input[name\x3d"rufus-checkbox-'.concat(b,
'"]'));a?this.checkedIndices.add(b):this.checkedIndices.delete(b);this.toggleTextAreaDisplay(c);this.toggleSubmitButton(d)}},{key:"handleDismissButtonClick",value:function(a,b){this.showThumbsDownFeedbackSentText();this.sendFeedback("MAIN_FEEDBACK","THUMBS_DOWN",c.EMPTY_FEEDBACK.detailFeedback,c.EMPTY_FEEDBACK.freeFormFeedback,a,c.FEEDBACK_SUCCESS_CALLBACK,c.FEEDBACK_FAILURE_CALLBACK,b)}},{key:"handleSubmitButtonClick",value:function(a,b){var d=this.extractFeedbackData(),g=d.detailFeedback;d=d.freeFormFeedback;
0<this.checkedIndices.size&&k.addCount(p.RUFUS_FEEDBACK_OPTION_SUBMITTED,1);this.checkedIndices=new Set;this.showThumbsDownFeedbackSentText();this.sendFeedback("DETAIL_FEEDBACK","THUMBS_DOWN",g,d,a,function(){k.widgetBodyEnd(ma.RUFUS_FEEDBACK_LATENCY,!1);k.addCount(p.RUFUS_FEEDBACK_TEXT_SUBMITTED,1)},c.FEEDBACK_FAILURE_CALLBACK,b);J(F.DETAIL_FEEDBACK_REQUEST,ia.THUMBS_DOWN)}},{key:"getVotingConfig",value:function(){var a=document.getElementById("rufus-thumbs-down"),b=document.getElementById("rufus-thumbs-up");
return{thumbsUpArea:b,thumbsDownArea:a,isThumbsDownClicked:a&&"https://m.media-amazon.com/images/G/01/Rufus_Desktop/thumbs_down_click-a00e7dd1-e695-495e-b9f8-b462ef9adc71._CB559251617_._SY200_.png"===a.src,isThumbsUpClicked:b&&"https://m.media-amazon.com/images/G/01/Rufus_Desktop/thumbs_up_click-9ca6525e-fc19-41b9-b951-5c5f7bcb3f5a._CB559251617_._SY200_.png"===b.src}}},{key:"updateThumbImage",value:function(a,b){a&&(a.src=b)}},{key:"hideElement",value:function(a){null==a||a.classList.add("aok-hidden")}},
{key:"showElement",value:function(a){null==a||a.classList.remove("aok-hidden")}},{key:"scrollIntoViewElementWithId",value:function(a){this.dispatch("onThumbsDownClick",a)}},{key:"toggleSubmitButton",value:function(a){a&&a.checked?(0===this.numberOfCheckBoxChecked&&this.enableSubmitButton(),this.numberOfCheckBoxChecked+=1):(1===this.numberOfCheckBoxChecked&&this.disableSubmitButton(),--this.numberOfCheckBoxChecked)}},{key:"enableSubmitButton",value:function(){var a=document.getElementById("rufus-submit-feedback-button"),
b=document.getElementById("rufus-submit-feedback-button-announce");a.classList.remove("a-button-disabled");b.removeAttribute("disabled")}},{key:"disableSubmitButton",value:function(){var a=document.getElementById("rufus-submit-feedback-button"),b=document.getElementById("rufus-submit-feedback-button-announce");a.classList.add("a-button-disabled");b.setAttribute("disabled","disabled")}},{key:"getIndexFromCheckboxId",value:function(a){return a.split("-").pop()||""}},{key:"toggleTextAreaDisplay",value:function(a){a&&
a.classList.toggle("aok-hidden")}},{key:"extractFeedbackData",value:function(){var a,b=[],c="",g=function(a,b){var c="undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(!c){if(Array.isArray(a)||(c=function(a,b){if(a){if("string"==typeof a)return ef(a,b);var c={}.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?ef(a,b):void 0}}(a))||b&&a&&"number"==
typeof a.length){c&&(a=c);var d=0;b=function(){};return{s:b,n:function(){return d>=a.length?{done:!0}:{done:!1,value:a[d++]}},e:function(a){throw a;},f:b}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var g,l=!0,q=!1;return{s:function(){c=c.call(a)},n:function(){var a=c.next();return l=a.done,a},e:function(a){q=!0;g=a},f:function(){try{l||null==c.return||c.return()}finally{if(q)throw g;
}}}}(this.checkedIndices);try{for(g.s();!(a=g.n()).done;){var k=a.value,p=document.getElementsByName("rufus-checkbox-".concat(k)),m=null!=p?p[0]:null;m&&""!=m.value.trim()&&b.push(m.value);var xa=document.getElementById("rufus-text-area-inner-".concat(k));xa&&(c+=xa.value)}}catch(ta){g.e(ta)}finally{g.f()}return{detailFeedback:b,freeFormFeedback:c}}},{key:"showThumbsDownFeedbackSentText",value:function(){var a,b=document.getElementById("rufus-thumbs-down-feedback-box"),c=document.getElementById("rufus-thumbs-up"),
g=document.getElementById("rufus-feedback-text"),k=document.getElementById("rufus-thumbs-down-feedback-sent-text");this.numberOfCheckBoxChecked=0;b.remove();null===(a=c.parentElement)||void 0===a||a.remove();this.hideElement(g);this.showElement(k);this.dispatch("onFeedbackSubmitted",void 0)}},{key:"sendFeedback",value:function(b,c,q,g,C,p,m,xa){k.widgetBodyBegin(ma.RUFUS_FEEDBACK_LATENCY);var d=Ca(),l=d.uxSessionId,P=d.nileRequestId,N=d.sessionId;d=d.marketplaceId;var r=(new Date).toISOString();b=
{method:"POST",params:this.shouldUseRufusCommonModule?Fi.buildPayload(this.panelContainer,b,l,d,P,r,q,g,c,N):{feedbackType:b,conversationId:l+d,turnRequestId:P,gmtTime:r,detailFeedback:q,freeformFeedback:g,mainFeedback:c,turnSessionId:N,pageContext:xa.buildFeedbackPageContext()},paramsFormat:"json",contentType:"application/json",success:p,error:m,headers:a({},jb.ANTI_CSRF_TOKEN,Md())};C.post("".concat("/rufus/cl/","feedback?tabId\x3d").concat(l,"\x26ref\x3d").concat(Eb.FEEDBACK),b)}}])}(Ga);a(td,
"EMPTY_FEEDBACK",{detailFeedback:[],freeFormFeedback:""});a(td,"FEEDBACK_SUCCESS_CALLBACK",function(){k.widgetBodyEnd(ma.RUFUS_FEEDBACK_LATENCY,!1)});a(td,"FEEDBACK_FAILURE_CALLBACK",function(){k.widgetBodyEnd(ma.RUFUS_FEEDBACK_LATENCY,!0)});var hc=function(a){return a.HANDLE_EXPAND="rufus-cl-handle-expand",a.HANDLE_STREAM="rufus-cl-handle-stream",a}({}),Gi=["heroBanner","rufusMarketing"],Hi={heroBanner:{actions:[{name:"HolidayShopRedirect",type:"stream",context:{qis:Ma.NILE_INGRESS_LINK}},{name:"GetStartedRedirect",
type:"stream",context:{qis:Ma.NILE_INGRESS_LINK}}]},rufusMarketing:{actions:[{name:"DealsRedirect",type:"stream",context:{qis:Ma.NILE_INGRESS_LINK}},{name:"GiftingRedirect",type:"stream",context:{qis:Ma.NILE_INGRESS_LINK}},{name:"CategoryRedirect",type:"stream",context:{qis:Ma.NILE_INGRESS_LINK}}]}},xg=function(a){a=(new URL(a)).searchParams;var b=a.get("rufus-action"),c=a.get("rufus-client");if(b||c){var l=function(a,b){if(a&&b&&(c=b,Gi.includes(c)))return function(a,b){return Hi[a].actions.find(function(a){return a.name===
b})}(b,a);var c}(b,c);if(l)return{action:b,client:c,query:a.get("rufus-query"),actionConfig:l};a="rufus-action: ".concat(b," is not defined as an available action for rufus-client: \n     ").concat(c," in the CL_EXTERNAL_CLIENT_CONFIGS");k.logErrorWithLevel(H.ERROR,a)}},yg=c.location.hostname,Ii=(K.getUrlByDomain(yg,"www.amazon.com"===yg?"Rufus/b?node\x3d121214013011\x26ref_\x3dnl_cl_dsk_faq":""),{OPEN_FAQ:{actions:[{action:"GET_STARTED",payload:void 0}]}}),Ji=function(b){function c(){var b;z(this,
c);a(b=function(a,b,c){return b=y(b),R(a,gf()?Reflect.construct(b,[],y(a).constructor):b.apply(a,c))}(this,c),"startPositionY",0);a(b,"handleAutoMinimizeToggleSwitchStateChange",function(a){fa.when("a-switch").execute(function(b){var c=document.getElementById("rufus-overflow-menu-auto-minimize-toggle");c?b.getSwitch(c).isOn(a):k.logErrorWithLevel(H.ERROR,"Errors happened when auto-minimize toggle switch state changing, toggle switch was not found")})});a(b,"initializeAutoMinimizeToggleSwitchEvents",
function(){var a=document.getElementById("rufus-overflow-menu-auto-minimize-toggle");a?(a.addEventListener("click",function(){k.addCount(p.RUFUS_PANEL_OVERFLOW_MENU_AUTO_MINIMIZE,1);fa.when("a-switch").execute(function(b){b.getSwitch(a).isOn()?J(F.RUFUS_PANEL_OVERFLOW_MENU,ia.AUTO_MINIMIZE_ENABLE):J(F.RUFUS_PANEL_OVERFLOW_MENU,ia.AUTO_MINIMIZE_DISABLE)})}),fa.when("A").execute(function(a){a.on("a:switch:rufus-overflow-menu-auto-minimize-toggle:on",function(){b.dispatch("onAutoMinimizeClick",!0)});
a.on("a:switch:rufus-overflow-menu-auto-minimize-toggle:off",function(){b.dispatch("onAutoMinimizeClick",!1)})})):k.logErrorWithLevel(H.ERROR,"Errors happened when auto-minimize toggle switch initialized, toggle switch was not found")});a(b,"onOptionClicked",function(a){a.forEach(function(a){"GET_STARTED"===a.action?(b.overflowMenuContainer.style.transition="none",b.setElementState(b.overflowMenuContainer,"closed"),J(F.RUFUS_PANEL_OVERFLOW_MENU,ia.GET_STARTED),J(F.RUFUS_PANEL_OVERFLOW_MENU,ia.OVERFLOW_MENU_CLOSE),
k.addCount(p.RUFUS_PANEL_OVERFLOW_MENU_GET_STARTED,1),b.dispatch("onGetStartedClicked",void 0)):k.logErrorWithLevel(H.ERROR,"Unsupported action:"+a.action)})});a(b,"overflowButtonClicked",function(a){a.preventDefault();var c="closed"===b.overflowMenuContainer.getAttribute("data-state")?"open":"closed";b.setElementState(b.overflowMenuContainer,c);b.dispatch("onOverflowMenuStateChange",c);J(F.RUFUS_PANEL_OVERFLOW_MENU,"closed"===c?ia.OVERFLOW_MENU_CLOSE:ia.OVERFLOW_MENU_OPEN);b.handleOverflowMenuOutsideClicked();
a.stopPropagation()});a(b,"setElementState",function(a,b){a.setAttribute("data-state",b)});a(b,"mousedown",function(a){a.target!==b.overflowButton&&(a.target===b.overflowMenuContainer||b.overflowMenuContainer.contains(a.target)||(b.setElementState(b.overflowMenuContainer,"closed"),b.dispatch("onOverflowMenuStateChange","closed")))});a(b,"handleOverflowMenuOutsideClicked",function(){"open"===b.overflowMenuContainer.getAttribute("data-state")?document.body.addEventListener("mousedown",b.mousedown):
document.body.removeEventListener("mousedown",b.mousedown)});a(b,"handleMouseenter",function(a){a.preventDefault();b.startPositionY=a.clientY;b.setElementState(b.overflowMenuContainer,"open");document.addEventListener("mousemove",b.handleMousemove);J(F.RUFUS_PANEL_OVERFLOW_MENU,ia.OVERFLOW_MENU_OPEN)});a(b,"handleMousemove",function(a){a=a.clientY-b.startPositionY;"open"===b.overflowMenuContainer.getAttribute("data-state")&&-5>a&&(b.setElementState(b.overflowMenuContainer,"closed"),document.removeEventListener("mousemove",
b.handleMousemove))});var l=new od;b.overflowButton=l.getElementOrRecordMissing("rufus-panel-header-overflow-button");b.overflowChervon=l.getElementOrRecordMissing("rufus-panel-header-overflow");b.overflowMenuContainer=l.getElementOrRecordMissing("rufus-overflow-menu-container");b.overflowMenuInnerOptions=l.getElementOrRecordMissing("rufus-overflow-menu-container-webapp");l=l.getMissingElements();return 0<l.length?(l="[OverflowMenu] Errors happened when overflow menu initialized, Rufus element IDs were not found: "+
l.join(", "),k.logErrorWithLevel(H.ERROR,l),R(b)):(b.initialize(),b)}return Aa(c,b),r(c,[{key:"renderOverflowMenu",value:function(){this.overflowMenuContainer.innerHTML=this.overflowMenuInnerOptions.innerHTML;this.overflowMenuInnerOptions.innerHTML=""}},{key:"initialize",value:function(){this.renderOverflowMenu();this.bindOptionActions();this.overflowButton.addEventListener("click",this.overflowButtonClicked);this.overflowChervon.addEventListener("mouseenter",this.handleMouseenter);this.initializeAutoMinimizeToggleSwitchEvents()}},
{key:"bindOptionActions",value:function(){var a=document.getElementById("rufus-overflow-menu-option-container-faq");a?(a.addEventListener("click",function(a){a.stopPropagation()}),a.addEventListener("click",this.onOptionClicked.bind(this,Ii.OPEN_FAQ.actions))):k.logErrorWithLevel(H.ERROR,"Errors happened when bind option actions, overflow menu faq option container not found")}}])}(Ga),Ra=function(a){function b(){z(this,b);var a=b;var c=(a=y(a),R(this,hf()?Reflect.construct(a,[],y(this).constructor):
a.apply(this,void 0)));return c.currentSearchFilterContext=null,c}return Aa(b,a),r(b,[{key:"setSearchFilterContext",value:function(a){var b;(null===(b=this.currentSearchFilterContext)||void 0===b?void 0:b.asinId)!==(null==a?void 0:a.asinId)&&(this.currentSearchFilterContext&&k.addCount(p.RASIN_CONVERSATION_REFINEMENT_SWAPPED,1),this.currentSearchFilterContext=a,this.dispatch("contextUpdated",this.currentSearchFilterContext),null===a?(J(F.CONVERSATION_REFINEMENT_CLEARED,ia.ASIN_REFINEMENT),k.addCount(p.RASIN_CONVERSATION_REFINEMENT_CLEARED,
1)):(J(F.CONVERSATION_REFINEMENT_SET,ia.ASIN_REFINEMENT),k.addCount(p.RASIN_CONVERSATION_REFINEMENT_SET,1)))}},{key:"getSearchFilterContext",value:function(){return this.currentSearchFilterContext}}],[{key:"getInstance",value:function(){return b.instance||(b.instance=new b),b.instance}}])}(Ga),Ki=function(b){function m(b){var d,g,l,N;z(this,m);a(g=function(a,b,c){return b=y(b),R(a,kf()?Reflect.construct(b,[],y(a).constructor):b.apply(a,c))}(this,m),"startPositionY",0);a(g,"startPositionX",0);a(g,
"newHeight",0);a(g,"newWidth",0);a(g,"showAnimationRunning",!1);a(g,"closeAnimationRunning",!1);a(g,"panelInFocus",!1);a(g,"closeRufusPanelLabel","");a(g,"openRufusPanelLabel","");a(g,"isPanelClosed",function(){return"closed"===g.currentState});a(g,"isPanelExpanded",function(){return"expanded"===g.currentState});a(g,"applyAnimationAndStateUpdateWithDefault",function(a){var b;if(a){var c=null===(b=g.getPanelContainerState())||void 0===b?void 0:b.viewState;c&&g.applyAnimationAndStateUpdate(c,a)}});
a(g,"updateStateAndContent",function(){var a,b=vc.panel.key;try{if(a=sessionStorage.getItem(b)){var c=a&&JSON.parse(a);c.content&&(g.rufusPanelContent.innerHTML=c.content);c.state&&g.updatePanelStateOnNavigationBack(c.state)}}catch(Ua){k.logErrorWithLevelWithException(H.ERROR,Ua,"".concat("RufusPanelContainer"," - Error reading from ").concat(b," ").concat(Ua instanceof Error?"(".concat(Ua.message,")"):""))}});a(g,"updatePanelStateOnNavigationBack",function(a){g.dispatch("onPanelContainerStateChange",
a);g.updatePanelViewStateOnNavigationBack(a);g.resizePanelOnNavigationBack(a)});a(g,"handleNavigateFromTeaserCX",function(a){k.addCount(p.RUFUS_RECOVERY_TEASER_CX_CLICK,1);var b=g.getPanelContainerState().viewState;if("closed"===b||"minimized"===b){var c=g.getPanelViewContext();c.keyword=a;c.qis=Ma.NILE_TEASER_CX_RECOVERY;g.setPanelViewContext(c);g.applyAnimationAndStateUpdate(b,"expanded");k.addCount(p.RUFUS_RECOVERY_TEASER_CX_OPEN_PANEL,1)}});a(g,"applyAnimationAndStateUpdate",function(a,b,c,d){a===
b||g.closeAnimationRunning||(g.A.trigger("rufus-panel-state-change",a,b),g.resetRufusFlyoutDivClassName(),g.applyPanelAnimation(a,b)&&g.handlePanelStateUpdate(b,c,d))});a(g,"isShowAnimationRunning",function(){return g.showAnimationRunning});a(g,"setPanelViewContext",function(a){g.rufusPanelViewContext.value=JSON.stringify(a)});a(g,"updatePanelState",function(a,b){var c=g.currentState;c=c?"".concat(c,"_to_").concat(a):a;J(b?F.PANEL_RESIZE_RUFUS:F.PANEL_RESIZE,c);g.currentState=a;g.rufusFlyoutDiv.setAttribute("data-state",
a);g.rufusButton.setAttribute("data-state",a);g.rufusButton.setAttribute("aria-label","expanded"===a?g.closeRufusPanelLabel:g.openRufusPanelLabel);g.panelInFocus="expanded"===g.currentState;g.logPanelFocusMetrics();k.addCount(p.RUFUS_PANEL_STATE_PREFIX+g.currentState.toUpperCase(),1);g.onPanelContainerStateChange();"expanded"===a&&g.updateRQPillsWidth(jf())});a(g,"bindActions",function(){g.navbar&&g.rufusButton&&g.rufusFlyoutDiv&&g.rufusPanelMinimizeButton&&g.rufusPanelCloseButton&&g.rufusPanelHeader&&
g.rufusPanelViewContext?(g.rufusButton.addEventListener("click",g.handleIngressClick),g.rufusPanelHeader.addEventListener("click",g.handlePanelHeaderClick),g.rufusPanelMinimizeButton.addEventListener("click",g.handlePanelMinimizeClick),g.rufusPanelCloseButton.addEventListener("click",g.handlePanelCloseClick),g.rufusPanelResizeHandleTop&&g.rufusPanelResizeHandleRight&&g.rufusPanelResizeHandleTopRight&&g.rufusPanelGrabber?(g.rufusPanelResizeHandleTop.addEventListener("mousedown",g.mousedownHandler),
g.rufusPanelResizeHandleRight.addEventListener("mousedown",g.mousedownHandler),g.rufusPanelResizeHandleTopRight.addEventListener("mousedown",g.mousedownHandler),g.rufusPanelGrabber.addEventListener("mousedown",g.mousedownHandler),g.rufusFlyoutDiv.addEventListener("dragstart",g.dragstart),c.addEventListener("resize",function(){g.rufusFlyoutDiv.classList.add("rufus-no-transition");var a=g.rufusFlyoutDiv.offsetTop,b=g.navbar.offsetTop+g.navbar.offsetHeight+12;a<b&&(g.newHeight=Math.max(g.newHeight-(b-
a),360),g.rufusFlyoutDiv.style.setProperty("--expanded-container-height",g.newHeight+"px"))}),c.addEventListener("click",function(a){var b=document.querySelector("#nav-rufus-content .rufus-container"),c=a.target;b&&b.contains(a.target)?g.panelInFocus||(g.panelInFocus=!0,g.logPanelFocusMetrics()):g.panelInFocus&&!["rufus-panel-header-minimize","rufus-panel-header-close","nav-rufus-disco-avatar","nav-rufus-disco-text","nav-rufus-disco"].includes(c.id)&&(g.panelInFocus=!1,g.logPanelFocusMetrics())}),
c.P&&fa.when("navbarJSLoaded").execute(function(){c.$Nav&&c.$Nav.getNow("cover")&&(c.$Nav.getNow("cover").isVisible()?g.hideRufusPanel():g.showRufusPanel(),c.$Nav.getNow("cover").onShow(function(){return g.hideRufusPanel()}),c.$Nav.getNow("cover").onHide(function(){return g.showRufusPanel()}))})):k.logErrorWithLevel(H.ERROR,"Error binding resize actions in PanelContainer, resize div in Rufus card is missing")):k.logErrorWithLevel(H.ERROR,"Error binding actions in PanelContainer, some div in Rufus card is missing")});
a(g,"hideRufusPanel",function(){g.rufusFlyoutDiv.style.zIndex=String(Number(c.getComputedStyle(g.navbar).zIndex)-3)});a(g,"showRufusPanel",function(){g.rufusFlyoutDiv.style.zIndex=""});a(g,"resizePanelOnNavigationBack",function(a){g.newHeight=a.height;g.newWidth=a.width;g.rufusFlyoutDiv.style.setProperty("--expanded-container-height",g.newHeight+"px");g.rufusFlyoutDiv.style.setProperty("--expanded-container-width",g.newWidth+"px")});a(g,"updatePanelViewStateOnNavigationBack",function(a){g.applyAnimationAndStateUpdate(g.currentState,
a.autoMinimize&&"closed"!=a.viewState?"minimized":a.viewState);g.dispatch("onAutoMinimizeToggleSwitchStateChange",a.autoMinimize)});a(g,"resetRufusFlyoutDivClassName",function(){g.rufusFlyoutDiv.className="rufus-panel-container"});a(g,"handlePanelStateUpdate",function(a,b,c){"closed"===a?(g.closeAnimationRunning=!0,g.addAnimationEndListener(function(){return g.onHideAnimationEnd(a,b,c)})):(g.showAnimationRunning=!0,g.addAnimationEndListener(function(){return g.onShowAnimationEnd(a)}),g.updatePanelState(a,
b))});a(g,"addAnimationEndListener",function(a){g.rufusFlyoutDiv.addEventListener("animationend",a,{once:!0})});a(g,"onHideAnimationEnd",function(a,b,c){var d,l;g.updatePanelState(a,b);null===(null===(d=Ra.getInstance())||void 0===d?void 0:d.getSearchFilterContext())||null!==(l=Ra.getInstance())&&void 0!==l&&l.setSearchFilterContext(null);g.closeAnimationRunning=!1;null!=c&&c||g.updateTruncateState(a);g.dispatch("onPanelAnimationEnd",a)});a(g,"onShowAnimationEnd",function(a){g.showAnimationRunning=
!1;g.dispatch("onPanelAnimationEnd",a);"expanded"===a&&g.updateScrollButtonVisibility()});a(g,"handleIngressClick",function(){g.applyAnimationAndStateUpdate(g.currentState,"expanded"!==g.currentState?"expanded":"closed")});a(g,"handlePanelCloseClick",function(a){switch(g.applyAnimationAndStateUpdate(g.currentState,"closed",void 0,void 0),g.getPanelContainerState().viewState){case "expanded":k.addCount(p.RUFUS_CLOSE_CLICK_FROM_EXPANDED,1);J(F.PANEL_CLOSE_CLICK);break;case "minimized":k.addCount(p.RUFUS_CLOSE_CLICK_FROM_MINIMIZED,
1),J(F.PANEL_CLOSE_CLICK)}a.stopPropagation()});a(g,"handlePanelHeaderClick",function(){"minimized"===g.currentState&&(g.applyAnimationAndStateUpdate(g.currentState,"expanded"),J(F.PANEL_EXPAND_CLICK))});a(g,"handlePanelMinimizeClick",function(a){var b="minimized"===g.currentState,c=b?"expanded":"minimized";J(b?F.PANEL_EXPAND_CLICK:F.PANEL_MINIMIZE_CLICK);g.applyAnimationAndStateUpdate(g.currentState,c,!1,!0);a.stopPropagation()});a(g,"disableTextSelection",function(a){a.preventDefault()});a(g,"mousedownHandler",
function(a){if(0===a.button&&"expanded"===g.currentState){var b=a.target;g.startPositionY=a.clientY;g.startPositionX=a.clientX;"BUTTON"!==b.tagName&&(document.addEventListener("selectstart",g.disableTextSelection),b===g.rufusPanelResizeHandleTopRight?(document.addEventListener("mousemove",g.mousemoveHeight),document.addEventListener("mousemove",g.mousemoveWidth),document.addEventListener("mouseup",g.mouseupHandler),g.rufusPanelResizeHandleTop.style.cursor="nesw-resize",g.rufusPanelResizeHandleRight.style.cursor=
"nesw-resize"):b===g.rufusPanelResizeHandleTop||b===g.rufusPanelGrabber?(document.addEventListener("mousemove",g.mousemoveHeight),document.addEventListener("mouseup",g.mouseupHandler),g.rufusPanelResizeHandleTopRight.style.cursor="ns-resize",g.rufusPanelResizeHandleRight.style.cursor="ns-resize"):b===g.rufusPanelResizeHandleRight&&(document.addEventListener("mousemove",g.mousemoveWidth),document.addEventListener("mouseup",g.mouseupHandler),g.rufusPanelResizeHandleTopRight.style.cursor="ew-resize",
g.rufusPanelResizeHandleTop.style.cursor="ew-resize"))}});a(g,"mousemoveHeight",function(a){g.rufusFlyoutDiv.style.transition="none";var b=a.clientY-g.startPositionY;g.rufusFlyoutDiv.offsetTop+b<=g.navbar.offsetTop+g.navbar.offsetHeight+12||(g.newHeight=g.rufusFlyoutDiv.clientHeight-b,g.newHeight=Math.max(g.newHeight,360),g.rufusFlyoutDiv.style.setProperty("--expanded-container-height",g.newHeight+"px"),360==g.newHeight&&a.clientY>g.startPositionY||(g.startPositionY=a.clientY))});a(g,"mousemoveWidth",
function(a){g.rufusFlyoutDiv.style.transition="none";g.newWidth=g.rufusFlyoutDiv.clientWidth-(g.startPositionX-a.clientX);g.newWidth=Math.max(g.newWidth,290);g.newWidth=Math.min(g.newWidth,400);var b=400<=g.newWidth&&a.clientX>g.startPositionX,c=290>=g.newWidth&&a.clientX<g.startPositionX;g.rufusFlyoutDiv.style.setProperty("--expanded-container-width",g.newWidth+"px");b||c||(g.startPositionX=a.clientX,g.debouncedUpdateRQPillsWidth())});a(g,"mouseupHandler",function(){g.rufusFlyoutDiv.style.transition=
g.rufusPanelTransition;g.rufusPanelResizeHandleTopRight.style.cursor="nesw-resize";g.rufusPanelResizeHandleTop.style.cursor="ns-resize";g.rufusPanelResizeHandleRight.style.cursor="ew-resize";g.onPanelContainerStateChange();g.updateScrollButtonVisibility();document.removeEventListener("mousemove",g.mousemoveHeight);document.removeEventListener("mousemove",g.mousemoveWidth);document.removeEventListener("mouseup",g.mouseupHandler);document.removeEventListener("selectstart",g.disableTextSelection)});
a(g,"dragstart",function(){g.mouseupHandler()});a(g,"onPanelContainerStateChange",function(){g.dispatch("onPanelContainerStateChange",g.getPanelContainerState())});a(g,"updateScrollButtonVisibility",function(){g.dispatch("updateScrollButtonVisibility",void 0)});a(g,"mapBottomSheetSizeToPanelState",function(a){return"expanded"!==a?g.getPanelContainerState().viewState:a});a(g,"updateRQPillsWidth",function(a){document.querySelectorAll("button.rufus-pill key, button.rufus-web-pill key").forEach(function(b){return Cf(b,
a)})});a(g,"debouncedUpdateRQPillsWidth",(l=g.updateRQPillsWidth,N=null,function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];clearTimeout(N);N=setTimeout(function(){l.apply(g,b)},100)}));g.A=b;g.navbar=document.getElementById("navbar");g.rufusFlyoutDiv=document.getElementById("nav-flyout-rufus");g.rufusPanelContent=document.getElementById("nav-rufus-content");g.rufusButton=document.getElementById("nav-rufus-disco");g.rufusPanelMinimizeButton=document.getElementById("rufus-panel-header-minimize");
g.rufusPanelCloseButton=document.getElementById("rufus-panel-header-close");g.rufusPanelHeader=document.getElementsByClassName("rufus-panel-header-container")[0];g.rufusPanelGrabber=document.getElementById("rufus-panel-header-grabber-row");g.rufusPanelViewContext=document.getElementById("rufus-view-context");g.rufusPanelResizeHandleTop=document.getElementById("rufus-panel-resize-handle-top");g.rufusPanelResizeHandleRight=document.getElementById("rufus-panel-resize-handle-right");g.rufusPanelResizeHandleTopRight=
document.getElementById("rufus-panel-resize-handle-top-right");g.currentState=null===(d=g.rufusFlyoutDiv)||void 0===d?void 0:d.getAttribute("data-state");b=g.rufusFlyoutDiv.style.getPropertyValue("--expanded-container-height");d=g.rufusFlyoutDiv.style.getPropertyValue("--expanded-container-width");g.newHeight=b?parseInt(b):0;g.newWidth=d?parseInt(d):0;g.rufusPanelTransition=g.rufusFlyoutDiv.style.transition;g.panelInFocus=g.currentState&&"expanded"===g.currentState;g.panelInFocus&&g.logPanelFocusMetrics();
g.bindActions();(b=g.getPanelViewContext().panelStateOnIngressClick)&&("expanded"===b?J(F.RUFUS_OPEN,ia.RUFUS_ICON_TAP):"closed"===b&&J(F.RUFUS_CLOSE,ia.RUFUS_ICON_TAP));k.addCount(p.RUFUS_PANEL_CONTAINER_INSTANTIATED,1);g.recordWeblabIfNotAlreadyRecorded("RUFUS_DESKTOP_VISUAL_BRANDING_UPDATE_1201601","rufus_visual_branding_recorded");g.recordWeblabIfNotAlreadyRecorded("NAV_RUFUS_DESKTOP_NEW_LOGO_1214746","rufus_new_logo_recorded");b=na.getInstance().getWeblabTreatment("RUFUS_DESKTOP_VISUAL_BRANDING_UPDATE_1201601");
return"T1"!==b&&"T2"!==b||(g.rufusPanelContent.style.backgroundColor="#FFFFFF"),g.initializeAccessibilityLabels(),g}return Aa(m,b),r(m,[{key:"getPanelContainerState",value:function(){return{height:this.newHeight,width:this.newWidth,viewState:this.currentState}}},{key:"getPanelViewContext",value:function(){try{var a=JSON.parse(this.rufusPanelViewContext.value)}catch(q){console.error("".concat("RufusPanelContainer"," - Error parsing viewContext ").concat(this.rufusPanelViewContext.value," ").concat(q instanceof
Error?"(".concat(q.message,")"):""))}return{pageType:a.pageType,keyword:a.keyword?a.keyword:"",asin:a.asin?a.asin:"",qis:a.qis?a.qis:"",metadata:a.metadata?a.metadata:"",panelStateOnIngressClick:a.panelStateOnIngressClick?a.panelStateOnIngressClick:""}}},{key:"handlePanelContainerViewStateUpdateWithCXZen",value:function(a){a=this.mapBottomSheetSizeToPanelState(a);this.applyAnimationAndStateUpdate(this.getPanelContainerState().viewState,a,!0);k.addCount(p.RUFUS_PANEL_EXPANDED_BY_CX_ZEN,1)}},{key:"handleOverflowMenuStateChange",
value:function(a){"open"===a?this.rufusFlyoutDiv.classList.add("rufus-panel-container-persistent-hover"):this.rufusFlyoutDiv.classList.remove("rufus-panel-container-persistent-hover")}},{key:"updateTruncateState",value:function(a){"expanded"===a&&(document.querySelectorAll("#rufus-conversation-container-inner .rufus-category-card-title .a-truncate").forEach(function(a){a.setAttribute("data-a-manual-update","true")}),c.P.when("A","a-truncate").execute(function(a,b){b.manualTruncate("#rufus-conversation-container-inner .rufus-category-card-title");
b.switchToAutoTruncate("#rufus-conversation-container-inner .rufus-category-card-title")}))}},{key:"logPanelFocusMetrics",value:function(){this.panelInFocus?(k.addCount(p.RUFUS_PANEL_INFOCUS,1),J(p.RUFUS_PANEL_INFOCUS)):(k.addCount(p.RUFUS_PANEL_OUTFOCUS,1),J(p.RUFUS_PANEL_OUTFOCUS))}},{key:"applyPanelAnimation",value:function(a,b){a="".concat(a,"_").concat(b);b=mh.get(a)||"";return""===b?(k.logErrorWithLevel(H.ERROR,"Error adding animation to panel due to invalid transitionKey: ".concat(a,", animationClass should not be empty")),
!1):(this.rufusFlyoutDiv.classList.add(b),!0)}},{key:"recordWeblabIfNotAlreadyRecorded",value:function(a,b){if(!sessionStorage.getItem(b)){var c=na.getInstance().getWeblabTreatment(a);c&&(k.recordTrigger(a,c),sessionStorage.setItem(b,"true"))}}},{key:"initializeAccessibilityLabels",value:(d=G(Q().mark(function q(){var a;return Q().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,b.next=3,Te(document.documentElement.lang);case 3:a=b.sent;this.closeRufusPanelLabel=a.getMessage("rufus_panel_close");
this.openRufusPanelLabel=a.getMessage("rufus_panel_open");b.next=13;break;case 8:b.prev=8,b.t0=b.catch(0),k.logErrorWithLevel(H.ERROR,"Error initializing accessibility labels: ".concat(b.t0 instanceof Error?b.t0.message:"")),this.closeRufusPanelLabel="Close Rufus panel",this.openRufusPanelLabel="Open Rufus panel";case 13:case "end":return b.stop()}},q,this,[[0,8]])})),function(){return d.apply(this,arguments)})}]);var d}(Ga),Li=function(){return r(function d(b){z(this,d);a(this,"RUFUS_PANEL_IMAGE_MODAL_IMAGE",
".rufus-panel-image-modal-image");a(this,"IMAGE_POPOVER_NAME","image-popover");a(this,"RUFUS_PANEL_IMAGE_MODAL_CLOSE_WRAPPER",".rufus-panel-image-modal-close-wrapper");a(this,"POPOVER_CLOSE_DATA_MODEL","data-a-popover-close");this.A=b;this.initialize()},[{key:"initialize",value:function(){this.registerOnImagePopoverShow(this.A)}},{key:"registerOnImagePopoverShow",value:function(a){var b=this;a.on("a:popover:show:"+this.IMAGE_POPOVER_NAME,function(a){k.addCount(p.RUFUS_MULTIMODAL_POPOVER_SHOWN,1);
a=a.popover.getContent();var c=a.find(b.RUFUS_PANEL_IMAGE_MODAL_IMAGE)[0];a=a.find(b.RUFUS_PANEL_IMAGE_MODAL_CLOSE_WRAPPER)[0];b.handleDismissButton(a);c.src.includes("_SL")&&(c.onload=function(){k.widgetBodyEnd(ma.RUFUS_HIGH_RESOLUTION_IMAGE_LOADED_LATENCY);k.widgetBodyBegin(ma.RUFUS_HIGH_RESOLUTION_IMAGE_RENDERED_LATENCY);c.decode().then(function(){k.widgetBodyEnd(ma.RUFUS_HIGH_RESOLUTION_IMAGE_RENDERED_LATENCY)})},c.src=function(a){var b=a.split(".");if(2<=b.length&&a.includes("_SL")&&a.includes("m.media-amazon.com")){var c=
b[b.length-1];return a.replace("".concat(b[b.length-2],".").concat(c),c)}return k.logErrorWithLevel(H.ERROR,"Image has a non-media central url or is not low res url."),a}(c.src),k.widgetBodyBegin(ma.RUFUS_HIGH_RESOLUTION_IMAGE_LOADED_LATENCY),c.onerror=function(a){vg("HIGH","RENDER",a.toString())})})}},{key:"handleDismissButton",value:function(a){var b=this;a.addEventListener("click",function(){k.addCount(p.RUFUS_MULTIMODAL_DISMISS_BUTTON_CLICKED,1);var c=a.parentElement.getAttribute(b.POPOVER_CLOSE_DATA_MODEL);
if(null!=c){var d,g;c=null!==(d=null===(g=JSON.parse(c))||void 0===g?void 0:g.actionId)&&void 0!==d?d:"";J(F.CLOSE_MEDIA,c)}})}}])}(),Mi=function(b){function m(){var b;return z(this,m),a(b=function(a,b,c){return b=y(b),R(a,lf()?Reflect.construct(b,[],y(a).constructor):b.apply(a,c))}(this,m),"isComposing",!1),a(b,"setFocus",function(){b.elements.textArea.focus()}),a(b,"handleCompositionStart",function(){b.isComposing=!0}),a(b,"handleCompositionEnd",function(){b.isComposing=!1}),a(b,"handleInput",function(){b.adjustTextAreaHeight();
b.isInputEmpty()?(J(F.INPUT_TEXT_ERASE),b.elements.submitButton.classList.add("aok-hidden")):b.elements.submitButton.classList.remove("aok-hidden")}),a(b,"adjustTextAreaHeight",function(){var a=c.getComputedStyle(b.elements.textArea),d=parseFloat(a.paddingTop),g=parseFloat(a.paddingBottom),k=parseFloat(a.lineHeight);b.elements.textArea.style.height="auto";b.elements.textArea.rows=1;a=b.elements.textArea.scrollHeight;d=4*k+(d+g);a>d?(b.elements.scrollButton.style.bottom="".concat(d+26,"px"),b.elements.textArea.style.overflowY=
"auto",b.elements.textArea.style.height="".concat(d,"px"),b.elements.textArea.scrollTop=b.elements.textArea.scrollHeight):(b.elements.scrollButton.style.bottom="".concat(a+26,"px"),b.elements.textArea.style.overflowY="hidden",b.elements.textArea.style.height="".concat(a,"px"));b.elements.submitButtonContainer.style.paddingRight="".concat(b.elements.textArea.offsetWidth-b.elements.textArea.clientWidth+20,"px")}),a(b,"handleKeyDown",function(a){"Enter"!==a.key||a.shiftKey||b.isIMEComposing(a)||(a.preventDefault(),
k.addCount(p.RUFUS_ENTER_PRESSED_ON_INPUT_TEXT,1),b.onQuery())}),a(b,"handleSubmitMouseUp",function(){b.elements.submitButton.classList.remove("clicked")}),a(b,"handleSubmitMouseDown",function(){b.elements.submitButton.classList.add("clicked")}),a(b,"submitButtonClicked",function(){k.addCount(p.RUFUS_SUBMIT_ON_INPUT_TEXT,1);b.onQuery()}),a(b,"onQuery",function(){b.isInputEmpty()||(J(F.INPUT_TEXT_TRIGGER),b.dispatch("onQuery",{query:b.elements.textArea.value}),b.reset(),b.adjustTextAreaHeight())}),
a(b,"logTextFocus",function(){J(F.INPUT_TEXT_FOCUS)}),a(b,"isInputEmpty",function(){return""===b.elements.textArea.value.trim()}),a(b,"reset",function(){b.elements.textArea.value="";b.elements.submitButton.classList.add("aok-hidden")}),b.elements=b.readHtmlElementsFromDom(),b.reset(),b.attachEventListeners(),b}return Aa(m,b),r(m,[{key:"refreshOnBfCacheNavigation",value:function(){Object.assign(this.elements,this.readHtmlElementsFromDom());this.attachEventListeners()}},{key:"readHtmlElementsFromDom",
value:function(){var a,b=document.querySelector(".nav-rufus-content");return{textArea:document.getElementById("rufus-text-area"),submitButton:document.getElementById("rufus-submit-button"),scrollButton:document.getElementById("rufus-scroll-button"),submitButtonContainer:null!==(a=null==b?void 0:b.querySelector(".rufus-submit-icon-container"))&&void 0!==a?a:null==b?void 0:b.querySelector(".rufus-web-submit-icon-container")}}},{key:"attachEventListeners",value:function(){this.elements.textArea.addEventListener("keydown",
this.handleKeyDown);this.elements.textArea.addEventListener("input",this.handleInput);this.elements.textArea.addEventListener("click",this.logTextFocus);this.elements.textArea.addEventListener("compositionstart",this.handleCompositionStart);this.elements.textArea.addEventListener("compositionend",this.handleCompositionEnd);this.elements.submitButton.addEventListener("click",this.submitButtonClicked);this.elements.submitButton.addEventListener("mousedown",this.handleSubmitMouseDown);this.elements.submitButton.addEventListener("mouseup",
this.handleSubmitMouseUp);this.elements.submitButton.addEventListener("mouseleave",this.handleSubmitMouseUp)}},{key:"isIMEComposing",value:function(a){return a.isComposing||229===a.keyCode||this.isComposing}}])}(Ga),we=function(a){return a.ShouldDelayThickClientInitialization="shouldDelayThickClientInitialization",a.ShouldDelayThickClientInitialStreaming="shouldDelayThickClientInitialStreaming",a}({}),mb=r(function E(){z(this,E)});a(mb,"RASIN_WIDGET_NAME","RufusAsinIngressButton");a(mb,"RASIN_WIDGET_TYPE",
"AsinFaceoutComponent");a(mb,"RASIN_WIDGET_LOCATION","actions-recipe");a(mb,"RASIN_FEATURE_NAME","rasin");var zg=function(){function a(){z(this,a)}return r(a,[{key:"buildEnhancedContext",value:function(a){var b,c,g,d=Ra.getInstance().getSearchFilterContext();return d?(this.logRasinQisMetric(null==a||null===(b=a.queryContext)||void 0===b?void 0:b.qis),hb(hb({},a),{},{queryContext:this.buildQueryContext(a.queryContext,d),pageContext:this.buildPageContext(a.pageContext,d,(null==a||null===(c=a.queryContext)||
void 0===c?void 0:c.actionType)===Z.ASIN_CLICK),metaDataMap:this.buildMetaDataMap(null==a||null===(g=a.queryContext)||void 0===g?void 0:g.actionType)})):a}},{key:"buildQueryContext",value:function(a,b){if(void 0!==a)return(null==a?void 0:a.actionType)===Z.ASIN_CLICK?hb(hb({},a),{},{actionType:Z.ASIN_CLICK,clickedAsinId:b.asinId,query:"",qis:qa.NILE_ASIN_INGRESS}):hb(hb({},a),{},{actionType:Z.SEARCH,query:null==a?void 0:a.query,qis:null==a?void 0:a.qis})}},{key:"buildPageContext",value:function(a,
b,c){if(void 0!==a){var g=[{type:"ASIN",value:b.asinId}],d=K.extractBaseUrl(a.targetUrl);c=c?"?ref_\x3d".concat(Eb.RASIN_INGRESS_BUTTON_CLICK):"";b="".concat(d,"/dp/").concat(b.asinId).concat(c);return hb(hb({},a),{},{pageType:wa.DETAIL_PAGE,targetPageType:wa.DETAIL_PAGE,originPageType:null==a?void 0:a.originPageType,targetUrl:b,pageMetadata:g,targetPageMetadata:g,originPageMetadata:g})}}},{key:"buildMetaDataMap",value:function(a){if(a)return{rawOriginPageType:wa.SEARCH_RESULTS,rawTargetPageType:wa.SEARCH_RESULTS,
widgetName:mb.RASIN_WIDGET_NAME,widgetType:mb.RASIN_WIDGET_TYPE,widgetLocation:mb.RASIN_WIDGET_LOCATION,refmarker:a===Z.ASIN_CLICK?Eb.RASIN_INGRESS_BUTTON_CLICK:"",featureName:mb.RASIN_FEATURE_NAME}}},{key:"logRasinQisMetric",value:function(a){if(a&&Object.values(qa).includes(a))switch(a){case qa.NILE_CL_TEXT_INPUT:k.addCount(p.RASIN_CL_INPUT_QUERY,1);break;case qa.NILE_RELATED_QUESTION:case qa.NILE_DEALS_RELATED_QUESTION:case qa.NILE_NDSWDCS_RELATED_QUESTION:k.addCount(p.RASIN_RQ_PILL_CLICK,1)}}}],
[{key:"getInstance",value:function(){return this.instance||(this.instance=new a),this.instance}}])}(),Ni=function(){return r(function d(){z(this,d)},null,[{key:"buildContext",value:function(a,b,c,g,k,p,m,r,u,y){var d=this.buildQueryContext(g,k,p,r,u,10<arguments.length&&void 0!==arguments[10]?arguments[10]:"");d={queryContext:d,pageContext:this.buildPageContext(a,c,g,d.query,m,y,r),bottomSheetContext:this.buildBottomSheetContext(b,c,g),impressionsContext:this.buildImpressionsContext(a,k,m),requestCancellationTokens:this.buildRequestCancellationTokens(a),
isDebug:"n"};return Ra.getInstance().getSearchFilterContext()?zg.getInstance().buildEnhancedContext(d):d}},{key:"buildQueryContext",value:function(a,b,c,g,C){var d,l,q,m=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"",r=K.extractQueryFromUrl(K.getCurrentPageUrl());return void 0!==(d=g&&Object.values(Ma).includes(g)?b||C:b||r||m)&&500<(null===(l=d)||void 0===l?void 0:l.length)&&(k.addCount(p.INPUT_QUERY_MAX_LIMIT_REACHED,1),d=null===(q=d)||void 0===q?void 0:q.slice(0,500)),{query:d,actionType:a,
qis:g||this.getQueryInputSourceByActionType(a,b),clickedAsinId:c}}},{key:"buildPageContext",value:function(a,b,c,g,k,p,m){var d,l,q,C,r=b.getPanelViewContext(),N=a.getPanelState();a=K.getCurrentPageUrl();p=K.setReftagAndQisInTargetUrl(a,null==p?void 0:p.url);b=K.getOriginUrl();r=Za(r.pageType);g=r!==wa.SEARCH_RESULTS||g?r:wa.UNKNOWN;N=Za(b&&null!=N&&N.originPageType?N.originPageType:"");r=null===(d=(l=K.metadataParsers)[g])||void 0===d?void 0:d.call(l,a);d=null===(q=(C=K.metadataParsers)[N])||void 0===
q?void 0:q.call(C,b);c=this.isNavigationQuery(c,k,m);return{pageType:g,targetPageType:g,originPageType:c?N:g,targetUrl:p,originUrl:c?b:a,targetPageMetadata:r,pageMetadata:r,originPageMetadata:c?d:r}}},{key:"buildBottomSheetContext",value:function(a,b,c){b=b.getPanelContainerState();return{bottomSheetEmpty:""===a.getActiveConversationContainerContent().trim()&&c===Z.SWIPE_UP,previousTurnsBottomSheetSize:this.mapPanelViewStateToBottomSheetSize(b.viewState)}}},{key:"buildImpressionsContext",value:function(a,
b,c){var g={},d=nb("impressionsContextKey");d&&(g.IMPRESSIONS_CONTEXT_KEY=d);b=b&&0<b.length&&!c;return(a.hasCustomerSeenFTUX()||b)&&(a.markCustomerSeenFTUX(),g[vf.FIRST_TIME_USER_MESSAGE_SEEN_STATUS]=wf.SEEN),g}},{key:"buildRequestCancellationTokens",value:function(a){var b;if(a=null===(b=a.getPanelState())||void 0===b?void 0:b.requestContext)return[a]}},{key:"getQueryInputSourceByActionType",value:function(a,b){switch(a){case Z.SEARCH:return b&&0<b.length?qa.NILE_CL_TEXT_INPUT:K.extractQis(K.getCurrentPageUrl());
case Z.SWIPE_UP:return K.extractQis(K.getCurrentPageUrl())}}},{key:"mapPanelViewStateToBottomSheetSize",value:function(a){switch(a){case "closed":return Db.HIDDEN;case "minimized":return Db.COLLAPSED;case "expanded":return Db.EXPANDED}}},{key:"isNavigationQuery",value:function(a){var b=2<arguments.length?arguments[2]:void 0;return 1<arguments.length&&void 0!==arguments[1]&&arguments[1]&&(a===Z.SEARCH||a===Z.ASIN_CLICK)&&b!==Ma.NILE_OPTION_IN_AUTOCOMPLETE}}])}(),Oi=function(){return r(function g(b,
c,q){var d=this;z(this,g);a(this,"searchBarQuery","");a(this,"setSearchBarQuery",function(a){d.searchBarQuery=a});a(this,"setIsRufusStayBehaviorRequired",function(a){d.isRufusStayBehaviorRequired=""===a?void 0:"true"===a});this.panelContainer=b;this.cacheManager=c;this.conversationList=q;this.searchFilterContextBuilder=zg.getInstance()},[{key:"buildContext",value:function(a,b,c,g,k,p,m){if(7<arguments.length&&void 0!==arguments[7]&&arguments[7])return Ni.buildContext(this.cacheManager,this.conversationList,
this.panelContainer,a,b,c,g,k,p,m,this.getSearchBarQuery());var d=this.buildQueryContext(a,b,c,k,p);d={queryContext:d,pageContext:this.buildPageContext(a,d.query,g,m,k),bottomSheetContext:this.buildBottomSheetContext(a),impressionsContext:this.buildImpressionsContext(b,g,k===qa.NILE_ASIN_INGRESS),requestCancellationTokens:this.buildRequestCancellationTokens(),isDebug:"n"};return Ra.getInstance().getSearchFilterContext()?this.searchFilterContextBuilder.buildEnhancedContext(d):d}},{key:"buildFeedbackPageContext",
value:function(){var a,b,c=this.panelContainer.getPanelViewContext(),g=K.getCurrentPageUrl();c=Za(c.pageType);var k=null===(a=(b=K.metadataParsers)[c])||void 0===a?void 0:a.call(b,g);return{pageType:c,targetPageType:c,originPageType:c,targetUrl:K.getCurrentPageUrl(),originUrl:g,targetPageMetadata:k,pageMetadata:k,originPageMetadata:k}}},{key:"getSearchBarQuery",value:function(){return this.searchBarQuery}},{key:"getIsRufusStayBehaviorRequired",value:function(){return this.isRufusStayBehaviorRequired}},
{key:"buildQueryContext",value:function(a,b,c,g,m){var d,l,q,C=K.extractQueryFromUrl(K.getCurrentPageUrl()),r=this.getSearchBarQuery();return void 0!==(d=g&&Object.values(Ma).includes(g)?b||m:b||C||r)&&500<(null===(l=d)||void 0===l?void 0:l.length)&&(k.addCount(p.INPUT_QUERY_MAX_LIMIT_REACHED,1),d=null===(q=d)||void 0===q?void 0:q.slice(0,500)),{query:d,actionType:a,qis:g||this.getQueryInputSourceByActionType(a,b),clickedAsinId:c}}},{key:"buildPageContext",value:function(a,b,c,g,k){var d,l,q,p,m=
this.panelContainer.getPanelViewContext(),C=this.cacheManager.getPanelState(),r=K.getCurrentPageUrl();g=K.setReftagAndQisInTargetUrl(r,null==g?void 0:g.url);var u=K.getOriginUrl();m=Za(m.pageType);b=m!==wa.SEARCH_RESULTS||b?m:wa.UNKNOWN;C=Za(u&&null!=C&&C.originPageType?C.originPageType:"");m=null===(d=(l=K.metadataParsers)[b])||void 0===d?void 0:d.call(l,r);d=null===(q=(p=K.metadataParsers)[C])||void 0===q?void 0:q.call(p,u);a=this.isNavigationQuery(a,c,k);return{pageType:b,targetPageType:b,originPageType:a?
C:b,targetUrl:g,originUrl:a?u:r,targetPageMetadata:m,pageMetadata:m,originPageMetadata:a?d:m}}},{key:"buildBottomSheetContext",value:function(a){var b=this.panelContainer.getPanelContainerState();return{bottomSheetEmpty:""===this.conversationList.getActiveConversationContainerContent().trim()&&a===Z.SWIPE_UP,previousTurnsBottomSheetSize:this.mapPanelViewStateToBottomSheetSize(b.viewState)}}},{key:"buildImpressionsContext",value:function(a,b,c){var g={},d=nb("impressionsContextKey");d&&(g.IMPRESSIONS_CONTEXT_KEY=
d);a=a&&0<a.length&&!b;return(this.cacheManager.hasCustomerSeenFTUX()||a||c)&&(this.cacheManager.markCustomerSeenFTUX(),g[vf.FIRST_TIME_USER_MESSAGE_SEEN_STATUS]=wf.SEEN),g}},{key:"buildRequestCancellationTokens",value:function(){var a,b=null===(a=this.cacheManager.getPanelState())||void 0===a?void 0:a.requestContext;if(b)return[b]}},{key:"getQueryInputSourceByActionType",value:function(a,b){switch(a){case Z.SEARCH:return b&&0<b.length?qa.NILE_CL_TEXT_INPUT:K.extractQis(K.getCurrentPageUrl());case Z.SWIPE_UP:return K.extractQis(K.getCurrentPageUrl())}}},
{key:"mapPanelViewStateToBottomSheetSize",value:function(a){switch(a){case "closed":return Db.HIDDEN;case "minimized":return Db.COLLAPSED;case "expanded":return Db.EXPANDED}}},{key:"isNavigationQuery",value:function(a){var b=2<arguments.length?arguments[2]:void 0;return 1<arguments.length&&void 0!==arguments[1]&&arguments[1]&&(a===Z.SEARCH||a===Z.ASIN_CLICK)&&b!==Ma.NILE_OPTION_IN_AUTOCOMPLETE}}])}(),Pi=function(){return r(function q(b,c){var g=this;z(this,q);a(this,"RUFUS_EVENT_METRIC_SUFFIX",a({},
hc.HANDLE_EXPAND,"_expand_rufus"));this.panelContainer=b;this.conversationOrchestrator=c;this.events=a(a({},hc.HANDLE_EXPAND,function(a){return g.handleExpand(a)}),hc.HANDLE_STREAM,function(a){return g.handleStreamForCL(a)})},[{key:"init",value:function(){this.registerEvents(this.events)}},{key:"registerEvents",value:function(a){Object.entries(a).forEach(function(a){var b=Na(a,2);a=b[0];b=b[1];c.P&&fa.declare(a,b)})}},{key:"handleExpand",value:function(a){a?(k.addCount(a+this.RUFUS_EVENT_METRIC_SUFFIX[hc.HANDLE_EXPAND],
1),this.updatePanelState("expanded")):k.logErrorWithLevel(H.ERROR,"Error handling rufus panel expand with empty rufusClient name")}},{key:"handleStreamForCL",value:function(a){this.validateDataBeforeHandlingRufusStream(a)?(a.metricName&&k.addCount(a.metricName,1),this.conversationOrchestrator.stream(a),this.updatePanelState("expanded")):(a="Error handling rufus stream with params: "+JSON.stringify(a),k.logErrorWithLevel(H.ERROR,a))}},{key:"validateDataBeforeHandlingRufusStream",value:function(a){return!!(a.qis&&
a.query&&a.metricName)}},{key:"updatePanelState",value:function(a){var b=this.panelContainer.getPanelContainerState().viewState;this.panelContainer.applyAnimationAndStateUpdate(b,a)}}])}(),Qi=function(){return r(function d(){z(this,d);a(this,"localStorage",!1);a(this,"sessionStorage",!1);a(this,"webCrypto",!1);a(this,"flexbox",!1);a(this,"browserName","");this.checkCapabilities()},[{key:"areAllFeaturesSupported",value:function(){return this.localStorage&&this.sessionStorage&&this.webCrypto&&this.flexbox}},
{key:"checkIsStreamingInterruptedBehaviorDifferent",value:function(){return this.browserName=ye.getInstance().browserName,"Safari"===this.browserName}},{key:"checkCapabilities",value:function(){this.checkLocalStorage();this.checkSessionStorage();this.checkFlexbox();this.checkWebCrypto()}},{key:"checkLocalStorage",value:function(){try{localStorage.setItem("test","test"),localStorage.removeItem("test"),this.localStorage=!0}catch(d){this.localStorage=!1}}},{key:"checkSessionStorage",value:function(){try{sessionStorage.setItem("test",
"test"),sessionStorage.removeItem("test"),this.sessionStorage=!0}catch(d){this.sessionStorage=!1}}},{key:"checkWebCrypto",value:function(){this.webCrypto=!(!c.crypto||!c.crypto.subtle)}},{key:"checkFlexbox",value:function(){var a=document.createElement("div");a.style.display="flex";this.flexbox="flex"===a.style.display}}])}(),Ag=function(){function b(c,l){var d=this;z(this,b);a(this,"onDismissClick",function(a){a.preventDefault();J(F.FILTER_PILL_DISMISS_CLICK,ia.ASIN_REFINEMENT);k.addCount(p.RASIN_FILTER_PILL_DISMISS_CLICK,
1);Ra.getInstance().setSearchFilterContext(null);d.hide()});a(this,"onPillClick",function(){var a;J(F.FILTER_PILL_CLICK,ia.ASIN_REFINEMENT);J(uc.OPEN_URL,"".concat(ia.FILTER_PILL_INGRESS_PREFIX).concat(null===(a=Ra.getInstance())||void 0===a||null===(a=a.getSearchFilterContext())||void 0===a?void 0:a.asinId));k.addCount(p.RASIN_FILTER_PILL_CLICK,1)});this.elements={container:c,link:c.querySelector("#rufus-asin-filter-pill-content"),image:c.querySelector("#rufus-asin-filter-pill-preview-image"),title:c.querySelector(".rufus-asin-filter-pill-title"),
dismissButton:c.querySelector(".rufus-asin-filter-pill-dismiss")};this.shade=document.querySelector(".".concat("rufus-asin-filter-shade"));this.updateContent(l);this.show();this.attachHandlers()}return r(b,[{key:"hide",value:function(){b.hideFilterPillAndShadeElements(this.elements.container,this.shade)}},{key:"updateContent",value:function(a){this.elements.link.href="/dp/".concat(a.asinId,"/").concat(Eb.DP_FROM_FILTER_PILL);this.elements.image.src=a.productImageUrl||"";this.elements.image.alt=a.asinTitle;
this.elements.title.textContent=a.asinTitle}},{key:"show",value:function(){b.toggleElementVisibility(this.elements.container,!0,"rufus-asin-filter-pill-show","rufus-asin-filter-pill-hide");b.toggleElementVisibility(this.shade,!0,"rufus-asin-filter-shade-show","rufus-asin-filter-shade-hide");this.elements.container.setAttribute("aria-label","Conversation filter set to: ".concat(this.elements.title.textContent))}},{key:"attachHandlers",value:function(){this.elements.dismissButton.onclick=this.onDismissClick;
this.elements.link.onclick=this.onPillClick}}],[{key:"createIfPossible",value:function(a){var c=document.getElementById("rufus-asin-filter-pill");return c?new b(c,a):(k.logErrorWithLevel(H.WARN,"No filter pill element found in DOM"),null)}},{key:"cleanupRasinFilterPill",value:function(){var a=document.getElementById("rufus-asin-filter-pill"),c=document.querySelector(".".concat("rufus-asin-filter-shade"));a&&c&&!a.classList.contains("aok-hidden")&&b.hideFilterPillAndShadeElements(a,c)}},{key:"toggleElementVisibility",
value:function(a,b,c,g){a&&(b?(a.classList.remove("aok-hidden",g),a.classList.add(c)):(a.classList.remove(c),a.classList.add(g),a.addEventListener("animationend",function(){a.classList.add("aok-hidden");a.classList.remove(g)},{once:!0})))}},{key:"hideFilterPillAndShadeElements",value:function(a,c){b.toggleElementVisibility(a,!1,"rufus-asin-filter-pill-show","rufus-asin-filter-pill-hide");b.toggleElementVisibility(c,!1,"rufus-asin-filter-shade-show","rufus-asin-filter-shade-hide")}}])}(),Ri=function(){return r(function q(b,
c){var g=this;z(this,q);a(this,"handleRufusAwareAsinCtaClick",function(a){g.panelContainer.applyAnimationAndStateUpdate(g.panelContainer.getPanelContainerState().viewState,"expanded");var b=Ra.getInstance().getSearchFilterContext();a.asinId!==(null==b?void 0:b.asinId)&&(Ra.getInstance().setSearchFilterContext({asinId:a.asinId,productImageUrl:a.productImageURL,asinTitle:a.asinTitle,dpLink:a.dpLink}),g.streamingClient.startStream({actionType:Z.ASIN_CLICK,inputQuery:"",isInitialStream:!1,qis:qa.NILE_ASIN_INGRESS}))});
a(this,"handleAsinContextChange",function(a){a?Ag.createIfPossible(a):(Ag.cleanupRasinFilterPill(),g.streamForSearch())});this.panelContainer=b;this.streamingClient=c},[{key:"initialize",value:function(){var a=Ra.getInstance(),b=!!document.getElementById("rufus-asin-filter-pill");return a&&b?(a.on("contextUpdated",this.handleAsinContextChange),this.registerRasinCtaClickHandler(),k.addCount(p.RASIN_INITIALIZE_SUCCESS,1),!0):(k.addCount(p.RASIN_INITIALIZATION_ERROR,1),!1)}},{key:"registerRasinCtaClickHandler",
value:function(){var a=this;fa.when("A").execute(function(b){b.on("rufus-asin-context",function(b){a.handleRufusAwareAsinCtaClick(b)})})}},{key:"streamForSearch",value:function(){var a=this.panelContainer.getPanelViewContext();this.streamingClient.startStream({actionType:Z.SEARCH,isInitialStream:!1,qis:a.qis,metadata:a.metadata,reftag:K.extractNileReftagFromUrl(K.getCurrentPageUrl())})}}])}(),Bg=function(a){return a.COLLAPSED="collapsed",a.HALF="half",a.EXPANDED="expanded",a.TEASER="teaser",a.TEASER_AUTO_EXPAND=
"teaserAutoExpand",a}({}),Cg=O(958),Dg=function(a,b){if(b&&a){try{var c=JSON.parse(a)}catch(q){a="Error parsing rufusTriggerMarkerMappingString: ".concat(a,". ").concat(q),c=void k.logErrorWithLevel(H.ERROR,a)}return null==c?void 0:c[b]}},Eg=function(){var a=G(Q().mark(function q(a){var b,c,l,m,p,r=arguments;return Q().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(b=1<r.length&&void 0!==r[1]?r[1]:3E3,c=2<r.length?r[2]:void 0,l=!1,m=3<r.length?r[3]:void 0,p=function(){var b=G(Q().mark(function Ad(){return Q().wrap(function(b){for(;;)switch(b.prev=
b.next){case 0:if(l){b.next=10;break}return l=!0,b.prev=2,b.next=5,a();case 5:b.next=10;break;case 7:b.prev=7,b.t0=b.catch(2),k.logErrorWithLevelWithException(H.ERROR,b.t0);case 10:case "end":return b.stop()}},Ad,null,[[2,7]])}));return function(){return b.apply(this,arguments)}}(),L.startTimeout(m,p,b),!c){g.next=10;break}return g.next=10,new Promise(function(a){fa.when(c).execute(G(Q().mark(function Ad(){return Q().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(!L.hasTimeout(m)){b.next=
4;break}return L.clear(m),b.next=4,p();case 4:a();case 5:case "end":return b.stop()}},Ad)})))});case 10:case "end":return g.stop()}},q)}));return function(b){return a.apply(this,arguments)}}(),Ia=function(a){return a.ActiveWithActiveContainerAnchor="ActiveWithActiveContainerAnchor",a.ActiveWithAnchor="ActiveWithAnchor",a.ActiveWithoutAnchor="ActiveWithoutAnchor",a.Inactive="Inactive",a}({}),Si=function(b){function c(b){var d;return z(this,c),a(d=function(a,b,c){return b=y(b),R(a,nf()?Reflect.construct(b,
[],y(a).constructor):b.apply(a,c))}(this,c),"topAlignmentTolerance",1),a(d,"autoScrollAnchorTopOffset",12),a(d,"firstScrollEventLogged",!1),a(d,"SHOW_SCROLL_BAR_CLASS","show-scroll-bar"),a(d,"autoScroll",function(){d.autoScrollingState!==Ia.Inactive&&d.toggleScrollBarVisibility(!1);d.autoScrollingState===Ia.ActiveWithoutAnchor?d.scrollToBottom():d.autoScrollingState===Ia.ActiveWithAnchor?d.scrollToLatestConversationTurn():d.autoScrollingState===Ia.ActiveWithActiveContainerAnchor&&d.scrollToTopOfActiveConversationContainer();
d.toggleScrollButtonVisibility()}),a(d,"scrollToBottom",function(){d.toggleScrollBarVisibility(!1);d.elements.container.scrollTop=d.elements.container.scrollHeight-d.elements.container.clientHeight}),a(d,"scrollToLatestConversationTurn",function(){var a=d.getLatestConversationTurnOrContainer();d.elements.container.scrollTop=d.calculateScrollPositionToLatestConversationTurnWithOffset(a)}),a(d,"scrollToTopOfActiveConversationContainer",function(){d.elements.container.scrollTop=d.elements.activeConversationContainer.offsetTop-
d.autoScrollAnchorTopOffset}),a(d,"handleScroll",function(a){a.stopPropagation();d.toggleScrollButtonVisibility()}),a(d,"toggleScrollButtonVisibility",function(){d.updateScrollButtonBottomPosition();d.elements.scrollButton.style.display=d.shouldDisplayScrollButton()?"flex":"none"}),a(d,"shouldDisplayScrollButton",function(){var a=d.panelContainer.isPanelExpanded(),b=d.panelContainer.isShowAnimationRunning(),c=d.elements.container.clientHeight<d.elements.container.scrollHeight,l=(d.autoScrollingState===
Ia.ActiveWithActiveContainerAnchor||d.autoScrollingState===Ia.ActiveWithAnchor)&&d.isCurrentConversationContainerAtTopOfPanel();l=d.autoScrollingState===Ia.Inactive||l;var k=d.elements.container.scrollTop,q=d.calculateScrollPositionToShowScrollButton(d.isRasinVisible());return a&&!b&&c&&l&&k<q}),a(d,"calculateScrollPositionToShowScrollButton",function(a){var b=d.elements.container.scrollHeight-d.elements.container.clientHeight-75;return a?b-104:b}),a(d,"updateScrollButtonBottomPosition",function(){var a=
d.elements.scrollButton,b=document.querySelector(".rufus-textarea-container");d.isRasinVisible()&&b?a.style.bottom="".concat(116,"px"):a.style.bottom="".concat(64,"px")}),a(d,"isRasinVisible",function(){var a=document.querySelector(".".concat("rufus-asin-filter-pill")),b=document.querySelector(".".concat("rufus-asin-filter-shade"));a=!!a&&a.classList.contains("rufus-asin-filter-pill-show");b=!!b&&b.classList.contains("rufus-asin-filter-shade-show");return a&&b}),a(d,"handleKeyDownOnContainer",function(a){rh.includes(a.key)&&
d.onManualScroll()}),a(d,"handleKeyDown",function(a){"Enter"===a.key&&d.handleArrowDownButtonClick()}),a(d,"toggleScrollBarVisibility",function(a){d.elements.container.classList.toggle(d.SHOW_SCROLL_BAR_CLASS,a)}),a(d,"onManualScroll",function(){d.setAutoScrollingState(Ia.Inactive);d.toggleScrollBarVisibility(!0);d.firstScrollEventLogged||(J(F.SCROLL_VIEW),d.firstScrollEventLogged=!0);100>d.elements.container.scrollTop&&d.dispatch("onTopReached",void 0)}),a(d,"handleArrowDownButtonClick",function(){d.setAutoScrollingState(Ia.ActiveWithoutAnchor);
d.elements.scrollButton.style.display="none";d.scrollToBottom();J(F.SCROLL_VIEW_END);k.addCount(p.RUFUS_SCROLL_DOWN_CLICKED,1)}),d.missingElementsRecorder=new od("ScrollingUtil"),d.elements=d.readHtmlElementsFromDom(),d.autoScrollingState=Ia.Inactive,d.panelContainer=b,d.attachEventListeners(),d}return Aa(c,b),r(c,[{key:"refreshOnBfCacheNavigation",value:function(){Object.assign(this.elements,this.readHtmlElementsFromDom());this.attachEventListeners()}},{key:"readHtmlElementsFromDom",value:function(){var a=
{container:this.missingElementsRecorder.getElementOrRecordMissing("rufus-conversation-container"),activeConversationContainer:this.missingElementsRecorder.getElementOrRecordMissing("rufus-active-conversation-container"),scrollButton:this.missingElementsRecorder.getElementOrRecordMissing("rufus-scroll-button")};return this.missingElementsRecorder.logMissingElementsAndThrowError(),a}},{key:"attachEventListeners",value:function(){var a=this;this.elements.container.addEventListener("wheel",this.onManualScroll);
this.elements.container.addEventListener("touchstart",this.onManualScroll);this.elements.container.addEventListener("scroll",this.handleScroll);this.elements.container.addEventListener("keydown",this.handleKeyDownOnContainer);this.elements.container.addEventListener("pointerup",this.onManualScroll);this.elements.container.addEventListener("pointercancel",this.onManualScroll);(new MutationObserver(function(){a.toggleScrollButtonVisibility()})).observe(this.elements.container,{childList:!0,subtree:!0});
this.elements.scrollButton.addEventListener("click",this.handleArrowDownButtonClick);this.elements.scrollButton.addEventListener("keydown",this.handleKeyDown);this.panelContainer.on("updateScrollButtonVisibility",this.toggleScrollButtonVisibility)}},{key:"scrollIntoView",value:function(a){this.setAutoScrollingState(Ia.Inactive);(a=document.getElementById(a))&&a.scrollIntoView({block:"nearest"})}},{key:"setAutoScrollingState",value:function(a){this.autoScrollingState=a}},{key:"getAutoScrollingState",
value:function(){return this.autoScrollingState}},{key:"getElementVerticalDistanceRelativeToScrollContainer",value:function(a){var b=this.elements.container.getBoundingClientRect();return a.getBoundingClientRect().top-b.top}},{key:"isCurrentConversationContainerAtTopOfPanel",value:function(){var a=this.getLatestConversationTurnOrContainer();a=this.calculateScrollPositionToLatestConversationTurnWithOffset(a);return this.isScrollPositionClose(this.elements.container.scrollTop,a)}},{key:"getLatestConversationTurnOrContainer",
value:function(){var a=this.elements.activeConversationContainer.children;return 0<a.length?a[a.length-1]:this.elements.activeConversationContainer}},{key:"calculateScrollPositionToLatestConversationTurnWithOffset",value:function(a){return this.getElementVerticalDistanceRelativeToScrollContainer(a)+this.elements.container.scrollTop-this.autoScrollAnchorTopOffset}},{key:"isScrollPositionClose",value:function(a,b){return Math.abs(a-b)<=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.topAlignmentTolerance)}}])}(Ga),
Ti=function(b){function d(b,g,l,q,m,r,u,A,B,E,M,O,U,T){var t;return z(this,d),a(t=function(a,b,c){return b=y(b),R(a,pf()?Reflect.construct(b,[],y(a).constructor):b.apply(a,c))}(this,d),"startInitialStreamingCallback",function(){if(t.shouldSkipStreamingOnSearchResults())return fa.declare("rufus-teaser-cx-bsr-teaser",!0),k.addCount(p.RUFUS_TEASER_RECOVERY_WIDGET_SENT_TO_SEARCH,1),void J(F.TEASER_RECOVERY_WIDGET_SENT_TO_SEARCH);if(t.isJSMigration){if(xg(c.location.href))return;var a;if(fa.now("rufus-cl-disable-default-initial-streaming").execute(function(b){a=
b}),a)return}(t.needsRemovePartialFTUE()||t.needsRemoveEmptyConversationTurn())&&t.conversationList.modifyContent(sa.RemoveLastActiveTurn);t.streamingClient.startInitialStreamingCall(t.panelContainer.getPanelViewContext())}),a(t,"needsRemovePartialFTUE",function(){return!t.conversationList.isLastTurnAnimationComplete()&&!t.conversationList.isAffordancePresentInContainer()}),a(t,"needsRemoveEmptyConversationTurn",function(){return t.conversationList.isLastTurnContentEmpty()}),a(t,"handleRetryRequest",
function(){var a=t.cacheManager.getRequestMetadata();a&&t.streamingClient.startStream(a)}),a(t,"saveRequestMetadataToPanelCache",function(a){t.cacheManager.setRequestMetadata(a)}),a(t,"handleThumbsDownClick",function(a){t.scrollingUtil.scrollIntoView(a)}),a(t,"handleOfflineError",function(){k.addCount(p.RUFUS_OFFLINE,1);(L.clearTimeouts(["initial_chunk_timeout","midstream_timeout"]),t.cacheManager.getRequestMetadata())?(t.streamingClient.getStreamingStatus().streamingStatus===ra.OPEN||ra.STREAMING,
t.renderOfflineError()):t.renderOfflineError()}),a(t,"handleOnlineEvent",function(){lb.removeError(xb.OFFLINE)}),a(t,"renderOfflineError",function(){lb.renderError({errorCode:xb.OFFLINE,errorMessage:"offline_error_message"});t.scrollingUtil.scrollToBottom()}),a(t,"onPageUnload",function(){t.isPageUnload=!0}),a(t,"handleStreamingStatusUpdate",function(a){var b,g=a.streamingStatus,d=a.isInitialStream,l=a.actionType,q=a.requestContext;a=t.capabilityManager.checkIsStreamingInterruptedBehaviorDifferent();
if(g!==ra.OPEN&&g!==ra.STREAMING||(t.conversationList.toggleLoader(db.VisibleWithAvatar),a&&g===ra.STREAMING&&(c.removeEventListener("beforeunload",t.onPageUnload),c.addEventListener("beforeunload",t.onPageUnload))),g===ra.STREAMING&&(t.conversationList.removeTemporarySections(),t.animationUtil.stopAnimating(),t.conversationList.createNewStreamContainer(d,l),d?(t.scrollingUtil.scrollToBottom(),t.scrollingUtil.setAutoScrollingState(Ia.ActiveWithActiveContainerAnchor)):(t.scrollingUtil.setAutoScrollingState(Ia.ActiveWithAnchor),
t.scrollingUtil.autoScroll(),t.conversationList.getInterruptionRecoveryContainer()&&(t.conversationList.moveInterruptionRecoveryContainerOutOfConversation(),t.updateCache())),q&&(null==q||null===(b=q.queryContext)||void 0===b?void 0:b.qis)===qa.NILE_CL_TEXT_INPUT)){var m;b=null!==(m=q.queryContext.query)&&void 0!==m?m:"";""!==b&&(m=function(a){var b=na.getInstance().getWeblabTreatment("RUFUS_DESKTOP_VISUAL_BRANDING_UPDATE_1201601");return"T1"===b||"T2"===b?function(a){var b=na.getInstance().getWeblabTreatment("RUFUS_DESKTOP_VISUAL_BRANDING_UPDATE_1201601");
return'\x3cdiv class\x3d"rufus-sections-container" data-section-class\x3d"CustomerText"\x3e\n        \x3cdiv class\x3d"a-section rufus-conversation-branding-update rufus-customer-text rufus-dialog-customer"\x3e\n            \x3cdiv class\x3d"'.concat("T2"===b?"rufus-speech-bubble-lighter":"rufus-speech-bubble",'"\x3e\n                    \x3cspan class\x3d"rufus-customer-text-wrap"\x3e').concat(a?(0,Cg.encoder)().encodeForHTML(a):"","\x3c/span\x3e\n            \x3c/div\x3e\n        \x3c/div\x3e\n    \x3c/div\x3e")}(a):
function(a){var b=na.getInstance().getWeblabTreatment("RUFUS_DESKTOP_COLOR_UPDATE_1168668");return b&&k.recordTrigger("RUFUS_DESKTOP_COLOR_UPDATE_1168668",b),'\x3cdiv class\x3d"rufus-sections-container" data-section-class\x3d"CustomerText"\x3e\n            \x3cdiv class\x3d"a-section rufus-conversation rufus-customer-text"\x3e\n                \x3cimg alt\x3d"" src\x3d"'.concat("T1"===b?"https://m.media-amazon.com/images/G/01/Rufus_Desktop/Avatar-Customer-Rio-V2-1-2.svg":"https://m.media-amazon.com/images/G/01/Rufus_Desktop/Avatar-Customer.png",
'" class\x3d"rufus-avatar-img" height\x3d"20" width\x3d"20"\x3e\n                \x3cdiv class\x3d"a-section rufus-text-subsections-with-avatar"\x3e\n                    \x3cdiv style\x3d"text-align: left;display:inline-block;"\x3e\n                        \x3cspan class\x3d"rufus-color-onyx rufus-font-size-default rufus-text-wrap"\x3e').concat(a?(0,Cg.encoder)().encodeForHTML(a):"","\x3c/span\x3e\n                    \x3c/div\x3e\n                \x3c/div\x3e\n            \x3c/div\x3e\n        \x3c/div\x3e")}(a)}(b),
t.conversationList.modifyContent(sa.InsertIntoLastActiveTurn,m))}t.textInput.setFocus();g!==ra.CLOSED&&g!==ra.ERROR||(c.removeEventListener("beforeunload",t.onPageUnload),1>t.animationUtil.getQueue().length&&t.conversationList.toggleLoader(db.Hidden),a&&t.isPageUnload||t.cacheManager.setPanelRequestCompleted(!0))}),a(t,"removeLoader",function(){var a=t.streamingClient.getStreamingStatus().streamingStatus;a!==ra.CLOSED&&a!==ra.ERROR||t.conversationList.toggleLoader(db.Hidden);a===ra.CLOSED&&t.streamingLifecycleEventLogger.emitStreamRenderEnd()}),
a(t,"markAnimationComplete",function(){t.streamingClient.getStreamingStatus().streamingStatus===ra.CLOSED&&t.conversationList.markLastTurnAnimationComplete()}),a(t,"stream",function(a){navigator.onLine?t.streamingClient.startStream({actionType:Z.SEARCH,inputQuery:a.query,qis:a.qis,metadata:a.metadata,reftag:Eb.CUSTOMER_SUBMITTED_QUERY}):t.handleOfflineError()}),a(t,"handleEventReceived",function(a){var b,c;switch(null!==(b=a.streamingEventType)&&void 0!==b?b:a.event.type){case aa.CONTEXT:t.handleContextChunk(a.event);
break;case aa.AFFORDANCE:if((null===(c=a.streamingStatusDetails.requestContext)||void 0===c||null===(c=c.queryContext)||void 0===c?void 0:c.qis)===qa.NILE_CL_TEXT_INPUT)break;t.handleContentChunk(a);break;case aa.REMOVE:t.handleRemoveEvent(a.event);break;default:t.handleContentChunk(a)}}),a(t,"handleEventReceivedV2",function(a){var b,c;switch(null!==(b=a.streamingEventType)&&void 0!==b?b:a.event.type){case aa.CONTEXT:t.handleContextChunk(a.event);break;case aa.AFFORDANCE:if((null===(c=a.streamingStatusDetails.requestContext)||
void 0===c||null===(c=c.queryContext)||void 0===c?void 0:c.qis)===qa.NILE_CL_TEXT_INPUT)break;t.handleContentChunkV2(a);break;case aa.REMOVE:t.handleRemoveEventV2(a.event);break;default:t.handleContentChunkV2(a)}}),a(t,"handleLoadMoreHistory",G(Q().mark(function Rg(){return Q().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!t.historyClient.isLoading()&&t.historyClient.hasMoreHistory()){a.next=2;break}return a.abrupt("return");case 2:return a.prev=2,a.next=5,t.fetchHistory(sa.PrependHistory);
case 5:a.next=10;break;case 7:a.prev=7,a.t0=a.catch(2),k.logErrorWithLevelWithException(H.ERROR,a.t0,"Could not load more history");case 10:case "end":return a.stop()}},Rg,null,[[2,7]])}))),a(t,"handleInterruptionRecoveryButtonClick",function(){var a=G(Q().mark(function sd(a){return Q().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,b.next=3,t.recoverInterruptedConversationFromHistory(a);case 3:b.next=10;break;case 5:b.prev=5,b.t0=b.catch(0),t.conversationList.dismissInterruptionRecoverySpinnerAndShowButton(),
k.logErrorWithLevelWithException(H.ERROR,b.t0,"Failed to call history endpoint to load interrupted conversation"),k.addCount(p.INTERRUPTION_RECOVERY_FAILED,1);case 10:case "end":return b.stop()}},sd,null,[[0,5]])}));return function(b){return a.apply(this,arguments)}}()),a(t,"handleTopReached",function(){k.addCount(p.RUFUS_SCROLL_TO_TOP,1);var a=t.historyClient.hasMoreHistory(),b=t.historyClient.isLoading(),c=t.conversationList.isFtuxOrRuxOnScreen();t.conversationList.toggleLoadMoreHistoryButtonElementVisibility(!t.conversationList.isFtuxPresent()&&
5<=t.conversationList.getNumberOfConversationTurns()&&a&&!b&&!t.conversationList.isSpinnerShowing());t.conversationList.toggleBeginningOfHistoryElementVisibility(!a&&!b&&!c)}),a(t,"handleCompleteMovingActiveConversationTurnsToHistory",G(Q().mark(function zd(){return Q().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.invalidateCache(!0);case 2:case "end":return a.stop()}},zd)}))),a(t,"handleConversationListCompleteReplacingContent",function(){t.updateCache();t.cacheManager.updateLastCacheInvalidatedTimestamp()}),
a(t,"invalidateCache",function(){var a=G(Q().mark(function gc(a){return Q().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(!t.isInvalidatingCache){b.next=2;break}return b.abrupt("return");case 2:if(t.isInvalidatingCache=!0,t.conversationList.toggleLoadMoreHistoryButtonElementVisibility(!1),b.prev=4,t.cacheManager.shouldInvalidatePanelCache()){b.next=8;break}return k.addCount(p.RUFUS_PANEL_CACHE_VALID,1),b.abrupt("return");case 8:return b.next=10,t.replaceCache(a);case 10:t.cacheManager.setRequestMetadata(void 0);
k.addCount(p.RUFUS_PANEL_CACHE_INVALID,1);b.next=17;break;case 14:b.prev=14,b.t0=b.catch(4),k.logErrorWithLevelWithException(H.ERROR,b.t0,"Could not invalidate cache");case 17:return b.prev=17,t.isInvalidatingCache=!1,b.finish(17);case 20:case "end":return b.stop()}},gc,null,[[4,14,17,20]])}));return function(b){return a.apply(this,arguments)}}()),a(t,"updateCache",function(){t.cacheManager.setPanelContent(t.conversationList.getPanelContentSnapshot())}),a(t,"handlePanelStateChange",function(a){if("expanded"===
a.viewState&&t.twisterClicked){var b=na.getInstance().getWeblabTreatment("RUFUS_1152798");b&&(k.recordTrigger("RUFUS_1152798",b),t.twisterClicked=!1)}t.updateContainerStateCache(a);t.logInterruptStreamMetric(a)}),a(t,"handlePanelAnimationEnd",function(a){"expanded"===a&&t.textInput.setFocus()}),a(t,"logInterruptStreamMetric",function(a){"minimized"!==a.viewState&&"closed"!==a.viewState||t.streamingClient.getStreamingStatus().streamingStatus!==ra.STREAMING&&t.streamingClient.getStreamingStatus().streamingStatus!==
ra.OPEN||(J(F.CONVERSATION_ABANDONMENT,"closed"===a.viewState?F.PANEL_CLOSE_CLICK:F.PANEL_MINIMIZE_CLICK),k.addCount(p.RUFUS_STREAM_INTERRUPT,1))}),a(t,"updateContainerStateCache",function(a){var b=t.cacheManager.getPanel();b&&(a=tc(tc({},b.state),a),t.cacheManager.setPanelState(a))}),a(t,"updatePanelContainerState",function(){var a,b=t.panelContainer.getPanelContainerState();b.originPageType=null===(a=t.cacheManager.getPanelState())||void 0===a?void 0:a.targetPageType;b.targetPageType=t.panelContainer.getPanelViewContext().pageType;
b.autoMinimize=t.determineAutoMinimizeState();t.updateContainerStateCache(b)}),a(t,"handleContextChunk",function(a){try{var b=JSON.parse(a.data);Ab.getInstance().nileRequestId=b.requestContext.requestId;t.handleBSR(b.bsr.bottomSheetSize);J(F.INVOKE_NILE);t.cacheManager.setPanelRequestContext(tc(tc({},b.requestContext),{},{requestCompleted:!1}))}catch(sd){lb.renderError({errorCode:xb.HANDLE_CONTEXT_CHUNK_ERROR}),k.logErrorWithLevelWithException(H.ERROR,sd,"".concat("ConversationOrchestrator"," - Error handling context chunk ",
"(".concat(sd.message,")")))}}),a(t,"handleBSR",function(a){switch(a){case Bg.TEASER:t.isEligibleToShowTeaser()&&(fa.declare("rufus-teaser-cx-bsr-teaser",Ab.getInstance().nileRequestId),k.addCount(p.RUFUS_TEASER_WIDGET_BSR_SENT_TO_SEARCH,1),J(F.TEASER_WIDGET_BSR_SENT_TO_SEARCH));break;case Bg.TEASER_AUTO_EXPAND:t.isEligibleToShowTeaser()&&(a=t.panelContainer.getPanelContainerState().viewState,t.panelContainer.applyAnimationAndStateUpdate(a,"expanded"),J(F.TEASER_AUTO_EXPANDS_CL),k.addCount(p.RUFUS_TEASER_AUTO_EXPANDS_CL,
1));break;default:t.panelContainer.handlePanelContainerViewStateUpdateWithCXZen(a)}}),a(t,"handleContentChunk",function(a){t.conversationList.updateHtmlSections(a);t.updateAnimationUtilPanelState(t.panelContainer.getPanelContainerState())}),a(t,"handleContentChunkV2",function(a){t.conversationList.updateHtmlSectionsV2(a);t.updateAnimationUtilPanelState(t.panelContainer.getPanelContainerState())}),a(t,"updateAnimationUtilPanelState",function(a){t.animationUtil.setViewState(a)}),a(t,"handleRemoveEvent",
function(a){var b,c;try{var g=JSON.parse(a.data)}catch(ve){return void k.logErrorWithLevelWithException(H.ERROR,ve,"".concat("ConversationOrchestrator"," - Error handling remove event: ").concat(ve instanceof Error?"(".concat(ve.message,")"):""))}t.conversationList.removeHtml(null===(b=g)||void 0===b?void 0:b.type,null===(c=g)||void 0===c?void 0:c.groupId)}),a(t,"handleRemoveEventV2",function(a){var b;try{var c=JSON.parse(a.data)}catch(gc){return void k.logErrorWithLevelWithException(H.ERROR,gc,"".concat("ConversationOrchestrator",
" - Error handling remove event: ").concat(gc instanceof Error?"(".concat(gc.message,")"):""))}c&&null!==(b=c.sections[0])&&void 0!==b&&b.target.groupId&&t.conversationList.removeHtml(c.sections[0].target.type,c.sections[0].target.groupId)}),a(t,"handleOverflowMenuGetStartedClick",function(){var a=t.cacheManager.getPanelState();!0===(null==a?void 0:a.autoMinimize)&&t.panelContainer.applyAnimationAndStateUpdate("expanded","minimized")}),a(t,"handleAutoMinimizeToggleSwitchEvent",function(a){t.cacheManager.toggleAutoMinimize(a)}),
a(t,"handleAutoMinimizeToggleSwitchStateChange",function(a){t.overflowMenu.handleAutoMinimizeToggleSwitchStateChange(a)}),a(t,"initializeAutoMinimizeToggleSwitch",function(){var a,b=t.cacheManager.getPanelState();t.handleAutoMinimizeToggleSwitchStateChange(null===(a=null==b?void 0:b.autoMinimize)||void 0===a||a)}),a(t,"handleOverflowMenuStateChange",function(a){t.panelContainer.handleOverflowMenuStateChange(a)}),a(t,"registerSearchPageAjaxEventHandler",function(){var a=t.cacheManager.getPreviousPageUrl()===
K.getCurrentPageUrl();fa.when("Rush","s-actions").execute(function(b,c){b.on(c.LOAD_SEARCH_PAGE_STARTING,function(){var b=t.cacheManager.getPanelState();!0!==(null==b?void 0:b.autoMinimize)||"expanded"!==(null==b?void 0:b.viewState)||a||t.panelContainer.applyAnimationAndStateUpdate(null==b?void 0:b.viewState,"minimized");a=!1});b.on(c.LOAD_SEARCH_PAGE_COMPLETE,function(){t.cacheManager.setPreviousPageUrl()})})}),a(t,"handleNavigateOnClickFromRecoveryTeaserCX",function(){var a=K.getCurrentPageUrl();
(a=K.getTeaserCXCustomerQueryFromURLQueryParam(a))&&t.panelContainer.handleNavigateFromTeaserCX(a)}),a(t,"isEligibleToShowTeaser",function(){var a,b,c=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],g="Search"===t.panelContainer.getPanelViewContext().pageType,d=t.panelContainer.isPanelExpanded(),l=na.getInstance().getWeblabTreatment("RUFUS_NAVONLY_INGRESS_1200814");g=!t.isBfcacheNavigation&&g&&!d&&"T1"!==l;if(!c)return g;c=null!==(a=null===(b=t.cacheManager.getPanelState())||void 0===b||
null===(b=b.requestMetadata)||void 0===b?void 0:b.isInitialStream)&&void 0!==a&&a;return g&&c}),a(t,"isEligibleForRasin",function(){var a=na.getInstance().getWeblabTreatment("RUFUS_NAVONLY_INGRESS_1200814");return"T1"===na.getInstance().getWeblabTreatment("SEARCH_RUFUS_ASIN_INGRESS_1207023")&&"T1"!==a}),a(t,"initializeTwisterStateChange",function(){fa.when("A").execute(function(a){a.on("PageRefresh:ATF",function(){t.handleTwisterVariationSelection()})})}),a(t,"handleTwisterVariationSelection",function(){var a=
na.getInstance().getWeblabTreatment("RUFUS_1152798");a&&("T1"==a&&(t.streamingClient.startInitialStreamingCall(t.panelContainer.getPanelViewContext()),k.addCount(p.RUFUS_TWISTER_STREAMING_REQUEST,1),J(F.RUFUS_TWISTER_STREAMING_REQUEST_SENT)),t.panelContainer.isPanelExpanded()?k.recordTrigger("RUFUS_1152798",a):t.twisterClicked=!0)}),t.cacheManager=b,t.historyClient=g,t.conversationList=l,t.panelContainer=q,t.streamingClient=m,t.textInput=r,t.overflowMenu=u,t.feedbackControl=A,t.scrollingUtil=B,t.animationUtil=
E,t.actions=M,t.actionsHandler=O,t.streamingLifecycleEventLogger=U,t.isInvalidatingCache=!1,t.capabilityManager=T,t.isPageUnload=!1,t.twisterClicked=!1,t.isJSMigration=!1,t}return Aa(d,b),r(d,[{key:"initialize",value:function(a){var b,g=this;this.isJSMigration=null!==(b=null==a?void 0:a.isJSMigration)&&void 0!==b&&b;this.textInput.on("onQuery",this.stream);this.scrollingUtil.on("onTopReached",this.handleTopReached);this.streamingClient.on("onEventReceived",this.handleEventReceived);this.streamingClient.on("onEventReceivedV2",
this.handleEventReceivedV2);this.streamingClient.on("onStreamingStatusChange",this.handleStreamingStatusUpdate);this.streamingClient.on("submitRetryRequest",this.handleRetryRequest);this.panelContainer.on("onPanelContainerStateChange",this.handlePanelStateChange);this.panelContainer.on("onPanelAnimationEnd",this.handlePanelAnimationEnd);this.panelContainer.on("onAutoMinimizeToggleSwitchStateChange",this.handleAutoMinimizeToggleSwitchStateChange);this.overflowMenu.on("onGetStartedClicked",this.handleOverflowMenuGetStartedClick);
this.overflowMenu.on("onAutoMinimizeClick",this.handleAutoMinimizeToggleSwitchEvent);this.overflowMenu.on("onOverflowMenuStateChange",this.handleOverflowMenuStateChange);this.animationUtil.on("sectionAnimationComplete",this.updateCache);this.animationUtil.on("allAnimationsInQueueComplete",this.markAnimationComplete);this.animationUtil.on("animationQueueComplete",this.removeLoader);this.feedbackControl.on("onThumbsDownClick",this.handleThumbsDownClick);this.feedbackControl.on("onFeedbackSubmitted",
this.updateCache);this.conversationList.on("onLoadMoreHistoryButtonClick",this.handleLoadMoreHistory);this.conversationList.on("onInterruptionRecoveryButtonClick",this.handleInterruptionRecoveryButtonClick);this.conversationList.on("lastActiveTurnContentUpdated",this.scrollingUtil.autoScroll);this.actions.on("onAction",this.actionsHandler.handleAction);this.isEligibleForRasin()&&(new Ri(this.panelContainer,this.streamingClient)).initialize();this.cacheManager.initialize();(b=this.cacheManager.getPanelState())&&
b.requestContext&&b.requestContext.requestId&&(Ab.getInstance().nileRequestId=b.requestContext.requestId,this.updateAnimationUtilPanelState(b));this.handleNavigateOnClickFromRecoveryTeaserCX();this.handleStreamingInterruption();this.conversationList.on("completeMovingActiveConversationTurnsToHistory",this.handleCompleteMovingActiveConversationTurnsToHistory);this.conversationList.on("completeReplacingContentInContainer",this.handleConversationListCompleteReplacingContent);this.streamingClient.on("invalidatePanelCache",
this.invalidateCache);this.streamingClient.on("saveRequestMetadataToPanelCache",this.saveRequestMetadataToPanelCache);this.actionsHandler.on("applyAnimationAndStateUpdateWithDefault",this.panelContainer.applyAnimationAndStateUpdateWithDefault);this.dispatch("cacheInvalidated",void 0);this.updatePanelContainerState();b=Dg(null==a?void 0:a.rufusTriggerMarkerMapping,null==a?void 0:a.pageType);(null==a?void 0:a.latencyRegressionMitigationStrategy)===we.ShouldDelayThickClientInitialStreaming&&b&&"YourOrders"!==
a.pageType?Eg(this.startInitialStreamingCallback,a.rufusLatencyMarkerFallbackTimeout,b,we.ShouldDelayThickClientInitialStreaming):this.startInitialStreamingCallback();this.initializeAutoMinimizeToggleSwitch();c.addEventListener("hashchange",function(){g.cacheManager.setPreviousPageUrl()});Za(this.panelContainer.getPanelViewContext().pageType)===wa.SEARCH_RESULTS&&this.registerSearchPageAjaxEventHandler();this.textInput.setFocus();c.addEventListener("pagehide",function(){g.terminateOngoingStreaming();
Ra.getInstance().setSearchFilterContext(null)});c.addEventListener("offline",this.handleOfflineError);c.addEventListener("online",this.handleOnlineEvent);this.initializeTwisterStateChange()}},{key:"handleBfCacheNavigation",value:function(){this.isBfcacheNavigation=!0;this.streamingLifecycleEventLogger.setIsBfcacheNavigation(!0);this.streamingClient.setIsBfcacheNavigation(!0);this.conversationList.refreshOnBfCacheNavigation();this.scrollingUtil.refreshOnBfCacheNavigation();this.textInput.refreshOnBfCacheNavigation()}},
{key:"shouldSkipStreamingOnSearchResults",value:function(){var a=na.getInstance().getWeblabTreatment("RUFUS_DESKTOP_TEASER_WIDGET_1017061"),b=na.getInstance().getWeblabTreatment("RUFUS_DESKTOP_TEASER_RECOVERY_WIDGET_1148246");return this.isEligibleToShowTeaser(!1)&&!0===this.streamingClient.getIsRufusStayBehaviorRequired()&&"C"!==a&&"T1"===b}},{key:"recoverInterruptedConversationFromHistory",value:(g=G(Q().mark(function P(a){var b;return Q().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return k.addCount(p.FETCH_HISTORY_INTERRUPTION_RECOVERY,
1),c.next=3,this.historyClient.fetchHistory(0,a);case 3:(b=c.sent)?this.conversationList.modifyContent(sa.ReplaceInterruptedConversation,b):(this.conversationList.dismissInterruptionRecoverySpinnerAndShowButton(),k.addCount(p.INTERRUPTION_RECOVERY_FAILED,1));case 5:case "end":return c.stop()}},P,this)})),function(a){return g.apply(this,arguments)})},{key:"fetchHistory",value:(q=G(Q().mark(function xa(a){var b,c;return Q().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return k.addCount(p.FETCH_HISTORY,
1),this.conversationList.startTopLoading(),this.conversationList.toggleLoadMoreHistoryButtonElementVisibility(!1),(b=this.historyClient.isFirstTimeLoadHistory())&&k.addCount(p.FIRST_TIME_FETCH_HISTORY,1),g.next=7,this.historyClient.fetchHistory(b?this.conversationList.getNumberOfConversationTurns():0);case 7:c=g.sent,this.conversationList.modifyContent(a,c,b);case 9:case "end":return g.stop()}},xa,this)})),function(a){return q.apply(this,arguments)})},{key:"replaceCache",value:(l=G(Q().mark(function ta(a){var b;
return Q().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.historyClient.fetchHistory(0);case 2:b=c.sent,a?this.conversationList.modifyContent(sa.ReplaceHistory,b):this.conversationList.modifyContent(sa.ReplaceActive,b);case 4:case "end":return c.stop()}},ta,this)})),function(a){return l.apply(this,arguments)})},{key:"determineAutoMinimizeState",value:function(){var a,b=null===(a=this.cacheManager.getPanelState())||void 0===a?void 0:a.autoMinimize;if(null!=b)return b;a=na.getInstance().getWeblabTreatment("RUFUS_DESKTOP_DISABLE_AUTOMINIMIZE_LAUNCH_1260409");
return a&&k.recordTrigger("RUFUS_DESKTOP_DISABLE_AUTOMINIMIZE_LAUNCH_1260409",a),"T1"!==a}},{key:"terminateOngoingStreaming",value:function(){this.streamingClient.abortCurrentStream(pd.PAGE_NAVIGATION);this.conversationList.toggleLoader(db.Hidden)}},{key:"handleStreamingInterruption",value:function(){var a;this.conversationList.getInterruptionRecoveryContainer()&&this.conversationList.checkInterruptionRecoveryButtonVisibility()&&(this.conversationList.moveInterruptionRecoveryContainerOutOfConversation(),
this.updateCache());var b=null===(a=this.cacheManager.getPanelState())||void 0===a?void 0:a.requestContext;b&&!b.requestCompleted&&0===this.conversationList.getRemovableSectionsFromLatestActiveTurn().length&&(this.conversationList.getInterruptionRecoveryContainer()?(a=b.requestId)&&(this.conversationList.moveInterruptionRecoveryContainerToConversation(a),this.scrollingUtil.scrollToBottom()):(a=document.createElement("div"),a.innerHTML="Response interrupted",a.className="rufus-interrupted-stream-text",
b=document.createElement("div"),b.classList.add("rufus-interrupted-stream-affordance"),b.appendChild(a),this.conversationList.modifyContent(sa.InsertIntoLastActiveTurn,b.outerHTML)),this.cacheManager.setPanelRequestCompleted(!0),this.updateCache())}}]);var l,q,g}(Ga),Fg=r(function d(){z(this,d)});a(Fg,"recordAssetsLoad",function(){var a,b;if(null!==(a=c.performance)&&void 0!==a&&a.getEntriesByType){var q=["RufusPanelWebAssets","RufusCriticalAssets"];(null===(b=performance)||void 0===b?void 0:b.getEntriesByType("resource")).filter(function(a){return a.name.includes(".js")&&
q.some(function(b){return a.name.includes(b)})}).forEach(function(a){var b=Date.now(),c=a.transferSize<a.encodedBodySize;c=0===a.transferSize||c;var g=q.find(function(b){return a.name.includes(b)});g+=c?"Cached":"Cold";k.addCount("".concat(g,"JS"),1);k.widgetBodyBegin("".concat(g,"JSLoadTime"),b);k.widgetBodyEnd("".concat(g,"JSLoadTime"),!1,b+a.duration)})}});var Ui=function(b){function c(b){z(this,c);var g=c;var d=(g=y(g),R(this,qf()?Reflect.construct(g,[],y(this).constructor):g.apply(this,void 0)));
return a(d,"queue",[]),a(d,"isAnimating",!1),a(d,"typewriterAnimationDelay",125),d.scrollingUtil=b,d}return Aa(c,b),r(c,[{key:"setViewState",value:function(a){this.panelState=a}},{key:"enqueueAnimation",value:function(a){this.queue.push(a);this.isAnimating||this.animateNextSection()}},{key:"getQueue",value:function(){return this.queue}},{key:"getIsAnimating",value:function(){return this.isAnimating}},{key:"stopAnimating",value:function(){this.isAnimating=!1;this.queue=[]}},{key:"prepareSectionForReplaceAnimation",
value:function(a,b){var c=parseInt(a.dataset.currentAnimatedKey||"0");a=b.querySelectorAll("key, .rufus-markdown-animation-support");a=Na(Array.from(a).reduce(function(a,b,g){return(g>c-1?a[0]:a[1]).push(b),a},[[],[]]),2);b=a[1];this.hideElements(a[0]);fc(b)}},{key:"prepareSectionForAppendAnimation",value:function(a){var b=Array.from(a.querySelectorAll("key, .rufus-markdown-animation-support"));this.hideElements(b);a.classList.add("rufus-visibility-hidden")}},{key:"animateNextSection",value:function(){var a=
this,b=this.queue.shift();if(void 0!==b){this.isAnimating=!0;var c=b();0===this.queue.length&&this.dispatch("animationQueueComplete",void 0);c?Kd(c,function(){a.animateSection(c);0===a.queue.length&&a.dispatch("allAnimationsInQueueComplete",void 0)}):this.animateNextSection()}else this.isAnimating=!1}},{key:"animateSection",value:function(a){var b=this,c=parseInt(a.dataset.currentAnimatedKey||"0"),d=this.panelState&&"expanded"===this.panelState.viewState;d||(fc([a]),function(a){for(var b=function(){var b=
g[c];a.querySelectorAll("."+b).forEach(function(a){a.classList.remove(b)})},c=0,g=["fade-in","rufus-fade-in","rufus-web-fade-in"];c<g.length;c++)b()}(a));Array.from(a.querySelectorAll("button.rufus-pill")).forEach(function(a){var b=na.getInstance().getWeblabTreatment("RUFUS_DESKTOP_RQ_PILL_RESIZE_EXPERIMENT_1146390");b&&(k.recordTrigger("RUFUS_DESKTOP_RQ_PILL_RESIZE_EXPERIMENT_1146390",b),"T1"===b&&a.classList.add("rufus-related-question-pill-resize-experiment"))});var l=Array.from(a.querySelectorAll("key, .rufus-markdown-animation-support"));
if(this.scrollingUtil.autoScroll(),this.showElement(a),l.forEach(function(a){(a.classList.contains("rufus-related-question-pill")||a.classList.contains("rufus-web-related-question-pill"))&&Cf(a,jf())}),c<l.length)if(this.showElement(l[c]),c++,a.dataset.currentAnimatedKey=c.toString(),d)setTimeout(function(){return b.animateSection(a)},this.typewriterAnimationDelay);else{for(;c<l.length;c++)this.showElement(l[c]);this.cleanUpAnimationsAndDispatchCacheEvent(a,l);this.animateNextSection()}else{if(!d)return this.cleanUpAnimationsAndDispatchCacheEvent(a,
l),void this.animateNextSection();var q;(a&&"function"==typeof a.getAnimations?q=a.getAnimations({subtree:!0}):k.logErrorWithLevel(H.WARN,"The section element does not support getAnimations."),q&&0<q.length)?(c=q[q.length-1],d=c.currentTime,q=c.effect,q=null==q?void 0:q.getTiming().duration,null!=d&&null!=q&&d<q?c.finished.finally(function(){b.cleanUpAnimationsAndDispatchCacheEvent(a,l);b.animateNextSection()}).catch(function(a){a&&"name"in a&&"AbortError"!==a.name&&k.logErrorWithLevelWithException(H.ERROR,
a,"[AnimationUtil.animateSection] exception thrown from currentAnimation.finished promise")}):(this.cleanUpAnimationsAndDispatchCacheEvent(a,l),this.animateNextSection())):(this.cleanUpAnimationsAndDispatchCacheEvent(a,l),this.animateNextSection())}}},{key:"cleanUpAnimationsAndDispatchCacheEvent",value:function(a,b){fc([a]);fc(b);this.dispatch("sectionAnimationComplete",void 0)}},{key:"showElement",value:function(a){a.classList.remove("rufus-visibility-hidden")}},{key:"hideElements",value:function(a){a.forEach(function(a){a.classList.add("rufus-visibility-hidden")})}}])}(Ga),
Vi=function(){return r(function l(){z(this,l)},null,[{key:"cleanup",value:function(){sessionStorage.removeItem(vc.panel.key);var a=document.getElementById("nav-rufus-disco"),b=document.getElementById("nav-flyout-rufus");null==a||a.remove();null==b||b.remove()}}])}(),Wi=function(){return r(function l(){z(this,l)},null,[{key:"recordLatencyStats",value:function(a,b,c){var g=this.calculateInterSectionLatencyStats(a);a=g.min;var l=g.max,q=g.avg;g=g.median;var m=Date.now();null!=a&&null!=l&&null!=q&&null!=
g&&(k.widgetBodyBegin("".concat(b,"_MIN_").concat(c,"_LATENCY"),m),k.widgetBodyEnd("".concat(b,"_MIN_").concat(c,"_LATENCY"),!1,m+a),k.widgetBodyBegin("".concat(b,"_MAX_").concat(c,"_LATENCY"),m),k.widgetBodyEnd("".concat(b,"_MAX_").concat(c,"_LATENCY"),!1,m+l),k.widgetBodyBegin("".concat(b,"_AVG_").concat(c,"_LATENCY"),m),k.widgetBodyEnd("".concat(b,"_AVG_").concat(c,"_LATENCY"),!1,m+q),k.widgetBodyBegin("".concat(b,"_MEDIAN_").concat(c,"_LATENCY"),m),k.widgetBodyEnd("".concat(b,"_MEDIAN_").concat(c,
"_LATENCY"),!1,m+g))}},{key:"calculateInterSectionLatencyStats",value:function(a){if(2>a.length)return{};a.sort(function(a,b){return a-b});for(var b=[],c=1;c<a.length;c++)b.push(a[c]-a[c-1]);b.sort(function(a,b){return a-b});a=b.reduce(function(a,b){return a+b},0)/b.length;return{min:b[0],median:b[Math.ceil(.5*(b.length-1))],max:b[b.length-1],avg:a}}}])}(),Xi=function(){return r(function l(){z(this,l)},null,[{key:"validateAndRecordLatencyStats",value:function(a,b,c,k){b&&a.length-1!==b||1<a.length&&
Wi.recordLatencyStats(a,c,k)}},{key:"recordAllLatencyStats",value:function(a,b,c,k){var g=this;this.validateAndRecordLatencyStats(a.renderingTimestamps,c,k,"RENDER");this.validateAndRecordLatencyStats(a.networkTimestamps,c,k,"ROUND_TRIP_NETWORK");this.validateAndRecordLatencyStats(a.backendTimestamps,c,k,"BACKEND");b.forEach(function(a,b){g.validateAndRecordLatencyStats(a.renderingTimestamps,void 0,k,"".concat(b,"_RENDER"));g.validateAndRecordLatencyStats(a.networkTimestamps,void 0,k,"".concat(b,
"_ROUND_TRIP_NETWORK"));g.validateAndRecordLatencyStats(a.backendTimestamps,void 0,k,"".concat(b,"_BACKEND"))})}},{key:"batchRecordLatencyMarkersMetrics",value:function(a){var b=this,c=new qg,k=new Map,l=a.requestStartTime;if(l&&a.backendProcessingStartTime){c.renderingTimestamps.push(l);c.networkTimestamps.push(l);c.backendTimestamps.push(a.backendProcessingStartTime);var m=a.patchMap,p=a.cxType,r=0;Object.entries(m).forEach(function(g){g=Na(g,2);var q=g[0];g=g[1];var u=g.tagType,C="".concat(g.tagType,
"_").concat(g.occurrenceCount);if(null!=u){var y,z,N,A,B;q=b.getSectionStartTime(Number(q),m);var t=g.backendProcessingEndTime,F=a.backendProcessingStartTime,G=g.renderEndTime,P=null!==(y=k.get(u))&&void 0!==y?y:k.set(u,new qg).get(u);null!=G&&(c.renderingTimestamps.push(G),null==P||P.renderingTimestamps.push(G));null!=q&&(c.networkTimestamps.push(q),null==P||P.networkTimestamps.push(q));null!=t&&(c.backendTimestamps.push(t),null==P||P.backendTimestamps.push(t));b.recordTagLevelLatency(C,p,l,q,G,
F,t,null===(z=a.generationModelMetadata)||void 0===z?void 0:z.agentName);b.recordTagLevelLatency(u,p,l,q,G,F,t,null===(N=a.generationModelMetadata)||void 0===N?void 0:N.agentName);1!==g.occurrenceCount?b.recordTagLevelLatency("".concat(u,"_SUBSEQUENT"),p,l,q,G,F,t,null===(A=a.generationModelMetadata)||void 0===A?void 0:A.agentName):0==r&&b.recordTagLevelLatency("".concat(u,"_TOP_TAG"),p,l,q,G,F,t,null===(B=a.generationModelMetadata)||void 0===B?void 0:B.agentName);r++}});this.recordAllLatencyStats(c,
k,r,p)}}},{key:"recordCsmTagLevelLatencyMetrics",value:function(a,b,c,m){if(k.widgetBodyBegin(a,b),k.widgetBodyEnd(a,!1,c),m)a="".concat(m,"-").concat(a),k.widgetBodyBegin(a,b),k.widgetBodyEnd(a,!1,c)}},{key:"recordTagLevelLatency",value:function(a,b,c,k,m,p,r,u){this.recordCsmTagLevelLatencyMetrics("".concat(a,"_").concat(b,"_RENDER_LATENCY"),c,m,u);this.recordCsmTagLevelLatencyMetrics("".concat(a,"_").concat(b,"_NETWORK_LATENCY"),c,k,u);this.recordCsmTagLevelLatencyMetrics("".concat(a,"_").concat(b,
"_RENDER_NETWORK_LATENCY"),k,m,u);this.recordCsmTagLevelLatencyMetrics("".concat(a,"_").concat(b,"_BACKEND_LATENCY"),p,r,u);this.recordBackendFEDeltaLatency(a,b,c,k,p,r,u)}},{key:"getSectionStartTime",value:function(a,b){if(0==a)return b[String(a)].renderStartTime;for(var c=a,k=--c;null!=b[c]&&null==b[c].backendProcessingEndTime&&0<c;)k=c,c--;return null!=b[c]&&null==b[c].backendProcessingEndTime?b[String(c)].renderStartTime:null!=b[k]&&null==b[k].backendProcessingEndTime?b[String(k)].renderStartTime:
b[String(a)].renderStartTime}},{key:"recordBackendFEDeltaLatency",value:function(a,b,c,k,m,p,r){if(k&&p&&m){var g=Date.now();c=k-c-(p-m);this.recordCsmTagLevelLatencyMetrics("".concat(a,"_").concat(b,"_BACKEND_FE_DELTA"),g,g+c,r)}}}])}(),ud=function(a){return a.REQUEST_START="request-start",a.REQUEST_INTERRUPTED="request-interrupted",a.RENDER_START="render-start",a.RENDER_END="render-end",a}({}),Lb=function(a){return a.INPUT_BOX="inputBox",a.SWIPE_UP="swipeUp",a.RELATED_QUESTION_PILLS="relatedQuestionPills",
a.NAVIGATION="navigation",a.RETRY_BUTTON="retryButton",a.ASIN_CLICK="asinClick",a}({}),Mb=function(a){return a.MESSAGE_FTUX="message-ftux",a.MESSAGE_RUX="message-rux",a.INFERENCE_PILLS="inference-pills",a.INFERENCE_ANSWERING="inference-answering",a.CURATED="curated",a.AFFORDANCE="affordance",a}({}),Gg=function(a){return a.ASIN_FACEOUT="AsinFaceout",a}(Gg||{}),Hg=function(a){return a.ASIN_RECOMMENDATIONS="ASINRecommendations",a}(Hg||{}),Yi=function(){return r(function q(b){var c=this;z(this,q);a(this,
"reset",function(){c.state=new rg(c.tabId)});this.tabId=b;this.isBfcacheNavigation=!1;this.state=new rg(b)},[{key:"setIsBfcacheNavigation",value:function(a){this.isBfcacheNavigation=a}},{key:"startStreamingRequest",value:function(a){this.state.requestInterrupted&&this.sendCSA_BIMetric(this.state.activeChunkType);k.addCount(ha.STREAM_START,1);this.reset();null!=a?(this.state.trigger=a,this.state.latencyData.requestStartTime=Date.now()):k.addCount(ha.STREAM_WITHOUT_ACTION,1)}},{key:"openStreamingRequest",
value:function(){k.addCount(ha.SSE_STREAM_OPEN,1);this.logCSMLatency(ha.SSE_STREAM_OPEN)}},{key:"closeStreamingRequest",value:function(){k.addCount(ha.SSE_STREAM_CLOSE,1);this.logCSMLatency(ha.SSE_STREAM_CLOSE)}},{key:"handleRequestInterrupted",value:function(a){this.state.requestInterrupted||(k.addCount(ha.STREAM_INTERRUPTION,1),this.state.interruptionReason=a,this.logCSMLatency(ha.STREAM_INTERRUPTION),this.state.requestInterrupted=!0,this.state.latencyData.requestInterruptTime=Date.now(),J(F.CONVERSATION_ABANDONMENT,
a))}},{key:"handleStreamError",value:function(a,b){this.state.requestInterrupted||(k.addCount(ha.STREAM_ERROR,1),k.logErrorWithLevel(H.ERROR,"Stream closed due to error. InterruptionReason: ".concat(a,", ResponseCode: ").concat(b)),this.state.interruptionReason=a,this.logCSMLatency(ha.STREAM_ERROR),this.state.requestInterrupted=!0,this.state.latencyData.requestInterruptTime=Date.now())}},{key:"setChunkReceived",value:function(a,b){var c,k=2<arguments.length&&void 0!==arguments[2]&&arguments[2];a.data&&
(this.state.latencyData.activeChunk.renderStartTime=Date.now(),this.state.activeChunkType=a.type,k&&(c=a.data,!/^\s*</.test(c))?this.updateStreamStateFromEventDataV2(a):this.updateStreamStateFromEventData(a),this.state.isUplChunk=this.getIsUplMeasure(a.type),this.state.isUplChunk)&&(c=this.getUplType(a,b))&&this.logCSMLatency(c+ha.RECEIVE_SUFFIX,!0)}},{key:"setChunkReceivedV2",value:function(a,b){a.data&&(this.state.latencyData.activeChunk.renderStartTime=Date.now(),this.state.activeChunkType=a.type,
this.updateStreamStateFromEventDataV2(a),this.state.isUplChunk=this.getIsUplMeasure(a.type),this.state.isUplChunk)&&(a=this.getUplType(a,b))&&this.logCSMLatency(a+ha.RECEIVE_SUFFIX,!0)}},{key:"emitStreamRenderEnd",value:function(){this.logCSMLatency(ha.STREAM_LAST_RENDERED_CHUNK,!0)}},{key:"recordSectionRenderEnd",value:function(a,b,c,k){var g=Date.now();this.recordFirstInferenceChunkRenderLatency(a);0===c&&this.emitChunkFirstSectionRenderEndMetrics(a,b,g);k&&(this.emitChunkLastSectionRenderEndMetric(a),
this.recordPatchRenderEnd(g),this.batchRecordLatencyOnceLastPatchWasProcessed())}},{key:"recordFirstInferenceChunkRenderLatency",value:function(a){a.type!==aa.INFERENCE||this.state.latencyData.firstInferenceChunkProcessed||(this.logCSMLatency(ha.FIRST_INFERENCE_CHUNK_RENDER_SUFFIX,!0),this.state.latencyData.firstInferenceChunkProcessed=!0)}},{key:"recordPatchRenderEnd",value:function(a){var b=this;this.state.activeChunkPatchIds.forEach(function(c){(c=b.state.latencyData.patchMap[c])&&(c.renderEndTime=
a)})}},{key:"emitChunkFirstSectionRenderEndMetrics",value:function(a,b,c){if(a.data){var g=this.isBfcacheNavigation?tg.configName:rd.configName;g=Kb.getInstance().getLogger(g);(g&&!g.markerProcessed("initial_streaming_first_chunk_received")&&(g.setMarker("initial_streaming_first_chunk_received"),g.emitMetrics()),this.state.latencyData.activeChunk.renderEndTime=c,this.state.isUplChunk)&&(c=this.getUplType(a,b))&&this.logCSMLatency(c+ha.RENDER_SUFFIX,!0);this.state.isRequestTriggerUplLogged||(b=this.getRequestTriggerValue(b,
a))&&(this.state.isRequestTriggerUplLogged=!0,this.logCSMLatency(b+ha.RENDER_SUFFIX,!0));this.logCSMLatency(a.type+ha.CHUNK_FIRST_SECTION_RENDER_SUFFIX,!0);this.sendCSA_BIMetric(a.type)}}},{key:"emitChunkLastSectionRenderEndMetric",value:function(a){a.data&&this.logCSMLatency(a.type+ha.CHUNK_LAST_SECTION_RENDER_SUFFIX,!0)}},{key:"sendCSA_BIMetric",value:function(a){var b,g;a={nileRequestId:Ab.getInstance().nileRequestId,groupId:this.state.groupId,sequenceId:this.state.sequenceId,contentId:this.state.contentId,
slotId:this.state.slotId,requestType:null!==(b=this.state.trigger)&&void 0!==b?b:Z.UNKNOWN,interruptionReason:null!==(g=this.state.interruptionReason)&&void 0!==g?g:"",chunkType:null!=a?a:"unknown"};b=c.csa?c.csa("Content",{element:a}):void 0;b&&(b("mark",ud.REQUEST_START,this.state.latencyData.requestStartTime),b("mark",ud.RENDER_START,this.state.latencyData.activeChunk.renderStartTime),b("mark",ud.RENDER_END,this.state.latencyData.activeChunk.renderEndTime),this.state.latencyData.requestInterruptTime&&
b("mark",ud.REQUEST_INTERRUPTED,this.state.latencyData.requestInterruptTime))}},{key:"logCSMLatency",value:function(a){var b,c=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(this.state.latencyData.requestStartTime){k.widgetBodyBegin(a,this.state.latencyData.requestStartTime);k.widgetBodyEnd(a,!1);var l=null===(b=this.state.latencyData.generationModelMetadata)||void 0===b?void 0:b.agentName;c&&l&&(b="".concat(l,"-").concat(a),k.widgetBodyBegin(b,this.state.latencyData.requestStartTime),
k.widgetBodyEnd(b,!1))}}},{key:"getUplType",value:function(a,b){var c;switch(a.type){case aa.MESSAGE:return"SEEN"===(null===(c=b.requestContext)||void 0===c||null===(c=c.impressionsContext)||void 0===c?void 0:c.FIRST_TIME_USER_MESSAGE_SEEN_STATUS)?Mb.MESSAGE_RUX:Mb.MESSAGE_FTUX;case aa.CURATED_ANSWER:return Mb.CURATED;case aa.AFFORDANCE:return Mb.AFFORDANCE;case aa.INFERENCE:return b.isInitialStream&&!0!==this.state.isQuestionAnswering?Mb.INFERENCE_PILLS:Mb.INFERENCE_ANSWERING}}},{key:"updateStreamStateFromEventData",
value:function(a){var b=this.createTempElement(a.data);this.updateStateFromSection(b);this.handleTelemetryData(b,a);this.handleGenerationModelMetadata(b)}},{key:"handleGenerationModelMetadata",value:function(a){a=a.querySelector('script[type\x3d"a-state"][data-a-state*\x3d"generationModelMetadata"]');var b=this.state.latencyData.generationModelMetadata;if(a&&(!b||!b.agentName))try{this.state.latencyData.generationModelMetadata=JSON.parse(a.innerHTML)}catch(g){k.logErrorWithLevelWithException(H.ERROR,
g,"".concat("StreamingLifecycleEventLogger"," - Error parsing event Generation Model Metadata:"))}}},{key:"handleTelemetryData",value:function(a,b){var c;b.type===aa.REMOVE&&(c={chunk:{2:{last:!1}}});if(a=a.querySelector('script[type\x3d"a-state"][data-a-state*\x3d"telemetryInfo"]'))try{c=JSON.parse(a.innerHTML)}catch(C){k.logErrorWithLevelWithException(H.ERROR,C,"".concat("StreamingLifecycleEventLogger"," - Error parsing event telemetry data:"))}this.processEventTelemetryData(c)}},{key:"updateStateFromSection",
value:function(a){var b,c,k,l;(a=a.querySelector('[id^\x3d"section_groupId_"]'))&&(this.state=tf(tf({},this.state),{},{groupId:null!==(b=a.getAttribute("data-csa-c-group-id"))&&void 0!==b?b:"",sequenceId:null!==(c=a.getAttribute("data-csa-c-sequence-id"))&&void 0!==c?c:"",contentId:null!==(k=a.getAttribute("data-csa-c-content-id"))&&void 0!==k?k:"",slotId:null!==(l=a.getAttribute("data-csa-c-slot-id"))&&void 0!==l?l:""}))}},{key:"createTempElement",value:function(a){var b=document.createElement("div");
return b.innerHTML=a,b}},{key:"updateStreamStateFromEventDataV2",value:function(a){var b,c=this,k=wg.parseEventData(a);null==k||null===(b=k.sections)||void 0===b||b.forEach(function(b){var g;"HTML"===(null==b||null===(g=b.content)||void 0===g?void 0:g.format)&&(b=c.createTempElement(b.content.data),c.updateStateFromSection(b),c.handleTelemetryData(b,a),c.handleGenerationModelMetadata(b))})}},{key:"isFtuxPlaceholderChunk",value:function(a){var b=document.createElement("div");b.innerHTML=a.data;a=b.querySelector('[id^\x3d"section_groupId_"]');
return!!a&&"PlaceholderMessage"===a.getAttribute("data-section-class")}},{key:"getIsUplMeasure",value:function(a){switch(a){case aa.MESSAGE:if(!this.state.chunkFirstReceivedMap.has(aa.MESSAGE))return this.state.chunkFirstReceivedMap.set(aa.MESSAGE,!0),!0;break;case aa.CURATED_ANSWER:if(!this.state.chunkFirstReceivedMap.has(aa.CURATED_ANSWER))return this.state.chunkFirstReceivedMap.set(aa.CURATED_ANSWER,!0),!0;break;case aa.AFFORDANCE:if(!this.state.chunkFirstReceivedMap.has(aa.AFFORDANCE))return this.state.chunkFirstReceivedMap.set(aa.AFFORDANCE,
!0),!0;break;case aa.INFERENCE:if(!this.state.chunkFirstReceivedMap.has(aa.INFERENCE))return this.state.chunkFirstReceivedMap.set(aa.INFERENCE,!0),!0}return!1}},{key:"getRequestTriggerValue",value:function(a,b){var c,l;if(aa.AFFORDANCE!==b.type){if(b.type!==aa.MESSAGE||!this.isFtuxPlaceholderChunk(b))switch(this.state.trigger){case Z.SEARCH:if(a.isInitialStream)return!0===this.state.isQuestionAnswering?Lb.NAVIGATION:Lb.ASIN_CLICK;var m;if((null===(c=a.requestContext)||void 0===c||null===(c=c.queryContext)||
void 0===c?void 0:c.qis)===qa.NILE_RELATED_QUESTION||(null===(l=a.requestContext)||void 0===l||null===(l=l.queryContext)||void 0===l?void 0:l.qis)===qa.NILE_DEALS_RELATED_QUESTION)return(null===(m=a.requestContext)||void 0===m?void 0:m.queryContext.qis)===qa.NILE_DEALS_RELATED_QUESTION&&k.addCount(p.RUFUS_DEALS_PILL_PRESENTED,1),Lb.RELATED_QUESTION_PILLS;if(a.inputQuery&&0<a.inputQuery.length)return Lb.INPUT_BOX;break;case Z.SWIPE_UP:return Lb.SWIPE_UP;case Z.ASIN_CLICK:return Lb.ASIN_CLICK}}else this.state.isQuestionAnswering=
!0}},{key:"processEventTelemetryData",value:function(a){a?(this.state.activeChunkPatchIds=Object.keys(a.chunk),this.processChunkTelemetryData(a.chunk),a.backfill&&this.processChunkBackfillData(a.backfill)):this.state.activeChunkPatchIds=[]}},{key:"processChunkTelemetryData",value:function(a){for(var b in a)b in this.state.latencyData.patchMap||(this.state.latencyData.patchMap[b]={isLast:a[b].last,renderStartTime:this.state.latencyData.activeChunk.renderStartTime})}},{key:"processChunkBackfillData",
value:function(a){for(var b in a)if(b in this.state.latencyData.patchMap){var c=a[b],l=this.state.latencyData.patchMap[b];l.tagType=c.tagType;l.backendProcessingEndTime=c.lastCompletedPatchProcessedAt;l.occurrenceCount=c.occurrenceCount;this.state.latencyData.backendProcessingStartTime||(this.state.latencyData.backendProcessingStartTime=c.processingStartedAt);c.tagType==Gg.ASIN_FACEOUT&&(this.state.latencyData.cxType=Hg.ASIN_RECOMMENDATIONS);this.state.latencyData.cxType||(this.state.latencyData.cxType=
c.cxType)}else k.addCount(p.UNKNOWN_PATCH_ID_IN_BACKFILL_DATA,1)}},{key:"batchRecordLatencyOnceLastPatchWasProcessed",value:function(){var a,b=function(a,b){var c="undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(!c){if(Array.isArray(a)||(c=function(a,b){if(a){if("string"==typeof a)return rf(a,b);var c={}.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?
rf(a,b):void 0}}(a))||b&&a&&"number"==typeof a.length){c&&(a=c);var g=0;b=function(){};return{s:b,n:function(){return g>=a.length?{done:!0}:{done:!1,value:a[g++]}},e:function(a){throw a;},f:b}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var k,l=!0,m=!1;return{s:function(){c=c.call(a)},n:function(){var a=c.next();return l=a.done,a},e:function(a){m=!0;k=a},f:function(){try{l||null==c.return||
c.return()}finally{if(m)throw k;}}}}(this.state.activeChunkPatchIds);try{for(b.s();!(a=b.n()).done;)if(this.isLastJsonPatch(this.state.latencyData.patchMap[a.value])){Xi.batchRecordLatencyMarkersMetrics(this.state.latencyData);this.state.latencyData.patchMap={};break}}catch(g){b.e(g)}finally{b.f()}}},{key:"isLastJsonPatch",value:function(a){return a&&a.isLast&&null!=a.backendProcessingEndTime}}])}(),Zi=function(){var a=G(Q().mark(function C(a,b){var d,g,m,q,r,u,y,z,A,B,G,L,M,t,O,R,U,T,W,X,Y,V,Z,aa;
return Q().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if((m=na.getInstance().getWeblabTreatment("TEST_1056934"))&&k.recordTrigger("TEST_1056934",m),q=function(a){return a===Fb.AUTHENTICATED},(r=th.getInstance()).on("authStatusChanged",function(a){q(a)||Vi.cleanup()}),q(r.checkAuthStatus())){C.next=7;break}return C.abrupt("return");case 7:if(lb.initialize(),document.getElementById("rufus-container")||k.logErrorWithLevel(H.ERROR,"RufusPanelWebAssets is initializing without rufus-container."),
(u=new Qi).areAllFeaturesSupported()){C.next=14;break}return k.addCount(p.RUFUS_INSUFFICIENT_BROWSER_CAPABILITIES,1),lb.renderError({errorCode:xb.INSUFFICIENT_BROWSER_CAPABILITIES}),C.abrupt("return");case 14:if(b.hasRufusPanelAutoMinimized&&J(F.PANEL_RESIZE_RUFUS,ia.EXPANDED_TO_MINIMIZED),y=new uh(b.uniqueId,b.cacheEnabled),Ae.getInstance().tabId=y.getTabId(),pb(),z=new Ji,A=new Ki(a),B=new Df(a,y.getTabId()),G=new Si(A),L=new Ui(G),M=new Yi(y.getTabId()),t=new Ei(L,M,y),O=new Mi,R=new Oi(A,y,t),
U=K.extractQueryFromUrl(K.getCurrentPageUrl()),Za(A.getPanelViewContext().pageType)!==wa.SEARCH_RESULTS){C.next=32;break}return C.next=32,fa.when("s-metadata").execute(function(a){R.setIsRufusStayBehaviorRequired(a.isRufusStayBehaviorRequired);U||R.setSearchBarQuery(a.keywords)});case 32:return T=new ug(a,R,y.getTabId(),M),W=new td(a,R,A),X=new Ai(a),new Li(a),Y=new sh(T),V=new Ti(y,B,t,A,T,O,z,W,G,L,X,Y,M,u),b.isJSMigration&&((new Pi(A,V)).init(),N=void 0,P=void 0,N=xg(c.location.href),P=null==N?
void 0:N.actionConfig,!(!N||"stream"!==(null==P?void 0:P.type))&&function(a){var b,c=null==a?void 0:a.actionConfig,d=a.client+"_"+a.action,g={query:null!==(b=a.query)&&void 0!==b?b:"",qis:null==c?void 0:c.context.qis,metricName:d};fa.when(hc.HANDLE_STREAM).execute(function(a){a(g)})}(N)),V.initialize(b),Z=function(){c.P&&(fa.declare("rufus-thick-client",!0),fa.declare("rufus-stream",function(a){V.stream(a);Ig(A)}),fa.declare("rufus-expand",function(){Ig(A)}),Fg.recordAssetsLoad())},(null==b?void 0:
b.thickClientLoaded)&&(null==b||b.thickClientLoaded()),aa=rd.configName,null===(d=Kb.getInstance().getLogger(aa))||void 0===d||d.setMarker("initialized"),null===(g=Kb.getInstance().getLogger(aa))||void 0===g||g.emitMetrics(),C.abrupt("return",{conversationOrchestrator:V,panelContainer:A,callback:Z});case 46:case "end":return C.stop()}var N,P},C)}));return function(b,c){return a.apply(this,arguments)}}(),Ig=function(a){var b=a.getPanelContainerState().viewState;a.applyAnimationAndStateUpdate(b,"expanded")},
xe=function(){var a=G(Q().mark(function C(a,b){var d;return Q().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return fa.now("rufus-panel-first-visible").execute(function(a){void 0!==a&&Kb.getInstance().initialize(rd,a)}),g.next=3,Zi(a,b);case 3:(d=g.sent)&&d.callback(),c.addEventListener("pageshow",function(a){a.persisted&&(null==d||d.panelContainer.updateStateAndContent(),(null==d?void 0:d.panelContainer.isPanelClosed())||Kb.getInstance().initialize(tg),null==d||d.conversationOrchestrator.handleBfCacheNavigation(),
null==d||d.conversationOrchestrator.startInitialStreamingCallback())});case 6:case "end":return g.stop()}},C)}));return function(b,c){return a.apply(this,arguments)}}();c.P&&(fa.when("A","sp.load.rufus.critical.assets.js","sp.load.rufus.panel.assets.js","rufus-common-modules").execute(function(){var a=G(Q().mark(function P(a,b,c,d){var g;return Q().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return g=Ld(Ld(Ld({},b),c),{},{isJSMigration:!0},d),k.next=3,xe(a,g);case 3:case "end":return k.stop()}},
P)}));return function(b,c,d,k){return a.apply(this,arguments)}}()),fa.when("A","rufus-thin-client").execute(function(){var a=G(Q().mark(function C(a,b){var c,d;return Q().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(c=Dg(null==b?void 0:b.rufusTriggerMarkerMapping,null==b?void 0:b.pageType),"shouldDelayThickClientInitialization"!==b.latencyRegressionMitigationStrategy||!c||"YourOrders"===b.pageType){g.next=7;break}return d=function(){var c=G(Q().mark(function La(){return Q().wrap(function(c){for(;;)switch(c.prev=
c.next){case 0:return c.next=2,xe(a,b);case 2:case "end":return c.stop()}},La)}));return function(){return c.apply(this,arguments)}}(),g.next=5,Eg(d,b.rufusLatencyMarkerFallbackTimeout,c,we.ShouldDelayThickClientInitialization);case 5:g.next=9;break;case 7:return g.next=9,xe(a,b);case 9:case "end":return g.stop()}},C)}));return function(b,c){return a.apply(this,arguments)}}()))})()}()});