/*! For license information please see splitio-react-1.11.1.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("React")):"function"==typeof define&&define.amd?define(["React"],t):"object"==typeof exports?exports.splitio=t(require("React")):e.splitio=t(e.React)}(self,(function(e){return function(){var t={774:function(e){e.exports=function(e,t,n,r){var i=n?n.call(r,e,t):void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var s=Object.keys(e),o=Object.keys(t);if(s.length!==o.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(t),u=0;u<s.length;u++){var c=s[u];if(!a(c))return!1;var l=e[c],f=t[c];if(!1===(i=n?n.call(r,l,f,c):void 0)||void 0===i&&l!==f)return!1}return!0}},24:function(t){"use strict";t.exports=e}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var s=n[e]={exports:{}};return t[e](s,s.exports,r),s.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var i={};return function(){"use strict";r.d(i,{default:function(){return ys}});var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;function s(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var o=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(r,i){for(var o,a,u=s(r),c=1;c<arguments.length;c++){for(var l in o=Object(arguments[c]))t.call(o,l)&&(u[l]=o[l]);if(e){a=e(o);for(var f=0;f<a.length;f++)n.call(o,a[f])&&(u[a[f]]=o[a[f]])}}return u},a=115,u=223,c=315,l=318,f=319,h="settings",p="Factory instantiation",d="sync:featureflag-changes: ",g="Global fetch API is not available.",m="control",v={treatment:m,config:null},y="IMPRESSION",S="EVENT",b="DEBUG",T="OPTIMIZED",E="NONE",_="localhost",k="standalone",R="producer",C="consumer",w="consumer_partial",A="MEMORY",O="LOCALSTORAGE",N="GRANTED",F="DECLINED",D="UNKNOWN",I="getTreatment",L="getTreatments",K="getTreatmentWithConfig",M="getTreatmentsWithConfig",x="getTreatmentsByFlagSet",U="getTreatmentsByFlagSets",P="getTreatmentsWithConfigByFlagSet",j="getTreatmentsWithConfigByFlagSets",B="track",q="split",W="splits",z="names",H="te",G={headers:{"Cache-Control":"no-cache"}};function Q(e){return"users="+encodeURIComponent(e)}function Y(e,t,n){var r=e.urls,i=e.sync.__splitFiltersValidation&&e.sync.__splitFiltersValidation.queryString,s=e.sync.impressionsMode,a=function(e,t){var n=e.log,r=e.core.authorizationKey,i=e.version,s=e.runtime,a=s.ip,u=s.hostname,c=t&&t();c||n.error(303,[g]);var l={Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r,SplitSDKVersion:i};return a&&(l.SplitSDKMachineIP=a),u&&(l.SplitSDKMachineName=u),function(e,t,r,i){void 0===t&&(t={}),void 0===r&&(r=function(){}),void 0===i&&(i=!1);var s={headers:t.headers?o({},l,t.headers):l,method:t.method||"GET",body:t.body};return c?c(e,s).then((function(e){return e.ok?(r(),e):e.text().then((function(t){return Promise.reject({response:e,message:t})}))})).catch((function(t){var s,o=t&&t.response;s=o?404===o.status?"Invalid SDK key or resource not found.":t.message:t.message||"Network Error",o&&403===o.status||n[i?"info":"error"](322,[o?o.status:"NO_STATUS",e,s]);var a=new Error(s);throw a.statusCode=o&&o.status,r(a),a})):Promise.reject(new Error(g))}}(e,t.getFetch);return{getSdkAPIHealthCheck:function(){var e=r.sdk+"/version";return a(e).then((function(){return!0})).catch((function(){return!1}))},getEventsAPIHealthCheck:function(){var e=r.events+"/version";return a(e).then((function(){return!0})).catch((function(){return!1}))},fetchAuth:function(e){var t=r.auth+"/v2/auth";if(e){var i=e.map(Q).join("&");i&&(t+="?"+i)}return a(t,void 0,n.trackHttp("to"))},fetchSplitChanges:function(t,s,o){var u=r.sdk+"/splitChanges?since="+t+(o?"&till="+o:"")+(i||"");return a(u,s?G:void 0,n.trackHttp("sp")).catch((function(t){throw 414===t.statusCode&&e.log.error(327),t}))},fetchSegmentChanges:function(e,t,i,s){var o=r.sdk+"/segmentChanges/"+t+"?since="+e+(s?"&till="+s:"");return a(o,i?G:void 0,n.trackHttp("se"))},fetchMySegments:function(e,t){var i=r.sdk+"/mySegments/"+encodeURIComponent(e);return a(i,t?G:void 0,n.trackHttp("ms"))},postEventsBulk:function(e,t){var i=r.events+"/events/bulk";return a(i,{method:"POST",body:e,headers:t},n.trackHttp("ev"))},postTestImpressionsBulk:function(e,t){var i=r.events+"/testImpressions/bulk";return a(i,{method:"POST",body:e,headers:o({SplitSDKImpressionsMode:s},t)},n.trackHttp("im"))},postTestImpressionsCount:function(e,t){var i=r.events+"/testImpressions/count";return a(i,{method:"POST",body:e,headers:t},n.trackHttp("ic"))},postUniqueKeysBulkCs:function(e,t){var i=r.telemetry+"/v1/keys/cs";return a(i,{method:"POST",body:e,headers:t},n.trackHttp(H))},postUniqueKeysBulkSs:function(e,t){var i=r.telemetry+"/v1/keys/ss";return a(i,{method:"POST",body:e,headers:t},n.trackHttp(H))},postMetricsConfig:function(e,t){var i=r.telemetry+"/v1/metrics/config";return a(i,{method:"POST",body:e,headers:t},n.trackHttp(H),!0)},postMetricsUsage:function(e,t){var i=r.telemetry+"/v1/metrics/usage";return a(i,{method:"POST",body:e,headers:t},n.trackHttp(H),!0)}}}function V(e,t,n,r){void 0===r&&(r="task");var i,s,o,a=0,u=!1,c=0;function l(){for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];return a++,e.debug(37,[r]),i=(i?i.then((function(){return t.apply(void 0,n)})):t.apply(void 0,n)).then((function(e){return a--,e}))}function f(e){return l.apply(void 0,s).then((function(t){return u&&e===c&&(o=setTimeout(f,n,e)),t}))}return{execute:l,isExecuting:function(){return a>0},start:function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];if(!u)return u=!0,c++,s=t,e.debug(36,[r,n]),f(c)},stop:function(){u=!1,o&&(e.debug(38,[r]),clearTimeout(o),o=void 0)},isRunning:function(){return u}}}function J(e,t,n,r,i,s,o,a){void 0===o&&(o=0);var u,c=0;return V(e,(function(){if(n.isEmpty()&&!u)return Promise.resolve();var r="number"==typeof(u=n.pop(u)).length?u.length+" "+i:i;e[a?"debug":"info"](116,[r]);var l=JSON.stringify(s?s(u):u);return o||(u=void 0),t(l).then((function(){c=0,u=void 0})).catch((function(t){o?c===o?(c=0,u=void 0,e[a?"debug":"warn"](209,[r,t])):(c++,e[a?"debug":"warn"](210,[r,t])):e[a?"debug":"warn"](209,[r,t])}))}),r,i+" submitter")}function Z(e,t){var n,r=!1,i=e.start;e.start=function(){r=!0,n=setTimeout(i,t)};var s=e.stop;return e.stop=function(){r=!1,clearTimeout(n),s()},e.isRunning=function(){return r},e}var $="events";function X(e){var t=e.settings,n=t.log,r=t.scheduler.eventsPushRate,i=t.startup.eventsFirstPushWindow,s=e.splitApi.postEventsBulk,o=e.storage.events,u=J(n,s,o,r,$);return i>0&&(u=Z(u,i)),o.setOnFullQueueCb((function(){u.isRunning()&&(n.info(a,[$]),u.execute())})),u}var ee=function(e,t){return ee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},ee(e,t)};function te(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}ee(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var ne=function(){return ne=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ne.apply(this,arguments)};function re(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function ie(e,t){var n;if(fe(e))for(var r=Object.keys(e),i=0;i<r.length&&!n;i++){var s=r[i];t(e[s],s,e)&&(n=e[s])}else if(Array.isArray(e))for(i=0;i<e.length&&!n;i++)t(e[i],i,e)&&(n=e[i]);return n}function se(e,t){if(Array.isArray(e)&&"function"==typeof t)for(var n=0;n<e.length;n++)if(!0===t(e[n],n,e))return n;return-1}function oe(e,t){return Object.keys(e).forEach((function(n){return t(e[n],n,e)})),e}function ae(e,t,n){var r=n;try{var i=t.split("."),s=e;i.forEach((function(e){return s=s[e]})),void 0!==s&&(r=s)}catch(e){}return r}function ue(e){return!0===e||!1===e}function ce(e){return e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&(Number.isFinite?Number.isFinite(e):isFinite(e))}function le(e){return e instanceof Number&&(e=e.valueOf()),e!=e}function fe(e){return null!==e&&"object"==typeof e&&(e.constructor===Object||null!=e.constructor&&"Object"===e.constructor.name)}function he(e){return"string"==typeof e||e instanceof String}function pe(e){return he(e)?e.toUpperCase():e}function de(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=e;if(fe(t)&&Object.keys(t).forEach((function(e){var n=t[e];fe(n)&&(n=i[e]&&fe(i[e])?de({},i[e],n):de({},n)),void 0!==n&&(i[e]=n)})),n&&n.length){var s=n.splice(0,1)[0];i=de.apply(void 0,re([i,s],n,!1))}return i}function ge(e,t){return!(!he(e)||!he(t))&&e.slice(0,t.length)===t}function me(e){if("number"==typeof e)return e;if(fe(e)&&"function"==typeof e.valueOf){var t=e.valueOf();e=fe(t)?t+"":t}return"string"!=typeof e?0===e?e:+e:+(e=e.replace(/^\s+|\s+$/g,""))}function ve(e){if(null==e)return"";if("string"==typeof e)return e;if(Array.isArray(e))return e.map((function(e){return he(e)?e:""}))+"";var t=e+"";return"0"===t&&1/e===Number.NEGATIVE_INFINITY?"-0":t}function ye(e){var t={};return e.filter((function(e){return!Object.prototype.hasOwnProperty.call(t,e)&&(t[e]=!0)}))}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var Se="impressions";function be(e,t){var n=function(e,t){var n={};if(Array.isArray(e)&&he(t))for(var r=0;r<e.length;r++){var i=e[r][t];he(i)&&(n[i]||(n[i]=[]),n[i].push(e[r]))}return n}(t,"feature"),r=[];return oe(n,(function(t,n){r.push({f:n,i:t.map((function(t){return{k:t.keyName,t:t.treatment,m:t.time,c:t.changeNumber,r:e?t.label:void 0,b:t.bucketingKey?t.bucketingKey:void 0,pt:t.pt?t.pt:void 0}}))})})),r}function Te(e){var t=e.settings,n=t.log,r=t.scheduler.impressionsRefreshRate,i=t.core.labelsEnabled,s=e.splitApi.postTestImpressionsBulk,o=e.storage.impressions,u=J(n,s,o,r,Se,be.bind(void 0,i),1);return o.setOnFullQueueCb((function(){u.isRunning()&&(n.info(a,[Se]),u.execute())})),u}function Ee(e){for(var t=[],n=Object.keys(e),r=0;r<n.length;r++){var i=n[r].split("::");if(2===i.length){var s=i[0],o=i[1],a={f:s,m:Number(o),rc:e[n[r]]};t.push(a)}}return{pf:t}}var _e="state::splits-arrived",ke="state::splits-cache-loaded",Re="state::segments-arrived",Ce="init::timeout",we="init::ready",Ae="init::cache-ready",Oe="state::update";function Ne(e){return C===e||w===e}var Fe=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/;function De(e,t,n,r){if(void 0===r&&(r="feature flag name"),null==t)e.error(c,[n,r]);else if(he(t)){if(Fe.test(t)&&(e.warn(214,[n,r,t]),t=t.trim()),t.length>0)return t;e.error(f,[n,r])}else e.error(l,[n,r]);return!1}function Ie(e,t,n,r,i){if(void 0===r&&(r="feature flag names"),void 0===i&&(i="feature flag name"),Array.isArray(t)&&t.length>0){var s=[];if(t.forEach((function(t){var r=De(e,t,n,i);r&&s.push(r)})),s.length)return ye(s)}return e.error(320,[n,r]),!1}var Le=[{type:"bySet",maxLength:50,queryParam:"sets="},{type:"byName",maxLength:400,queryParam:"names="},{type:"byPrefix",maxLength:50,queryParam:"prefixes="}],Ke=/^[a-z0-9][_a-z0-9]{0,49}$/,Me=/[A-Z]/;function xe(e,t,n){return ye(t.map((function(t){return Me.test(t)&&(e.warn(226,[n,t]),t=t.toLowerCase()),t})).filter((function(t){return Ke.test(t)?"string"==typeof t:(e.warn(225,[n,t,Ke,t]),!1)})))}function Ue(e,t){return ie(e,(function(e){return e.type===t&&e.values.length>0}))}function Pe(e,t,n,r){if(null==t)return e.error(c,[n,r]),!1;if(ce(t))return e.warn(213,[n,r,t]),ve(t);if(he(t)){if((t=t.trim()).length>0&&t.length<=250)return t;0===t.length?e.error(f,[n,r]):t.length>250&&e.error(316,[n,r])}else e.error(l,[n,r]);return!1}function je(e,t,n){if(fe(t)){var r=Pe(e,t.matchingKey,n,"matchingKey"),i=Pe(e,t.bucketingKey,n,"bucketingKey");return r&&i?{matchingKey:r,bucketingKey:i}:(e.error(317,[n]),!1)}return Pe(e,t,n,"key")}var Be=/[A-Z]/,qe="traffic_type";function We(e,t,n){if(null==t)e.error(c,[n,qe]);else if(he(t)){if(0!==t.length)return Be.test(t)&&(e.warn(216,[n]),t=t.toLowerCase()),t;e.error(f,[n,qe])}else e.error(l,[n,qe]);return!1}var ze={mode:k,core:{authorizationKey:void 0,key:void 0,trafficType:void 0,labelsEnabled:!0,IPAddressesEnabled:void 0},scheduler:{featuresRefreshRate:60,segmentsRefreshRate:60,telemetryRefreshRate:3600,impressionsRefreshRate:300,offlineRefreshRate:15,eventsPushRate:60,eventsQueueSize:500,impressionsQueueSize:3e4,pushRetryBackoffBase:1},urls:{sdk:"https://sdk.split.io/api",events:"https://events.split.io/api",auth:"https://auth.split.io/api",streaming:"https://streaming.split.io",telemetry:"https://telemetry.split.io/api"},storage:void 0,debug:void 0,impressionListener:void 0,version:void 0,integrations:void 0,streamingEnabled:!0,sync:{splitFilters:void 0,impressionsMode:T,localhostMode:void 0,enabled:!0},log:void 0};function He(e){return Math.round(1e3*e)}function Ge(e,t){var n=t.defaults,r=t.runtime,i=t.storage,s=t.integrations,a=t.logger,u=t.localhost,c=t.consent,l=de({},ze,n,e),f=a(l);l.log=f,l.sync.impressionsMode=function(e,t){return t=pe(t),[b,T,E].indexOf(t)>-1?t:(e.error(321,["impressionsMode",[b,T,E],T]),T)}(f,l.sync.impressionsMode);var p,d=l.scheduler,g=l.startup;d.featuresRefreshRate=He(d.featuresRefreshRate),d.segmentsRefreshRate=He(d.segmentsRefreshRate),d.offlineRefreshRate=He(d.offlineRefreshRate),d.eventsPushRate=He(d.eventsPushRate),d.telemetryRefreshRate=He(("telemetryRefreshRate",(p=d.telemetryRefreshRate)>=60?p:(f.error(326,["telemetryRefreshRate",60]),60))),void 0===ae(e,"scheduler.impressionsRefreshRate")&&l.sync.impressionsMode===b&&(d.impressionsRefreshRate=60),d.impressionsRefreshRate=He(d.impressionsRefreshRate),d.metricsRefreshRate&&f.warn("`metricsRefreshRate` will be deprecated soon. For configuring telemetry rates, update `telemetryRefreshRate` value in configs"),g.requestTimeoutBeforeReady=He(g.requestTimeoutBeforeReady),g.readyTimeout=He(g.readyTimeout),g.eventsFirstPushWindow=He(g.eventsFirstPushWindow),l.mode=function(e,t){if("localhost"===e)return _;if(-1===[k,R,C,w].indexOf(t))throw Error("Invalid mode provided");return t}(l.core.authorizationKey,l.mode),i&&(l.storage=i(l));var m=l.core.key;if(t.acceptKey){if(l.mode===_&&void 0===m?l.core.key="localhost_key":l.core.key=je(f,m,"Client instantiation"),t.acceptTT){var v=l.core.trafficType;void 0!==v&&(l.core.trafficType=We(f,v,"Client instantiation"))}}else void 0!==m&&f.warn("Provided `key` is ignored in server-side SDK."),l.core.key=void 0;l.runtime=r(l),s&&(l.integrations=s(l)),u&&(l.sync.localhostMode=u(l)),!1!==l.streamingEnabled&&(l.streamingEnabled=!0,d.pushRetryBackoffBase=He(d.pushRetryBackoffBase)),!1!==l.sync.enabled&&(l.sync.enabled=!0);var y=function(e,t,n){var r,i,s={validFilters:[],queryString:null,groupedFilters:{bySet:[],byName:[],byPrefix:[]}};return t?Ne(n)?(e.warn(219),s):Array.isArray(t)&&0!==t.length?(s.validFilters=t.filter((function(t,n){return t&&(r=t.type,Le.some((function(e){return e.type===r})))&&Array.isArray(t.values)?(s.groupedFilters[t.type]=s.groupedFilters[t.type].concat(t.values),!0):(e.warn(220,[n]),!1);var r})),Le.forEach((function(t){var n=t.type,r=t.maxLength;s.groupedFilters[n].length>0&&(s.groupedFilters[n]=function(e,t,n,r){var i=Ie(e,n,h,t+" filter",t+" filter value");if(i){if("bySet"===t&&(i=xe(e,i,h)),i.length>r)throw new Error(r+" unique values can be specified at most for '"+t+"' filter. You passed "+i.length+". Please consider reducing the amount or using other filter.");i.sort()}return i||[]}(e,n,s.groupedFilters[n],r))})),Ue(s.validFilters,"bySet")&&((Ue(s.validFilters,"byName")||Ue(s.validFilters,"byPrefix"))&&e.error(328),o(s.groupedFilters,{byName:[],byPrefix:[]})),s.queryString=(r=s.groupedFilters,i=[],Le.forEach((function(e){var t=e.type,n=e.queryParam,s=r[t];s.length>0&&i.push(n+s.map((function(e){return encodeURIComponent(e)})).join(","))})),i.length>0?"&"+i.join("&"):null),e.debug(39,[s.queryString]),s):(e.warn(221),s):s}(f,l.sync.splitFilters,l.mode);return l.sync.splitFilters=y.validFilters,l.sync.__splitFiltersValidation=y,l.userConsent=c(l),l}var Qe,Ye,Ve,Je="sdk_key",Ze={};function $e(e){var t=e();return function(){return Math.round(e()-t)}}var Xe=((Qe={})[k]=0,Qe[C]=1,Qe[w]=2,Qe),et=((Ye={})[T]=0,Ye[b]=1,Ye[E]=2,Ye),tt=((Ve={}).UNKNOWN=1,Ve.GRANTED=2,Ve.DECLINED=3,Ve);var nt="unique keys";function rt(e){var t=[Te(e),X(e)],n=function(e){var t=e.settings.log,n=e.splitApi.postTestImpressionsCount,r=e.storage.impressionCounts;if(r)return J(t,n,r,18e5,"impression counts",Ee,1)}(e);n&&t.push(n);var r=function(e){var t=e.storage.telemetry,n=e.platform.now;if(t&&n){var r=e.settings,i=e.settings,s=i.log,a=i.scheduler.telemetryRefreshRate,u=e.splitApi,c=e.readiness,l=e.sdkReadinessManager,f=$e(n),h=Z(J(s,u.postMetricsUsage,t,a,"telemetry stats",void 0,0,!0),a);return c.gate.once(Ae,(function(){t.recordTimeUntilReadyFromCache(f())})),l.incInternalReadyCbCount(),c.gate.once(we,(function(){t.recordTimeUntilReady(f()),h.isRunning()&&J(s,u.postMetricsConfig,function(e,t){return{isEmpty:function(){return!1},clear:function(){},pop:function(){var n,r,i=t.urls,s=t.scheduler,a=void 0!==t.core.key,u=function(e){var t=0;e.validFilters.forEach((function(e){"bySet"===e.type&&(t+=e.values.length)}));var n=e.groupedFilters.bySet.length;return{flagSetsTotal:t,flagSetsIgnored:t-n}}(t.sync.__splitFiltersValidation),c=u.flagSetsTotal,l=u.flagSetsIgnored;return o((n=t.mode,r=t.storage.type,{oM:Xe[n],st:r.toLowerCase(),aF:Object.keys(Ze).length,rF:Object.keys(Ze).reduce((function(e,t){return e+Ze[t]-1}),0)}),{sE:t.streamingEnabled,rR:{sp:s.featuresRefreshRate/1e3,se:a?void 0:s.segmentsRefreshRate/1e3,ms:a?s.segmentsRefreshRate/1e3:void 0,im:s.impressionsRefreshRate/1e3,ev:s.eventsPushRate/1e3,te:s.telemetryRefreshRate/1e3},uO:{s:i.sdk!==ze.urls.sdk,e:i.events!==ze.urls.events,a:i.auth!==ze.urls.auth,st:i.streaming!==ze.urls.streaming,t:i.telemetry!==ze.urls.telemetry},iQ:s.impressionsQueueSize,eQ:s.eventsQueueSize,iM:et[t.sync.impressionsMode],iL:!!t.impressionListener,hP:!1,tR:e.getTimeUntilReady(),tC:e.getTimeUntilReadyFromCache(),nR:e.getNonReadyUsage(),t:e.popTags(),i:t.integrations&&t.integrations.map((function(e){return e.type})),uC:t.userConsent?tt[t.userConsent]:0,fsT:c,fsI:l})}}}(t,r),0,"telemetry config",void 0,0,!0).execute()})),h}}(e);return e.storage.uniqueKeys&&t.push(function(e){var t=e.settings,n=t.log,r=t.core.key,i=e.splitApi,s=i.postUniqueKeysBulkCs,o=i.postUniqueKeysBulkSs,u=e.storage.uniqueKeys,c=J(n,void 0!==r?s:o,u,9e5,nt);return u.setOnFullQueueCb((function(){c.isRunning()&&(n.info(a,[nt]),c.execute())})),c}(e)),{start:function(e){e||t.forEach((function(e){return e.start()})),r&&r.start()},stop:function(e){t.forEach((function(e){return e.stop()})),!e&&r&&r.stop()},isRunning:function(){return t.some((function(e){return e.isRunning()}))},execute:function(e){var n=e?[]:t.map((function(e){return e.execute()}));return r&&n.push(r.execute()),Promise.all(n)},isExecuting:function(){return t.some((function(e){return e.isExecuting()}))}}}var it,st="PUSH_NONRETRYABLE_ERROR",ot="PUSH_RETRYABLE_ERROR",at="PUSH_SUBSYSTEM_UP",ut="PUSH_SUBSYSTEM_DOWN",ct="MY_SEGMENTS_UPDATE",lt="MY_SEGMENTS_UPDATE_V2",ft="SEGMENT_UPDATE",ht="SPLIT_KILL",pt="SPLIT_UPDATE",dt="CONTROL",gt="OCCUPANCY";function mt(e){var t=e.userConsent;return!t||t===N}!function(e){e.STREAMING_DISABLED="STREAMING_DISABLED",e.STREAMING_PAUSED="STREAMING_PAUSED",e.STREAMING_RESUMED="STREAMING_RESUMED",e.STREAMING_RESET="STREAMING_RESET"}(it||(it={}));var vt=function(){function e(t,n,r){this.baseMillis=e.__TEST__BASE_MILLIS||n||e.DEFAULT_BASE_MILLIS,this.maxMillis=e.__TEST__MAX_MILLIS||r||e.DEFAULT_MAX_MILLIS,this.attempts=0,this.cb=t}return e.prototype.scheduleCall=function(){var e=this,t=Math.min(this.baseMillis*Math.pow(2,this.attempts),this.maxMillis);return this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout((function(){e.timeoutID=void 0,e.cb()}),t),this.attempts++,t},e.prototype.reset=function(){this.attempts=0,this.timeoutID&&(clearTimeout(this.timeoutID),this.timeoutID=void 0)},e.DEFAULT_BASE_MILLIS=1e3,e.DEFAULT_MAX_MILLIS=18e5,e}(),yt=[/control_pri$/,/control_sec$/],St=[10,20];function bt(e,t){var n,r,i=0,s=-1,o=!1,a=new vt(u);function u(){if(n=!0,i>s){o=!1;var c=i;e.execute(r,!0).then((function(e){n&&(!1!==e&&(r&&t.trackUpdatesFromSSE("ms"),s=Math.max(s,c)),o?u():a.scheduleCall())}))}else n=!1}return{put:function(e,t){e<=s||e<=i||(i=e,o=!0,r=t,!a.timeoutID&&n||u(),a.reset())},stop:function(){n=!1,a.reset()}}}var Tt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Et(e){var t=String(e).replace(/[=]+$/,"");if(t.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var n="",r=0,i=void 0,s=void 0,o=0;s=t.charAt(o++);~s&&(i=r%4?64*i+s:s,r++%4)?n+=String.fromCharCode(255&i>>(-2*r&6)):0)s=Tt.indexOf(s);return n}var _t=String.fromCharCode;function kt(e){var t,n,r,i,s;return n=function(e){if("string"!=typeof e)throw TypeError("Illegal argument: "+typeof e);var t=0;return function(){return t>=e.length?null:e.charCodeAt(t++)}}(e),i=[],s=[],r=t=function(){if(0===arguments.length)return s.join("")+_t.apply(String,i);i.length+arguments.length>1024&&(s.push(_t.apply(String,i)),i.length=0),Array.prototype.push.apply(i,arguments)},function(e,t){for(var n,r=null;null!==(n=null!==r?r:e());)n>=55296&&n<=57343&&null!==(r=e())&&r>=56320&&r<=57343?(t(1024*(n-55296)+r-56320+65536),r=null):t(n);null!==r&&t(r)}(n,(function(e){!function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<128?t(127&n):n<2048?(t(n>>6&31|192),t(63&n|128)):n<65536?(t(n>>12&15|224),t(n>>6&63|128),t(63&n|128)):(t(n>>18&7|240),t(n>>12&63|128),t(n>>6&63|128),t(63&n|128)),n=null}(e,r)})),t()}function Rt(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function Ct(e,t){return e<<t|e>>>32-t}function wt(e,t){return function(e,t){t=t||0;for(var n,r=(e=e||"").length%4,i=e.length-r,s=t,o=0,a=3432918353,u=461845907,c=0;c<i;c+=4)o=Rt(o=255&e.charCodeAt(c)|(255&e.charCodeAt(c+1))<<8|(255&e.charCodeAt(c+2))<<16|(255&e.charCodeAt(c+3))<<24,a),o=Rt(o=Ct(o,15),u),s=Rt(s=Ct(s^=o,13),5)+3864292196;switch(o=0,r){case 3:o^=(255&e.charCodeAt(c+2))<<16;case 2:o^=(255&e.charCodeAt(c+1))<<8;case 1:o=Rt(o^=255&e.charCodeAt(c),a),s^=o=Rt(o=Ct(o,15),u)}return n=s^=e.length,n=Rt(n^=n>>>16,2246822507),(s=(n=Rt(n^=n>>>13,3266489909))^n>>>16)>>>0}(kt(e),t>>>0)}function At(e,t){return Math.abs(wt(e,t)%100)+1}function Ot(e){return function(e){for(var t=String(e),n="",r=void 0,i=void 0,s=0,o=Tt;t.charAt(0|s)||(o="=",s%1);n+=o.charAt(63&r>>8-s%1*8)){if((i=t.charCodeAt(s+=3/4))>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");r=r<<8|i}return n}(wt(e,0).toString())}var Nt,Ft,Dt=/^control_/,It=function(){function e(e,t,n){if(this.eventSource=n&&n(),!this.eventSource)throw new Error("EventSource API is not available. ");this.streamingUrl=e.urls.streaming+"/sse",this.useHeaders=t,this.headers=function(e){var t={SplitSDKClientKey:he(e.core.authorizationKey)?e.core.authorizationKey.slice(-4):"",SplitSDKVersion:e.version},n=e.runtime,r=n.ip,i=n.hostname;return r&&(t.SplitSDKMachineIP=r),i&&(t.SplitSDKMachineName=i),t}(e)}return e.prototype.setEventHandler=function(e){this.handler=e},e.prototype.open=function(e){this.close();var t=Object.keys(e.channels).map((function(e){var t=Dt.test(e)?"[?occupancy=metrics.publishers]":"";return encodeURIComponent(t+e)})).join(","),n=this.streamingUrl+"?channels="+t+"&accessToken="+e.token+"&v=1.1&heartbeats=true";this.connection=new this.eventSource(this.useHeaders?n:n+"&SplitSDKVersion="+this.headers.SplitSDKVersion+"&SplitSDKClientKey="+this.headers.SplitSDKClientKey,this.useHeaders?{headers:this.headers}:void 0),this.handler&&(this.connection.addEventListener("open",this.handler.handleOpen),this.connection.addEventListener("message",this.handler.handleMessage),this.connection.addEventListener("error",this.handler.handleError))},e.prototype.close=function(){this.connection&&this.connection.close()},e}();function Lt(e){return fe(e)?e.matchingKey:e}function Kt(e){return fe(e)?{matchingKey:e.matchingKey,bucketingKey:e.bucketingKey}:{matchingKey:e,bucketingKey:e}}!function(e){e[e.None=0]="None",e[e.Gzip=1]="Gzip",e[e.Zlib=2]="Zlib"}(Nt||(Nt={})),function(e){e[e.UnboundedFetchRequest=0]="UnboundedFetchRequest",e[e.BoundedFetchRequest=1]="BoundedFetchRequest",e[e.KeyList=2]="KeyList",e[e.SegmentRemoval=3]="SegmentRemoval"}(Ft||(Ft={}));var Mt=function(){if([typeof Uint8Array,typeof Uint16Array,typeof Uint32Array].some((function(e){return"function"!=e})))return"global Uint8Array object is not available for gzip/zlib decompression";var e=Uint8Array,t=Uint16Array,n=Uint32Array,r=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),s=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o=function(e,r){for(var i=new t(31),s=0;s<31;++s)i[s]=r+=1<<e[s-1];var o=new n(i[30]);for(s=1;s<30;++s)for(var a=i[s];a<i[s+1];++a)o[a]=a-i[s]<<5|s;return[i,o]},a=o(r,2),u=a[0],c=a[1];u[28]=258,c[258]=28;for(var l=o(i,0)[0],f=new t(32768),h=0;h<32768;++h){var p=(43690&h)>>>1|(21845&h)<<1;p=(61680&(p=(52428&p)>>>2|(13107&p)<<2))>>>4|(3855&p)<<4,f[h]=((65280&p)>>>8|(255&p)<<8)>>>1}var d=function(e,n,r){for(var i=e.length,s=0,o=new t(n);s<i;++s)++o[e[s]-1];var a,u=new t(n);for(s=0;s<n;++s)u[s]=u[s-1]+o[s-1]<<1;if(r){a=new t(1<<n);var c=15-n;for(s=0;s<i;++s)if(e[s])for(var l=s<<4|e[s],h=n-e[s],p=u[e[s]-1]++<<h,d=p|(1<<h)-1;p<=d;++p)a[f[p]>>>c]=l}else for(a=new t(i),s=0;s<i;++s)e[s]&&(a[s]=f[u[e[s]-1]++]>>>15-e[s]);return a},g=new e(288);for(h=0;h<144;++h)g[h]=8;for(h=144;h<256;++h)g[h]=9;for(h=256;h<280;++h)g[h]=7;for(h=280;h<288;++h)g[h]=8;var m=new e(32);for(h=0;h<32;++h)m[h]=5;var v=d(g,9,1),y=d(m,5,1),S=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},b=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},T=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},E=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],_=function(e,t,n){var r=new Error(t||E[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,_),!n)throw r;return r},k=function(o,a,c){var f=o.length;if(!f||c&&c.f&&!c.l)return a||new e(0);var h=!a||c,p=!c||c.i;c||(c={}),a||(a=new e(3*f));var g=function(t){var n=a.length;if(t>n){var r=new e(Math.max(2*n,t));r.set(a),a=r}},m=c.f||0,E=c.p||0,k=c.b||0,R=c.l,C=c.d,w=c.m,A=c.n,O=8*f;do{if(!R){m=b(o,E,1);var N=b(o,E+1,3);if(E+=3,!N){var F=o[(q=4+((E+7)/8|0))-4]|o[q-3]<<8,D=q+F;if(D>f){p&&_(0);break}h&&g(k+F),a.set(o.subarray(q,D),k),c.b=k+=F,c.p=E=8*D,c.f=m;continue}if(1==N)R=v,C=y,w=9,A=5;else if(2==N){var I=b(o,E,31)+257,L=b(o,E+10,15)+4,K=I+b(o,E+5,31)+1;E+=14;for(var M=new e(K),x=new e(19),U=0;U<L;++U)x[s[U]]=b(o,E+3*U,7);E+=3*L;var P=S(x),j=(1<<P)-1,B=d(x,P,1);for(U=0;U<K;){var q,W=B[b(o,E,j)];if(E+=15&W,(q=W>>>4)<16)M[U++]=q;else{var z=0,H=0;for(16==q?(H=3+b(o,E,3),E+=2,z=M[U-1]):17==q?(H=3+b(o,E,7),E+=3):18==q&&(H=11+b(o,E,127),E+=7);H--;)M[U++]=z}}var G=M.subarray(0,I),Q=M.subarray(I);w=S(G),A=S(Q),R=d(G,w,1),C=d(Q,A,1)}else _(1);if(E>O){p&&_(0);break}}h&&g(k+131072);for(var Y=(1<<w)-1,V=(1<<A)-1,J=E;;J=E){var Z=(z=R[T(o,E)&Y])>>>4;if((E+=15&z)>O){p&&_(0);break}if(z||_(2),Z<256)a[k++]=Z;else{if(256==Z){J=E,R=null;break}var $=Z-254;if(Z>264){var X=r[U=Z-257];$=b(o,E,(1<<X)-1)+u[U],E+=X}var ee=C[T(o,E)&V],te=ee>>>4;if(ee||_(3),E+=15&ee,Q=l[te],te>3&&(X=i[te],Q+=T(o,E)&(1<<X)-1,E+=X),E>O){p&&_(0);break}h&&g(k+131072);for(var ne=k+$;k<ne;k+=4)a[k]=a[k-Q],a[k+1]=a[k+1-Q],a[k+2]=a[k+2-Q],a[k+3]=a[k+3-Q];k=ne}}c.l=R,c.p=J,c.b=k,c.f=m,R&&(m=1,c.m=w,c.d=C,c.n=A)}while(!m);return k==a.length?a:function(r,i,s){(null==i||i<0)&&(i=0),(null==s||s>r.length)&&(s=r.length);var o=new(r instanceof t?t:r instanceof n?n:e)(s-i);return o.set(r.subarray(i,s)),o}(a,0,k)};return{gunzipSync:function(t,n){return k(t.subarray(function(e){31==e[0]&&139==e[1]&&8==e[2]||_(6,"invalid gzip data");var t=e[3],n=10;4&t&&(n+=e[10]|2+(e[11]<<8));for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[n++]);return n+(2&t)}(t),-8),n||new e((i=(r=t).length,(r[i-4]|r[i-3]<<8|r[i-2]<<16|r[i-1]<<24)>>>0)));var r,i},unzlibSync:function(e,t){return k(((8!=(15&(n=e)[0])||n[0]>>>4>7||(n[0]<<8|n[1])%31)&&_(6,"invalid zlib data"),32&n[1]&&_(6,"invalid zlib data: preset dictionaries not supported"),e.subarray(2,-4)),t);var n}}}();function xt(e,t){var n,r=(n=Et(e).split("").map((function(e){return e.charCodeAt(0)})),new Uint8Array(n));if("string"==typeof Mt)throw new Error(Mt);if(1===t)return Mt.gunzipSync(r);if(2===t)return Mt.unzlibSync(r);throw new Error("Invalid compression algorithm #"+t)}function Ut(e,t,n){void 0===n&&(n=!0);var r,i=(r=xt(e,t),String.fromCharCode.apply(null,r));return n&&(i=i.replace(/\d+/g,'"$&"')),JSON.parse(i)}var Pt=function(){function e(e){var t=this;this.__setData__=[],Array.isArray(e)&&e.forEach((function(e){t.add(e)}))}return e.prototype.clear=function(){this.__setData__.length&&(this.__setData__.length=0)},e.prototype.add=function(e){return this.has(e)||this.__setData__.push(e),this},e.prototype.delete=function(e){var t=this.__setData__.indexOf(e);return-1!==t&&(this.__setData__.splice(t,1),!0)},e.prototype.has=function(e){return-1!==this.__setData__.indexOf(e)},e.prototype.forEach=function(e,t){if("function"!=typeof e)throw new TypeError(e+" is not a function");for(var n=0;n<this.__setData__.length;n++){var r=this.__setData__[n];e.call(t,r,r,this)}},Object.defineProperty(e.prototype,"size",{get:function(){return this.__setData__.length},enumerable:!1,configurable:!0}),e}();function jt(e){return e instanceof Pt?e.__setData__.slice():Array.from(e)}var Bt="function"==typeof Array.from&&"function"==typeof Set&&Set.prototype&&Set.prototype.values?Set:Pt;function qt(e,t){var n=new Bt(jt(e));return t.forEach((function(e){n.add(e)})),n}function Wt(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]+t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]+t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]+t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]+t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function zt(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]*t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]*t[3],n[1]+=n[2]>>>16,n[2]&=65535,n[2]+=e[3]*t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]*t[3],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[2]*t[2],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[3]*t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function Ht(e,t){return 32==(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])}function Gt(e,t){return 0==(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function Qt(e,t){return[e[0]^t[0],e[1]^t[1]]}function Yt(e){return e=Qt(e,[0,e[0]>>>1]),e=Qt(e=zt(e,[4283543511,3981806797]),[0,e[0]>>>1]),Qt(e=zt(e,[3301882366,444984403]),[0,e[0]>>>1])}function Vt(e,t){return function(e,t){t=t||0;for(var n=(e=e||"").length%16,r=e.length-n,i=[0,t],s=[0,t],o=[0,0],a=[0,0],u=[2277735313,289559509],c=[1291169091,658871167],l=0;l<r;l+=16)o=[255&e.charCodeAt(l+4)|(255&e.charCodeAt(l+5))<<8|(255&e.charCodeAt(l+6))<<16|(255&e.charCodeAt(l+7))<<24,255&e.charCodeAt(l)|(255&e.charCodeAt(l+1))<<8|(255&e.charCodeAt(l+2))<<16|(255&e.charCodeAt(l+3))<<24],a=[255&e.charCodeAt(l+12)|(255&e.charCodeAt(l+13))<<8|(255&e.charCodeAt(l+14))<<16|(255&e.charCodeAt(l+15))<<24,255&e.charCodeAt(l+8)|(255&e.charCodeAt(l+9))<<8|(255&e.charCodeAt(l+10))<<16|(255&e.charCodeAt(l+11))<<24],o=Ht(o=zt(o,u),31),i=Wt(i=Ht(i=Qt(i,o=zt(o,c)),27),s),i=Wt(zt(i,[0,5]),[0,1390208809]),a=Ht(a=zt(a,c),33),s=Wt(s=Ht(s=Qt(s,a=zt(a,u)),31),i),s=Wt(zt(s,[0,5]),[0,944331445]);switch(o=[0,0],a=[0,0],n){case 15:a=Qt(a,Gt([0,e.charCodeAt(l+14)],48));case 14:a=Qt(a,Gt([0,e.charCodeAt(l+13)],40));case 13:a=Qt(a,Gt([0,e.charCodeAt(l+12)],32));case 12:a=Qt(a,Gt([0,e.charCodeAt(l+11)],24));case 11:a=Qt(a,Gt([0,e.charCodeAt(l+10)],16));case 10:a=Qt(a,Gt([0,e.charCodeAt(l+9)],8));case 9:a=zt(a=Qt(a,[0,e.charCodeAt(l+8)]),c),s=Qt(s,a=zt(a=Ht(a,33),u));case 8:o=Qt(o,Gt([0,e.charCodeAt(l+7)],56));case 7:o=Qt(o,Gt([0,e.charCodeAt(l+6)],48));case 6:o=Qt(o,Gt([0,e.charCodeAt(l+5)],40));case 5:o=Qt(o,Gt([0,e.charCodeAt(l+4)],32));case 4:o=Qt(o,Gt([0,e.charCodeAt(l+3)],24));case 3:o=Qt(o,Gt([0,e.charCodeAt(l+2)],16));case 2:o=Qt(o,Gt([0,e.charCodeAt(l+1)],8));case 1:o=zt(o=Qt(o,[0,e.charCodeAt(l)]),u),i=Qt(i,o=zt(o=Ht(o,31),c))}return i=Wt(i=Qt(i,[0,e.length]),s=Qt(s,[0,e.length])),s=Wt(s,i),i=Wt(i=Yt(i),s=Yt(s)),s=Wt(s,i),("00000000"+(i[0]>>>0).toString(16)).slice(-8)+("00000000"+(i[1]>>>0).toString(16)).slice(-8)+("00000000"+(s[0]>>>0).toString(16)).slice(-8)+("00000000"+(s[1]>>>0).toString(16)).slice(-8)}(kt(e),t>>>0)}function Jt(e){var t,n,r,i=[0];for(t=0;t<e.length;t+=1){for(r=parseInt(e.charAt(t),16),n=i.length-1;n>=0;n-=1)i[n]=16*i[n]+r,r=i[n]/10|0,i[n]%=10;for(;r>0;)i.unshift(r%10),r=r/10|0}return i.join("")}function Zt(e,t){return e<1?t:new Promise((function(n,r){var i=setTimeout((function(){r(new Error("Operation timed out because it exceeded the configured time limit of "+e+" ms."))}),e);t.then((function(e){clearTimeout(i),n(e)}),(function(e){clearTimeout(i),r(e)}))}))}function $t(e,t,n,r,i,s,o,a){var u=!0,c=!0;function l(e){return c&&(e=Zt(s,e)),e}function f(e){var t;if(Array.isArray(e))t=r.resetSegments(e);else{var s=e.name,o=e.add;r.isInSegment(s)!==o?(t=!0,o?r.addToSegment(s):r.removeFromSegment(s)):t=!1}n.usesSegments()&&(t||u)&&(u=!1,i.emit(Re))}function h(n,r,i){return(r?new Promise((function(e){f(r),e(!0)})):t(a,i,l).then((function(e){return c=!1,f(e),!0}))).catch((function(t){return c&&o>n?(n+=1,e.warn(204,[n,t]),h(n)):(c=!1,!1)}))}return function(e,t){return h(0,e,t)}}function Xt(e,t,n,r,i,s,o,a,u){void 0===o&&(o=0),void 0===a&&(a=0);var c=!0;function l(e){return c&&o&&(e=Zt(o,e)),e}return function(o,f,h){return Promise.resolve(n.getChangeNumber()).then((function p(d,g){void 0===g&&(g=0),e.debug(31,[d]);var m=Promise.resolve(h?{splits:[h.payload],till:h.changeNumber}:t(d,o,f,l)).then((function(t){c=!1;var o=function(e,t){var n=new Bt,r=e.reduce((function(e,r){return"ACTIVE"===r.status&&function(e,t){var n=t.groupedFilters,r=n.bySet,i=n.byName,s=n.byPrefix;if(r.length>0)return e.sets&&e.sets.some((function(e){return r.indexOf(e)>-1}));var o=i.length>0,a=s.length>0;if(!o&&!a)return!0;var u=o&&i.indexOf(e.name)>-1,c=a&&s.some((function(t){return ge(e.name,t)}));return u||c}(r,t)?(e.added.push([r.name,r]),function(e){for(var t=e.conditions,n=new Bt,r=0;r<t.length;r++)t[r].matcherGroup.matchers.forEach((function(e){"IN_SEGMENT"===e.matcherType&&n.add(e.userDefinedSegmentMatcherData.segmentName)}));return n}(r).forEach((function(e){n.add(e)}))):e.removed.push(r.name),e}),{added:[],removed:[],segments:[]});return r.segments=jt(n),r}(t.splits,i);return e.debug(32,[o.added.length]),e.debug(33,[o.removed.length]),e.debug(34,[o.segments.length]),Promise.all([n.setChangeNumber(t.till),n.addSplits(o.added),n.removeSplits(o.removed),r.registerSegments(o.segments)]).then((function(e){return!s||Promise.resolve(!s.splitsArrived||d!==t.till&&function(e){var t=e[1],n=e[2];return!(!t||!t.some((function(e){return e})))||!(!n||!n.some((function(e){return e})))}(e)&&(u||function(e){return Promise.resolve(e.getRegisteredSegments()).then((function(t){return Promise.all(t.map((function(t){return e.getChangeNumber(t)}))).then((function(e){return e.every((function(e){return-1!==e}))}))}))}(r))).catch((function(){return!1})).then((function(e){return e&&s.emit(_e),!0}))}))})).catch((function(t){return e.warn(205,[t]),c&&a>g?(g+=1,e.info(109,[g,t]),p(d,g)):(c=!1,!1)}));return s&&c&&Promise.resolve(n.checkCache()).then((function(e){e&&s.emit(ke)})),m}))}}var en=function(){function e(e){void 0===e&&(e=0),this.maxQueue=e,this.queue=[]}return e.prototype.setOnFullQueueCb=function(e){this.onFullQueue=e},e.prototype.track=function(e){var t;(t=this.queue).push.apply(t,e),this.maxQueue>0&&this.queue.length>=this.maxQueue&&this.onFullQueue&&this.onFullQueue()},e.prototype.clear=function(){this.queue=[]},e.prototype.pop=function(e){var t=this.queue;return this.clear(),e?e.concat(t):t},e.prototype.isEmpty=function(){return 0===this.queue.length},e}();function tn(e){return e-e%36e5}var nn=function(){function e(e){void 0===e&&(e=3e4),this.cache={},this.cacheSize=0,this.maxStorage=e}return e.prototype._makeKey=function(e,t){return e+"::"+tn(t)},e.prototype.track=function(e,t,n){var r=this._makeKey(e,t),i=this.cache[r];this.cache[r]=i?i+n:n,this.onFullQueue&&(this.cacheSize=this.cacheSize+n,this.cacheSize>=this.maxStorage&&this.onFullQueue())},e.prototype.pop=function(e){var t=this.cache;return this.clear(),e?(Object.keys(t).forEach((function(n){e[n]?e[n]+=t[n]:e[n]=t[n]})),e):t},e.prototype.clear=function(){this.cache={},this.cacheSize=0},e.prototype.isEmpty=function(){return 0===Object.keys(this.cache).length},e}(),rn=function(){function e(e){void 0===e&&(e=0),this.maxQueue=e,this.queue=[],this.queueByteSize=0}return e.prototype.setOnFullQueueCb=function(e){this.onFullQueue=e},e.prototype.track=function(e,t){return void 0===t&&(t=0),this.queueByteSize+=t,this.queue.push(e),this._checkForFlush(),!0},e.prototype.clear=function(){this.queue=[],this.queueByteSize=0},e.prototype.pop=function(e){var t=this.queue;return this.clear(),e?e.concat(t):t},e.prototype.isEmpty=function(){return 0===this.queue.length},e.prototype._checkForFlush=function(){(this.queueByteSize>5242880||this.maxQueue>0&&this.queue.length>=this.maxQueue)&&this.onFullQueue&&this.onFullQueue()},e}(),sn=/[^.]+$/,on=function(e){function t(t,n){var r=e.call(this,t)||this;return r.matchingKey=n,r.regexSplitsCacheKey=new RegExp("^"+t+"\\.(splits?|trafficType|flagSet)\\."),r}return te(t,e),t.prototype.buildSegmentNameKey=function(e){return this.prefix+"."+this.matchingKey+".segment."+e},t.prototype.extractSegmentName=function(e){var t=this.prefix+"."+this.matchingKey+".segment.";if(ge(e,t))return e.substr(t.length)},t.prototype.buildOldSegmentNameKey=function(e){return this.matchingKey+"."+this.prefix+".segment."+e},t.prototype.extractOldSegmentKey=function(e){var t=this.matchingKey+"."+this.prefix+".segment.";if(ge(e,t))return e.substr(t.length)},t.prototype.buildLastUpdatedKey=function(){return this.prefix+".splits.lastUpdated"},t.prototype.isSplitsCacheKey=function(e){return this.regexSplitsCacheKey.test(e)},t}(function(){function e(e){void 0===e&&(e="SPLITIO"),this.prefix=e}return e.prototype.buildTrafficTypeKey=function(e){return this.prefix+".trafficType."+e},e.prototype.buildFlagSetKey=function(e){return this.prefix+".flagSet."+e},e.prototype.buildSplitKey=function(e){return this.prefix+".split."+e},e.prototype.buildSplitsTillKey=function(){return this.prefix+".splits.till"},e.prototype.isSplitKey=function(e){return ge(e,this.prefix+".split.")},e.prototype.buildSplitKeyPrefix=function(){return this.prefix+".split."},e.prototype.buildSplitsWithSegmentCountKey=function(){return this.prefix+".splits.usingSegments"},e.prototype.buildSegmentNameKey=function(e){return this.prefix+".segment."+e},e.prototype.buildSegmentTillKey=function(e){return this.prefix+".segment."+e+".till"},e.prototype.extractKey=function(e){var t=e.match(sn);if(t&&t.length)return t[0];throw new Error("Invalid latency key provided")},e.prototype.buildHashKey=function(){return this.prefix+".hash"},e}());function an(){var e="__SPLITSOFTWARE__";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}var un=function(){function e(){}return e.prototype.addSplits=function(e){var t=this;return e.map((function(e){return t.addSplit(e[0],e[1])}))},e.prototype.removeSplits=function(e){var t=this;return e.map((function(e){return t.removeSplit(e)}))},e.prototype.getSplits=function(e){var t=this,n={};return e.forEach((function(e){n[e]=t.getSplit(e)})),n},e.prototype.getAll=function(){var e=this;return this.getSplitNames().map((function(t){return e.getSplit(t)}))},e.prototype.checkCache=function(){return!1},e.prototype.killLocally=function(e,t,n){var r=this.getSplit(e);if(r&&(!r.changeNumber||r.changeNumber<n)){var i=o({},r);return i.killed=!0,i.defaultTreatment=t,i.changeNumber=n,this.addSplit(e,i)}return!1},e}();function cn(e){for(var t=e.conditions||[],n=0;n<t.length;n++)for(var r=t[n].matcherGroup.matchers,i=0;i<r.length;i++)if("IN_SEGMENT"===r[i].matcherType)return!0;return!1}var ln="storage:localstorage: ",fn=function(e){function t(t,n,r){var i=e.call(this)||this;return i.keys=n,i.log=t.log,i.storageHash=function(e){return wt(e.core.authorizationKey+"::"+e.sync.__splitFiltersValidation.queryString).toString(16)}(t),i.flagSetsFilter=t.sync.__splitFiltersValidation.groupedFilters.bySet,i._checkExpiration(r),i._checkFilterQuery(),i}return te(t,e),t.prototype._decrementCount=function(e){var t=me(localStorage.getItem(e))-1;t>0?localStorage.setItem(e,t):localStorage.removeItem(e)},t.prototype._decrementCounts=function(e){try{if(e){var t=this.keys.buildTrafficTypeKey(e.trafficTypeName);if(this._decrementCount(t),cn(e)){var n=this.keys.buildSplitsWithSegmentCountKey();this._decrementCount(n)}}}catch(e){this.log.error(ln+e)}},t.prototype._incrementCounts=function(e){try{if(e){var t=this.keys.buildTrafficTypeKey(e.trafficTypeName);if(localStorage.setItem(t,me(localStorage.getItem(t))+1),cn(e)){var n=this.keys.buildSplitsWithSegmentCountKey();localStorage.setItem(n,me(localStorage.getItem(n))+1)}}}catch(e){this.log.error(ln+e)}},t.prototype.clear=function(){this.log.info(ln+"Flushing Splits data from localStorage");for(var e=localStorage.length,t=[],n=0;n<e;n++){var r=localStorage.key(n);null!=r&&this.keys.isSplitsCacheKey(r)&&t.push(r)}t.forEach((function(e){localStorage.removeItem(e)})),this.hasSync=!1},t.prototype.addSplit=function(e,t){try{var n=this.keys.buildSplitKey(e),r=localStorage.getItem(n),i=r?JSON.parse(r):null;return localStorage.setItem(n,JSON.stringify(t)),this._incrementCounts(t),this._decrementCounts(i),i&&this.removeFromFlagSets(i.name,i.sets),this.addToFlagSets(t),!0}catch(e){return this.log.error(ln+e),!1}},t.prototype.removeSplit=function(e){try{var t=this.getSplit(e);return localStorage.removeItem(this.keys.buildSplitKey(e)),this._decrementCounts(t),t&&this.removeFromFlagSets(t.name,t.sets),!0}catch(e){return this.log.error(ln+e),!1}},t.prototype.getSplit=function(e){var t=localStorage.getItem(this.keys.buildSplitKey(e));return t&&JSON.parse(t)},t.prototype.setChangeNumber=function(e){if(this.updateNewFilter){this.log.info(ln+"SDK key or feature flag filter criteria was modified. Updating cache");var t=this.keys.buildHashKey();try{localStorage.setItem(t,this.storageHash)}catch(e){this.log.error(ln+e)}this.updateNewFilter=!1}try{return localStorage.setItem(this.keys.buildSplitsTillKey(),e+""),localStorage.setItem(this.keys.buildLastUpdatedKey(),Date.now()+""),this.hasSync=!0,!0}catch(e){return this.log.error(ln+e),!1}},t.prototype.getChangeNumber=function(){var e=localStorage.getItem(this.keys.buildSplitsTillKey());return null!==e?le(e=parseInt(e,10))?-1:e:-1},t.prototype.getSplitNames=function(){for(var e=localStorage.length,t=[],n=0;n<e;){var r=localStorage.key(n);null!=r&&this.keys.isSplitKey(r)&&t.push(this.keys.extractKey(r)),n++}return t},t.prototype.trafficTypeExists=function(e){var t=me(localStorage.getItem(this.keys.buildTrafficTypeKey(e)));return ce(t)&&t>0},t.prototype.usesSegments=function(){if(!this.hasSync)return!0;var e=localStorage.getItem(this.keys.buildSplitsWithSegmentCountKey()),t=null===e?0:me(e);return!ce(t)||t>0},t.prototype.checkCache=function(){return this.getChangeNumber()>-1},t.prototype._checkExpiration=function(e){var t=localStorage.getItem(this.keys.buildLastUpdatedKey());null!==t&&!le(t=parseInt(t,10))&&e&&t<e&&this.clear()},t.prototype._checkFilterQuery=function(){var e=this.keys.buildHashKey();if(localStorage.getItem(e)!==this.storageHash)try{this.updateNewFilter=!0,this.checkCache()&&this.clear()}catch(e){this.log.error(ln+e)}},t.prototype.getNamesByFlagSets=function(e){var t=this;return e.map((function(e){var n=t.keys.buildFlagSetKey(e),r=localStorage.getItem(n);return new Bt(r?JSON.parse(r):[])}))},t.prototype.addToFlagSets=function(e){var t=this;e.sets&&e.sets.forEach((function(n){if(!(t.flagSetsFilter.length>0)||t.flagSetsFilter.some((function(e){return e===n}))){var r=t.keys.buildFlagSetKey(n),i=localStorage.getItem(r),s=new Bt(i?JSON.parse(i):[]);s.add(e.name),localStorage.setItem(r,JSON.stringify(jt(s)))}}))},t.prototype.removeFromFlagSets=function(e,t){var n=this;t&&t.forEach((function(t){n.removeNames(t,e)}))},t.prototype.removeNames=function(e,t){var n=this.keys.buildFlagSetKey(e),r=localStorage.getItem(n);if(r){var i=new Bt(JSON.parse(r));i.delete(t),0!==i.size?localStorage.setItem(n,JSON.stringify(jt(i))):localStorage.removeItem(n)}},t}(un),hn=function(){function e(){}return e.prototype.registerSegments=function(e){return!1},e.prototype.setChangeNumber=function(e,t){return!0},e.prototype.getChangeNumber=function(e){return-1},e.prototype.resetSegments=function(e){return!0},e}(),pn=function(e){function t(t,n){var r=e.call(this)||this;return r.log=t,r.keys=n,r}return te(t,e),t.prototype.clear=function(){this.log.info(ln+"Flushing MySegments data from localStorage"),this.resetSegments([])},t.prototype.addToSegment=function(e){var t=this.keys.buildSegmentNameKey(e);try{return localStorage.setItem(t,"1"),!0}catch(e){return this.log.error(ln+e),!1}},t.prototype.removeFromSegment=function(e){var t=this.keys.buildSegmentNameKey(e);try{return localStorage.removeItem(t),!0}catch(e){return this.log.error(ln+e),!1}},t.prototype.isInSegment=function(e){return"1"===localStorage.getItem(this.keys.buildSegmentNameKey(e))},t.prototype.resetSegments=function(e){var t,n=this,r=!1,i=Object.keys(localStorage).reduce((function(t,r){var i=n.keys.extractSegmentName(r);if(i)t.push(i);else if(i=n.keys.extractOldSegmentKey(r)){var s=n.keys.buildSegmentNameKey(i);try{!localStorage.getItem(s)&&e.indexOf(i)>-1&&(localStorage.setItem(s,"1"),t.push(i)),localStorage.removeItem(r)}catch(e){n.log.error(e)}}return t}),[]);if(0===e.length&&i.length===e.length)return r;if(i.length!==e.length)r=!0,i.forEach((function(e){return n.removeFromSegment(e)})),e.forEach((function(e){return n.addToSegment(e)}));else{for(t=0;t<e.length&&-1!==i.indexOf(e[t]);t++);t<e.length&&(r=!0,i.forEach((function(e){return n.removeFromSegment(e)})),e.forEach((function(e){return n.addToSegment(e)})))}return r},t.prototype.getRegisteredSegments=function(){var e=this;return Object.keys(localStorage).reduce((function(t,n){var r=e.keys.extractSegmentName(n);return r&&t.push(r),t}),[])},t.prototype.getKeysCount=function(){return 1},t}(hn),dn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.segmentCache={},t}return te(t,e),t.prototype.clear=function(){this.segmentCache={}},t.prototype.addToSegment=function(e){return this.segmentCache[e]=!0,!0},t.prototype.removeFromSegment=function(e){return delete this.segmentCache[e],!0},t.prototype.isInSegment=function(e){return!0===this.segmentCache[e]},t.prototype.resetSegments=function(e){var t,n=this,r=!1,i=Object.keys(this.segmentCache);if(0===e.length&&i.length===e.length)return r;if(i.length!==e.length)r=!0,this.segmentCache={},e.forEach((function(e){n.addToSegment(e)}));else{for(t=0;t<e.length&&this.isInSegment(e[t]);t++);t<e.length&&(r=!0,this.segmentCache={},e.forEach((function(e){n.addToSegment(e)})))}return r},t.prototype.getRegisteredSegments=function(){return Object.keys(this.segmentCache)},t.prototype.getKeysCount=function(){return 1},t}(hn),gn=function(e){function t(t){var n=e.call(this)||this;return n.splitsCache={},n.ttCache={},n.changeNumber=-1,n.splitsWithSegmentsCount=0,n.flagSetsCache={},n.flagSetsFilter=t?t.groupedFilters.bySet:[],n}return te(t,e),t.prototype.clear=function(){this.splitsCache={},this.ttCache={},this.changeNumber=-1,this.splitsWithSegmentsCount=0},t.prototype.addSplit=function(e,t){var n=this.getSplit(e);if(n){var r=n.trafficTypeName;this.ttCache[r]--,this.ttCache[r]||delete this.ttCache[r],this.removeFromFlagSets(n.name,n.sets),cn(n)&&this.splitsWithSegmentsCount--}if(t){this.splitsCache[e]=t;var i=t.trafficTypeName;return this.ttCache[i]=(this.ttCache[i]||0)+1,this.addToFlagSets(t),cn(t)&&this.splitsWithSegmentsCount++,!0}return!1},t.prototype.removeSplit=function(e){var t=this.getSplit(e);if(t){delete this.splitsCache[e];var n=t.trafficTypeName;return this.ttCache[n]--,this.ttCache[n]||delete this.ttCache[n],this.removeFromFlagSets(t.name,t.sets),cn(t)&&this.splitsWithSegmentsCount--,!0}return!1},t.prototype.getSplit=function(e){return this.splitsCache[e]||null},t.prototype.setChangeNumber=function(e){return this.changeNumber=e,!0},t.prototype.getChangeNumber=function(){return this.changeNumber},t.prototype.getSplitNames=function(){return Object.keys(this.splitsCache)},t.prototype.trafficTypeExists=function(e){return ce(this.ttCache[e])&&this.ttCache[e]>0},t.prototype.usesSegments=function(){return-1===this.getChangeNumber()||this.splitsWithSegmentsCount>0},t.prototype.getNamesByFlagSets=function(e){var t=this;return e.map((function(e){return t.flagSetsCache[e]||new Bt}))},t.prototype.addToFlagSets=function(e){var t=this;e.sets&&e.sets.forEach((function(n){t.flagSetsFilter.length>0&&!t.flagSetsFilter.some((function(e){return e===n}))||(t.flagSetsCache[n]||(t.flagSetsCache[n]=new Bt([])),t.flagSetsCache[n].add(e.name))}))},t.prototype.removeFromFlagSets=function(e,t){var n=this;t&&t.forEach((function(t){n.removeNames(t,e)}))},t.prototype.removeNames=function(e,t){this.flagSetsCache[e]&&(this.flagSetsCache[e].delete(t),0===this.flagSetsCache[e].size&&delete this.flagSetsCache[e])},t}(un),mn="GOOGLE_ANALYTICS_TO_SPLIT",vn="SPLIT_TO_GOOGLE_ANALYTICS";function yn(e){var t=Math.min(22,Math.max(0,Math.ceil(Math.log(e)/Math.log(1.5))));return le(t)?0:t}function Sn(e){var t=e.settings;return t.mode!==_&&(void 0===t.core.key||Math.random()<=.001)}var bn=function(){function e(e,t){this.splits=e,this.segments=t,this.e=!0,this.notReadyUsage=0,this.impressionStats=[0,0,0],this.eventStats=[0,0],this.lastSync={},this.httpErrors={},this.httpLatencies={},this.authRejections=0,this.tokenRefreshes=0,this.streamingEvents=[],this.tags=[],this.exceptions={},this.latencies={},this.updatesFromSSE={sp:0,ms:0}}return e.prototype.isEmpty=function(){return this.e},e.prototype.clear=function(){},e.prototype.pop=function(){return this.e=!0,{lS:this.getLastSynchronization(),mL:this.popLatencies(),mE:this.popExceptions(),hE:this.popHttpErrors(),hL:this.popHttpLatencies(),tR:this.popTokenRefreshes(),aR:this.popAuthRejections(),iQ:this.getImpressionStats(0),iDe:this.getImpressionStats(2),iDr:this.getImpressionStats(1),spC:this.splits&&this.splits.getSplitNames().length,seC:this.segments&&this.segments.getRegisteredSegments().length,skC:this.segments&&this.segments.getKeysCount(),sL:this.getSessionLength(),eQ:this.getEventStats(0),eD:this.getEventStats(1),sE:this.popStreamingEvents(),t:this.popTags(),ufs:this.popUpdatesFromSSE()}},e.prototype.getTimeUntilReady=function(){return this.timeUntilReady},e.prototype.recordTimeUntilReady=function(e){this.timeUntilReady=e},e.prototype.getTimeUntilReadyFromCache=function(){return this.timeUntilReadyFromCache},e.prototype.recordTimeUntilReadyFromCache=function(e){this.timeUntilReadyFromCache=e},e.prototype.getNonReadyUsage=function(){return this.notReadyUsage},e.prototype.recordNonReadyUsage=function(){this.notReadyUsage++},e.prototype.getImpressionStats=function(e){return this.impressionStats[e]},e.prototype.recordImpressionStats=function(e,t){this.impressionStats[e]+=t,this.e=!1},e.prototype.getEventStats=function(e){return this.eventStats[e]},e.prototype.recordEventStats=function(e,t){this.eventStats[e]+=t,this.e=!1},e.prototype.getLastSynchronization=function(){return this.lastSync},e.prototype.recordSuccessfulSync=function(e,t){this.lastSync[e]=t,this.e=!1},e.prototype.popHttpErrors=function(){var e=this.httpErrors;return this.httpErrors={},e},e.prototype.recordHttpError=function(e,t){var n=this.httpErrors[e]=this.httpErrors[e]||{};n[t]=(n[t]||0)+1,this.e=!1},e.prototype.popHttpLatencies=function(){var e=this.httpLatencies;return this.httpLatencies={},e},e.prototype.recordHttpLatency=function(e,t){(this.httpLatencies[e]=this.httpLatencies[e]||[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])[yn(t)]++,this.e=!1},e.prototype.popAuthRejections=function(){var e=this.authRejections;return this.authRejections=0,e},e.prototype.recordAuthRejections=function(){this.authRejections++,this.e=!1},e.prototype.popTokenRefreshes=function(){var e=this.tokenRefreshes;return this.tokenRefreshes=0,e},e.prototype.recordTokenRefreshes=function(){this.tokenRefreshes++,this.e=!1},e.prototype.popStreamingEvents=function(){return this.streamingEvents.splice(0)},e.prototype.recordStreamingEvents=function(e){this.streamingEvents.length<20&&this.streamingEvents.push(e),this.e=!1},e.prototype.popTags=function(){return this.tags.splice(0)},e.prototype.addTag=function(e){this.tags.length<10&&this.tags.push(e),this.e=!1},e.prototype.getSessionLength=function(){return this.sessionLength},e.prototype.recordSessionLength=function(e){this.sessionLength=e,this.e=!1},e.prototype.popExceptions=function(){var e=this.exceptions;return this.exceptions={},e},e.prototype.recordException=function(e){this.exceptions[e]=(this.exceptions[e]||0)+1,this.e=!1},e.prototype.popLatencies=function(){var e=this.latencies;return this.latencies={},e},e.prototype.recordLatency=function(e,t){(this.latencies[e]=this.latencies[e]||[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])[yn(t)]++,this.e=!1},e.prototype.popUpdatesFromSSE=function(){var e=this.updatesFromSSE;return this.updatesFromSSE={sp:0,ms:0},e},e.prototype.recordUpdatesFromSSE=function(e){this.updatesFromSSE[e]++,this.e=!1},e}(),Tn=function(){function e(e){void 0===e&&(e=3e4),this.uniqueTrackerSize=0,this.uniqueKeysTracker={},this.maxStorage=e}return e.prototype.setOnFullQueueCb=function(e){this.onFullQueue=e},e.prototype.track=function(e,t){this.uniqueKeysTracker[e]||(this.uniqueKeysTracker[e]=new Bt);var n=this.uniqueKeysTracker[e];n.has(t)||(n.add(t),this.uniqueTrackerSize++),this.uniqueTrackerSize>=this.maxStorage&&this.onFullQueue&&this.onFullQueue()},e.prototype.clear=function(){this.uniqueTrackerSize=0,this.uniqueKeysTracker={}},e.prototype.pop=function(){var e=this.uniqueKeysTracker;return this.clear(),this.fromUniqueKeysCollector(e)},e.prototype.isEmpty=function(){return 0===Object.keys(this.uniqueKeysTracker).length},e.prototype.fromUniqueKeysCollector=function(e){for(var t=[],n=Object.keys(e),r=0;r<n.length;r++){var i=n[r],s={k:i,fs:jt(e[i])};t.push(s)}return{keys:t}},e}();function En(e){var t=e.settings,n=t.scheduler,r=n.impressionsQueueSize,i=n.eventsQueueSize,s=t.sync,o=s.impressionsMode,a=s.__splitFiltersValidation,u=new gn(a),c=new dn,l={splits:u,segments:c,impressions:new en(r),impressionCounts:o!==b?new nn:void 0,events:new rn(i),telemetry:Sn(e)?new bn(u,c):void 0,uniqueKeys:o===E?new Tn:void 0,destroy:function(){this.splits.clear(),this.segments.clear(),this.impressions.clear(),this.impressionCounts&&this.impressionCounts.clear(),this.events.clear(),this.uniqueKeys&&this.uniqueKeys.clear()},shared:function(){return{splits:this.splits,segments:new dn,impressions:this.impressions,impressionCounts:this.impressionCounts,events:this.events,telemetry:this.telemetry,destroy:function(){this.splits=new gn(a),this.segments.clear()}}}};if(e.settings.mode===_){var f=function(){return!0};l.impressions.track=f,l.events.track=f,l.impressionCounts&&(l.impressionCounts.track=f),l.uniqueKeys&&(l.uniqueKeys.track=f)}return l}function _n(e){return null!=e&&"function"==typeof e.then}function kn(e,t,n){return!t.isDestroyed()||(e.error(314,[n]),!1)}function Rn(e,t,n,r){return!(!t.isReady()&&!t.isReadyFromCache()&&(e.warn(203,[n,r?" for feature flag "+r.toString():""]),1))}En.type=A;var Cn="definition not found",wn="not ready",An="exception";function On(e,t,n,r,i){return!t.isReady()||r!==Cn&&null!=r||(e.warn(215,[i,n]),!1)}function Nn(e){var t=e.conditions,n=ie(t,(function(e){return"ROLLOUT"===e.conditionType}));return n||(n=t[0]),n?n.partitions.map((function(e){return e.treatment})):[]}function Fn(e){return e?{name:e.name,trafficType:e.trafficTypeName,killed:e.killed,changeNumber:e.changeNumber||0,treatments:Nn(e),configs:e.configurations||{},sets:e.sets||[],defaultTreatment:e.defaultTreatment}:null}function Dn(e){var t=[];return e.forEach((function(e){var n=Fn(e);n&&t.push(n)})),t}function In(e,t,n){var r=n.readinessManager,i=n.sdkStatus,s=e.log,a=Ne(e.mode);return o(Object.create(i),{split:function(e){var n=De(s,e,q);if(!kn(s,r,q)||!Rn(s,r,q)||!n)return a?Promise.resolve(null):null;var i=t.getSplit(n);return _n(i)?i.catch((function(){return null})).then((function(e){return On(s,r,n,e,q),Fn(e)})):(On(s,r,n,i,q),Fn(i))},splits:function(){if(!kn(s,r,W)||!Rn(s,r,W))return a?Promise.resolve([]):[];var e=t.getAll();return _n(e)?e.catch((function(){return[]})).then(Dn):Dn(e)},names:function(){if(!kn(s,r,z)||!Rn(s,r,z))return a?Promise.resolve([]):[];var e=t.getSplitNames();return _n(e)?e.catch((function(){return[]})):e}})}var Ln=function(){function e(){this.attributesCache={}}return e.prototype.setAttribute=function(e,t){return this.attributesCache[e]=t,!0},e.prototype.getAttribute=function(e){return this.attributesCache[e]},e.prototype.setAttributes=function(e){return this.attributesCache=o(this.attributesCache,e),!0},e.prototype.getAll=function(){return this.attributesCache},e.prototype.removeAttribute=function(e){return Object.keys(this.attributesCache).indexOf(e)>=0&&(delete this.attributesCache[e],!0)},e.prototype.clear=function(){return this.attributesCache={},!0},e}();function Kn(e,t,n){return null==t||fe(t)?t:(e.error(311,[n,"attributes"]),!1)}function Mn(e,t,n){if(!Kn(e,t,n))return!1;var r=!0;return Object.keys(t).forEach((function(i){(function(e,t,n,r){if(!he(t)||0===t.length)return e.warn(r+": you passed an invalid attribute name, attribute name must be a non-empty string."),!1;var i=he(n),s=ce(n),o=ue(n),a=Array.isArray(n);return!!(i||s||o||a)||(e.warn(r+": you passed an invalid attribute value for "+t+". Acceptable types are: string, number, boolean and array of strings."),!1)})(e,i,t[i],n)||(r=!1)})),r}function xn(e,t,n,r){var i=function(e,t){var n=new Ln,r=t.getTreatment,i=t.getTreatmentWithConfig,s=t.getTreatments,a=t.getTreatmentsWithConfig,u=t.getTreatmentsByFlagSets,c=t.getTreatmentsWithConfigByFlagSets,l=t.getTreatmentsByFlagSet,f=t.getTreatmentsWithConfigByFlagSet,h=t.track;function p(e){var t=n.getAll();return Object.keys(t).length>0?o({},t,e):e}return o(t,{getTreatment:function(e,t,n){return r(e,t,p(n))},getTreatmentWithConfig:function(e,t,n){return i(e,t,p(n))},getTreatments:function(e,t,n){return s(e,t,p(n))},getTreatmentsWithConfig:function(e,t,n){return a(e,t,p(n))},getTreatmentsByFlagSets:function(e,t,n){return u(e,t,p(n))},getTreatmentsWithConfigByFlagSets:function(e,t,n){return c(e,t,p(n))},getTreatmentsByFlagSet:function(e,t,n){return l(e,t,p(n))},getTreatmentsWithConfigByFlagSet:function(e,t,n){return f(e,t,p(n))},track:function(e,t,n,r,i){return h(e,t,n,r,i)},setAttribute:function(t,r){var i={};return i[t]=r,!!Mn(e,i,"setAttribute")&&(e.debug("stored "+r+" for attribute "+t),n.setAttribute(t,r))},getAttribute:function(t){return e.debug("retrieved attribute "+t),n.getAttribute(t+"")},setAttributes:function(t){return!!Mn(e,t,"setAttributes")&&n.setAttributes(t)},getAttributes:function(){return n.getAll()},removeAttribute:function(t){return e.debug("removed attribute "+t),n.removeAttribute(t+"")},clearAttributes:function(){return n.clear()}})}(e,t);return o(i,{getTreatment:i.getTreatment.bind(i,n),getTreatmentWithConfig:i.getTreatmentWithConfig.bind(i,n),getTreatments:i.getTreatments.bind(i,n),getTreatmentsWithConfig:i.getTreatmentsWithConfig.bind(i,n),getTreatmentsByFlagSets:i.getTreatmentsByFlagSets.bind(i,n),getTreatmentsWithConfigByFlagSets:i.getTreatmentsWithConfigByFlagSets.bind(i,n),getTreatmentsByFlagSet:i.getTreatmentsByFlagSet.bind(i,n),getTreatmentsWithConfigByFlagSet:i.getTreatmentsWithConfigByFlagSet.bind(i,n),track:r?i.track.bind(i,n,r):i.track.bind(i,n),isClientSide:!0,key:n,trafficType:r})}var Un={UNDEFINED:0,ALL_KEYS:1,IN_SEGMENT:2,WHITELIST:3,EQUAL_TO:4,GREATER_THAN_OR_EQUAL_TO:5,LESS_THAN_OR_EQUAL_TO:6,BETWEEN:7,EQUAL_TO_SET:8,CONTAINS_ANY_OF_SET:9,CONTAINS_ALL_OF_SET:10,PART_OF_SET:11,ENDS_WITH:12,STARTS_WITH:13,CONTAINS_STRING:14,IN_SPLIT_TREATMENT:15,EQUAL_TO_BOOLEAN:16,MATCHES_STRING:17},Pn="BOOLEAN",jn="STRING",Bn="NUMBER",qn="DATETIME",Wn="NOT_SPECIFIED";function zn(e){return e.whitelist}function Hn(e){return e.value}function Gn(e){return new Date(e).setUTCHours(0,0,0,0)}function Qn(e){return new Date(e).setUTCSeconds(0,0)}function Yn(e){var t=e.map((function(e){var t,n=e.matcherType,r=e.negate,i=e.keySelector,s=e.userDefinedSegmentMatcherData,o=e.whitelistMatcherData,a=e.unaryNumericMatcherData,u=e.betweenMatcherData,c=e.dependencyMatcherData,l=e.booleanMatcherData,f=e.stringMatcherData,h=i&&i.attribute,p=function(e){return Un[e]||Un.UNDEFINED}(n),d=jn,g=void 0;return p===Un.IN_SEGMENT?g=(t=s)?t.segmentName:void 0:p===Un.WHITELIST?g=function(e){return new Bt(e.whitelist)}(o):p===Un.EQUAL_TO?(g=Hn(a),d=Bn,"DATETIME"===a.dataType&&(g=Gn(g),d=qn)):p===Un.GREATER_THAN_OR_EQUAL_TO||p===Un.LESS_THAN_OR_EQUAL_TO?(g=Hn(a),d=Bn,"DATETIME"===a.dataType&&(g=Qn(g),d=qn)):p===Un.BETWEEN?(d=Bn,"DATETIME"===(g=u).dataType&&(g.start=Qn(g.start),g.end=Qn(g.end),d=qn)):p===Un.EQUAL_TO_SET||p===Un.CONTAINS_ANY_OF_SET||p===Un.CONTAINS_ALL_OF_SET||p===Un.PART_OF_SET?(g=zn(o),d="SET"):p===Un.STARTS_WITH||p===Un.ENDS_WITH||p===Un.CONTAINS_STRING?g=zn(o):p===Un.IN_SPLIT_TREATMENT?(g=c,d=Wn):p===Un.EQUAL_TO_BOOLEAN?(d=Pn,g=l):p===Un.MATCHES_STRING&&(g=f),{attribute:h,negate:r,type:p,value:g,dataType:d}}));return-1===se(t,(function(e){return e.type===Un.UNDEFINED}))?t:[]}var Vn=function(){function e(e,t){if(100!==e[e.length-1])throw new RangeError("Provided invalid dataset as input");this._ranges=e,this._treatments=t}return e.parse=function(t){var n=t.reduce((function(e,t){var n=t.size,r=t.treatment;return e.ranges.push(e.inc+=n),e.treatments.push(r),e}),{inc:0,ranges:[],treatments:[]});return new e(n.ranges,n.treatments)},e.prototype.getTreatmentFor=function(e){if(e<0||e>100)throw new RangeError("Please provide a value between 0 and 100");var t=se(this._ranges,(function(t){return e<=t}));return this._treatments[t]},e}(),Jn=[void 0,function(e){return function(t){return e.debug(4),null!=t}},function(e,t,n){return function(r){var i=n.segments.isInSegment(t,r);return _n(i)?i.then((function(n){return e.debug(18,[t,r,i]),n})):e.debug(18,[t,r,i]),i}},function(e,t){return function(n){var r=t.has(n);return e.debug(22,[n,jt(t).join(","),r]),r}},function(e,t){return function(n){var r=n===t;return e.debug(12,[n,t,r]),r}},function(e,t){return function(n){var r=n>=t;return e.debug(15,[n,t,r]),r}},function(e,t){return function(n){var r=n<=t;return e.debug(16,[n,t,r]),r}},function(e,t){return function(n){var r=n>=t.start&&n<=t.end;return e.debug(5,[n,t.start,t.end,r]),r}},function(e,t){return function(n){for(var r=n.length===t.length,i=function(e){se(t,(function(t){return t===n[e]}))<0&&(r=!1)},s=0;s<n.length&&r;s++)i(s);return e.debug(13,[n,t,r]),r}},function(e,t){return function(n){for(var r=!1,i=function(e){se(n,(function(n){return n===t[e]}))>=0&&(r=!0)},s=0;s<t.length&&!r;s++)i(s);return e.debug(8,[n,t,r]),r}},function(e,t){return function(n){var r=!0;if(n.length<t.length)r=!1;else for(var i=function(e){se(n,(function(n){return n===t[e]}))<0&&(r=!1)},s=0;s<t.length&&r;s++)i(s);return e.debug(7,[n,t,r]),r}},function(e,t){return function(n){for(var r=n.length<=t.length,i=function(e){se(t,(function(t){return t===n[e]}))<0&&(r=!1)},s=0;s<n.length&&r;s++)i(s);return e.debug(17,[n,t,r]),r}},function(e,t){return function(n){var r=t.some((function(e){return r=e,void 0===i&&(i=!1),!(!he(t=n)||!he(r))&&(i&&(t=t.toLowerCase(),r=r.toLowerCase()),t.slice(t.length-r.length)===r);var t,r,i}));return e.debug(14,[n,t,r]),r}},function(e,t){return function(n){var r=t.some((function(e){return ge(n,e)}));return e.debug(21,[n,t,r]),r}},function(e,t){return function(n){var r=t.some((function(e){return he(n)&&n.indexOf(e)>-1}));return e.debug(9,[n,t,r]),r}},function(e,t,n){var r=t.split,i=t.treatments;function s(t,n,r){var i=!1;return Array.isArray(n)&&(i=-1!==n.indexOf(t.treatment)),e.debug(10,[r,t.treatment,t.label,r,n,i]),i}return function(t,o){var a=t.key,u=t.attributes;e.debug(11,[r,JSON.stringify(a),u?"\n attributes: "+JSON.stringify(u):""]);var c=o(e,a,r,u,n);return _n(c)?c.then((function(e){return s(e,i,r)})):s(c,i,r)}},function(e,t){return function(n){var r=t===n;return e.debug(6,[t,n]),r}},function(e,t){return function(n){var r;try{r=new RegExp(t)}catch(n){return e.debug(20,[t]),!1}var i=r.test(n);return e.debug(19,[n,t,i?"yes":"no"]),i}}];function Zn(e,t,n){var r,i=t.type,s=t.value;return Jn[i]&&(r=Jn[i](e,s,n)),r}function $n(e,t){return{key:e,attributes:t}}function Xn(e,t,n,r){var i=n.attribute,s=function(e,t,n,r){var i=void 0;return n?r?(i=r[n],e.debug(23,[n,i])):e.warn(201,[n]):i=t,i}(e,t,i,r),o=function(e,t,n,r,i){var s,o,a,u,c=function(e,t){switch(e){case Un.EQUAL_TO:return"DATETIME"===t?Gn:void 0;case Un.GREATER_THAN_OR_EQUAL_TO:case Un.LESS_THAN_OR_EQUAL_TO:case Un.BETWEEN:return"DATETIME"===t?Qn:void 0;case Un.IN_SPLIT_TREATMENT:return $n;default:return}}(t,r);switch(r){case Bn:case qn:o=me(n),s=isNaN(o)?void 0:o;break;case jn:u=a=n,fe(a)&&(u=a.matchingKey?a.matchingKey:void 0),s=ve(u)||void 0;break;case"SET":s=function(e){var t=Array.isArray(e)?ye(e.map((function(e){return e+""}))):[];return t.length?t:void 0}(n);break;case Pn:s=function(e){if(!0===e||!1===e)return e;if("string"==typeof e){var t=e.toLocaleLowerCase();if("true"===t)return!0;if("false"===t)return!1}}(n);break;case Wn:s=n;break;default:s=void 0}return c&&(s=c(s,i)),e.debug(24,[n,r,s instanceof Object?JSON.stringify(s):s]),s}(e,n.type,s,n.dataType,r);return void 0!==o?o:void e.warn(200,[s+(i?" for attribute "+i:"")])}function er(e,t,n,r,i,s){if(t){var o=function(e,t,n,r){var i=At(t,n),s=r.getTreatmentFor(i);return e.debug(3,[i,t,n,s]),s}(e,n,r,i);return{treatment:o,label:s}}}function tr(e,t,n,r,i){return function(s,o,a,u,c,l){if("ROLLOUT"===i&&!function(e,t,n){return!(e<100&&At(t,n)>e)}(a,s.bucketingKey,u))return{treatment:void 0,label:"not in split"};var f=t(s,c,l);return _n(f)?f.then((function(t){return er(e,t,s.bucketingKey,o,n,r)})):er(e,f,s.bucketingKey,o,n,r)}}function nr(e,t){function n(t){var n=t.every((function(e){return e}));return e.debug(0,[n]),n}return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=t.map((function(t){return t.apply(void 0,e)}));return-1!==se(i,_n)?Promise.all(i).then(n):n(i)}}function rr(e,t){return{treatment:ae(e,"treatment",t),label:ae(e,"label","default rule")}}var ir=function(){function e(e,t){this.baseInfo=e,this.evaluator=t,"string"!=typeof this.baseInfo.defaultTreatment&&(this.baseInfo.defaultTreatment=m)}return e.parse=function(t,n,r){return new e(n,function(e,t,n){for(var r=[],i=0;i<t.length;i++){var s=t[i],o=s.matcherGroup,a=s.partitions,u=s.label,c=s.conditionType,l=Yn(o.matchers).map((function(t){var r=Zn(e,t,n);return function(n,i,s){var o=Xn(e,n,t,i),a=!(void 0===o||!r)&&r(o,s);return _n(a)?a.then((function(e){return Boolean(e^t.negate)})):Boolean(a^t.negate)}}));if(0===l.length){r=[];break}r.push(tr(e,nr(e,l),Vn.parse(a),u,c))}return function(e,t){function n(t){for(var n=t.length,r=0;r<n;r++){var i=t[r];if(void 0!==i)return e.debug(1,[i.treatment]),i}e.debug(2)}return!Array.isArray(t)||Array.isArray(t)&&0===t.length?function(){return e.error(300),{treatment:m,label:An}}:function(e,r,i,s,o,a){var u=t.map((function(t){return t(e,r,i,s,o,a)}));return-1!==se(u,_n)?Promise.all(u).then((function(e){return n(e)})):n(u)}}(e,r)}(t,n.conditions,r))},e.prototype.getKey=function(){return this.baseInfo.name},e.prototype.getTreatment=function(e,t,n){var r,i,s,o=this.baseInfo,a=o.killed,u=o.seed,c=o.defaultTreatment,l=o.trafficAllocation,f=o.trafficAllocationSeed;try{r=Kt(e)}catch(e){return{treatment:m,label:An}}if(this.isGarbage())i=m,s="archived";else{if(!a){var h=this.evaluator(r,u,l,f,t,n);return _n(h)?h.then((function(e){return rr(e,c)})):rr(h,c)}i=c,s="killed"}return{treatment:i,label:s}},e.prototype.isGarbage=function(){return"ARCHIVED"===this.baseInfo.status},e.prototype.getChangeNumber=function(){return this.baseInfo.changeNumber},e}(),sr={treatment:m,label:An,config:null};function or(e){var t={};return e.forEach((function(e){t[e]=sr})),t}function ar(e,t,n,r,i){var s;try{s=i.splits.getSplit(n)}catch(e){return sr}return _n(s)?s.then((function(n){return cr(e,n,t,r,i)})).catch((function(){return sr})):cr(e,s,t,r,i)}function ur(e,t,n,r,i){var s;try{s=i.splits.getSplits(n)}catch(e){return or(n)}return _n(s)?s.then((function(s){return lr(e,n,s,t,r,i)})).catch((function(){return or(n)})):lr(e,n,s,t,r,i)}function cr(e,t,n,r,i){var s={treatment:m,label:Cn,config:null};if(t){var o=ir.parse(e,t,i);if(_n(s=o.getTreatment(n,r,ar)))return s.then((function(e){return e.changeNumber=o.getChangeNumber(),e.config=t.configurations&&t.configurations[e.treatment]||null,e}));s.changeNumber=o.getChangeNumber(),s.config=t.configurations&&t.configurations[s.treatment]||null}return s}function lr(e,t,n,r,i,s){var o={},a=[];return t.forEach((function(t){var u=cr(e,n[t],r,i,s);_n(u)?a.push(u.then((function(e){o[t]=e}))):o[t]=u})),a.length>0?Promise.all(a).then((function(){return o})):o}function fr(e,t,n){e.warn(217,[n,t])}var hr={treatment:m,label:wn};function pr(e){var t={};return e.forEach((function(e){t[e]=hr})),t}var dr=/^[a-zA-Z0-9][-_.:a-zA-Z0-9]{0,79}$/,gr="event_type";function mr(e,t,n){if(null==t)e.error(c,[n,gr]);else if(he(t))if(0===t.length)e.error(f,[n,gr]);else{if(dr.test(t))return t;e.error(310,[n,t])}else e.error(l,[n,gr]);return!1}function vr(e,t,n){return ce(t)||null==t?t:(e.error(313,[n]),!1)}var yr=1024;function Sr(e,t,n){if(null==t)return{properties:null,size:yr};if(!fe(t))return e.error(311,[n,"properties"]),{properties:!1,size:yr};var r=Object.keys(t),i=o({},t),s={properties:i,size:yr};r.length>300&&e.warn(212,[n]);for(var a=0;a<r.length;a++){s.size+=2*r[a].length;var u=i[r[a]],c=he(u),l=ce(u),f=ue(u),h=null===u;if(c||l||f||h||(i[r[a]]=null,u=null,h=!0,e.warn(211,[n,r[a]])),h?s.size+=0:l?s.size+=8:f?s.size+=4:c&&(s.size+=2*u.length),s.size>32768){e.error(312,[n]),s.properties=!1;break}}return s}function br(e,t){var n=e.sdkReadinessManager,r=e.syncManager,i=e.storage,s=e.signalListener,a=e.settings,u=e.telemetryTracker,c=e.uniqueKeysTracker,l=0;function f(){return r?r.flush():Promise.resolve()}return o(Object.create(n.sdkStatus),function(e,t,n){var r=e.log,i=Ne(e.mode);function s(t,i,s,o,a){var u=ge(o,L),c=je(r,t,o),l=!1,f=[];i&&(l=u?Ie(r,i,o):De(r,i,o));var h=Kn(r,s,o),p=kn(r,n,o);return a&&(f=function(e,t,n,r){var i=Ie(e,n,t,"flag sets","flag set"),s=i?xe(e,i,t):[];return r.length>0&&(s=s.filter((function(n){return r.indexOf(n)>-1||(e.warn(227,[t,n]),!1)}))),s}(r,o,a,e.sync.__splitFiltersValidation.groupedFilters.bySet)),Rn(r,n,o,l),{valid:p&&c&&(l||f.length>0)&&!1!==h,key:c,splitOrSplits:l,flagSetOrFlagSets:f,attributes:h}}function a(e){return i?Promise.resolve(e):e}return{getTreatment:function(e,n,r){var i=s(e,n,r,I);return i.valid?t.getTreatment(i.key,i.splitOrSplits,i.attributes):a(m)},getTreatmentWithConfig:function(e,n,r){var i=s(e,n,r,K);return i.valid?t.getTreatmentWithConfig(i.key,i.splitOrSplits,i.attributes):a(o({},v))},getTreatments:function(e,n,r){var i=s(e,n,r,L);if(i.valid)return t.getTreatments(i.key,i.splitOrSplits,i.attributes);var o={};return i.splitOrSplits&&i.splitOrSplits.forEach((function(e){return o[e]=m})),a(o)},getTreatmentsWithConfig:function(e,n,r){var i=s(e,n,r,M);if(i.valid)return t.getTreatmentsWithConfig(i.key,i.splitOrSplits,i.attributes);var u={};return i.splitOrSplits&&i.splitOrSplits.forEach((function(e){return u[e]=o({},v)})),a(u)},getTreatmentsByFlagSets:function(e,n,r){var i=s(e,void 0,r,U,n);return i.valid?t.getTreatmentsByFlagSets(i.key,i.flagSetOrFlagSets,i.attributes):a({})},getTreatmentsWithConfigByFlagSets:function(e,n,r){var i=s(e,void 0,r,j,n);return i.valid?t.getTreatmentsWithConfigByFlagSets(i.key,i.flagSetOrFlagSets,i.attributes):a({})},getTreatmentsByFlagSet:function(e,n,r){var i=s(e,void 0,r,x,[n]);return i.valid?t.getTreatmentsByFlagSet(i.key,i.flagSetOrFlagSets[0],i.attributes):a({})},getTreatmentsWithConfigByFlagSet:function(e,n,r){var i=s(e,void 0,r,P,[n]);return i.valid?t.getTreatmentsWithConfigByFlagSet(i.key,i.flagSetOrFlagSets[0],i.attributes):a({})},track:function(e,s,o,a,u){var c=je(r,e,B),l=We(r,s,B),f=mr(r,o,B),h=vr(r,a,B),p=Sr(r,u,B),d=p.properties,g=p.size;return kn(r,n,B)&&c&&l&&f&&!1!==h&&!1!==d?t.track(c,l,f,h,d,g):!!i&&Promise.resolve(!1)}}}(a,function(e){var t=e.sdkReadinessManager.readinessManager,n=e.storage,r=e.settings,i=e.impressionsTracker,s=e.eventTracker,o=e.telemetryTracker,a=r.log,u=r.mode,c=Ne(u);function l(e,r,s,u,l){void 0===u&&(u=!1),void 0===l&&(l=I);var f=o.trackEval(u?"tc":"t"),h=function(t){var n=[],o=p(t,r,e,0,u,l,n);return i.track(n,s),f(n[0]&&n[0].label),o},d=t.isReady()||t.isReadyFromCache()?ar(a,e,r,s,n):c?Promise.resolve(hr):hr;return _n(d)?d.then((function(e){return h(e)})):h(d)}function f(e,r,s,u,l){void 0===u&&(u=!1),void 0===l&&(l=L);var f=o.trackEval(u?"tcs":"ts"),h=function(t){var n=[],r={};return Object.keys(t).forEach((function(i){r[i]=p(t[i],i,e,0,u,l,n)})),i.track(n,s),f(n[0]&&n[0].label),r},d=t.isReady()||t.isReadyFromCache()?ur(a,e,r,s,n):c?Promise.resolve(pr(r)):pr(r);return _n(d)?d.then((function(e){return h(e)})):h(d)}function h(e,r,s,u,l,f){void 0===u&&(u=!1),void 0===l&&(l="tfs"),void 0===f&&(f=U);var h=o.trackEval(l),d=function(t){var n=[],r={},o=t;return Object.keys(o).forEach((function(t){r[t]=p(o[t],t,e,0,u,f,n)})),i.track(n,s),h(n[0]&&n[0].label),r},g=t.isReady()||t.isReadyFromCache()?function(e,t,n,r,i,s){var o;function a(o){for(var a=new Bt,u=0;u<n.length;u++){var c=o[u];c.size?a=qt(a,c):e.warn(228,[s,n[u]])}return a.size?ur(e,t,jt(a),r,i):{}}try{o=i.splits.getNamesByFlagSets(n)}catch(e){return{}}return _n(o)?o.then((function(e){return a(e)})).catch((function(){return{}})):a(o)}(a,e,r,s,n,f):c?Promise.resolve({}):{};return _n(g)?g.then((function(e){return d(e)})):d(g)}function p(e,n,r,i,s,o,u){var c=Lt(r),l=function(e){return fe(e)?e.bucketingKey:void 0}(r),f=e.treatment,h=e.label,p=e.changeNumber,d=e.config,g=void 0===d?null:d;return a.info(102,[n,c,f,h]),On(a,t,n,h,o)&&(a.info(103),u.push({feature:n,keyName:c,treatment:f,time:Date.now(),bucketingKey:l,label:h,changeNumber:p})),s?{treatment:f,config:g}:f}return{getTreatment:l,getTreatmentWithConfig:function(e,t,n){return l(e,t,n,!0,K)},getTreatments:f,getTreatmentsWithConfig:function(e,t,n){return f(e,t,n,!0,M)},getTreatmentsByFlagSets:h,getTreatmentsWithConfigByFlagSets:function(e,t,n){return h(e,t,n,!0,"tcfs",j)},getTreatmentsByFlagSet:function(e,t,n){return h(e,[t],n,!1,"tf",x)},getTreatmentsWithConfigByFlagSet:function(e,t,n){return h(e,[t],n,!0,"tcf",P)},track:function(e,r,i,c,l,f){void 0===f&&(f=1024);var h=o.trackEval("tr"),p=Lt(e),d={eventTypeId:i,trafficTypeName:r,value:c,timestamp:Date.now(),key:p,properties:l};!function(e,t,n,r,i,s){if(!t.isReady()||r===_)return!0;var o=n.trafficTypeExists(i);_n(o)?o.then((function(t){return t||fr(e,i,s),t})):o||fr(e,i,s)}(a,t,n.splits,u,r,B);var g=s.track(d,f);return _n(g)?g.then((function(e){return h(),e})):(h(),g)},isClientSide:!1}}(e),n.readinessManager),{flush:function(){return e=f,t=Date.now(),(n=t-l)<1e3?(a.log.warn("Flush cooldown, remaining time "+(1e3-n)/1e3+" seconds"),Promise.resolve()):(l=t,e());var e,t,n},destroy:function(){var e;return n.readinessManager.destroy(),t||(e=a.core.authorizationKey,Ze[e]&&Ze[e]--,0===Ze[e]&&delete Ze[e],u.sessionLength()),r&&r.stop(),f().then((function(){return s&&s.stop(),c&&c.stop(),i.destroy()}))}})}function Tr(e,t){return(e.matchingKey?e.matchingKey:e)+"-"+(e.bucketingKey?e.bucketingKey:e)+"-"+(void 0!==t?t:"")}var Er="Client instantiation";function _r(e){var t=e.storage,n=e.syncManager,r=e.sdkReadinessManager,i=e.settings,s=i.core,a=s.key,u=s.trafficType,c=i.startup.readyTimeout,l=i.log,f=xn(l,br(e),a,u),h=Tr(Kt(a),u),p={};return p[h]=f,function(i,s){if(void 0===i)return l.debug(27),f;var a,u=je(l,i,"Shared "+Er);if(!1===u)throw new Error("Shared Client needs a valid key.");if(void 0!==s&&!1===(a=We(l,s,"Shared "+Er)))throw new Error("Shared Client needs a valid traffic type or no traffic type at all.");var h=Tr(u,a);if(p[h])l.debug(28);else{var d=Lt(u),g=r.shared(c),m=t.shared&&t.shared(d,(function(e){e?g.readinessManager.timeout():g.readinessManager.segments.emit(Re)})),v=n&&m&&n.shared(d,g.readinessManager,m);p[h]=xn(l,br(o({},e,{sdkReadinessManager:g,storage:m||t,syncManager:v,signalListener:void 0}),!0),u,a),v&&v.start(),l.info(104)}return p[h]}}var kr=function(){function e(e){var t=this;this.__mapKeysData__=[],this.__mapValuesData__=[],Array.isArray(e)&&e.forEach((function(e){t.set(e[0],e[1])}))}return e.prototype.clear=function(){this.__mapKeysData__.length&&(this.__mapKeysData__.length=0,this.__mapValuesData__.length=0)},e.prototype.delete=function(e){var t=this.__mapKeysData__.indexOf(e);return-1!==t&&(this.__mapKeysData__.splice(t,1),this.__mapValuesData__.splice(t,1),!0)},e.prototype.forEach=function(e,t){for(var n=0;n<this.__mapKeysData__.length;n++)e.call(t,this.__mapValuesData__[n],this.__mapKeysData__[n],this)},e.prototype.get=function(e){var t=this.__mapKeysData__.indexOf(e);if(-1!==t)return this.__mapValuesData__[t]},e.prototype.has=function(e){return-1!==this.__mapKeysData__.indexOf(e)},e.prototype.set=function(e,t){var n=this.__mapKeysData__.indexOf(e);return-1===n&&(n=this.__mapKeysData__.push(e)-1),this.__mapValuesData__[n]=t,this},Object.defineProperty(e.prototype,"size",{get:function(){return this.__mapKeysData__.length},enumerable:!1,configurable:!0}),e}(),Rr="function"==typeof Array.from&&"function"==typeof Map&&Map.prototype&&Map.prototype.values?Map:kr,Cr=function(e,t,n,r){this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null},wr=function(){function e(){this.tail=null,this.head=null,this.length=0}return e.prototype.removeNode=function(e){if(e&&e instanceof Cr){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t}},e.prototype.unshiftNode=function(e){if(e&&e instanceof Cr&&e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},e.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)this.head=new Cr(arguments[e],null,this.head,this),this.tail||(this.tail=this.head),this.length++;return this.length},e}(),Ar=function(){function e(e){this.maxLen=e||1,this.items=new Rr,this.lru=new wr}return e.prototype.get=function(e){var t=this.items.get(e);if(t&&t instanceof Cr)return this.lru.unshiftNode(t),t.value.value},e.prototype.set=function(e,t){var n=this.items.get(e);if(n){if(!(n instanceof Cr))return!1;this.lru.unshiftNode(n),this.lru.head.value.value=t}else{if(this.lru.length===this.maxLen){var r=this.lru.tail;if(!r)return!1;this.items.delete(r.value.key),this.lru.removeNode(this.lru.tail)}this.lru.unshift({key:e,value:t}),this.items.set(e,this.lru.head)}return!0},e}(),Or=function(){function e(e,t){this.cache=new Ar(e),this.hasher=t}return e.prototype.testAndSet=function(e){var t=this.hasher(e),n=this.cache.get(t);return this.cache.set(t,e.time),n},e}();function Nr(e){return wt(function(e){return e.keyName+":"+e.feature+":"+e.treatment+":"+e.label+":"+e.changeNumber}(e))}function Fr(){return new Or(500,Nr)}var Dr,Ir="ga-to-split: ",Lr="ga-to-split:mapper",Kr=(Dr={eventTypeId:{event:"eventAction",social:"socialAction"},eventValue:{event:"eventValue",timing:"timingValue"},eventProperties:{pageview:["page"],screenview:["screenName"],event:["eventCategory","eventLabel"],social:["socialNetwork","socialTarget"],timing:["timingCategory","timingVar","timingLabel"],exception:["exDescription","exFatal"]}},function(e){var t=e.get("hitType"),n=e.get(Dr.eventTypeId[t]||"hitType"),r=e.get(Dr.eventValue[t]),i={},s=Dr.eventProperties[t];if(s)for(var o=0;o<s.length;o++){var a=e.get(s[o]);void 0!==a&&(i[s[o]]=a)}return{eventTypeId:n,value:r,properties:i,timestamp:Date.now()}});var Mr=/^[^a-zA-Z0-9]+/,xr=/[^-_.:a-zA-Z0-9]+/g;function Ur(e,t){var n=t.storage,r=t.settings,i=r.core,s=r.log,a=t.telemetryTracker,u={prefix:"ga",identities:i.key&&i.trafficType?[{key:i.key,trafficType:i.trafficType}]:void 0};!function(e,t,n,r,i,s){var o=e.GoogleAnalyticsObject||"ga";e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o]("provide","splitTracker",n);var a=e[o].q&&e[o].q.push!==[].push;i&&!a&&r.error(Ir+"integration is configured to autorequire the splitTracker plugin, but the necessary script does not seem to have run. Please check the docs."),s&&a&&s.addTag("integration:ga-autorequire")}(window,0,(function(t,r){var i=o({},u,e,r);this.tracker=t;var a=function(e){if(!Array.isArray(e))return[];var t=function(e,t){void 0===t&&(t=JSON.stringify);var n={};return e.filter((function(e){var r=t(e);return!Object.prototype.hasOwnProperty.call(n,r)&&(n[r]=!0)}))}(e);return t.filter((function(e){if(!e)return!1;var t=e.key,n=e.trafficType;return!(!he(t)&&!ce(t)||!he(n))}))}(i.identities);if(0!==a.length){var c=a.length-i.identities.length;c&&s.warn(Ir+(c+" identities were discarded because they are invalid or duplicated. Identities must be an array of objects with key and trafficType.")),i.identities=a,he(i.prefix)||(s.warn(Ir+"The provided `prefix` was ignored since it is invalid. Please check that you are passing a string object as `prefix`."),i.prefix=void 0);var l=t.get("sendHitTask");t.set("sendHitTask",(function(e){if(l(e),!1!==i.hits&&!e.get("splitHit")){try{if(i.filter&&!i.filter(e))return}catch(e){return void s.warn(Ir+"custom filter threw: "+e)}var t=Kr(e);if(i.mapper){try{t=i.mapper(e,t)}catch(e){return void s.warn(Ir+"custom mapper threw: "+e)}if(!t)return}i.prefix&&(t.eventTypeId=i.prefix+"."+t.eventTypeId),t.eventTypeId=function(e,t){if(!he(t)||0===t.length)return t;var n=t.replace(Mr,"").replace(xr,"_"),r=n.slice(0,80);return r.length<n.length&&e.warn(Ir+"EventTypeId was truncated because it cannot be more than 80 characters long."),r}(s,t.eventTypeId),function(e,t){return!(!mr(e,t.eventTypeId,Lr)||!1===vr(e,t.value,Lr)||!1===Sr(e,t.properties,Lr).properties||t.timestamp&&!ce(t.timestamp)||t.key&&!1===je(e,t.key,Lr)||t.trafficTypeName&&!1===We(e,t.trafficTypeName,Lr))}(s,t)&&(t.key&&t.trafficTypeName?n.events.track(t):i.identities.forEach((function(e){var r=o({key:e.key,trafficTypeName:e.trafficType},t);n.events.track(r)})))}})),s.info(Ir+"integration started")}else s.warn(Ir+"No valid identities were provided. Please check that you are passing a valid list of identities or providing a traffic type at the SDK configuration.")}),s,!0===e.autoRequire,a)}var Pr="split-to-ga: ",jr="`ga` command queue not found.",Br="No hit was sent.",qr=function(){function e(t,n){this.trackerNames=e.defaultTrackerNames,this.log=t,n&&("function"==typeof n.filter&&(this.filter=n.filter),"function"==typeof n.mapper&&(this.mapper=n.mapper),Array.isArray(n.trackerNames)&&(this.trackerNames=ye(n.trackerNames)),this.impressions=n.impressions,this.events=n.events),t.info("split-to-ga: integration started"),"function"!=typeof e.getGa()&&t.warn(Pr+(jr+" No hits will be sent until it is available."))}return e.defaultMapper=function(e){var t=e.type,n=e.payload;switch(t){case y:return{hitType:"event",eventCategory:"split-impression",eventAction:"Evaluate "+n.impression.feature,eventLabel:"Treatment: "+n.impression.treatment+". Targeting rule: "+n.impression.label+".",nonInteraction:!0};case S:return{hitType:"event",eventCategory:"split-event",eventAction:n.eventTypeId,eventValue:n.value,nonInteraction:!0}}},e.getGa=function(){return"undefined"!=typeof window?window[window.GoogleAnalyticsObject||"ga"]:void 0},e.validateFieldsObject=function(e,t){return!(!t||!t.hitType)||(e.warn("split-to-ga: your custom mapper returned an invalid FieldsObject instance. It must be an object with at least a `hitType` field."),!1)},e.prototype.queue=function(t){var n=e.getGa();if(n){if(!1===this.impressions&&t.type===y)return;if(!1===this.events&&t.type===S)return;var r;try{if(this.filter&&!this.filter(t))return;if(r=e.defaultMapper(t),this.mapper&&(!(r=this.mapper(t,r))||!e.validateFieldsObject(this.log,r)))return}catch(e){return void this.log.warn("split-to-ga: queue method threw: "+e+". "+Br)}this.trackerNames.forEach((function(e){var t=e?e+".send":"send";r.splitHit=!0,n(t,r)}))}else this.log.warn(Pr+(jr+" ")+Br)},e.defaultTrackerNames=[""],e}();function Wr(e,t){var n=e.map((function(e){switch(e.type){case mn:return function(e){function t(t){return Ur(e,t)}return void 0===e&&(e={}),t.type="GOOGLE_ANALYTICS_TO_SPLIT",t}(e);case vn:return function(e){function t(t){return new qr(t.settings.log,e)}return void 0===e&&(e={}),t.type="SPLIT_TO_GOOGLE_ANALYTICS",t}(e)}})).filter((function(e){return e&&"function"==typeof e}));return function(e,t){var n=[];if(e.forEach((function(e){var r=e(t);r&&r.queue&&n.push(r)})),0!==n.length)return{handleImpression:function(e){n.forEach((function(t){return t.queue({type:y,payload:e})}))},handleEvent:function(e){n.forEach((function(t){return t.queue({type:S,payload:e})}))}}}(n,t)}function zr(e){var t=En(e);return t.splits.checkCache=function(){return!0},t}function Hr(e,t){var n=!1,r=!1,i=function e(i){var s=new Promise((function(e,n){return i.then(e,(function(e){r?n(e):t(e)}))})),o=s.then;return Object.defineProperty(s,"then",{value:function(t,i){var a=o.call(s,t,i);return"function"==typeof t&&(n=!0),"function"==typeof i?(r=!0,a):e(a)}}),s}(e);return i.hasOnFulfilled=function(){return n},i}function Gr(e,t,n){void 0===t&&(t=0),void 0===n&&(n=function(e){var t=o(new e,{splitsArrived:!1,splitsCacheLoaded:!1});return t.on(_e,(function(e){e||(t.splitsArrived=!0)})),t.once(ke,(function(){t.splitsCacheLoaded=!0})),t}(e));var r=function(e){var t=o(new e,{segmentsArrived:!1});return t.once(Re,(function(){t.segmentsArrived=!0})),t}(e),i=new e,s=!1;n.splitsCacheLoaded?s=!0:n.once(ke,(function(){if(s=!0,!l)try{i.emit(Ae)}catch(e){setTimeout((function(){throw e}),0)}}));var a,u=!1;function c(){u||(u=!0,i.emit(Ce,"Split SDK emitted SDK_READY_TIMED_OUT event."))}t>0&&(a=setTimeout(c,t));var l=!1;n.on(_e,h),r.on(Re,h);var f=!1;function h(e){if(l)try{i.emit(Oe,e)}catch(e){setTimeout((function(){throw e}),0)}else if(n.splitsArrived&&r.segmentsArrived){clearTimeout(a),l=!0;try{i.emit(we)}catch(e){setTimeout((function(){throw e}),0)}}}var p=1;return{splits:n,segments:r,gate:i,shared:function(t){return void 0===t&&(t=0),p++,Gr(e,t,n)},timeout:c,setDestroyed:function(){f=!0},destroy:function(){f=!0,r.removeAllListeners(),i.removeAllListeners(),clearTimeout(a),p>0&&p--,0===p&&n.removeAllListeners()},isReady:function(){return l},hasTimedout:function(){return u},isReadyFromCache:function(){return s},isDestroyed:function(){return f},isOperational:function(){return(l||s)&&!f}}}function Qr(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=Gr(t,n));var i=0,s=0;r.gate.on("removeListener",(function(e){e===we&&s--})),r.gate.on("newListener",(function(t){t!==we&&t!==Ce||(r.isReady()?e.error(302,[t===we?"SDK_READY":"SDK_READY_TIMED_OUT"]):t===we&&s++)}));var a,u=a=Hr(new Promise((function(t,n){r.gate.once(we,(function(){e.info(101),s!==i||a.hasOnFulfilled()||e.warn(202),t()})),r.gate.once(Ce,(function(e){n(new Error(e))}))})),c);function c(t){e.error(t&&t.message)}return r.gate.once(Ae,(function(){e.info(100)})),{readinessManager:r,shared:function(n){return void 0===n&&(n=0),Qr(e,t,n,r.shared(n))},incInternalReadyCbCount:function(){i++},sdkStatus:o(Object.create(r.gate),{Event:{SDK_READY:we,SDK_READY_FROM_CACHE:Ae,SDK_UPDATE:Oe,SDK_READY_TIMED_OUT:Ce},ready:function(){return r.hasTimedout()?r.isReady()?Promise.resolve():Hr(Promise.reject(new Error("Split SDK has emitted SDK_READY_TIMED_OUT event.")),c):u},__getStatus:function(){return{isReady:r.isReady(),isReadyFromCache:r.isReadyFromCache(),isOperational:r.isOperational(),hasTimedout:r.hasTimedout(),isDestroyed:r.isDestroyed()}}})}}zr.type=A;var Yr={DEBUG:"DEBUG",INFO:"INFO",WARN:"WARN",ERROR:"ERROR",NONE:"NONE"},Vr={DEBUG:1,INFO:2,WARN:3,ERROR:4,NONE:5};function Jr(e){return!!ie(Yr,(function(t){return e===t}))}function Zr(e,t){void 0===e&&(e=""),void 0===t&&(t=[]);var n=0;return e.replace(/%s/g,(function(){return t[n++]}))}var $r={prefix:"splitio",logLevel:Yr.NONE,showLevel:!0},Xr=function(){function e(e,t){this.options=o({},$r,e),this.codes=t||new Rr,this.logLevel=Vr[this.options.logLevel]}return e.prototype.setLogLevel=function(e){this.options.logLevel=e,this.logLevel=Vr[e]},e.prototype.debug=function(e,t){this._shouldLog(Vr.DEBUG)&&this._log(Yr.DEBUG,e,t)},e.prototype.info=function(e,t){this._shouldLog(Vr.INFO)&&this._log(Yr.INFO,e,t)},e.prototype.warn=function(e,t){this._shouldLog(Vr.WARN)&&this._log(Yr.WARN,e,t)},e.prototype.error=function(e,t){this._shouldLog(Vr.ERROR)&&this._log(Yr.ERROR,e,t)},e.prototype._log=function(e,t,n){if("number"==typeof t){var r=this.codes.get(t);t=r?Zr(r,n):"Message code "+t+(n?", with args: "+n.toString():"")}else n&&(t=Zr(t,n));var i=this._generateLogMessage(e,t);console.log(i)},e.prototype._generateLogMessage=function(e,t){var n="";return this.options.showLevel&&(n+="["+e+"]"+(e===Yr.INFO||e===Yr.WARN?" ":"")+" "),this.options.prefix&&(n+=this.options.prefix+" => "),n+t},e.prototype._shouldLog=function(e){return e>=this.logLevel},e}();function ei(e){function t(t){Jr(t)?e.setLogLevel(t):e.error(301)}return{enable:function(){t(Yr.DEBUG)},setLogLevel:t,disable:function(){t(Yr.NONE)},LogLevel:Yr}}var ti={add:function(){return!0},contains:function(){return!0},clear:function(){}};function ni(e){var t=e.settings,n=e.platform,r=e.storageFactory,i=e.splitApiFactory,s=e.extraProps,a=e.syncManagerFactory,u=e.SignalListener,h=e.impressionsObserverFactory,d=e.integrationsManagerFactory,g=e.sdkManagerFactory,m=e.sdkClientMethodFactory,v=e.filterAdapterFactory,y=t.log,S=t.sync.impressionsMode;!function(e,t){var n=function(e,t){var n=!1;return null==t?e.error(c,[p,Je]):he(t)?t.length>0?n=t:e.error(f,[p,Je]):e.error(l,[p,Je]),n}(e,t);n&&(Ze[n]?(e.warn(222,[Ze[n]+" factory/ies with this SDK Key"]),Ze[n]++):(Ze[n]=1,Object.keys(Ze).length>1&&e.warn(222,["an instance of the Split factory"])))}(y,t.core.authorizationKey);var b,_,k,R=Qr(y,n.EventEmitter,t.startup.readyTimeout),C=R.readinessManager,w=r({settings:t,onReadyCb:function(e){e?C.timeout():(C.splits.emit(_e),C.segments.emit(Re))}}),A=function(e,t){if(e&&t){var n=$e(t);return{trackEval:function(n){var r=$e(t);return function(t){switch(t){case An:return void e.recordException(n);case wn:e.recordNonReadyUsage&&e.recordNonReadyUsage()}e.recordLatency(n,r())}},trackHttp:function(n){var r=$e(t);return function(t){e.recordHttpLatency(n,r()),t&&t.statusCode?e.recordHttpError(n,t.statusCode):e.recordSuccessfulSync(n,Date.now())}},sessionLength:function(){e.recordSessionLength&&e.recordSessionLength(n())},streamingEvent:function(t,n){80===t?e.recordAuthRejections():(e.recordStreamingEvents({e:t,d:n,t:Date.now()}),50===t&&e.recordTokenRefreshes())},addTag:function(t){e.addTag&&e.addTag(t)},trackUpdatesFromSSE:function(t){e.recordUpdatesFromSSE(t)}}}var r=function(){return function(){}};return{trackEval:r,trackHttp:r,sessionLength:function(){},streamingEvent:function(){},addTag:function(){},trackUpdatesFromSSE:function(){}}}(w.telemetry,n.now),O=d&&d({settings:t,storage:w,telemetryTracker:A}),N=h(),D=S===E?function(e,t,n){var r;return void 0===n&&(n=ti),n.refreshRate&&(r=setInterval(n.clear,n.refreshRate)),{track:function(r,i){n.add(r,i)?t.track(r,i):e.debug("unique-keys-tracker: The feature "+i+" and key "+r+" exist in the filter")},stop:function(){clearInterval(r)}}}(y,w.uniqueKeys,v&&v()):void 0;switch(S){case T:_=N,k=w.impressionCounts,b={process:function(e){var t=[];return e.forEach((function(e){e.pt=_.testAndSet(e);var n=Date.now();e.pt&&k.track(e.feature,n,1),(!e.pt||e.pt<tn(n))&&t.push(e)})),{impressionsToStore:t,impressionsToListener:e,deduped:e.length-t.length}}};break;case E:b=function(e,t){return{process:function(n){return n.forEach((function(n){var r=Date.now();e.track(n.feature,r,1),t.track(n.keyName,n.feature)})),{impressionsToStore:[],impressionsToListener:n,deduped:0}}}}(w.impressionCounts,D);break;default:b=function(e){return{process:function(t){return t.forEach((function(t){t.pt=e.testAndSet(t)})),{impressionsToStore:t,impressionsToListener:t,deduped:0}}}}(N)}var I=function(e,t,n,r,i){var s=e.log,a=e.impressionListener,u=e.runtime,c=u.ip,l=u.hostname,f=e.version;return{track:function(u,h){if(e.userConsent!==F){var p=u.length,d=n.process(u),g=d.impressionsToStore,m=d.impressionsToListener,v=d.deduped,y=m.length;if(g.length>0){var S=t.track(g);_n(S)?S.then((function(){s.info(121,[p])})).catch((function(e){s.error(307,[p,e])})):i&&(i.recordImpressionStats(0,g.length),i.recordImpressionStats(2,v))}if(a||r)for(var b=function(e){var t={impression:o({},m[e]),attributes:h,ip:c,hostname:l,sdkLanguageVersion:f};setTimeout((function(){r&&r.handleImpression(t);try{a&&a.logImpression(t)}catch(e){s.error(308,[e])}}),0)},T=0;T<y;T++)b(T)}}}}(t,w.impressions,b,O,w.telemetry),L=function(e,t,n,r){var i=e.log,s=Ne(e.mode);function a(e,t){var r=e.eventTypeId,s=e.trafficTypeName,a=e.key,u=e.value,c=e.timestamp,l=e.properties,f='event of type "'+r+'" for traffic type "'+s+'". Key: '+a+". Value: "+u+". Timestamp: "+c+". "+(l?"With properties.":"With no properties.");return t?(i.info(120,[f]),n&&setTimeout((function(){var t=o({},e);l&&(t.properties=o({},l)),n.handleEvent(t)}),0)):i.error(309,[f]),t}return{track:function(n,i){if(e.userConsent===F)return!!s&&Promise.resolve(!1);var o=t.track(n,i);return _n(o)?o.then(a.bind(null,n)):(r&&r.recordEventStats(o?0:1,1),a(n,o))}}}(t,w.events,O,w.telemetry),K=i&&i(t,n,A),M={splitApi:K,eventTracker:L,impressionsTracker:I,telemetryTracker:A,uniqueKeysTracker:D,sdkReadinessManager:R,readiness:C,settings:t,storage:w,platform:n},x=a&&a(M);M.syncManager=x;var U=u&&new u(x,t,w,K);M.signalListener=U;var P=m(M),j=g(t,w.splits,R);return x&&x.start(),U&&U.start(),y.info(105),o({client:P,manager:function(){return y.debug(29),j},Logger:ei(y),settings:t},s&&s(M))}var ri={GRANTED:N,DECLINED:F,UNKNOWN:D};function ii(e){var t=e.settings,n=e.settings.log,r=e.syncManager,i=e.storage,s=i.events,o=i.impressions,a=i.impressionCounts;return mt(t)||n.info(124,[t.userConsent]),{setStatus:function(e){var i,u;if(!ue(e))return n.warn(325,["UserConsent.setStatus"]),!1;var c=e?N:F;return t.userConsent!==c?(n.info(122,[t.userConsent,c]),t.userConsent=c,e?null===(i=null==r?void 0:r.submitterManager)||void 0===i||i.start():(null===(u=null==r?void 0:r.submitterManager)||void 0===u||u.stop(!0),s.clear&&s.clear(),o.clear&&o.clear(),a&&a.clear&&a.clear())):n.info(123,[c]),!0},getStatus:function(){return t.userConsent},Status:ri}}var si=!("undefined"==typeof process||void 0===process.version||!process.version),oi="Split SDK client is ready",ai=[[300,"engine:combiner: Invalid feature flag, no valid rules found"],[301,"logger: Invalid Log Level - No changes to the logs will be applied."],[303,"The SDK will not get ready. Reason: %s"],[307,"impressions-tracker: Could not store impressions bulk with %s impression(s). Error: %s"],[308,"impressions-tracker: Impression listener logImpression method threw: %s."],[309,"events-tracker: Failed to queue %s"],[304,"sync:offline: There was an issue loading the mock feature flags data. No changes will be applied to the current cache. %s"],[305,"sync:streaming: Failed to connect or error on streaming connection, with error message: %s"],[306,"sync:streaming: Failed to authenticate for streaming. Error: %s."],[322,"Response status is not OK. Status: %s. URL: %s. Message: %s"],[302,"A listener was added for %s on the SDK, which has already fired and won't be emitted again. The callback won't be executed."],[314,"%s: Client has already been destroyed - no calls possible."],[310,'%s: you passed "%s", event_type must adhere to the regular expression /^[a-zA-Z0-9][-_.:a-zA-Z0-9]{0,79}$/g. This means an event_type must be alphanumeric, cannot be more than 80 characters long, and can only include a dash, underscore, period, or colon as separators of alphanumeric characters.'],[311,"%s: %s must be a plain object."],[312,"%s: the maximum size allowed for the properties is 32768 bytes, which was exceeded. Event not queued."],[313,"%s: value must be a finite number."],[c,"%s: you passed a null or undefined %s. It must be a non-empty string."],[316,"%s: %s too long. It must have 250 characters or less."],[317,"%s: Key must be an object with bucketingKey and matchingKey with valid string properties."],[l,"%s: you passed an invalid %s. It must be a non-empty string."],[f,"%s: you passed an empty %s. It must be a non-empty string."],[320,"%s: %s must be a non-empty array."],[325,"%s: provided param must be a boolean value."],[321,'settings: you passed an invalid "%s" config param. It should be one of the following values: %s. Defaulting to "%s".'],[323,'settings: an invalid value was received for "sync.localhostMode" config. A valid entity should be provided for localhost mode.'],[324,"settings: the provided storage is invalid.%s Falling back into default MEMORY storage"],[326,'settings: the provided "%s" config param is lower than allowed. Setting to the minimum value %s seconds'],[327,"settings: the amount of flag sets provided are big causing uri length error."],[328,"settings: the Set filter is exclusive and cannot be used simultaneously with names or prefix filters. Ignoring names and prefixes."]].concat([[200,"engine:value: Value %s doesn't match with expected type."],[201,"engine:value: Defined attribute [%s], no attributes received."],[204,"sync:my-segments: Retrying download of segments #%s. Reason: %s"],[205,d+"Error while doing fetch of feature flags. %s"],[206,"sync:streaming: Error parsing SSE error notification: %s"],[207,"sync:streaming: Error parsing SSE message notification: %s"],[208,"sync:streaming: Falling back to polling mode. Reason: %s"],[209,"sync:submitter: Dropping %s after retry. Reason: %s."],[210,"sync:submitter: Failed to push %s, keeping data to retry on next iteration. Reason: %s."],[203,"%s: the SDK is not ready, results may be incorrect%s. Make sure to wait for SDK readiness before using this method."],[202,"No listeners for SDK Readiness detected. Incorrect control treatments could have been logged if you called getTreatment/s while the SDK was not yet ready."],[211,'%s: Property "%s" is of invalid type. Setting value to null.'],[212,"%s: Event has more than 300 properties. Some of them will be trimmed when processed."],[213,'%s: %s "%s" is not of type string, converting.'],[214,'%s: %s "%s" has extra whitespace, trimming.'],[215,'%s: feature flag "%s" does not exist in this environment. Please double check what feature flags exist in the Split user interface.'],[216,"%s: traffic_type_name should be all lowercase - converting string to lowercase."],[217,'%s: traffic type "%s" does not have any corresponding feature flag in this environment, make sure you\'re tracking your events to a valid traffic type defined in the Split user interface.'],[227,"%s: you passed %s which is not part of the configured FlagSetsFilter, ignoring Flag Set."],[218,"settings: %s integration item(s) at settings is invalid. %s"],[219,"settings: feature flag filters are not applicable for Consumer modes where the SDK does not keep rollout data in sync. Filters were discarded"],[220,'settings: feature flag filter at position %s is invalid. It must be an object with a valid filter type ("bySet", "byName" or "byPrefix") and a list of "values".'],[221,"settings: feature flag filter configuration must be a non-empty array of filter objects."],[222,"settings: You already have %s. We recommend keeping only one instance of the factory at all times (Singleton pattern) and reusing it throughout your application"],[u,"sync:streaming: Fetching MySegments due to an error processing %s notification: %s"],[224,"sync:streaming: Fetching SplitChanges due to an error processing SPLIT_UPDATE notification: %s"],[225,"%s: you passed %s, flag set must adhere to the regular expressions %s. This means a flag set must start with a letter or number, be in lowercase, alphanumeric and have a max length of 50 characters. %s was discarded."],[226,"%s: flag set %s should be all lowercase - converting string to lowercase."],[228,"%s: you passed %s flag set that does not contain cached feature flag names. Please double check what flag sets are in use in the Split user interface."]]).concat([[100,oi+" from cache"],[101,oi],[102,"impressions-tracker: Feature flag: %s. Key: %s. Evaluation: %s. Label: %s"],[103,"impressions-tracker: Queueing corresponding impression."],[104,"New shared client instance created."],[105,"New Split SDK instance created."],[120,"events-tracker: Successfully queued %s"],[121,"impressions-tracker: Successfully stored %s impression(s)."],[122,"UserConsent: consent status changed from %s to %s."],[123,"UserConsent: call had no effect because it was the current consent status (%s)."],[124,"Starting the SDK with %s user consent. No data will be sent."],[106,"sync:polling-manager: Turning segments data polling %s."],[107,"sync:polling-manager: Starting polling"],[108,"sync:polling-manager: Stopping polling"],[109,d+"Retrying download of feature flags #%s. Reason: %s"],[a,"sync:submitter: Flushing full %s queue and reseting timer."],[116,"sync:submitter: Pushing %s."],[110,"sync:streaming: Refreshing streaming token in %s seconds, and connecting streaming in %s seconds."],[111,"sync:streaming: Attempting to reconnect streaming in %s seconds."],[112,"sync:streaming: Connecting streaming."],[113,"sync:streaming: Streaming is disabled for given SDK key. Switching to polling mode."],[114,"sync:streaming: Disconnecting streaming."],[117,"sync:sync-manager: Streaming not available. Starting polling."],[118,"sync:sync-manager: Streaming couldn't connect. Continue polling."],[119,"sync:sync-manager: Streaming connected. Syncing and stopping polling."]]).concat([[0,"engine:combiner: [andCombiner] evaluates to %s"],[1,"engine:combiner: Treatment found: %s"],[2,"engine:combiner: All predicates evaluated, no treatment found."],[3,'engine: using algo "murmur" bucket %s for key %s using seed %s - treatment %s'],[4,"engine:matcher: [allMatcher] is always true"],[5,"engine:matcher: [betweenMatcher] is %s between %s and %s? %s"],[6,"engine:matcher: [booleanMatcher] %s === %s"],[7,"engine:matcher: [containsAllMatcher] %s contains all elements of %s? %s"],[8,"engine:matcher: [containsAnyMatcher] %s contains at least an element of %s? %s"],[9,"engine:matcher: [containsStringMatcher] %s contains %s? %s"],[10,'engine:matcher: [dependencyMatcher] parent feature flag "%s" evaluated to "%s" with label "%s". %s evaluated treatment is part of [%s] ? %s.'],[11,'engine:matcher: [dependencyMatcher] will evaluate parent feature flag: "%s" with key: %s %s'],[12,"engine:matcher: [equalToMatcher] is %s equal to %s? %s"],[13,"engine:matcher: [equalToSetMatcher] is %s equal to set %s? %s"],[14,"engine:matcher: [endsWithMatcher] %s ends with %s? %s"],[15,"engine:matcher: [greaterThanEqualMatcher] is %s greater than %s? %s"],[16,"engine:matcher: [lessThanEqualMatcher] is %s less than %s? %s"],[17,"engine:matcher: [partOfMatcher] %s is part of %s? %s"],[18,"engine:matcher: [segmentMatcher] evaluated %s / %s => %s"],[19,"engine:matcher: [stringMatcher] does %s matches with %s? %s"],[20,"engine:matcher: [stringMatcher] %s is an invalid regex"],[21,"engine:matcher: [startsWithMatcher] %s starts with %s? %s"],[22,"engine:matcher: [whitelistMatcher] evaluated %s in [%s] => %s"],[23,"engine:value: Extracted attribute [%s], [%s] will be used for matching."],[24,"engine:sanitize: Attempted to sanitize [%s] which should be of type [%s]. Sanitized and processed value => [%s]"],[25,"cleanup: Registering cleanup handler %s"],[26,"cleanup: Deregistering cleanup handler %s"],[27,"Retrieving default SDK client."],[28,"Retrieving existing SDK client."],[29,"Retrieving manager instance."],[30,"sync:offline: Feature flags data: \n%s"],[31,d+"Spin up feature flags update using since = %s"],[32,d+"New feature flags %s"],[33,d+"Removed feature flags %s"],[34,d+"Segment names collected %s"],[35,"sync:streaming: New SSE message received, with data: %s."],[36,"sync: Starting %s. Running each %s millis"],[37,"sync: Running %s"],[38,"sync: Stopping %s"],[39,'settings: feature flags filtering criteria is "%s".']]),ui=new Rr(ai),ci=String(si?process.env.SPLITIO_DEBUG:an()?localStorage.getItem("splitio_debug"):""),li=Yr.NONE;function fi(e){var t=e.treatment;return e.keys?{conditionType:"WHITELIST",matcherGroup:{combiner:"AND",matchers:[{keySelector:null,matcherType:"WHITELIST",negate:!1,whitelistMatcherData:{whitelist:he(e.keys)?[e.keys]:e.keys}}]},partitions:[{treatment:t,size:100}],label:"whitelisted "+t}:{conditionType:"ROLLOUT",matcherGroup:{combiner:"AND",matchers:[{keySelector:null,matcherType:"ALL_KEYS",negate:!1}]},partitions:[{treatment:t,size:100}],label:"default rule"}}function hi(){return Promise.resolve()}/^(enabled?|on)/i.test(ci)?li=Yr.DEBUG:Jr(ci)&&(li=ci);var pi,di=(pi=function(){var e={emptyMock:"1"};return function(t){var n,r,i=t.features||{};if(n=i,!((r=Object.keys(n)).length!==Object.keys(e).length?(e=n,1):r.some((function(t){var r,i,s=!e[t],o=typeof(r=e[t])!=typeof(i=n[t])||("string"==typeof r?r!==i:r.treatment!==i.treatment||r.config!==i.config),a=s||o;return a&&(e=n),a}))))return!1;var s={};return oe(i,(function(e,t){var n=e,r=null;fe(e)&&(n=e.treatment,r=e.config||r);var i={};null!==r&&(i[n]=r),s[t]={trafficTypeName:"localhost",conditions:[fi({treatment:n})],configurations:i}})),s}},function(e){var t=e.settings,n=e.readiness,r=e.storage;return o(function(e,t,n,r){return V(r.log,function(e,t,n,r){var i=r.log,s=t.splits,o=!0;return function(){var t=[],a=null,u={};try{u=e(r)}catch(e){a=e,i.error(304,[e])}return!a&&u?(i.debug(30,[JSON.stringify(u)]),oe(u,(function(e,n){t.push([n,{name:n,status:"ACTIVE",killed:!1,trafficAllocation:100,defaultTreatment:m,conditions:e.conditions||[],configurations:e.configurations,trafficTypeName:e.trafficTypeName}])})),Promise.all([s.clear(),s.addSplits(t)]).then((function(){return n.splits.emit(_e),o&&(o=!1,Promise.resolve(s.checkCache()).then((function(e){e&&n.splits.emit(ke),n.segments.emit(Re)}))),!0}))):Promise.resolve(!0)}}(e,t,n,r),r.scheduler.offlineRefreshRate,"offlineUpdater")}(pi(),r,n,t),{flush:hi,shared:function(e,t){return{start:function(){setTimeout((function(){t.segments.emit(Re)}),0)},stop:function(){},isRunning:function(){return!0},flush:hi}}})});di.type="LocalhostFromObject";var gi=[F,N,D],mi="LOCALSTORAGE";function vi(e,t){return void 0===t&&(t=[]),function(e,n,r){var i=e.integrations,s=e.log;if(!Array.isArray(i)||0===i.length)return[];var o=i.filter((function(e){return e&&he(e.type)&&t.indexOf(e.type)>-1})),a=i.length-o.length;return a&&s.warn(218,[a,'Integration items must have a valid "type" value']),o}(e)}var yi,Si={defaults:{startup:{requestTimeoutBeforeReady:5,retriesOnFailureBeforeReady:1,readyTimeout:10,eventsFirstPushWindow:10},userConsent:N,version:"javascript-10.25.2"},acceptKey:!0,acceptTT:!0,runtime:function(){return{ip:!1,hostname:!1}},storage:function(e){var t,n=e.log,r=e.mode,i=e.storage,s=void 0===i?{type:A}:i,o=s.type,a=s.options,u=void 0===a?{}:a,c=s.prefix,l=function(){t=o,o=A};return r===_&&o===mi&&l(),(o!==A&&o!==mi||o===mi&&!an())&&(l(),n.error("Invalid or unavailable storage. Fallbacking into MEMORY storage")),{type:o,options:u,prefix:c,__originalType:t}},integrations:function(e){return vi(e,[mn,vn])},logger:function(e){var t,n=e.debug,r=void 0!==n?"boolean"==typeof(t=n)?t?Yr.DEBUG:Yr.NONE:"string"==typeof t&&Jr(t)?t:void 0:li,i=new Xr({logLevel:r||li},ui);return r||i._log(Yr.ERROR,"Invalid Log Level - No changes to the logs will be applied."),i},localhost:function(){return di},consent:function(e){var t=e.userConsent,n=e.log;return t=pe(t),gi.indexOf(t)>-1?t:(n.error(321,["userConsent",gi,N]),N)}},bi="object"==typeof Reflect?Reflect:null,Ti=bi&&"function"==typeof bi.apply?bi.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};yi=bi&&"function"==typeof bi.ownKeys?bi.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var Ei=Number.isNaN||function(e){return e!=e};function _i(){_i.init.call(this)}_i.prototype._events=void 0,_i.prototype._eventsCount=0,_i.prototype._maxListeners=void 0;var ki=10;function Ri(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function Ci(e){return void 0===e._maxListeners?_i.defaultMaxListeners:e._maxListeners}function wi(e,t,n,r){var i,s,o,a;if(Ri(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]),void 0===o)o=s[t]=n,++e._eventsCount;else if("function"==typeof o?o=s[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(i=Ci(e))>0&&o.length>i&&!o.warned){o.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=o.length,a=u,console&&console.warn&&console.warn(a)}return e}function Ai(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Oi(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=Ai.bind(r);return i.listener=n,r.wrapFn=i,i}function Ni(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):Di(i,i.length)}function Fi(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function Di(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function Ii(e,t){return t=t||{},new Promise((function(n,r){var i=new XMLHttpRequest,s=[],o=[],a={},u=function(){return{ok:2==(i.status/100|0),statusText:i.statusText,status:i.status,url:i.responseURL,text:function(){return Promise.resolve(i.responseText)},json:function(){return Promise.resolve(i.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([i.response]))},clone:u,headers:{keys:function(){return s},entries:function(){return o},get:function(e){return a[e.toLowerCase()]},has:function(e){return e.toLowerCase()in a}}}};for(var c in i.open(t.method||"get",e,!0),i.onload=function(){i.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(e,t,n){s.push(t=t.toLowerCase()),o.push([t,n]),a[t]=a[t]?a[t]+","+n:n})),n(u())},i.onerror=r,i.withCredentials="include"==t.credentials,t.headers)i.setRequestHeader(c,t.headers[c]);i.send(t.body||null)}))}Object.defineProperty(_i,"defaultMaxListeners",{enumerable:!0,get:function(){return ki},set:function(e){if("number"!=typeof e||e<0||Ei(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");ki=e}}),_i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},_i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||Ei(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},_i.prototype.getMaxListeners=function(){return Ci(this)},_i.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var a=i[e];if(void 0===a)return!1;if("function"==typeof a)Ti(a,this,t);else{var u=a.length,c=Di(a,u);for(n=0;n<u;++n)Ti(c[n],this,t)}return!0},_i.prototype.addListener=function(e,t){return wi(this,e,t,!1)},_i.prototype.on=_i.prototype.addListener,_i.prototype.prependListener=function(e,t){return wi(this,e,t,!0)},_i.prototype.once=function(e,t){return Ri(t),this.on(e,Oi(this,e,t)),this},_i.prototype.prependOnceListener=function(e,t){return Ri(t),this.prependListener(e,Oi(this,e,t)),this},_i.prototype.removeListener=function(e,t){var n,r,i,s,o;if(Ri(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){o=n[s].listener,i=s;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},_i.prototype.off=_i.prototype.removeListener,_i.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,s=Object.keys(n);for(r=0;r<s.length;++r)"removeListener"!==(i=s[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},_i.prototype.listeners=function(e){return Ni(this,e,!0)},_i.prototype.rawListeners=function(e){return Ni(this,e,!1)},_i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):Fi.call(e,t)},_i.prototype.listenerCount=Fi,_i.prototype.eventNames=function(){return this._eventsCount>0?yi(this._events):[]};var Li,Ki,Mi="visibilitychange",xi="pagehide",Ui="for visibilitychange and pagehide events.",Pi=function(){function e(e,t,n,r){this.syncManager=e,this.settings=t,this.storage=n,this.serviceApi=r,this.flushData=this.flushData.bind(this),this.flushDataIfHidden=this.flushDataIfHidden.bind(this),this.fromImpressionsCollector=be.bind(void 0,t.core.labelsEnabled)}return e.prototype.start=function(){this.settings.log.debug(25,[Ui]),"undefined"!=typeof document&&document.addEventListener&&document.addEventListener(Mi,this.flushDataIfHidden),"undefined"!=typeof window&&window.addEventListener&&window.addEventListener(xi,this.flushData)},e.prototype.stop=function(){this.settings.log.debug(26,[Ui]),"undefined"!=typeof document&&document.removeEventListener&&document.removeEventListener(Mi,this.flushDataIfHidden),"undefined"!=typeof window&&window.removeEventListener&&window.removeEventListener(xi,this.flushData)},e.prototype.flushData=function(){if(this.syncManager){var e=this.settings.urls,t=e.events,n=e.telemetry;if(mt(this.settings)){var r=this.settings.sync.impressionsMode,i={sim:r===T?T:r===b?b:E};this._flushData(t+"/testImpressions/beacon",this.storage.impressions,this.serviceApi.postTestImpressionsBulk,this.fromImpressionsCollector,i),this._flushData(t+"/events/beacon",this.storage.events,this.serviceApi.postEventsBulk),this.storage.impressionCounts&&this._flushData(t+"/testImpressions/count/beacon",this.storage.impressionCounts,this.serviceApi.postTestImpressionsCount,Ee),this.storage.uniqueKeys&&this._flushData(n+"/v1/keys/cs/beacon",this.storage.uniqueKeys,this.serviceApi.postUniqueKeysBulkCs)}this.storage.telemetry&&this._flushData(n+"/v1/metrics/usage/beacon",this.storage.telemetry,this.serviceApi.postMetricsUsage)}},e.prototype.flushDataIfHidden=function(){"hidden"===document.visibilityState&&this.flushData()},e.prototype._flushData=function(e,t,n,r,i){if(!t.isEmpty()){var s=r?r(t.pop()):t.pop();this._sendBeacon(e,s,i)||n(JSON.stringify(s)).catch((function(){}))}},e.prototype._sendBeacon=function(e,t,n){if("undefined"!=typeof navigator&&navigator.sendBeacon){var r={entries:t,token:this.settings.core.authorizationKey,sdk:this.settings.version};n&&o(r,n);var i=JSON.stringify(r);try{return navigator.sendBeacon(e,i)}catch(e){return!1}}return!1},e}(),ji={getFetch:function(){return"function"==typeof fetch?fetch:Ii},getEventSource:function(){return"function"==typeof EventSource?EventSource:void 0},EventEmitter:_i,now:"object"==typeof performance&&"function"==typeof performance.now?performance.now.bind(performance):Date.now},Bi=Pi,qi=(Li=function(e){var t=e.splitApi,n=e.storage,r=e.readiness,i=e.settings,s=i.log,o=function(e,t,n,r,i){return V(r.log,Xt(r.log,function(e){return function(t,n,r,i){var s=e(t,n,r);return i&&(s=i(s)),s.then((function(e){return e.json()}))}}(e),t.splits,t.segments,r.sync.__splitFiltersValidation,n.splits,r.startup.requestTimeoutBeforeReady,r.startup.retriesOnFailureBeforeReady,!0),r.scheduler.featuresRefreshRate,"splitChangesUpdater")}(t.fetchSplitChanges,n,r,i),a={},u=f(Lt(i.core.key),r,n);function c(){oe(a,(function(e){e.start()}))}function l(){oe(a,(function(e){e.isRunning()&&e.stop()}))}function f(e,n,r){var s=function(e,t,n,r,i){return V(r.log,$t(r.log,function(e){return function(t,n,r){var i=e(t,n);return r&&(i=r(i)),i.then((function(e){return e.json()})).then((function(e){return e.mySegments.map((function(e){return e.name}))}))}}(e),t.splits,t.segments,n.segments,r.startup.requestTimeoutBeforeReady,r.startup.retriesOnFailureBeforeReady,i),r.scheduler.segmentsRefreshRate,"mySegmentsUpdater")}(t.fetchMySegments,r,n,i,e);function o(){n.isReady()||r.splits.usesSegments()||n.segments.emit(Re)}return r.splits.usesSegments()?n.splits.once(_e,o):setTimeout(o,0),a[e]=s,s}return r.splits.on(_e,(function(){if(o.isRunning()){var e=n.splits.usesSegments();e!==u.isRunning()&&(s.info(106,[e?"ON":"OFF"]),e?c():l())}})),{splitsSyncTask:o,segmentsSyncTask:u,start:function(){s.info(107),o.start(),n.splits.usesSegments()&&c()},stop:function(){s.info(108),o.isRunning()&&o.stop(),l()},isRunning:o.isRunning,syncAll:function(){var e=[o.execute()];return oe(a,(function(t){e.push(t.execute())})),Promise.all(e)},add:f,remove:function(e){delete a[e]},get:function(e){return a[e]}}},Ki=function(e,t){var n,r=e.settings,i=e.storage,s=e.splitApi,a=e.readiness,c=e.platform,l=e.telemetryTracker,f=r.core.key?Lt(r.core.key):void 0,h=r.log;try{n=new It(r,!f,c.getEventSource)}catch(e){return void h.warn(208,[e])}var p,d=(p=s.fetchAuth,function(e){return p(e).then((function(e){return e.json()})).then((function(e){if(e.token){var t=(r=e.token.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),i=decodeURIComponent(Et(r).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join("")),JSON.parse(i));if("number"!=typeof t.iat||"number"!=typeof t.exp)throw new Error('token properties "issuedAt" (iat) or "expiration" (exp) are missing or invalid');var n=JSON.parse(t["x-ably-capability"]);return o({decodedToken:t,channels:n},e)}var r,i;return e}))}),g=new c.EventEmitter,m=function(e,t,n){var r=function(e,t){var n=yt.map((function(e){return{regex:e,hasPublishers:!0,oTime:-1,cTime:-1}})),r=!0,i=!0;return{handleOpen:function(){t.streamingEvent(0),e.emit(at)},isStreamingUp:function(){return i&&r},handleOccupancyEvent:function(s,o,a){for(var u=0;u<n.length;u++){var c=n[u];if(c.regex.test(o)){if(t.streamingEvent(St[u],s),a>c.oTime){c.oTime=a,c.hasPublishers=0!==s;var l=n.some((function(e){return e.hasPublishers}));i&&(!l&&r?e.emit(ut):l&&!r&&e.emit(at)),r=l}return}}},handleControlEvent:function(s,o,a){if(s!==it.STREAMING_RESET)for(var u=0;u<n.length;u++){var c=n[u];if(c.regex.test(o))return void(a>c.cTime&&(c.cTime=a,s===it.STREAMING_DISABLED?(t.streamingEvent(30,0),e.emit(st)):r&&(s===it.STREAMING_PAUSED&&i?(t.streamingEvent(30,2),e.emit(ut)):s!==it.STREAMING_RESUMED||i||(t.streamingEvent(30,1),e.emit(at))),i=s===it.STREAMING_RESUMED))}else e.emit(s)}}}(t,n);return{handleOpen:function(){r.handleOpen()},handleError:function(r){var i=r;try{i=function(e){return he(e.data)&&(e.parsedData=JSON.parse(e.data)),e}(r)}catch(t){e.warn(206,[t])}var s=i.parsedData&&i.parsedData.message||i.message;e.error(305,[s]),function(e){if(e.parsedData&&e.parsedData.code){var t=e.parsedData.code;if(n.streamingEvent(60,t),40140<=t&&t<=40149)return!0;if(4e4<=t&&t<=49999)return!1}else n.streamingEvent(40,1);return!0}(i)?t.emit(ot):t.emit(st)},handleMessage:function(n){var i;try{if(i=function(e){if(e.data){var t=JSON.parse(e.data);return t.parsedData=JSON.parse(t.data),t.name&&"[meta]occupancy"===t.name&&(t.parsedData.type=gt),t}}(n),!i)return}catch(t){return void e.warn(207,[t])}var s=i.parsedData,o=i.data,a=i.channel,u=i.timestamp;if(e.debug(35,[o]),r.isStreamingUp()||-1!==[gt,dt].indexOf(s.type))switch(s.type){case pt:case ft:case lt:case ht:t.emit(s.type,s);break;case ct:t.emit(s.type,s,a);break;case gt:r.handleOccupancyEvent(s.metrics.publishers,a,u);break;case dt:r.handleControlEvent(s.controlType,a,u)}}}}(h,g,l);n.setEventHandler(m);var v,y,S,b,T=f?void 0:function(e,t,n){var r={};return{put:function(i){var s=i.changeNumber,o=i.segmentName;r[o]||(r[o]=function(r){var i,s,o=0,a=!1,u=new vt(c,1e4,6e4);function c(){i=!0,o>n.getChangeNumber(r)?(a=!1,t.execute(!1,r,!0,s?o:void 0).then((function(){if(i)if(a)c();else{var t=u.attempts+1;if(o<=n.getChangeNumber(r))return e.debug("Refresh completed"+(s?" bypassing the CDN":"")+" in "+t+" attempts."),void(i=!1);if(t<10)return void u.scheduleCall();s?(e.debug("No changes fetched after "+t+" attempts with CDN bypassed."),i=!1):(u.reset(),s=!0,c())}}))):i=!1}return{put:function(e){e<=n.getChangeNumber(r)||e<=o||(o=e,a=!0,s=!1,!u.timeoutID&&i||c(),u.reset())},stop:function(){i=!1,u.reset()}}}(o)),r[o].put(s)},stop:function(){Object.keys(r).forEach((function(e){return r[e].stop()}))}}}(h,t.segmentsSyncTask,i.segments),E=function(e,t,n,r,i,s){var o,a,u,c=0,l=!1,f=new vt(h,1e4,6e4);function h(){if(o=!0,c>t.getChangeNumber()){l=!1;var r=u?{payload:u,changeNumber:c}:void 0;n.execute(!0,a?c:void 0,r).then((function(){if(o)if(l)h();else{r&&i.trackUpdatesFromSSE("sp"),s&&s.execute(!0);var n=f.attempts+1;if(c<=t.getChangeNumber())return e.debug("Refresh completed"+(a?" bypassing the CDN":"")+" in "+n+" attempts."),void(o=!1);if(n<10)return void f.scheduleCall();a?(e.debug("No changes fetched after "+n+" attempts with CDN bypassed."),o=!1):(f.reset(),a=!0,h())}}))}else o=!1}function p(e,n){var r=e.changeNumber,i=e.pcn,s=t.getChangeNumber();r<=s||r<=c||(c=r,l=!0,a=!1,u=void 0,n&&s===i&&(u=n),!f.timeoutID&&o||h(),f.reset())}return{put:p,killSplit:function(e){var n=e.changeNumber,i=e.splitName,s=e.defaultTreatment;t.killLocally(i,s,n)&&r.emit(_e,!0),p({changeNumber:n})},stop:function(){o=!1,f.reset()}}}(h,i.splits,t.splitsSyncTask,a.splits,l,f?void 0:t.segmentsSyncTask),_={},k={},R=!1,C=new vt(w,r.scheduler.pushRetryBackoffBase);function w(){if(!v){h.info(112),v=!1;var e=f?Object.keys(k):void 0;d(e).then((function(t){if(!v)return t.pushEnabled?void(e&&e.length<Object.keys(k).length||function(e){S&&clearTimeout(S),b&&clearTimeout(b);var t=e.decodedToken,r=t.exp-t.iat-600,i="number"==typeof e.connDelay&&e.connDelay>=0?e.connDelay:60;h.info(110,[r,i]),S=setTimeout(w,1e3*r),b=setTimeout((function(){v||n.open(e)}),1e3*i),l.streamingEvent(50,t.exp)}(t)):(h.info(113),void g.emit(st))})).catch((function(e){if(!v){if(h.error(306,[e.message]),e.statusCode>=400&&e.statusCode<500)return l.streamingEvent(80),void g.emit(st);g.emit(ot)}}))}}function A(){v||(v=!0,n.close(),h.info(114),S&&clearTimeout(S),b&&clearTimeout(b),C.reset(),O())}function O(){E.stop(),f?oe(k,(function(e){return e.worker.stop()})):T.stop()}return g.on(ut,O),g.on(at,(function(){C.reset()})),g.on(st,(function(){y=!0,A(),g.emit(ut)})),g.on(ot,(function(){n.close();var e=C.scheduleCall();h.info(111,[e/1e3]),g.emit(ut)})),g.on(it.STREAMING_RESET,(function(){v||(S&&clearTimeout(S),w())})),g.on(ht,E.killSplit),g.on(pt,(function(e){if(e.d&&void 0!==e.c)try{var t=(n=e.c,r=e.d,n>0?Ut(r,n,!1):JSON.parse(Et(r)));if(t)return void E.put(e,t)}catch(e){h.warn(224,[e])}var n,r;E.put(e)})),f?(g.on(ct,(function(e,t){var n=t.split("_")[2],r=_[n];r&&k[r]&&k[r].worker.put(e.changeNumber,e.includesPayload?e.segmentList?e.segmentList:[]:void 0)})),g.on(lt,(function(e){switch(e.u){case Ft.BoundedFetchRequest:var t;try{s=e.d,o=e.c,t=xt(s,o)}catch(e){h.warn(u,["BoundedFetchRequest",e]);break}return void oe(k,(function(n){var r,i,s,o,a=n.hash64,u=n.worker;r=t,i=a.hex,o=(s=parseInt(i.slice(8),16)%(8*r.length))%8,(r[Math.floor(s/8)]&1<<o)>0&&u.put(e.changeNumber)}));case Ft.KeyList:var n,r,i=void 0;try{i=Ut(e.d,e.c),n=new Bt(i.a),r=new Bt(i.r)}catch(e){h.warn(u,["KeyList",e]);break}return void oe(k,(function(t){var i=t.hash64,s=t.worker,o=!!n.has(i.dec)||!r.has(i.dec)&&void 0;void 0!==o&&s.put(e.changeNumber,{name:e.segmentName,add:o})}));case Ft.SegmentRemoval:if(!e.segmentName){h.warn(u,["SegmentRemoval","No segment name was provided"]);break}return void oe(k,(function(t){return t.worker.put(e.changeNumber,{name:e.segmentName,add:!1})}))}var s,o;oe(k,(function(t){t.worker.put(e.changeNumber)}))}))):g.on(ft,T.put),o(Object.create(g),{stop:function(){A(),f&&this.remove(f)},start:function(){y||!1===v||(v=!1,f?this.add(f,t.segmentsSyncTask):setTimeout(w))},isRunning:function(){return!1===v},add:function(e,t){var n,r,i=Ot(e);_[i]||(_[i]=e,k[e]={hash64:(n=e,r=Vt(n).slice(0,16),{hex:r,dec:Jt(r)}),worker:bt(t,l)},R=!0,setTimeout((function(){R&&(R=!1,w())}),0))},remove:function(e){var t=Ot(e);delete _[t],delete k[e]}})},function(e){var t=e.settings,n=e.settings,r=n.log,i=n.streamingEnabled,s=n.sync.enabled,o=e.telemetryTracker,a=Li&&Li(e),u=s&&i&&a&&Ki?Ki(e,a):void 0,c=rt(e);u&&(u.on(at,(function(){r.info(119),a.isRunning()&&(a.stop(),o.streamingEvent(70,0)),a.syncAll()})),u.on(ut,(function(){a.isRunning()?r.info(118):(r.info(117),a.start(),o.streamingEvent(70,1))})));var l=!1,f=!0;return{pollingManager:a,pushManager:u,submitterManager:c,start:function(){l=!0,a&&(s?u?(f&&(a.syncAll(),f=!1),u.start()):a.start():f&&(a.syncAll(),f=!1)),c.start(!mt(t))},stop:function(){l=!1,u&&u.stop(),a&&a.isRunning()&&a.stop(),c.stop()},isRunning:function(){return l},flush:function(){return c.execute(!mt(t))},shared:function(e,t,n){if(a){var r=a.add(e,t,n);return{isRunning:r.isRunning,start:function(){s?u?(a.isRunning()?n.splits.usesSegments()&&r.start():r.execute(),u.add(e,r)):n.splits.usesSegments()&&r.start():t.isReady()||r.execute()},stop:function(){var t=a.get(e);t&&(u&&u.remove(e),t.isRunning()&&t.stop(),a.remove(e))},flush:function(){return Promise.resolve()}}}}}});function Wi(e){return e.storage.type===O?function(e){void 0===e&&(e={});var t=function(e){return e?e+".SPLITIO":"SPLITIO"}(e.prefix);function n(e){if(!an())return e.settings.log.warn(ln+"LocalStorage API is unavailable. Falling back to default MEMORY storage"),En(e);var n=e.settings,r=e.settings,i=r.log,s=r.scheduler,o=s.impressionsQueueSize,a=s.eventsQueueSize,u=r.sync,c=u.impressionsMode,l=u.__splitFiltersValidation,f=Lt(n.core.key),h=new on(t,f),p=Date.now()-864e6,d=new fn(n,h,p),g=new pn(i,h);return{splits:d,segments:g,impressions:new en(o),impressionCounts:c!==b?new nn:void 0,events:new rn(a),telemetry:Sn(e)?new bn(d,g):void 0,uniqueKeys:c===E?new Tn:void 0,destroy:function(){var e;this.splits=new gn(l),this.segments=new dn,this.impressions.clear(),this.impressionCounts&&this.impressionCounts.clear(),this.events.clear(),null===(e=this.uniqueKeys)||void 0===e||e.clear()},shared:function(e){var n=new on(t,e);return{splits:this.splits,segments:new pn(i,n),impressions:this.impressions,impressionCounts:this.impressionCounts,events:this.events,telemetry:this.telemetry,destroy:function(){this.splits=new gn(l),this.segments=new dn}}}}}return n.type=O,n}(e.storage):e.storage.__originalType===O?zr:En}function zi(e,t){var n=function(e){return Ge(e,Si)}(e),r=function(e){var t={settings:e,platform:ji,storageFactory:Wi(e),splitApiFactory:Y,syncManagerFactory:qi,sdkManagerFactory:In,sdkClientMethodFactory:_r,SignalListener:Bi,integrationsManagerFactory:e.integrations&&e.integrations.length>0?Wr.bind(null,e.integrations):void 0,impressionsObserverFactory:Fr,extraProps:function(e){return{UserConsent:ii(e)}}};return e.mode===_&&(t.splitApiFactory=void 0,t.syncManagerFactory=e.sync.localhostMode,t.SignalListener=void 0),t}(n);return t&&t(r),ni(r)}var Hi=r(24),Gi=r.n(Hi),Qi={treatment:"control",config:null},Yi="[WARN]  Both a config and factory props were provided to SplitFactoryProvider. Config prop will be ignored.";if(!Gi()||!Gi().createContext)throw new Error("React library is not available or its version is not supported. Check that it is properly installed or imported. Split SDK requires version 16.3.0+ of React.");var Vi=Gi().createContext({client:null,factory:null,isReady:!1,isReadyFromCache:!1,isTimedout:!1,hasTimedout:!1,lastUpdate:0,isDestroyed:!1});function Ji(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}var Zi=r(774),$i=r.n(Zi),Xi=new Map;function es(e){if(!Xi.has(e)){var t=zi(e,(function(e){e.settings.version="react-1.11.1"}));t.clientInstances=new Set,t.config=e,Xi.set(e,t)}return Xi.get(e)}function ts(e,t,n){var r=void 0!==t?e.client(t,n):e.client();if(void 0===r.lastUpdate){var i=function(){var e=Date.now();r.lastUpdate=e>r.lastUpdate?e:r.lastUpdate+1};r.lastUpdate=0,r.on(r.Event.SDK_READY,i),r.on(r.Event.SDK_READY_FROM_CACHE,i),r.on(r.Event.SDK_READY_TIMED_OUT,i),r.on(r.Event.SDK_UPDATE,i)}return e.clientInstances&&e.clientInstances.add(r),r}function ns(e){var t=[];return e.clientInstances.forEach((function(e){return t.push(e.destroy())})),e.clientInstances.clear(),Xi.delete(e.config),Promise.all(t)}function rs(e){var t=e&&e.__getStatus(),n=!!t&&t.isReady,r=!!t&&t.hasTimedout;return{isReady:n,isReadyFromCache:!!t&&t.isReadyFromCache,isTimedout:r&&!n,hasTimedout:r,isDestroyed:!!t&&t.isDestroyed,lastUpdate:e&&e.lastUpdate||0}}function is(e,t){e&&t&&e.setAttributes(t)}var ss=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/;function os(){return function(e,t){var n;void 0===t&&(t=Ji);var r,i=[],s=!1;return function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];return s&&n===this&&t(o,i)||(r=e.apply(this,o),s=!0,n=this,i=o),r}}(us,as)}function as(e,t){return e[0]===t[0]&&e[1]===t[1]&&$i()(e[2],t[2])&&$i()(e[3],t[3])&&$i()(e[4],t[4])&&$i()(e[5],t[5])}function us(e,t,n,r,i,s){return n&&s&&console.log("[WARN]  Both names and flagSets properties were provided. flagSets will be ignored."),e&&e.__getStatus().isOperational&&(n||s)?n?e.getTreatmentsWithConfig(n,r):e.getTreatmentsWithConfigByFlagSets(s,r):n&&(o=function(e,t){if(void 0===t&&(t="feature flag names"),Array.isArray(e)&&e.length>0){var n=[];if(e.forEach((function(e){var t=function(e,t){if(void 0===t&&(t="feature flag name"),null==e)console.log("[ERROR] you passed a null or undefined "+t+", "+t+" must be a non-empty string.");else if("string"==typeof(n=e)||n instanceof String){if(ss.test(e)&&(console.log("[WARN] "+t+' "'+e+'" has extra whitespace, trimming.'),e=e.trim()),e.length>0)return e;console.log("[ERROR] you passed an empty "+t+", "+t+" must be a non-empty string.")}else console.log("[ERROR] you passed an invalid "+t+", "+t+" must be a non-empty string.");var n;return!1}(e);t&&n.push(t)})),n.length)return r={},n.filter((function(e){return!Object.prototype.hasOwnProperty.call(r,e)&&(r[e]=!0)}))}var r;return console.log("[ERROR] "+t+" must be a non-empty array."),!1}(n))?o.reduce((function(e,t){return e[t]=Qi,e}),{}):{};var o}var cs={updateOnSdkUpdate:!1,updateOnSdkTimedout:!1,updateOnSdkReady:!0,updateOnSdkReadyFromCache:!0};function ls(e){var t=ne(ne({},cs),e),n=t.updateOnSdkReady,r=t.updateOnSdkReadyFromCache,i=t.updateOnSdkTimedout,s=t.updateOnSdkUpdate,o=t.splitKey,a=t.trafficType,u=t.attributes,c=Gi().useContext(Vi),l=c.client,f=c.factory,h=l;o&&f&&(h=ts(f,o,a)),is(h,u);var p=rs(h),d=Gi().useState(p.lastUpdate)[1];return Gi().useEffect((function(){if(h){var e=function(){return d(h.lastUpdate)},t=rs(h);return n&&(t.isReady?p.isReady||e():h.once(h.Event.SDK_READY,e)),r&&(t.isReadyFromCache?p.isReadyFromCache||e():h.once(h.Event.SDK_READY_FROM_CACHE,e)),i&&(t.hasTimedout?p.hasTimedout||e():h.once(h.Event.SDK_READY_TIMED_OUT,e)),s&&h.on(h.Event.SDK_UPDATE,e),function(){h.off(h.Event.SDK_READY,e),h.off(h.Event.SDK_READY_FROM_CACHE,e),h.off(h.Event.SDK_READY_TIMED_OUT,e),h.off(h.Event.SDK_UPDATE,e)}}}),[h,n,r,i,s,p]),ne({factory:f,client:h},p)}var fs=function(e){function t(t){var n=e.call(this,t)||this;n.update=function(){n.setState({lastUpdate:n.state.client.lastUpdate})};var r=t.factory,i=t.client;return n.state=ne({factory:r,client:i},rs(i)),n}return te(t,e),t.getDerivedStateFromProps=function(e,t){var n=e.client,r=e.factory;is(n,e.attributes);var i=rs(n);return n!==t.client||i.isReady!==t.isReady||i.isReadyFromCache!==t.isReadyFromCache||i.hasTimedout!==t.hasTimedout||i.isDestroyed!==t.isDestroyed?ne({client:n,factory:r},i):null},t.prototype.subscribeToEvents=function(e){if(e){var t=rs(e),n=this.state;this.props.updateOnSdkReady&&(t.isReady?n.isReady||this.update():e.once(e.Event.SDK_READY,this.update)),this.props.updateOnSdkReadyFromCache&&(t.isReadyFromCache?n.isReadyFromCache||this.update():e.once(e.Event.SDK_READY_FROM_CACHE,this.update)),this.props.updateOnSdkTimedout&&(t.hasTimedout?n.hasTimedout||this.update():e.once(e.Event.SDK_READY_TIMED_OUT,this.update)),this.props.updateOnSdkUpdate&&e.on(e.Event.SDK_UPDATE,this.update)}},t.prototype.unsubscribeFromEvents=function(e){e&&(e.off(e.Event.SDK_READY,this.update),e.off(e.Event.SDK_READY_FROM_CACHE,this.update),e.off(e.Event.SDK_READY_TIMED_OUT,this.update),e.off(e.Event.SDK_UPDATE,this.update))},t.prototype.componentDidMount=function(){this.subscribeToEvents(this.props.client)},t.prototype.componentDidUpdate=function(e){this.props.client!==e.client&&(this.unsubscribeFromEvents(e.client),this.subscribeToEvents(this.props.client))},t.prototype.componentWillUnmount=function(){this.unsubscribeFromEvents(this.props.client)},t.prototype.render=function(){var e=this.props.children;return Gi().createElement(Vi.Provider,{value:this.state},"function"==typeof e?e(ne({},this.state)):e)},t.defaultProps=ne({children:null,factory:null,client:null},cs),t}(Gi().Component);function hs(e){return Gi().createElement(Vi.Consumer,null,(function(t){var n=t.factory,r=n?ts(n,e.splitKey,e.trafficType):null;return Gi().createElement(fs,ne({},e,{factory:n,client:r,attributes:e.attributes}))}))}var ps=function(e){function t(t){var n=e.call(this,t)||this,r=t.factory,i=t.config;i||r||console.error("[ERROR] SplitFactory must receive either a Split config or a Split factory as props."),i&&r&&console.log(Yi);var s=null;r?s=r:i&&(s=es(i)),n.isFactoryExternal=!!r;var o=s?ts(s):null;return n.state={client:o,factory:s},n}return te(t,e),t.prototype.componentWillUnmount=function(){!this.isFactoryExternal&&this.state.factory&&ns(this.state.factory)},t.prototype.render=function(){var e=this.state,t=e.factory,n=e.client;return Gi().createElement(fs,ne({},this.props,{factory:t,client:n}))},t.defaultProps=ne({children:null},cs),t}(Gi().Component),ds=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.evaluateFeatureFlags=os(),t}return te(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.names,r=t.flagSets,i=t.children,s=t.attributes;return Gi().createElement(Vi.Consumer,null,(function(t){var o=t.client,a=t.lastUpdate,u=e.evaluateFeatureFlags(o,a,n,s,o?ne({},o.getAttributes()):{},r);return i(ne(ne({},t),{treatments:u}))}))},t}(Gi().Component);function gs(e){var t=ls(ne(ne({},e),{attributes:void 0})),n=t.client,r=t.lastUpdate,i=e.names,s=e.flagSets,o=e.attributes,a=Gi().useMemo(os,[])(n,r,i,o,n?ne({},n.getAttributes()):{},s);return ne(ne({},t),{treatments:a})}var ms=function(){return!1};function vs(){var e=Gi().useContext(Vi);return ne(ne({},e),{manager:e.factory?e.factory.manager():null})}var ys={SplitSdk:zi,withSplitFactory:function(e,t,n){return function(r,i,s,o,a){return void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===o&&(o=!0),void 0===a&&(a=!0),function(u){return Gi().createElement(ps,{config:e,factory:t,updateOnSdkUpdate:i,updateOnSdkTimedout:s,updateOnSdkReady:o,updateOnSdkReadyFromCache:a,attributes:n},(function(e){return Gi().createElement(r,ne({},u,e))}))}}},withSplitClient:function(e,t,n){return function(r,i,s,o,a){return void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===o&&(o=!0),void 0===a&&(a=!0),function(u){return Gi().createElement(hs,{splitKey:e,trafficType:t,updateOnSdkUpdate:i,updateOnSdkTimedout:s,updateOnSdkReady:o,updateOnSdkReadyFromCache:a,attributes:n},(function(e){return Gi().createElement(r,ne({},u,e))}))}}},withSplitTreatments:function(e,t){return function(n){return function(r){return Gi().createElement(ds,{names:e,attributes:t},(function(e){return Gi().createElement(n,ne({},r,e))}))}}},SplitFactory:ps,SplitFactoryProvider:function(e){var t=ne(ne({},cs),e),n=t.config,r=t.factory,i=t.updateOnSdkReady,s=t.updateOnSdkReadyFromCache,o=t.updateOnSdkTimedout,a=t.updateOnSdkUpdate;n&&r&&(console.log(Yi),n=void 0);var u=Gi().useState(null),c=u[0],l=u[1],f=r||(c&&n===c.config?c:null),h=f?ts(f):null;return Gi().useEffect((function(){if(n){var e=es(n);return function(){ns(e)}}}),[n]),Gi().useEffect((function(){var e=n&&es(n);if(e){var t=ts(e),r=rs(t),u=function(){c(),l(e)},c=function(){t.off(t.Event.SDK_READY,u),t.off(t.Event.SDK_READY_FROM_CACHE,u),t.off(t.Event.SDK_READY_TIMED_OUT,u),t.off(t.Event.SDK_UPDATE,u)};return i&&(r.isReady?u():t.once(t.Event.SDK_READY,u)),s&&(r.isReadyFromCache?u():t.once(t.Event.SDK_READY_FROM_CACHE,u)),o&&(r.hasTimedout?u():t.once(t.Event.SDK_READY_TIMED_OUT,u)),a&&t.on(t.Event.SDK_UPDATE,u),c}}),[n,i,s,o,a]),Gi().createElement(fs,ne({},e,{factory:f,client:h}))},SplitClient:hs,SplitTreatments:ds,useClient:function(e,t,n){return ls({splitKey:e,trafficType:t,attributes:n}).client},useSplitClient:ls,useTreatments:function(e,t,n){return gs({names:e,attributes:t,splitKey:n}).treatments},useSplitTreatments:gs,useTrack:function(e,t){var n=ls({splitKey:e,trafficType:t,updateOnSdkReady:!1,updateOnSdkReadyFromCache:!1}).client;return n?n.track.bind(n):ms},useManager:function(){return vs().manager},useSplitManager:vs,SplitContext:Vi}}(),i.default}()}));