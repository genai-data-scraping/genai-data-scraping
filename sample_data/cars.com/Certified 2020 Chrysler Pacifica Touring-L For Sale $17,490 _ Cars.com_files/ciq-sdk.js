/*! License information is available at licenses.txt */!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}(self,(()=>(()=>{"use strict";var e={835:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(996),o=n.n(i),r=n(798),s=n.n(r)()(o());s.push([e.id,'creditiq-vdp-button,\ncreditiq-srp-button {\n  cursor: pointer;\n  text-align: center;\n  margin: auto;\n}\n\ncreditiq-vdp-button {\n  max-width: 280px;\n}\ncreditiq-vdp-button img {\n  max-height: 100%;\n  max-width: 100%;\n}\n\ncreditiq-srp-button {\n  margin: 0;\n}\ncreditiq-srp-button img {\n  max-height: 100%;\n  max-width: 100%;\n}\n\n.creditiq-site-provider-cdk creditiq-vdp-button {\n  position: absolute;\n  top: 505px;\n  left: 640px;\n  display: block;\n  padding: 0 11px;\n}\n.creditiq-site-provider-cdk creditiq-srp-button {\n  display: inline-block;\n  height: 48px;\n  margin-top: -9px;\n  margin-left: 5px;\n}\n\n.ciq-modal {\n  position: relative;\n}\n.ciq-modal-content {\n  position: absolute;\n  height: 200px;\n  width: 200px;\n  top: 30%;\n  left: 50%;\n  margin-left: -100px;\n  background: white;\n  border-radius: 3px;\n  z-index: 1;\n  border: 1px solid #ddd;\n}\n.embed-view .ciq-modal-content {\n  background: transparent;\n}\n.ciq-modal-backdrop {\n  background: #000;\n  opacity: 0.4;\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n}\n.inline-view .ciq-modal-content {\n  border: none;\n}\n.inline-view .ciq-modal-backdrop {\n  opacity: 0;\n}\n\nbody.modal-active-ios > :not(.ciq-checkout-modal) {\n  display: none !important;\n}\n\n.ciq-loading-wrap {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding-top: 25%;\n}\n.ciq-loading-text {\n  font-family: sans-serif;\n  margin-top: 14px;\n  font-size: 14px;\n}\n.ciq-loading-skCircle {\n  width: 50px;\n  height: 50px;\n  position: relative;\n}\n.ciq-loading-skCircle .ciq-loading-skChild {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n.ciq-loading-skCircle .ciq-loading-skChild:before {\n  content: "";\n  display: block;\n  margin: 0 auto;\n  width: 15%;\n  height: 15%;\n  background-color: #ccc;\n  border-radius: 100%;\n  animation: skCircleBounceDelay 1.2s infinite ease-in-out both;\n}\n.ciq-loading-skCircle .ciq-loading-skCircle2 {\n  transform: rotate(30deg);\n}\n.ciq-loading-skCircle .ciq-loading-skCircle3 {\n  transform: rotate(60deg);\n}\n.ciq-loading-skCircle .ciq-loading-skCircle4 {\n  transform: rotate(90deg);\n}\n.ciq-loading-skCircle .ciq-loading-skCircle5 {\n  transform: rotate(120deg);\n}\n.ciq-loading-skCircle .ciq-loading-skCircle6 {\n  transform: rotate(150deg);\n}\n.ciq-loading-skCircle .ciq-loading-skCircle7 {\n  transform: rotate(180deg);\n}\n.ciq-loading-skCircle .ciq-loading-skCircle8 {\n  transform: rotate(210deg);\n}\n.ciq-loading-skCircle .ciq-loading-skCircle9 {\n  transform: rotate(240deg);\n}\n.ciq-loading-skCircle .ciq-loading-skCircle10 {\n  transform: rotate(270deg);\n}\n.ciq-loading-skCircle .ciq-loading-skCircle11 {\n  transform: rotate(300deg);\n}\n.ciq-loading-skCircle .ciq-loading-skCircle12 {\n  transform: rotate(330deg);\n}\n.ciq-loading-skCircle .ciq-loading-skCircle2:before {\n  animation-delay: -1.1s;\n}\n.ciq-loading-skCircle .ciq-loading-skCircle3:before {\n  animation-delay: -1s;\n}\n.ciq-loading-skCircle .ciq-loading-skCircle4:before {\n  animation-delay: -0.9s;\n}\n.ciq-loading-skCircle .ciq-loading-skCircle5:before {\n  animation-delay: -0.8s;\n}\n.ciq-loading-skCircle .ciq-loading-skCircle6:before {\n  animation-delay: -0.7s;\n}\n.ciq-loading-skCircle .ciq-loading-skCircle7:before {\n  animation-delay: -0.6s;\n}\n.ciq-loading-skCircle .ciq-loading-skCircle8:before {\n  animation-delay: -0.5s;\n}\n.ciq-loading-skCircle .ciq-loading-skCircle9:before {\n  animation-delay: -0.4s;\n}\n.ciq-loading-skCircle .ciq-loading-skCircle10:before {\n  animation-delay: -0.3s;\n}\n.ciq-loading-skCircle .ciq-loading-skCircle11:before {\n  animation-delay: -0.2s;\n}\n.ciq-loading-skCircle .ciq-loading-skCircle12:before {\n  animation-delay: -0.1s;\n}\n@keyframes skCircleBounceDelay {\n  0%, 80%, 100% {\n    transform: scale(0);\n  }\n  40% {\n    transform: scale(1);\n  }\n}',""]);const a=s},798:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,i,o,r){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(i)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(s[c]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);i&&s[d[0]]||(void 0!==r&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=r),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),o&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=o):d[4]="".concat(o)),t.push(d))}},t}},996:e=>{e.exports=function(e){return e[1]}},274:e=>{e.exports=function(e,t,n,i,o,r,s,a){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,i,o,r,s,a],d=0;(c=new Error(t.replace(/%s/g,(function(){return l[d++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}},256:e=>{var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var r={},s=[],a=0;a<e.length;a++){var c=e[a],l=i.base?c[0]+i.base:c[0],d=r[l]||0,h="".concat(l," ").concat(d);r[l]=d+1;var u=n(h),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==u)t[u].references++,t[u].updater(p);else{var m=o(p,i);i.byIndex=a,t.splice(a,0,{identifier:h,updater:m,references:1})}s.push(h)}return s}function o(e,t){var n=t.domAPI(t);n.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var r=i(e=e||[],o=o||{});return function(e){e=e||[];for(var s=0;s<r.length;s++){var a=n(r[s]);t[a].references--}for(var c=i(e,o),l=0;l<r.length;l++){var d=n(r[l]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}r=c}}},522:e=>{var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},150:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},553:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},771:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,o&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},802:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={id:i,exports:{}};return e[i](r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0;var i={};return(()=>{var e,t;n.r(i),function(e){e.SOURCE="SOURCE",e.DESTINATION="DESTINATION"}(e||(e={})),function(e){e.EMAIL="EMAIL",e.TEXT="TEXT"}(t||(t={}));const o=["consumerInfo","enableConsumerAuth"],r=[...o,"destinationOrgId","tradeInVehicle","applicant","coApplicant","downPayment","requestedTerm","registrationDetails","suppliedStructure","metadata","vehicle","hideHeader","flowName","theme","blackout","referer","skipToLatestStep","preferredFirstStepName","trackingTags"],s=e=>e&&Object.keys(e).filter((e=>!r.includes(e)));const a="object"==typeof global&&global&&global.Object===Object&&global;var c="object"==typeof self&&self&&self.Object===Object&&self;const l=a||c||Function("return this")();const d=l.Symbol;var h=Object.prototype,u=h.hasOwnProperty,p=h.toString,m=d?d.toStringTag:void 0;const f=function(e){var t=u.call(e,m),n=e[m];try{e[m]=void 0;var i=!0}catch(e){}var o=p.call(e);return i&&(t?e[m]=n:delete e[m]),o};var g=Object.prototype.toString;const v=function(e){return g.call(e)};var y=d?d.toStringTag:void 0;const E=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":y&&y in Object(e)?f(e):v(e)};const b=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};const A=function(e){if(!b(e))return!1;var t=E(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t};const C=l["__core-js_shared__"];var _,T=(_=/[^.]+$/.exec(C&&C.keys&&C.keys.IE_PROTO||""))?"Symbol(src)_1."+_:"";const O=function(e){return!!T&&T in e};var w=Function.prototype.toString;const D=function(e){if(null!=e){try{return w.call(e)}catch(e){}try{return e+""}catch(e){}}return""};var I=/^\[object .+?Constructor\]$/,k=Function.prototype,S=Object.prototype,L=k.toString,R=S.hasOwnProperty,q=RegExp("^"+L.call(R).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const N=function(e){return!(!b(e)||O(e))&&(A(e)?q:I).test(D(e))};const P=function(e,t){return null==e?void 0:e[t]};const U=function(e,t){var n=P(e,t);return N(n)?n:void 0};const F=U(Object,"create");const x=function(){this.__data__=F?F(null):{},this.size=0};const M=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t};var j=Object.prototype.hasOwnProperty;const H=function(e){var t=this.__data__;if(F){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return j.call(t,e)?t[e]:void 0};var $=Object.prototype.hasOwnProperty;const B=function(e){var t=this.__data__;return F?void 0!==t[e]:$.call(t,e)};const V=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=F&&void 0===t?"__lodash_hash_undefined__":t,this};function K(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}K.prototype.clear=x,K.prototype.delete=M,K.prototype.get=H,K.prototype.has=B,K.prototype.set=V;const z=K;const W=function(){this.__data__=[],this.size=0};const G=function(e,t){return e===t||e!=e&&t!=t};const Y=function(e,t){for(var n=e.length;n--;)if(G(e[n][0],t))return n;return-1};var Q=Array.prototype.splice;const Z=function(e){var t=this.__data__,n=Y(t,e);return!(n<0)&&(n==t.length-1?t.pop():Q.call(t,n,1),--this.size,!0)};const X=function(e){var t=this.__data__,n=Y(t,e);return n<0?void 0:t[n][1]};const J=function(e){return Y(this.__data__,e)>-1};const ee=function(e,t){var n=this.__data__,i=Y(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this};function te(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}te.prototype.clear=W,te.prototype.delete=Z,te.prototype.get=X,te.prototype.has=J,te.prototype.set=ee;const ne=te;const ie=U(l,"Map");const oe=function(){this.size=0,this.__data__={hash:new z,map:new(ie||ne),string:new z}};const re=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};const se=function(e,t){var n=e.__data__;return re(t)?n["string"==typeof t?"string":"hash"]:n.map};const ae=function(e){var t=se(this,e).delete(e);return this.size-=t?1:0,t};const ce=function(e){return se(this,e).get(e)};const le=function(e){return se(this,e).has(e)};const de=function(e,t){var n=se(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this};function he(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}he.prototype.clear=oe,he.prototype.delete=ae,he.prototype.get=ce,he.prototype.has=le,he.prototype.set=de;const ue=he;const pe=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};const me=function(e){return this.__data__.has(e)};function fe(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new ue;++t<n;)this.add(e[t])}fe.prototype.add=fe.prototype.push=pe,fe.prototype.has=me;const ge=fe;const ve=function(e,t,n,i){for(var o=e.length,r=n+(i?1:-1);i?r--:++r<o;)if(t(e[r],r,e))return r;return-1};const ye=function(e){return e!=e};const Ee=function(e,t,n){for(var i=n-1,o=e.length;++i<o;)if(e[i]===t)return i;return-1};const be=function(e,t,n){return t==t?Ee(e,t,n):ve(e,ye,n)};const Ae=function(e,t){return!!(null==e?0:e.length)&&be(e,t,0)>-1};const Ce=function(e,t,n){for(var i=-1,o=null==e?0:e.length;++i<o;)if(n(t,e[i]))return!0;return!1};const _e=function(e,t){return e.has(t)};const Te=U(l,"Set");const Oe=function(){};const we=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n};const De=Te&&1/we(new Te([,-0]))[1]==1/0?function(e){return new Te(e)}:Oe;const Ie=function(e,t,n){var i=-1,o=Ae,r=e.length,s=!0,a=[],c=a;if(n)s=!1,o=Ce;else if(r>=200){var l=t?null:De(e);if(l)return we(l);s=!1,o=_e,c=new ge}else c=t?[]:a;e:for(;++i<r;){var d=e[i],h=t?t(d):d;if(d=n||0!==d?d:0,s&&h==h){for(var u=c.length;u--;)if(c[u]===h)continue e;t&&c.push(h),a.push(d)}else o(c,h,n)||(c!==a&&c.push(h),a.push(d))}return a};const ke=function(e){return e&&e.length?Ie(e):[]};function Se(e,t,n){const i={creator:e},o=e=>t?e.toLowerCase():e;for(const t in e)i[t]=o(t);return Object.defineProperty(i,"parse",{value:(e,t=!0)=>{if(!e)return;if(n){const r=Object.keys(n).filter((e=>"creator"!==e)).filter((t=>t.toLowerCase()===e.toLowerCase()))[0];if(r)return t?i[n[r]]:o(r)}const r=Object.keys(i).filter((e=>"creator"!==e)).filter((t=>t.toLowerCase()===e.toLowerCase()))[0];return i[r]}}),Object.defineProperty(i,"values",{value:(e=!1)=>ke(Object.keys(i).filter((e=>"creator"!==e)).map((t=>i.parse(i[t],e))).filter((e=>!!e)))}),i}const Le=Se({APPLICATION:"",DECISION:"",CREDIT_REPORT_SUMMARY:"",SETTINGS:"",EVENT:"",TRACKING_EVENT:"",USER_ACTIVITY_PULSE:"",IDENTITY_VERIFICATION:"",ANCILLARY_PRODUCT_CONTRACT:"",SELECTED_PRE_QUAL_DECISION:"",SELECTED_APPROVAL_DECISION:""},!1),Re=Se({CHECKOUT_LOGIN_REQUESTED:"",CHECKOUT_CREATE_ACCOUNT_REQUESTED:"",CHECKOUT_RESEND_ACOUNT_VERIFICATION:"",CHECKOUT_FLOW_LOADED:"",CHECKOUT_FLOW_COMPLETED:"",CHECKOUT_LEAD_SUBMITTED:"",CHECKOUT_APPLICATION_SUBMITTED:"",CHECKOUT_OFFER_SUMMARY_REQUESTED:"",CHECKOUT_OFFER_SUMMARY_DISPLAYED:"",CHECKOUT_COMPLETE_YOUR_APPLICATION_CLICKED:""},!1),qe=(Re.CHECKOUT_LOGIN_REQUESTED,Re.CHECKOUT_CREATE_ACCOUNT_REQUESTED,Re.CHECKOUT_RESEND_ACOUNT_VERIFICATION,Se({...Re.creator,CREDIT_APPLICATION_SUBMITTED:"",LEAD_SUBMITTED:"",DECISION_PRESENTED_TO_USER:"",LENDER_APPLICANT_PREQUAL_RECEIVED:""},!1)),Ne=(Se({...qe.creator,CREATE:"",UPDATE:"",DELETE:""},!1),Se({AUTO:"",ANCILLARY:"",INSURANCE:"",AUTO_PURCHASE:"",AUTO_REFINANCE:"",WARRANTY_PURCHASE:"",INSURANCE_PURCHASE:""},!0,{AUTO_PURCHASE:"AUTO",AUTO_REFINANCE:"AUTO",WARRANTY_PURCHASE:"ANCILLARY",INSURANCE_PURCHASE:"INSURANCE"})),Pe=Se({ACCU_TRADE:"",BLACKBOOK:"",EDMUNDS:"",KBB:"",NADA:"",PRICING:""},!1);Pe.ACCU_TRADE,Pe.KBB,Pe.NADA,Pe.BLACKBOOK,Pe.EDMUNDS,Pe.PRICING,Se({KBB:"",ACCU_TRADE:""}),Se({PASSENGER_VEHICLE:"",LIGHT_TRUCK:"",SUV:""}),Se({GAS:"",ELECTRIC:"",DIESEL:"",HYBRID:""});var Ue,Fe;!function(e){e.AWD="AWD",e["4WD"]="4WD",e.FWD="FWD",e.RWD="RWD"}(Ue||(Ue={})),function(e){e.ACTIVE="ACTIVE",e.INACTIVE="INACTIVE"}(Fe||(Fe={}));Se({WHOLESALE:"",RETAIL:"",TRADE_IN:"",LENDING:""},!0);const xe=Se({NEW:"",USED:""},!0);var Me;!function(e){e.NEW="new",e.USED="used",e.CPO="cpo"}(Me||(Me={}));Se({FAIR:"",GOOD:"",VERY_GOOD:"",EXCELLENT:""},!0);Se({FRONT:"",INTERIOR:"",LEFT_SIDE:"",MECHANICAL:"",NON_FACTORY_OR_AFTERMARKET:"",REAR:"",RIGHT_SIDE:"",ROOF:"",TIRES_AND_WHEELS:"",WARNING_LIGHTS:"",OTHER:""},!1);var je,He,$e,Be,Ve,Ke=n(274),ze=n.n(Ke);!function(e){e.Call="call",e.Reply="reply",e.Syn="syn",e.SynAck="synAck",e.Ack="ack"}(je||(je={})),function(e){e.Fulfilled="fulfilled",e.Rejected="rejected"}(He||(He={})),function(e){e.ConnectionDestroyed="ConnectionDestroyed",e.ConnectionTimeout="ConnectionTimeout",e.NoIframeSrc="NoIframeSrc"}($e||($e={})),function(e){e.DataCloneError="DataCloneError"}(Be||(Be={})),function(e){e.Message="message"}(Ve||(Ve={}));const We={"http:":"80","https:":"443"},Ge=/^(https?:)?\/\/([^/:]+)?(:(\d+))?/,Ye=["file:","data:"],Qe=({name:e,message:t,stack:n})=>({name:e,message:t,stack:n});let Ze=0;const Xe=()=>++Ze,Je=e=>e?e.split("."):[],et=(e,t,n)=>{const i=Je(t);return i.reduce(((e,t,o)=>(void 0===e[t]&&(e[t]={}),o===i.length-1&&(e[t]=n),e[t])),e),e},tt=(e,t)=>{const n={};return Object.keys(e).forEach((i=>{const o=e[i],r=((e,t)=>{const n=Je(t||"");return n.push(e),(e=>e.join("."))(n)})(i,t);"object"==typeof o&&Object.assign(n,tt(o,r)),"function"==typeof o&&(n[r]=o)})),n},nt=(e,t,n,i,o)=>{const{localName:r,local:s,remote:a,originForSending:c,originForReceiving:l}=t;let d=!1;o(`${r}: Connecting call sender`);const h=e=>(...t)=>{let n;o(`${r}: Sending ${e}() call`);try{a.closed&&(n=!0)}catch(e){n=!0}if(n&&i(),d){const t=new Error(`Unable to send ${e}() call due to destroyed connection`);throw t.code=$e.ConnectionDestroyed,t}return new Promise(((n,i)=>{const d=Xe(),h=t=>{if(t.source!==a||t.data.penpal!==je.Reply||t.data.id!==d)return;if("*"!==l&&t.origin!==l)return void o(`${r} received message from origin ${t.origin} which did not match expected origin ${l}`);const c=t.data;o(`${r}: Received ${e}() reply`),s.removeEventListener(Ve.Message,h);let u=c.returnValue;c.returnValueIsError&&(u=(e=>{const t=new Error;return Object.keys(e).forEach((n=>t[n]=e[n])),t})(u)),(c.resolution===He.Fulfilled?n:i)(u)};s.addEventListener(Ve.Message,h);const u={penpal:je.Call,id:d,methodName:e,args:t};a.postMessage(u,c)}))},u=n.reduce(((e,t)=>(e[t]=h(t),e)),{});return Object.assign(e,(e=>{const t={};for(const n in e)et(t,n,e[n]);return t})(u)),()=>{d=!0}},it=(e,t,n,i,o)=>{const{destroy:r,onDestroy:s}=i;let a,c;const l={};return i=>{if("*"!==t&&i.origin!==t)return void o(`Parent: Handshake - Received ACK message from origin ${i.origin} which did not match expected origin ${t}`);o("Parent: Handshake - Received ACK");const d={localName:"Parent",local:window,remote:i.source,originForSending:n,originForReceiving:t};a&&a(),a=((e,t,n)=>{const{localName:i,local:o,remote:r,originForSending:s,originForReceiving:a}=e;let c=!1;const l=e=>{if(e.source!==r||e.data.penpal!==je.Call)return;if("*"!==a&&e.origin!==a)return void n(`${i} received message from origin ${e.origin} which did not match expected origin ${a}`);const o=e.data,{methodName:l,args:d,id:h}=o;n(`${i}: Received ${l}() call`);const u=e=>t=>{if(n(`${i}: Sending ${l}() reply`),c)return void n(`${i}: Unable to send ${l}() reply due to destroyed connection`);const o={penpal:je.Reply,id:h,resolution:e,returnValue:t};e===He.Rejected&&t instanceof Error&&(o.returnValue=Qe(t),o.returnValueIsError=!0);try{r.postMessage(o,s)}catch(e){if(e.name===Be.DataCloneError){const t={penpal:je.Reply,id:h,resolution:He.Rejected,returnValue:Qe(e),returnValueIsError:!0};r.postMessage(t,s)}throw e}};new Promise((e=>e(t[l].apply(t,d)))).then(u(He.Fulfilled),u(He.Rejected))};return o.addEventListener(Ve.Message,l),()=>{c=!0,o.removeEventListener(Ve.Message,l)}})(d,e,o),s(a),c&&c.forEach((e=>{delete l[e]})),c=i.data.methodNames;const h=nt(l,d,c,r,o);return s(h),l}},ot=e=>{let{iframe:t,methods:n={},childOrigin:i,timeout:o,debug:r=!1}=e;const s=(e=>(...t)=>{e&&console.log("[Penpal]",...t)})(r),a=((e,t)=>{const n=[];let i=!1;return{destroy(o){i||(i=!0,t(`${e}: Destroying connection`),n.forEach((e=>{e(o)})))},onDestroy(e){i?e():n.push(e)}}})("Parent",s),{onDestroy:c,destroy:l}=a;i||((e=>{if(!e.src&&!e.srcdoc){const e=new Error("Iframe must have src or srcdoc property defined.");throw e.code=$e.NoIframeSrc,e}})(t),i=(e=>{if(e&&Ye.find((t=>e.startsWith(t))))return"null";const t=document.location,n=Ge.exec(e);let i,o,r;return n?(i=n[1]?n[1]:t.protocol,o=n[2],r=n[4]):(i=t.protocol,o=t.hostname,r=t.port),`${i}//${o}${r&&r!==We[i]?`:${r}`:""}`})(t.src));const d="null"===i?"*":i,h=tt(n),u=((e,t,n,i)=>o=>{if("*"!==n&&o.origin!==n)return void e(`Parent: Handshake - Received SYN message from origin ${o.origin} which did not match expected origin ${n}`);e("Parent: Handshake - Received SYN, responding with SYN-ACK");const r={penpal:je.SynAck,methodNames:Object.keys(t)};o.source.postMessage(r,i)})(s,h,i,d),p=it(h,i,d,a,s);return{promise:new Promise(((e,n)=>{const i=((e,t)=>{let n;return void 0!==e&&(n=window.setTimeout((()=>{const n=new Error(`Connection timed out after ${e}ms`);n.code=$e.ConnectionTimeout,t(n)}),e)),()=>{clearTimeout(n)}})(o,l),r=n=>{if(n.source===t.contentWindow&&n.data)if(n.data.penpal!==je.Syn)if(n.data.penpal!==je.Ack);else{const t=p(n);t&&(i(),e(t))}else u(n)};window.addEventListener(Ve.Message,r),s("Parent: Awaiting handshake"),((e,t)=>{const{destroy:n,onDestroy:i}=t,o=setInterval((()=>{e.isConnected||(clearInterval(o),n())}),6e4);i((()=>{clearInterval(o)}))})(t,a),c((e=>{window.removeEventListener(Ve.Message,r),e&&n(e)}))})),destroy(){l()}}},rt=(e,t)=>{const n=e.getAttribute("style");e.setAttribute("data-ciq-orig-style",n||""),e.setAttribute("style",t)};let st;const at=/^http(s)?:\/\//,ct=(e,t)=>{const n=null!=t&&e?.parentNode===t?t:e?.parentNode;e&&n&&n.removeChild(e)};var lt;!function(e){e[e.UNLOADED=0]="UNLOADED",e[e.PRELOADED=1]="PRELOADED",e[e.LOADED=2]="LOADED"}(lt||(lt={}));class dt{constructor(e,t,n,i){this.config=e,this.isInline=t,this.queryOpts=n,this.reportUserActivity=i,this.framePhaseListeners=[],this.isFramePhase=(...e)=>e.includes(this.framePhase);const o=e.host?e.host:st;if(!o)throw new Error("No host provided and defaultHost has not been configured");const r=e.noHttps?o:(e=>at.test(e)?e:`https://${e}`)(o);this.BASE_URL=r.endsWith("/")?r:`${r}/`,this.setFrameId(),this.makeLoader(),this.setFramePhase(lt.UNLOADED)}makeLoader(){const e=document.createElement("div");e.innerHTML=`<div class="ciq-modal ${this.isInline?"inline-view":""}">\n          <div class="ciq-modal-dialog">\n            <div class="ciq-modal-content">\n              <div class="ciq-loading-wrap">\n                <div class="ciq-loading-skCircle">\n                  <div class="ciq-loading-skCircle1 ciq-loading-skChild"></div>\n                  <div class="ciq-loading-skCircle2 ciq-loading-skChild"></div>\n                  <div class="ciq-loading-skCircle3 ciq-loading-skChild"></div>\n                  <div class="ciq-loading-skCircle4 ciq-loading-skChild"></div>\n                  <div class="ciq-loading-skCircle5 ciq-loading-skChild"></div>\n                  <div class="ciq-loading-skCircle6 ciq-loading-skChild"></div>\n                  <div class="ciq-loading-skCircle7 ciq-loading-skChild"></div>\n                  <div class="ciq-loading-skCircle8 ciq-loading-skChild"></div>\n                  <div class="ciq-loading-skCircle9 ciq-loading-skChild"></div>\n                  <div class="ciq-loading-skCircle10 ciq-loading-skChild"></div>\n                  <div class="ciq-loading-skCircle11 ciq-loading-skChild"></div>\n                  <div class="ciq-loading-skCircle12 ciq-loading-skChild"></div>\n                </div>\n                <div class="ciq-loading-text">Loading...</div>\n              </div>\n            </div>\n          </div>\n          <div class="ciq-modal-backdrop"></div>\n        </div>`;const t=e.querySelector(".ciq-modal-backdrop");t&&t.addEventListener("click",(()=>{this.isInline||this.close()})),this.loader=e.firstChild}setFrameStyles(e){if(this.isInline){const t={width:"0","min-width":"100%","max-width":"100%",height:"600px"};this.setStyles(e,t),this.setStyles(this.loader,t)}else{const t={position:this.needsScrollHack()?"absolute":"fixed",top:"0",right:"0",bottom:"0",left:"0",width:"100%",height:"100vh",zIndex:2147483646,background:"transparent",zoom:1};this.setStyles(this.loader,{...t,position:"fixed"}),this.setStyles(e,t)}}clearPreloadTimeout(){this.preloadTimeout&&(clearTimeout(this.preloadTimeout),this.preloadTimeout=void 0),this.preloadResolve&&(this.preloadResolve(),this.preloadResolve=void 0)}schedulePreload(e,t,n,i){return new Promise((o=>{const r=!0===i?1e3:!1===i||null==i?0:i,s={parentEl:e,options:t,changeHandler:n};this.clearPreloadTimeout(),this.preloadResolve=o,this.preloadTimeout=window.setTimeout((()=>{this.preload(e,s.options),o()}),r),this.preloadOpts=s}))}preload(e,t,n){this.setFramePhase(lt.UNLOADED),this.triedToPreloadSinceLastOpen=!0,this.parentEl=this.validateParentEl(e),this.options=this.validateAndCombineOptions(t),this.createFrame(this.parentEl,n)}async open(e,t,n){if(this.triedToPreloadSinceLastOpen&&await((await(this.penpal?.promise))?.openRequested()),this.clearPreloadTimeout(),this.openChangeHandler=n,!this.triedToPreloadSinceLastOpen){this.remove(),this.preloadOpts?.parentEl&&e&&this.preloadOpts.parentEl!==e&&console.warn("Different element passed to preload and open, note this while reload the frame and counteracts some of the effects of preloading");const n=this.preloadOpts?.parentEl||e;if(!n)throw new Error("no parent element supplied for frame");this.preload(n,this.preloadOpts?.options||t,!0)}this.triedToPreloadSinceLastOpen=!1;const i=(e=>!e||0===s(e)?.length)(t);if(this.preloadOpts&&t&&!i)throw new Error(`options passed to open or inject included keys that must be passed to preload when preloading: ${s(t)?.join(",")}`);return this.startLoading(this.preloadOpts&&i?t:void 0)}async updateOptions(e){return this.framePhase<lt.LOADED&&console.warn("cant update options prior to showing modal, this will have no effect, pass options to open instead"),(await(this.penpal?.promise))?.update(e)}startLoading(e){return new Promise((t=>{this.addOneTimeListener(lt.PRELOADED,(async()=>{await((await(this.penpal?.promise))?.start(e))}));const n=this.iframe,i=this.parentEl;if(!n)throw new Error("called showLoader before creating frame");if(!i)throw new Error("called showLoader before setting parentEl");const o=document.createElement("div");o.innerHTML="<meta content='width=device-width,initial-scale=1,maximum-scale=5,user-scalable=1' name='viewport'>",this.meta=o.firstElementChild;const r=this.options?.isEmbed?"add":"remove";this.loader.classList[r]("embed-view"),i.appendChild(this.loader),document.head.appendChild(this.meta),this.addOneTimeListener(lt.LOADED,(async()=>{await this.show(),t()}))}))}remove(){this.penpal?.destroy(),this.penpal=void 0,ct(this.iframe,this.parentEl),ct(this.meta,document.head),this.removeLoader(),this.setFramePhase(lt.UNLOADED),this.parentEl=this.iframe=void 0}close(){this.remove(),null!=this.bodyScroll&&(document.body.scrollTop=this.bodyScroll),Array.from(document.querySelectorAll("[data-ciq-orig-style]")).forEach((e=>{const t=e.getAttribute("data-ciq-orig-style");t?e.setAttribute("style",t):e.removeAttribute("style"),e.removeAttribute("data-ciq-orig-style")})),document.body.classList.remove("modal-active-ios"),this.preloadOpts&&this.preload(this.preloadOpts.parentEl,this.preloadOpts.options)}hide(e){this.setStyles(e,{display:"none"})}show(){this.removeLoader(),this.needsScrollHack()?(rt(document.body,"\n        height: 100%;\n        overflow-y: scroll;\n        -webkit-overflow-scrolling: touch;\n        background: white;\n      "),rt(document.documentElement,"\n        height: 100%;\n        overflow-y: scroll;\n        -webkit-overflow-scrolling: touch;\n      "),Array.from(document.body.children).forEach((e=>e!==this.iframe&&rt(e,"display: none !important;"))),this.iframe&&(this.iframe.style.height="100%"),document.body.classList.add("modal-active-ios")):this.isInline||rt(document.body,"\n        overflow: hidden;\n      "),this.iframe&&(this.bodyScroll=document.body.scrollTop,this.maybeSetScrollForMobile(),this.setStyles(this.iframe,{display:""}))}setStyles(e,t){Object.keys(t).forEach((n=>e.style[n]=t[n]))}needsScrollHack(){const e=navigator.userAgent,t=!!e.match(/iPad/i)||!!e.match(/iPhone/i),n=!!e.match(/WebKit/i);return t&&n&&!this.isInline}maybeSetScrollForMobile(){this.needsScrollHack()&&(document.body.scrollTop=0)}createFrame(e,t){const n=document.createElement("iframe");return this.iframe=n,n.src=`${this.BASE_URL}?${this.getQueryString(t,this.config)}`,n.scrollIntoView=()=>{},this.setAttributes(n,{id:this.frameId,class:"ciq-checkout-modal",marginwidth:"0",marginheight:"0",hspace:"0",vspace:"0",frameborder:"0",scrolling:"auto"}),this.setFrameStyles(n),this.initPostMessaging(n),this.hide(n),n.parentElement!==e&&e.appendChild(n),n}removeLoader(){ct(this.loader,this.parentEl)}setFrameId(){this.frameId=`creditiq-checkout-${this.isInline?"inline":"modal"}-frame-${dt.frameInt++}`}setAttributes(e,t){Object.keys(t).forEach((n=>e.setAttribute(n,t[n])))}initPostMessaging(e){const t={close:async()=>this.close(),resetScroll:async()=>{this.iframe&&this.iframe.scrollIntoView(!0)},setFrameStyles:async e=>{this.iframe&&this.setStyles(this.iframe,e)},changelog:async(e,t)=>{this.onChangelog({dataType:e,data:t})},requestSDKOptions:async()=>{const{sourceOrgId:e}=this.config;return{...this.options,sourceOrgId:e,isInline:this.isInline}},preloaded:async()=>{this.setFramePhase(lt.PRELOADED)},loaded:async()=>{this.setFramePhase(lt.LOADED)}};this.penpal=ot({iframe:e,methods:t})}setFramePhase(e){this.framePhase=e,this.framePhaseListeners.map((({fn:t,phase:n})=>n===e||null==n?t(e):void 0))}addOneTimeListener(e,t){const n=this.addFramePhaseListener(e,(e=>{n(),t(e)}));return n}addFramePhaseListener(e,t){const n="number"==typeof e,i=n?e:void 0,o=n?t:e,r={phase:i,fn:o};return this.framePhaseListeners.push(r),i&&this.framePhase>=i&&setTimeout((()=>{o(this.framePhase)})),()=>{const e=this.framePhaseListeners.indexOf(r);-1!==e&&(this.framePhaseListeners=[...this.framePhaseListeners.slice(0,e),...this.framePhaseListeners.slice(e+1)])}}onChangelog({dataType:e,data:t}){e!==Le.USER_ACTIVITY_PULSE?this.fireChangeLog(e,t):this.reportUserActivity()}fireChangeLog(e,t){"function"==typeof this.preloadOpts?.changeHandler&&this.preloadOpts?.changeHandler(e,t),"function"==typeof this.openChangeHandler&&this.openChangeHandler(e,t)}getQueryString(e,t){const n=window.ga?.getAll?.()?.[0]?.get("linkerParam")||void 0;return[new URLSearchParams({isEmbed:(!!this.options?.isEmbed).toString(),...this.options?.theme&&{theme:this.options?.theme?.toString()},...this.options?.isNonConsumer&&{isNonConsumer:this.options?.isNonConsumer?.toString()},inline:this.isInline.toString(),origin:window.location.origin,preloading:(!e).toString()}).toString(),n].join("&")}validateAndCombineOptions(e){const t={...this.queryOpts,...e};if(t&&t.vehicle){const e=t.vehicle.type;e&&ze()(Object.keys(xe).some((t=>xe[t]===e)),`Invalid vehicle type '${e}' in creditiq options object`)}return t&&t.productType&&ze()(Ne.values().some((e=>e===t.productType)),`Invalid product type '${t.productType}' in creditiq options object`),t}validateParentEl(e){return ze()(e instanceof HTMLElement,"Parent element of must be an instanceof HTMLElement for creditiq checkout"),e}}dt.frameInt=0;const ht=dt;var ut=n(256),pt=n.n(ut),mt=n(771),ft=n.n(mt),gt=n(522),vt=n.n(gt),yt=n(553),Et=n.n(yt),bt=n(150),At=n.n(bt),Ct=n(802),_t=n.n(Ct),Tt=n(835),Ot={};Ot.styleTagTransform=_t(),Ot.setAttributes=Et(),Ot.insert=vt().bind(null,"head"),Ot.domAPI=ft(),Ot.insertStyleElement=At();pt()(Tt.Z,Ot);Tt.Z&&Tt.Z.locals&&Tt.Z.locals;const wt=function(){return l.Date.now()};var Dt=/\s/;const It=function(e){for(var t=e.length;t--&&Dt.test(e.charAt(t)););return t};var kt=/^\s+/;const St=function(e){return e?e.slice(0,It(e)+1).replace(kt,""):e};const Lt=function(e){return null!=e&&"object"==typeof e};const Rt=function(e){return"symbol"==typeof e||Lt(e)&&"[object Symbol]"==E(e)};var qt=/^[-+]0x[0-9a-f]+$/i,Nt=/^0b[01]+$/i,Pt=/^0o[0-7]+$/i,Ut=parseInt;const Ft=function(e){if("number"==typeof e)return e;if(Rt(e))return NaN;if(b(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=b(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=St(e);var n=Nt.test(e);return n||Pt.test(e)?Ut(e.slice(2),n?2:8):qt.test(e)?NaN:+e};var xt=Math.max,Mt=Math.min;const jt=function(e,t,n){var i,o,r,s,a,c,l=0,d=!1,h=!1,u=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var n=i,r=o;return i=o=void 0,l=t,s=e.apply(r,n)}function m(e){return l=e,a=setTimeout(g,t),d?p(e):s}function f(e){var n=e-c;return void 0===c||n>=t||n<0||h&&e-l>=r}function g(){var e=wt();if(f(e))return v(e);a=setTimeout(g,function(e){var n=t-(e-c);return h?Mt(n,r-(e-l)):n}(e))}function v(e){return a=void 0,u&&i?p(e):(i=o=void 0,s)}function y(){var e=wt(),n=f(e);if(i=arguments,o=this,c=e,n){if(void 0===a)return m(c);if(h)return clearTimeout(a),a=setTimeout(g,t),p(c)}return void 0===a&&(a=setTimeout(g,t)),s}return t=Ft(t)||0,b(n)&&(d=!!n.leading,r=(h="maxWait"in n)?xt(Ft(n.maxWait)||0,t):r,u="trailing"in n?!!n.trailing:u),y.cancel=function(){void 0!==a&&clearTimeout(a),l=0,i=c=o=a=void 0},y.flush=function(){return void 0===a?s:v(wt())},y};const Ht=function(e,t,n){var i=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return b(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),jt(e,t,{leading:i,maxWait:t,trailing:o})};function $t(e){const t=new URLSearchParams(e);return Array.from(t.entries()).reduce(((e,[t,n])=>({...e,[t]:Array.isArray(e[t])?[...e[t],n]:e[t]?[e[t],n]:n})),{})}const Bt="creditiq-inline-checkout",Vt="creditiq-vdp-button",Kt="creditiq-srp-button",zt=[Kt,Vt,Bt];class Wt{getOptionsFromElement(e){const t={type:this.getDataAttribute(e,"vehicle-type"),vin:this.getDataAttribute(e,"vehicle-vin"),stockId:this.getDataAttribute(e,"vehicle-stock-id"),make:this.getDataAttribute(e,"vehicle-make"),model:this.getDataAttribute(e,"vehicle-model"),year:this.getDataAttributeAsInt(e,"vehicle-year"),body:this.getDataAttribute(e,"vehicle-body"),trim:this.getDataAttribute(e,"vehicle-trim"),mileage:this.getDataAttributeAsInt(e,"vehicle-mileage"),salePrice:this.getDataAttributeAsFloat(e,"vehicle-sale-price"),msrp:this.getDataAttributeAsFloat(e,"vehicle-msrp"),invoicePrice:this.getDataAttributeAsFloat(e,"vehicle-invoice-price"),isCertified:"true"===this.getDataAttribute(e,"vehicle-is-certified"),inServiceDate:this.getDataAttribute(e,"vehicle-in-service-date")},n={type:this.getDataAttribute(e,"trade-in-vehicle-type"),vin:this.getDataAttribute(e,"trade-in-vehicle-vin"),make:this.getDataAttribute(e,"trade-in-vehicle-make"),model:this.getDataAttribute(e,"trade-in-vehicle-model"),year:this.getDataAttributeAsInt(e,"trade-in-vehicle-year"),body:this.getDataAttribute(e,"trade-in-vehicle-body"),trim:this.getDataAttribute(e,"trade-in-vehicle-trim"),mileage:this.getDataAttributeAsInt(e,"trade-in-vehicle-mileage"),condition:this.getDataAttribute(e,"trade-in-vehicle-condition"),inServiceDate:this.getDataAttribute(e,"trade-in-vehicle-in-service-date"),loanBalance:this.getDataAttributeAsFloat(e,"trade-in-vehicle-loan-balance"),tradeAllowance:this.getDataAttributeAsFloat(e,"trade-in-vehicle-trade-allowance")};return Gt({productType:this.getDataAttribute(e,"product-type"),txnType:this.getDataAttribute(e,"txn-type"),destinationOrgId:this.getDataAttribute(e,"destination-org-id"),flowName:this.getDataAttribute(e,"flow-name"),downPayment:this.getDataAttributeAsFloat(e,"down-payment"),requestedTerm:this.getDataAttributeAsInt(e,"requested-term"),vehicle:t,tradeInVehicle:n,dealer:{id:this.getDataAttribute(e,"dealer-id"),name:this.getDataAttribute(e,"dealer-name"),email:this.getDataAttribute(e,"dealer-email"),phone:this.getDataAttribute(e,"dealer-phone"),website:this.getDataAttribute(e,"dealer-website"),address:{line1:this.getDataAttribute(e,"dealer-address-line-1"),line2:this.getDataAttribute(e,"dealer-address-line-2"),city:this.getDataAttribute(e,"dealer-address-city"),state:this.getDataAttribute(e,"dealer-address-state"),zip:this.getDataAttribute(e,"dealer-address-zip")}}})||{}}getDataAttribute(e,t){const n=e.getAttribute(`data-${t}`);return"string"==typeof n&&n.trim()||void 0}getDataAttributeAsInt(e,t){return this.getDataAttributeAsNumber(e,t,parseInt)}getDataAttributeAsFloat(e,t){return this.getDataAttributeAsNumber(e,t,parseFloat)}getDataAttributeAsNumber(e,t,n){const i=n(this.getDataAttribute(e,t)||"");return 0===i?i:i||void 0}}const Gt=e=>Object.keys(e).reduce(((t,n)=>{const i=e[n],o="object"!=typeof i||Array.isArray(i)?i:function(e){return t=e,Object.keys(t).some((e=>!!t[e]))?e:void 0;var t}(Gt(i));return null!=o&&(t[n]=o),t}),{});class Yt{constructor(e,t){this.openModal=e,this.useCustomButtons=t,this.util=new Wt}init(){this.cleanup(),this.useCustomButtons||this.preLoadImages(),this.clickHandler=this.handleDelegatedClick.bind(this),window.addEventListener("click",this.clickHandler,!0)}cleanup(){this.clickHandler&&window.removeEventListener("click",this.clickHandler,!0)}addVdpButton(e){this.addButton(e,Yt.VDP_BUTTON_URL)}addSrpButton(e){this.addButton(e,Yt.SRP_BUTTON_URL)}addButton(e,t){if(this.useCustomButtons||e.children.length)return;const n=document.createElement("img");n.src=t,e.appendChild(n)}handleDelegatedClick(e){const t=this.findRelevantElementFromTarget(e.target);t&&this.openModal(this.util.getOptionsFromElement(t))}findRelevantElementFromTarget(e){if(e instanceof HTMLElement){if(this.containsButtonClass(e))return e;if(e.parentElement&&this.containsButtonClass(e.parentElement))return e.parentElement}}containsButtonClass(e){return[Kt,Vt].some((t=>e.classList.contains(t)))}preLoadImages(){[Yt.SRP_BUTTON_URL,Yt.VDP_BUTTON_URL].forEach((e=>{(new Image).src=e}))}}Yt.BASE_IMG_URL="https://images.creditiq.com/buttons",Yt.VDP_BUTTON_URL=`${Yt.BASE_IMG_URL}/vdp_button.png`,Yt.SRP_BUTTON_URL=`${Yt.BASE_IMG_URL}/srp_button.png`;class Qt{constructor(e,t,n){this.classes=e,this.onAdd=t,this.onRemove=n,this.classRegEx=new RegExp(`(^|\\s+)(${e.join("|")})(\\s+|$)`)}start(){this.observer||("loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>this.onInitialLoad())):this.onInitialLoad())}stop(){this.observer&&(this.observer.disconnect(),this.observer=void 0)}onInitialLoad(){const e=document.getElementsByTagName("body");this.processNodes(e,this.onAdd),this.registerObserver()}registerObserver(){this.observer=new MutationObserver(this.handleMutations.bind(this)),this.observer.observe(document.body,{attributes:!0,attributeOldValue:!0,attributeFilter:["class"],childList:!0,subtree:!0})}handleMutations(e){const t=e.length;let n=0;for(n=0;n<t;n++)this.processMutation(e[n])}processMutation(e){if(e.addedNodes.length&&this.processNodes(e.addedNodes,this.onAdd),e.removedNodes.length&&this.onRemove(this.findRelevantElements(e.removedNodes).map((e=>({element:e,relevantClass:e.className})))),"attributes"===e.type&&e.target instanceof HTMLElement&&"class"===e.attributeName){const t=e.oldValue||"",n=this.classRegEx.test(t),i=this.classRegEx.test(e.target.className||"");!n&&i?this.onAdd([e.target]):n&&!i&&this.onRemove([{element:e.target,relevantClass:t}])}}processNodes(e,t){const n=this.findRelevantElements(e);n.length&&t(n)}findRelevantElements(e){const t=e.length;let n,i=0,o=0,r=[];for(i=0;i<t;i++)if(n=e[i],n instanceof HTMLElement)for(o=0;o<this.classes.length;o++)r=r.concat(n.classList.contains(this.classes[o])?n:[],Array.prototype.slice.call(n.getElementsByClassName(this.classes[o])));return r}}class Zt{constructor(e,t,n,i){this.injectInline=e,this.openModal=t,this.getFrameById=n,this.handleAddedElement=e=>{e.forEach((e=>{e.classList.contains(Vt)?this.buttonManager.addVdpButton(e):e.classList.contains(Kt)?this.buttonManager.addSrpButton(e):e.classList.contains(Bt)&&this.injectInline(e,this.util.getOptionsFromElement(e),void 0)}))},this.handleRemovedElement=e=>{e.forEach((({element:e,relevantClass:t})=>{if(t.includes(Bt)){const t=e.querySelector(":scope > iframe"),n=t&&(e=>{const t=e.getAttribute("id");return t||console.warn("no frame id found on element, may fail to relase sdk references"),t})(t);n&&this.getFrameById(n).remove()}}))},this.util=new Wt,this.buttonManager=new Yt(t,i)}on(){this.domObserver||(this.domObserver=new Qt(zt,this.handleAddedElement,this.handleRemovedElement),this.domObserver.start(),this.buttonManager.init())}off(){this.domObserver&&(this.domObserver.stop(),this.buttonManager.cleanup())}}class Xt{constructor(){this.openModal=async(e,t)=>this.openFrame(this.modal,this.inline,document.body,e,t),this.injectInline=async(e,t,n)=>{const i=e||this.inline.preloadOpts?.parentEl;if(!i)throw new Error("inline mode requires a parent element to be passed to preload or injectInline");return this.openFrame(this.inline,this.modal,i,t,n)},this.updateAll=async e=>Promise.all(this.getAllFrames().map((t=>t.updateOptions(e)))),this.openFrame=async(e,t,n,i,o)=>(this.validateInitialized(),t.preloadOpts&&!e.preloadOpts&&await e.schedulePreload(n,t.preloadOpts.options,t.preloadOpts.changeHandler,0),await e.open(n,i,o),{updateOptions:t=>e.updateOptions(t)}),this.getFrameById=e=>(e=>e.includes("inline"))(e)?this.inline:this.modal}init(e){if(this.initialized)return;const t=this.parseQueryOpts();this.config=e,this.validateConfig(e);const n=function(e){const t=Ht((()=>{e()}),5e3,{leading:!0,trailing:!0});return document.addEventListener("mousemove",t,!1),document.addEventListener("mousedown",t,!1),document.addEventListener("keydown",t,!1),document.addEventListener("touchmove",t,!1),t}((()=>{this.getAllFrames().map((e=>e.fireChangeLog(Le.USER_ACTIVITY_PULSE,{})))}));this.modal=new ht(this.config,!1,t,n),this.inline=new ht(this.config,!0,t,n),this.maybeStartDeclarativeDom(),this.maybeAddSiteProviderClass(),this.initialized=!0}async preload(e,t,n,i){this.inline.preloadOpts=this.modal.preloadOpts=void 0,i?await this.inline.schedulePreload(i,e,t,n):await this.modal.schedulePreload(document.body,e,t,n)}closeModal(){this.modal.close()}getAllFrames(){return[this.inline,this.modal]}destroy(){this.declarativeDom&&this.declarativeDom.off()}parseQueryOpts(){const e=$t(window.location.search),t=e.ciq_sdk_linkToken,n=e.ciq_sdk_allowedTxnTypes,i={linkToken:t,isNonConsumer:"true"===e.ciq_sdk_isNonConsumer,flowName:e.ciq_sdk_flowName,allowedTxnTypes:Array.isArray(n)?n:n?[n]:[],forceAppIdInDealSummary:"true"===e.ciq_sdk_forceAppIdInDealSummary};if(t){const e=new URL(window.location.href);e.searchParams.set("ciq_sdk_linkToken","consumed"),window.history.replaceState({path:e.href},"",e.href)}return i}maybeStartDeclarativeDom(){this.config.useDeclarativeDom&&(this.declarativeDom=new Zt(this.injectInline,this.openModal,this.getFrameById,!!this.config.useCustomButtons),this.declarativeDom.on())}maybeAddSiteProviderClass(){this.config.siteProvider&&document.body.classList.add(`creditiq-site-provider-${this.config.siteProvider}`)}validateInitialized(){ze()(this.initialized,"creditiq was not been initialized")}validateConfig(e){e=e||this.config,ze()(e,"Missing creditiq config object")}}const Jt=e=>window.ciqUrls?.[e];var en;Jt("API_STAGE"),Jt("API_BASE_URL"),Jt("SOCKET_BASE_URL"),en=Jt("CHECKOUT_BASE_URL")??"checkout.creditiq.com",st=en,window.creditiq||(window.creditiq=new Xt)})(),i})()));